<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>6 Populations in Space | Primer of Ecology using R</title>
<meta name="author" content="Hank Stevens">
<meta name="description" content="Figure 6.1: A frequency distribution of the number of plant species (y-axis) that occupy different numbers of grassland remnants (x-axis). This U-shaped (bimodal) distribution of the number of...">
<meta name="generator" content="bookdown 0.29 with bs4_book()">
<meta property="og:title" content="6 Populations in Space | Primer of Ecology using R">
<meta property="og:type" content="book">
<meta property="og:description" content="Figure 6.1: A frequency distribution of the number of plant species (y-axis) that occupy different numbers of grassland remnants (x-axis). This U-shaped (bimodal) distribution of the number of...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="6 Populations in Space | Primer of Ecology using R">
<meta name="twitter:description" content="Figure 6.1: A frequency distribution of the number of plant species (y-axis) that occupy different numbers of grassland remnants (x-axis). This U-shaped (bimodal) distribution of the number of...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.1/transition.js"></script><script src="libs/bs3compat-0.4.1/tabs.js"></script><script src="libs/bs3compat-0.4.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-VCV8MES4YY"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-VCV8MES4YY');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Primer of Ecology using R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="theory.html"><span class="header-section-number">1</span> Theory in Ecology</a></li>
<li><a class="" href="oft.html"><span class="header-section-number">2</span> Optimal Foraging</a></li>
<li><a class="" href="expo.html"><span class="header-section-number">3</span> Simple density-independent growth</a></li>
<li><a class="" href="DID.html"><span class="header-section-number">4</span> Density-independent Demography</a></li>
<li><a class="" href="DDgrowth.html"><span class="header-section-number">5</span> Density-dependent growth</a></li>
<li><a class="active" href="meta.html"><span class="header-section-number">6</span> Populations in Space</a></li>
<li><a class="" href="comp.html"><span class="header-section-number">7</span> Direct competition and mutualism</a></li>
<li><a class="" href="cr.html"><span class="header-section-number">8</span> Consumer-resource Interactions</a></li>
<li><a class="" href="host-parasitoid-relations.html"><span class="header-section-number">9</span> Host-parasitoid relations</a></li>
<li><a class="" href="disease.html"><span class="header-section-number">10</span> Disease</a></li>
<li><a class="" href="consumer-resource-competition-and-mutualisms.html"><span class="header-section-number">11</span> Consumer-resource Competition and Mutualisms</a></li>
<li><a class="" href="food-webs-and-other-networks.html"><span class="header-section-number">12</span> Food webs and other networks</a></li>
<li><a class="" href="diversity.html"><span class="header-section-number">13</span> Diversity</a></li>
<li><a class="" href="references.html"><span class="header-section-number">14</span> References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="meta" class="section level1" number="6">
<h1>
<span class="header-section-number">6</span> Populations in Space<a class="anchor" aria-label="anchor" href="#meta"><i class="fas fa-link"></i></a>
</h1>
<div class="figure">
<span style="display:block;" id="fig:CandG"></span>
<img src="figs/CandG-1.png" alt="A frequency distribution of the number of plant species (y-axis) that occupy different numbers of  grassland remnants (x-axis). This U-shaped (bimodal) distribution of the number of sites occupied is common, and is consistent with Hanski's model of the rescue effect. Other years were similar (Collins and Glenn 1991)." width="75%"><p class="caption">
Figure 6.1: A frequency distribution of the number of plant species (y-axis) that occupy different numbers of grassland remnants (x-axis). This U-shaped (bimodal) distribution of the number of sites occupied is common, and is consistent with Hanski’s model of the rescue effect. Other years were similar (Collins and Glenn 1991).
</p>
</div>
<p>Over relatively large spatial scales, it is not unusual to have some species that seem to occur everywhere, and many species that are found in only one or a few locations. For example, Scott Collins and Susan Glenn <span class="citation">(<a href="references.html#ref-collins:1991fk" role="doc-biblioref">Collins and Glenn 1991</a>)</span> showed that in grasslands, each separated by up to 4<span class="math inline">\(\,\)</span>km, there were more species occupying only one site (Fig. <a href="meta.html#fig:CandG">6.1</a>, left-most bar) than two or more sites, and also that there are more species occupying all the sites than most intermediate numbers of sites (Fig. <a href="meta.html#fig:CandG">6.1</a>, right-most bar), resulting in a U-shaped frequency distribution. Illke Hanski <span class="citation">(<a href="references.html#ref-hanski1982" role="doc-biblioref">I. Hanski 1982</a>)</span> coined the rare and common species “satellite” and “core” species, respectively, and proposed an explanation. Part of the answer seems to come from <em>the effects of immigration and emigration in a spatial context</em>. In this chapter we explore mathematical representations of individuals and populations in space, and we investigate the consequences for populations and collections of populations.</p>
<div id="source-sink-dynamics" class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> Source-sink Dynamics<a class="anchor" aria-label="anchor" href="#source-sink-dynamics"><i class="fas fa-link"></i></a>
</h2>
In Chapters 3-5, we considered <em>closed</em> populations. In contrast, one could imagine a population governed by <em>b</em>irths plus <em>i</em>mmigration, and <em>d</em>eaths plus <em>e</em>migration (a <em>BIDE</em> model). Ron Pulliam <span class="citation">(<a href="references.html#ref-pulliam:1988ez" role="doc-biblioref">Pulliam 1988</a>)</span> proposed a simple model that includes all four components of <em>BIDE</em> which provides a foundation for thinking about connected subpopulations. We refer to the dynamics of these as <em>source-sink</em> models. Examples include subpopulations of birds inhabit low quality forest patches only because of immigration from high quality forest patches <span class="citation">(<a href="references.html#ref-robinson1995" role="doc-biblioref">Robinson et al. 1995</a>; <a href="references.html#ref-donovan1995" role="doc-biblioref">Dononvan et al. 1995</a>)</span>, or understory palms that inhabitat distinct microhabitats in which seeds move from high to low quality patches <span class="citation">(<a href="references.html#ref-berry2008" role="doc-biblioref">Berry et al. 2008</a>)</span>.
<div class="figure">
<span style="display:block;" id="fig:ssmodel"></span>
<img src="figs/ssmodel-1.png" alt="The simplest source-sink model, where $m_{21} &gt; m_{12}$ so that net movement of individuals is from the source to the sink." width="75%"><p class="caption">
Figure 6.2: The simplest source-sink model, where <span class="math inline">\(m_{21} &gt; m_{12}\)</span> so that net movement of individuals is from the source to the sink.
</p>
</div>
<p>The concept of source-sink populations begins with the assumption that spatially separated subpopulations occupy distinct patches, which each exhibit their own intrinisic dynamics due to births and deaths (Fig. <a href="meta.html#fig:ssmodel">6.2</a>). We can characterize each subpopulation with its own population growth rate, <span class="math inline">\(\lambda_i\)</span>. In addition, individuals migrate between patches. Therefore, the number of individuals we observe in a particular patch is due to both internal dynamics of births and deaths, and also migration.</p>
<p><em>Source populations</em> are those with more births than deaths (<span class="math inline">\(\lambda &gt; 1\)</span>) and with more emigration than immigration. <em>Sink populations</em> are those with fewer births than deaths (<span class="math inline">\(\lambda &lt; 1\)</span>) and with more immigration than emigration.</p>
<p>When we consider causes of variation in <span class="math inline">\(\lambda\)</span>, we often refer to the <em>quality</em> of patches or habitats. High quality patches have are those with high growth rates (<span class="math inline">\(\lambda&gt;1\)</span>), whereas low quality patches are those with low growth rates (<span class="math inline">\(\lambda &lt; 1\)</span>). We might also study factors associated with growth rate, such as the frequency of nesting sites, predator densities, or soil fertility, factors which we predict would regulate growth rates.</p>
<p>Pulliam envisioned two linked bird populations where we track adult reproduction, adult and juvenile survival, and estimate <span class="math inline">\(\lambda_i\)</span> separately for each population. The size of the source population, at time <span class="math inline">\(t+1\)</span> is <span class="math inline">\(n_{1,t+1}\)</span> and is the result of survival and fecundity. Adult survival is <span class="math inline">\(P_A\)</span>, and fecundity results from reproduction by adults, <span class="math inline">\(\beta_1 n_{1,t}\)</span>, times survival of the juveniles <span class="math inline">\(P_J\)</span>. The sink population was modeled the same way.
<span class="math display" id="eq:ss1">\[\begin{align}
  \tag{6.1}
  n_{1, t+1} &amp;= P_A n_{1,t} + \beta_1 n_{1,t}P_J = \lambda_1 n_1\\
  n_{2, t+1} &amp;= P_A n_{2,t} + \beta_2 n_{2,t}P_J = \lambda_2 n_2
\end{align}\]</span></p>
<p>Pulliam then assumed that</p>
<ul>
<li>the two populations vary only in fecundity (<span class="math inline">\(\beta\)</span>), which created differences in growth rates, such that <span class="math inline">\(\lambda_1 &gt; 1 &gt; \lambda_2\)</span>.</li>
<li>birds in excess of the number of territories in the source population emigrated from the source habitat to the sink habitat, <span class="math inline">\(m_{21} = \lambda_1 - 1\)</span>.</li>
</ul>
<p>These assumptions result in the source population maintaining a constant density, while all the excess fecundity migrates to the sink population.</p>
<p>We can use a matrix model to investigate source-sink populations <span class="citation">(e.g., <a href="references.html#ref-berry2008" role="doc-biblioref">Berry et al. 2008</a>)</span>. We place each rate in the respective element in a two-stage matrix model. We assume a pre-breeding census, in which we count only adults. The population dynamics would thus be governed by .</p>
<p><span class="math display" id="eq:SSBerry">\[\begin{equation}
\tag{6.2}
\mathbf{A} = \left(
\begin{array}{cccc}
P_{A1} + P_{J1}\beta_1 &amp;  M_{12} \\
M_{21}  &amp;  P_{A2} +P_{J2}\beta_2
\end{array} \right)
\end{equation}\]</span>
where the upper left element (row 1, column 1) reflects the within-patch growth characteristics for patch 1. The lower right quadrant (row 2, and column 2) reflects the within-patch growth characteristics of patch 2.</p>
<p>Source-sink models assume net migration flows from the source to the sink (<span class="math inline">\(M_{21}&gt;M_{12}\)</span>). We will assume, for simplicity, that migration is exclusively from the source to the sink (<span class="math inline">\(M_{21}&gt;0\)</span>, <span class="math inline">\(M_{12}=0\)</span>). We further assume that <span class="math inline">\(\lambda_1 &gt; 1\)</span> but all excess individuals migrate to patch 2, so <span class="math inline">\(M_{21} = \lambda_1 - 1&gt;0\)</span>. Then simplifies to</p>
<p><span class="math display" id="eq:SSPulliam">\[\begin{equation}
\tag{6.3}
\mathbf{A} = \left(
\begin{array}{cccc}
1 &amp;  0 \\
\lambda_1-1 &amp;  \lambda_2 \\
\end{array} \right)
\end{equation}\]</span></p>
<p>We first assign <span class="math inline">\(\lambda\)</span> for the source and sink populations, and create a matrix.</p>
<div class="sourceCode" id="cb211"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lambda1</span> <span class="op">&lt;-</span> <span class="fl">1.2</span>; <span class="va">lambda2</span> <span class="op">&lt;-</span> <span class="fl">.4</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,    <span class="fl">0</span>, </span>
<span>              <span class="va">lambda1</span><span class="op">-</span><span class="fl">1</span>, <span class="va">lambda2</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">A</span></span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]  1.0  0.0
## [2,]  0.2  0.4</code></pre>
<p>We can then use eigenanalysis, as we did in Chapter 4 for stage structured populations. The dominant eigenvalue will provide the long term asymptotic total population growth. We can calculate the stable stage distribution, which in this case is the distribution of individuals between the two habitats.</p>
<div class="sourceCode" id="cb213"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span><span class="va">eA</span><span class="op">$</span><span class="va">values</span></span></code></pre></div>
<pre><code>## [1] 1.0 0.4</code></pre>
<div class="sourceCode" id="cb215"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate the stable stage distr.</span></span>
<span><span class="op">(</span><span class="va">ssd</span> <span class="op">&lt;-</span> <span class="va">eA</span><span class="op">$</span><span class="va">vectors</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">eA</span><span class="op">$</span><span class="va">vectors</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.75 0.25</code></pre>
<p>From the dominant eigenvalue, we see Pulliam’s working assumption that the total population growth (for the two popuations combined) is <span class="math inline">\(\lambda=1\)</span>. Upon calculating the stable distribution, we also see that the source population contains more individuals than the sink population.</p>
<p>Pulliam explored the consequences of these assumptions for the relative abundances in the two populations. He varied <span class="math inline">\(\lambda_1\)</span> over a range of values and calculated the relative abundance of the source population. We let <code>p1</code> be the proportion of the total population in the source.</p>
<div class="sourceCode" id="cb217"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># a range of lambdas</span></span>
<span><span class="va">lambda1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, by<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># proportion of total N in the source habitat</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">lambda1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">l1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># replace lambda1</span></span>
<span>  <span class="va">A</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">l1</span><span class="op">-</span><span class="fl">1</span></span>
<span>  <span class="co"># extract the dominant eigenvalue</span></span>
<span>  <span class="va">dom.ev</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">$</span><span class="va">vectors</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="co"># calculate the relative abundance of the first pop.</span></span>
<span>  <span class="va">dom.ev</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">dom.ev</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot the result</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">lambda1</span>, y<span class="op">=</span><span class="va">p1</span>, geom<span class="op">=</span><span class="st">"line"</span>, </span>
<span>      ylab<span class="op">=</span><span class="st">"Fraction of total population\n in the source population"</span>,</span>
<span>      xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">)</span> </span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:ssP"></span>
<img src="figs/ssP-1.png" alt="The declining relative abundance in the high quality habitat in a source-sink model. The proportion of the total population ($n_1/(n_1+n_2)$) in the source population may decline with increasing habitat quality and growth rate." width="75%"><p class="caption">
Figure 6.3: The declining relative abundance in the high quality habitat in a source-sink model. The proportion of the total population (<span class="math inline">\(n_1/(n_1+n_2)\)</span>) in the source population may decline with increasing habitat quality and growth rate.
</p>
</div>
<p>One of his main theoretical findings was that <em>relative abundance and population density can be misleading indicators of habitat quality</em> (Fig. <a href="meta.html#fig:ssP">6.3</a>). If we assume that excess individuals in the source migrate to the sink, then as habitat quality and reproduction increase in the source population, the source population comprises <em>an ever decreasing proportion</em> of the total population! That is, as <span class="math inline">\(\lambda_1\)</span> gets larger, <span class="math inline">\(n_1/(n_1+n_2)\)</span> gets smaller. Thus, density can be a very misleading predictor of long-term population viability, if the source population is both productive and exhibits a high degree of emigration.</p>
<div id="complications-and-cases" class="section level3" number="6.1.1">
<h3>
<span class="header-section-number">6.1.1</span> Complications and cases<a class="anchor" aria-label="anchor" href="#complications-and-cases"><i class="fas fa-link"></i></a>
</h3>
<p>Pseudosinks and ecological traps are special cases with counterintuitive dynamics. Pseudosinks are patches in which immigration is so high that it pushes the subpopulation over its carrying capacity and depresses growth rates <span class="citation">(e.g., <a href="references.html#ref-breininger2004" role="doc-biblioref">Breininger and Oddy 2004</a>)</span>. In the absence of immigration, population growth rates would sustain the population (<span class="math inline">\(\lambda &gt; 1\)</span>). Ecological traps are habitats that are preferred by animals, but are actually low quality (<span class="math inline">\(\lambda &lt; 1\)</span>). These can occur, espcially in the face of human-induced rapid environmental change. In many cases, there is a mismatch between sensory traits of organisms and novel environments <span class="citation">(<a href="references.html#ref-robertson:2013tr" role="doc-biblioref">Robertson, Rehage, and Sih 2013</a>)</span>. Like a moth to a flame, as it were.</p>
<p>Ideal free and despotic are two types of distributions of individuals among patches. For both types, we assume that the quality of unoccupied habitats varies among patches. We also assume that individuals have negative effects on quality, for example, through territory occupation or resource use. This means that current habitat quality depends on the original quality of unoccupied habitat and the also the number of occupants. An ideal free distribution of individuals among patches results when individuals distribute themselves in perfect proportion to habitat quality. The net result is that all current patches have equal quality because high quality patches suffer from proportionally more individuals.</p>
<p>In contrast, an ideal despotic distribution arises when individuals always prefer habitat that has higher original quality, <em>until the habitat is full</em>, at which point they use low quality habitat. This is thought to occur where animals are territorial, and prefer the better habitat as long as there is a single territory available.</p>
<p>Balanced dispersal arises when migration occurs at similar rates among patches of similar quality (<span class="math inline">\(\lambda \approx 1\)</span>) but where patches vary in size and population size. This results in the unexpected obervation that migration for small patches with few individuals into large patches occurs nearly as often as the reverse. This means that <em>per capita</em> emigration rates are higher for small patches than large patches. It is not clear why this occurs, but it could could occur if the higher edge:area ratio of smaller patches boosts migration rate <span class="citation">(<a href="references.html#ref-hamback:2007yj" role="doc-biblioref">Hambäack et al. 2007</a>)</span> and the evolution of dispersal characteristics in populations of different sizes <span class="citation">(<a href="references.html#ref-legrand:2017aa" role="doc-biblioref">Legrand et al. 2017</a>; <a href="references.html#ref-mcpeek1992" role="doc-biblioref">McPeek and Holt 1992</a>)</span>.</p>
</div>
</div>
<div id="metapopulations" class="section level2" number="6.2">
<h2>
<span class="header-section-number">6.2</span> Metapopulations<a class="anchor" aria-label="anchor" href="#metapopulations"><i class="fas fa-link"></i></a>
</h2>
<p>The logistic model (Chapter 5) is all well and good, but it has no concept of <em>space</em> built into it. In many, and perhaps most circumstances in ecology, space has the potential to influence the dynamics of populations and ecosystem fluxes <span class="citation">(<a href="references.html#ref-lehman1997" role="doc-biblioref">Lehman and Tilman 1997</a>; <a href="references.html#ref-leibold:2004fe" role="doc-biblioref">Leibold et al. 2004</a>; <a href="references.html#ref-loreau:2003hb" role="doc-biblioref">Loreau, Mouquet, and Holt 2003</a>)</span>. The logistic equation represents a <em>closed</em> population, with no clear accounting for emigration or immigration. In particular cases, however, consideration of space may be essential. What will we learn if we start considering space, such that sites are open to receive immigrants and lose emigrants?</p>
<div class="figure">
<span style="display:block;" id="fig:metapop"></span>
<img src="figs/metapop-1.png" alt="Collections of sites, where each site (A-F) may be a spot of ground potentially occupied by a single plant, or it may be an oceanic island potentially occupied by a butterfly population. Sites may also be colonized via both internal and external sources." width="49%"><img src="figs/metapop-2.png" alt="Collections of sites, where each site (A-F) may be a spot of ground potentially occupied by a single plant, or it may be an oceanic island potentially occupied by a butterfly population. Sites may also be colonized via both internal and external sources." width="49%"><p class="caption">
Figure 6.4: Collections of sites, where each site (A-F) may be a spot of ground potentially occupied by a single plant, or it may be an oceanic island potentially occupied by a butterfly population. Sites may also be colonized via both internal and external sources.
</p>
</div>
<p><strong>A metapopulation is a population of populations</strong> (Fig. <a href="meta.html#fig:metapop">6.4</a>). Modeling metapopulations emerged from work in pest management when <span class="citation">Levins (<a href="references.html#ref-levins1969" role="doc-biblioref">1969</a>)</span> wanted to represent the dynamics of the proportion of fields infested by a pest. He assumed that a field was either occupied by the pest, or not. In this framework, we keep track of the proportion of all populations that remain occupied. He assumed that the metapopulation is closed, in the sense that all migration occurs there exists a finite number of sites which may exchange migrants.</p>
<p>Whether we consider a single spatial population, or single metapopulation, we can envision a <em>collection of sites</em> connected by dispersal. Each site may be a small spot of ground that is occupied by a plant, or it may be an oceanic island that is occupied by a population. All we know about a single site is that it is occupied or unoccupied. If the site is occupied by an individual, we know nothing of how big that individual is; if the site is occupied by a population, we know nothing about how many indiviuals are present. The models we derive below keep track of the proportion of sites that are occupied. These are known loosely as <em>metapopulation models</em>. Although some details can differ, whether we are modeling a collection of spatially discrete individuals in single population or a collection of spatially discrete populations, these two cases share the idea that there are a collection of sites connected by migration, and each is subject to extinction.</p>
<p>The most relevant underlying biology concerns colonization and extinction in our collection of sites (Fig. <a href="meta.html#fig:metapop">6.4</a>). In this chapter, we will assume that all sites experience equal rates. In the one model, we assume that the collection of sites receives propagules from the outside, from some external source that is not influenced by the collection of sites (Fig. <a href="meta.html#fig:metapop">6.4</a>). In all cases, we will consider how total rates of colonization, <span class="math inline">\(C\)</span>, and extinction, <span class="math inline">\(E\)</span>, influence the the rate of change of <span class="math inline">\(p\)</span>, the proportion of sites that are occupied,
<span class="math display">\[\frac{dp}{dt}=C-E.\]</span>
We will consider below, in a somewhat orderly fashion, several permutations of how we represent colonization and extinction of sites <span class="citation">(<a href="references.html#ref-gotelli1993" role="doc-biblioref">N. G. Gotelli and Kelley 1993</a>; <a href="references.html#ref-gotelli1991" role="doc-biblioref">N. J. Gotelli 1991</a>)</span>.</p>
<div id="the-classic-levins-model" class="section level3" number="6.2.1">
<h3>
<span class="header-section-number">6.2.1</span> The classic Levins model<a class="anchor" aria-label="anchor" href="#the-classic-levins-model"><i class="fas fa-link"></i></a>
</h3>
<p><span class="citation">Levins (<a href="references.html#ref-levins1969" role="doc-biblioref">1969</a>)</span> proposed what has become the classic metapopulation model,
<span class="math display" id="eq:intcol">\[\begin{equation}
  \tag{6.4}
  \frac{dp}{dt} = c_{i}p\left(1-p\right) - ep
\end{equation}\]</span>
This equation describes the dynamics of the proportion, <span class="math inline">\(p\)</span>, of a set of fields invaded by a pest. The pest colonizes different fields at a total rate governed by the rate of propagule production, <span class="math inline">\(c_i\)</span>, and also on the proportion of patches that contain the pest, <span class="math inline">\(p\)</span>. Thus, propagules are being scattered around the landscape at rate <span class="math inline">\(c_i p\)</span>. We use the subscript <span class="math inline">\(i\)</span> to remind us that the colonization is coming from within the sites that we are studying (i.e. internal colonization).</p>
<p>The rate at which <span class="math inline">\(p\)</span> changes is also related to the proportion of fields that are unoccupied, <span class="math inline">\((1-p)\)</span>, and are therefore available to become occupied and increase <span class="math inline">\(p\)</span>. The total rate of colonization is <span class="math inline">\(c_ip(1-p)\)</span>. The pest has a constant local extinction rate <span class="math inline">\(e\)</span>, so the total extinction rate in the landscape is <span class="math inline">\(ep\)</span>.</p>
<p>The parameters <span class="math inline">\(c_i\)</span> and <span class="math inline">\(e\)</span> are very similar to <span class="math inline">\(r\)</span> of continuous logistic growth, insofar as they are dimensionless instantaneous rates. However, they are sometimes thought of as probabilities. The parameter <span class="math inline">\(c_i\)</span> is approximately the proportion of open sites colonized per unit time. For instance, if we created or found 100 open sites, we could come back in a year and see how many became occupied over that time interval of one year, and that proportion would be a function of <span class="math inline">\(c_i\)</span>. The parameter <span class="math inline">\(e\)</span> is often thought of as the probability that a site becomes unoccupied per unit time. If we found 100 occupied sites in one year, we could revisit them a year later and see how many became *un}occupied over that time interval of one year.</p>
<p>With internal colonization, we are modeling a closed spatial population of sites, whether “site” refers to an entire field (as above), or a small patch of ground occupied by an individual plant <span class="citation">(<a href="references.html#ref-tilman1994b" role="doc-biblioref">Tilman et al. 1994</a>)</span>.</p>
<p>The Levins metapopulation model: An R function for a differential equation requires arguments for time, a vector of the state variables (here we have one state variable, <span class="math inline">\(p\)</span>), and a vector of parameters.</p>
<div class="sourceCode" id="cb218"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">levins</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">y</span>, <span class="va">parms</span><span class="op">)</span> <span class="op">{</span></span>
<span>       <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="va">parms</span><span class="op">)</span>, <span class="op">{</span></span>
<span>       <span class="va">dp</span> <span class="op">&lt;-</span> <span class="va">ci</span> <span class="op">*</span> <span class="va">p</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span> <span class="op">-</span> <span class="va">e</span> <span class="op">*</span> <span class="va">p</span></span>
<span>       <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">dp</span><span class="op">)</span><span class="op">)</span></span>
<span>       <span class="op">}</span><span class="op">)</span> <span class="op">}</span></span></code></pre></div>
<p>By using <code>with</code>, we can specify the parameters by their names, as long as <code>parms</code> includes names. The function <code><a href="https://rdrr.io/pkg/primer/man/levins.html">levins()</a></code> returns a list that contains a value for the derivative, evaluated at each time point, for each state variable (here merely <span class="math inline">\(dp /dt\)</span>). We then use <code>levins</code> in the numerical integration function <code>ode</code> in the <code>deSolve</code> package.</p>
<div class="sourceCode" id="cb219"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>ci<span class="op">=</span><span class="fl">0.15</span>, e<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="va">Initial.p</span> <span class="op">&lt;-</span> <span class="fl">0.01</span></span>
<span><span class="va">out.L</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/deSolve/man/ode.html">ode</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">Initial.p</span>, times<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, func<span class="op">=</span><span class="va">levins</span>, parms<span class="op">=</span><span class="va">prms</span> <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We then plot the result (Fig. <a href="meta.html#fig:levins">6.5</a>).</p>
<div class="sourceCode" id="cb220"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">out.L</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, y<span class="op">=</span><span class="va">out.L</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, geom<span class="op">=</span><span class="st">"line"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, ylab<span class="op">=</span><span class="st">"p"</span>, xlab<span class="op">=</span><span class="st">"time"</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, <span class="fl">25</span>, <span class="fl">.75</span>, label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/bquote.html">bquote</a></span><span class="op">(</span><span class="fu">over</span><span class="op">(</span><span class="va">dp</span>,<span class="va">dt</span><span class="op">)</span><span class="op">==</span><span class="fu">cp</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">-</span><span class="va">ep</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:levins"></span>
<img src="figs/levins-1.png" alt="The Levins metapopulation model (Levins 1969)." width="75%"><p class="caption">
Figure 6.5: The Levins metapopulation model (Levins 1969).
</p>
</div>
<p>Can we use this model to predict the eventual equilibrium? Sure — we just set <a href="meta.html#eq:intcol">(6.4)</a> to zero and solve for <span class="math inline">\(p\)</span>. This model achieves and equilibrium at,
<span class="math display" id="eq:3">\[\begin{align*}
  \tag{6.5}
  0 &amp;=c_{i}p-c_{i}p^2 - ep\\
  p^* &amp;= \frac{c_{i}-e}{c_{i}}=1-\frac{e}{c_{i}}.
\end{align*}\]</span>
When we do this, we see that <span class="math inline">\(p^* &gt; 0\)</span> as long as <span class="math inline">\(c_i &gt; e\)</span> (e.g., Fig. <a href="meta.html#fig:levins">6.5</a>). When is <span class="math inline">\(p^* = 1\)</span>, so that all the sites are filled? In principle, all sites cannot be occupied simultaneously unless <span class="math inline">\(e=0\)</span>.</p>
</div>
<div id="propagule-rain" class="section level3" number="6.2.2">
<h3>
<span class="header-section-number">6.2.2</span> Propagule rain<a class="anchor" aria-label="anchor" href="#propagule-rain"><i class="fas fa-link"></i></a>
</h3>
<p>From where else might propagules come? If a site is not closed off from the rest of the world, propagules could come from outside the collection of sites that we are actually monitoring.</p>
<p>For now, let us assume that our collection of sites is continually showered by propagules from an external source. If only those propagules are important, then we could represent the dynamics as,
<span class="math display" id="eq:proprain">\[\begin{equation}
  \tag{6.6}
  \frac{dp}{dt} = c_{e}\left(1-p\right) - ep
\end{equation}\]</span>
where <span class="math inline">\(c_{e}\)</span> specifies the rate of colonization coming from the external source. <span class="citation">N. J. Gotelli (<a href="references.html#ref-gotelli1991" role="doc-biblioref">1991</a>)</span> refers to this model as a metapopulation model with propagule rain, or as the island–mainland model. He calls it this because it describes a constant influx of propagules which does not depend on the proportion, <span class="math inline">\(p\)</span>, of sites occupied for propagule production. Extinction here is mediated only by the proportion of sites occupied, and has a constant per site rate.</p>
<p>The propagule rain metapopulation model: An R function for a differential equation requires arguments for time, a vector of the state variables (here we have one state variable, <span class="math inline">\(p\)</span>), and a vector of parameters.</p>
<div class="sourceCode" id="cb221"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gotelli</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span> <span class="va">t</span>, <span class="va">y</span>, <span class="va">parms</span><span class="op">)</span> <span class="op">{</span></span>
<span>       <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="va">parms</span><span class="op">)</span>, <span class="op">{</span></span>
<span>       <span class="va">dp</span> <span class="op">&lt;-</span> <span class="va">ce</span> <span class="op">*</span>  <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span> <span class="op">-</span> <span class="va">e</span> <span class="op">*</span> <span class="va">p</span></span>
<span>       <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">dp</span><span class="op">)</span><span class="op">)</span></span>
<span>       <span class="op">}</span><span class="op">)</span></span>
<span>       <span class="op">}</span></span>
<span><span class="va">prms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>ce<span class="op">=</span><span class="fl">0.15</span>, e<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="va">Initial.p</span> <span class="op">&lt;-</span> <span class="fl">0.01</span></span>
<span><span class="va">out.G</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/deSolve/man/ode.html">ode</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">Initial.p</span>, times<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, func<span class="op">=</span><span class="va">gotelli</span>, parms<span class="op">=</span><span class="va">prms</span> <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We then plot the result (Fig. <a href="meta.html#fig:gotelli">6.6</a>).</p>
<div class="sourceCode" id="cb222"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">out.G</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, y<span class="op">=</span><span class="va">out.G</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, geom<span class="op">=</span><span class="st">"line"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, ylab<span class="op">=</span><span class="st">"p"</span>, xlab<span class="op">=</span><span class="st">"time"</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, <span class="fl">50</span>, <span class="fl">.25</span>, label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/bquote.html">bquote</a></span><span class="op">(</span><span class="fu">over</span><span class="op">(</span><span class="va">dp</span>,<span class="va">dt</span><span class="op">)</span><span class="op">==</span><span class="va">c</span><span class="op">[</span><span class="va">e</span><span class="op">]</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">-</span><span class="va">ep</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:gotelli"></span>
<img src="figs/gotelli-1.png" alt="*Propagule rain metapopulation model (a.k.a. island-mainland model).*" width="75%"><p class="caption">
Figure 6.6: <em>Propagule rain metapopulation model (a.k.a. island-mainland model).</em>
</p>
</div>
<p>We can solve for this model’s equilibrium by setting eq. <span class="math inline">\(\ref{eq:proprain}\)</span> equal to zero.
<span class="math display">\[\begin{align*}
0  &amp;= c_{e}-c_{e}p - ep\\
p^*&amp;=\frac{c_{e}}{c_{e}+e}.
\end{align*}\]</span></p>
<p>Of course, we might also think that both internal and external sources are important, in which case we might want to include both sources in our model,
<span class="math display" id="eq:genmod">\[\begin{align}
  \tag{6.7}
  \frac{dp}{dt} &amp;= (c_{i}p+c_{e})\left(1-p\right) - ep
\end{align}\]</span>
As we have seen before, however, adding more parameters is not something we take lightly. Increasing the number of parameters by 50% could require a lot more effort to estimate.</p>
</div>
<div id="the-rescue-effect-and-the-core-satellite-model" class="section level3" number="6.2.3">
<h3>
<span class="header-section-number">6.2.3</span> The rescue effect and the core-satellite model<a class="anchor" aria-label="anchor" href="#the-rescue-effect-and-the-core-satellite-model"><i class="fas fa-link"></i></a>
</h3>
<p>Thus far, we have ignored what happens between census periods. Imagine that we sample site “A” each year on 1 January. It is possible that between 2 January and 31 December the population at site A becomes extinct and then is subsequently recolonized, or “rescued” from extinction. When we sample on 1 January in the next year, we have no way of knowing what has happened in the intervening time period. We would not realize that the population had become extinct and recolonization had occurred.</p>
<p>We can, however, model total extinction rate <span class="math inline">\(E\)</span> with this <em>rescue effect</em>,
<span class="math display" id="eq:reseff">\[\begin{equation}
  \tag{6.8}
  E = - ep\left( 1-p \right).
\end{equation}\]</span>
Note that as <span class="math inline">\(p \rightarrow 1\)</span>, the total extinction rate approaches zero. Total extinction rate declines because as the proportion of sites occupied increases, it becomes increasingly likely that dispersing propagules will land on all sites. When propagules happen to land on sites that are on the verge of extinction, they can “rescue” that site from extinction.</p>
<p><span class="citation">J. H. Brown and Kodric-Brown (<a href="references.html#ref-brown1977a" role="doc-biblioref">1977</a>)</span> found that enhanced opportunity for immigration seemed to reduce extinction rates in arthropod communities on thistles. They coined this effect of immigration on extinction as the <em>rescue effect.</em> <span class="citation">Robert H. MacArthur and Wilson (<a href="references.html#ref-macarthur1963" role="doc-biblioref">1963</a>)</span> also discussed this idea in the context of island biogeography. We can even vary the strength of this effect by adding yet another parameter <span class="math inline">\(q\)</span>, such that the total extinction rate is <span class="math inline">\(-ep\left( 1-qp \right)\)</span> <span class="citation">(<a href="references.html#ref-gotelli1993" role="doc-biblioref">N. G. Gotelli and Kelley 1993</a>)</span>.</p>
<p>Assuming only internal propagule supply and the simple rescue effect results in what is referred to as the the core-satellite model,
<span class="math display" id="eq:CoreSat1">\[\begin{align}
  \tag{6.9}
  \frac{dp}{dt} &amp;= c_ip\left(1-p\right) - ep\left( 1-p \right)
\end{align}\]</span>
This model was made famous by Illka Hanski <span class="citation">(<a href="references.html#ref-hanski1982" role="doc-biblioref">I. Hanski 1982</a>)</span>. It is referred to as the <em>core-satellite</em> model because Hanski showed that it predicts precisely the pattern we saw in Fig. <a href="meta.html#fig:CandG">6.1</a> at the beginning of the chapter.</p>
<p>The core-satellite metapopulation model: A function for a differential equation requires arguments for time, a vector of the state variables (here we have one state variable, <span class="math inline">\(p\)</span>), and a vector of parameters.</p>
<div class="sourceCode" id="cb223"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hanski</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span> <span class="va">t</span>, <span class="va">y</span>, <span class="va">parms</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span><span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="va">parms</span><span class="op">)</span>, <span class="op">{</span></span>
<span>       <span class="va">dp</span> <span class="op">&lt;-</span> <span class="va">ci</span> <span class="op">*</span> <span class="va">p</span> <span class="op">*</span>  <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span> <span class="op">-</span> <span class="va">e</span> <span class="op">*</span> <span class="va">p</span> <span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span></span>
<span>       <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">dp</span><span class="op">)</span><span class="op">)</span></span>
<span>       <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">prms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>ci<span class="op">=</span><span class="fl">0.15</span>, e<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="va">Initial.p</span> <span class="op">&lt;-</span> <span class="fl">0.01</span></span>
<span><span class="va">out.H</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/deSolve/man/ode.html">ode</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">Initial.p</span>, times<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, func<span class="op">=</span><span class="va">hanski</span>, parms<span class="op">=</span><span class="va">prms</span> <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We then plot the result (Fig. <a href="meta.html#fig:hanski">6.7</a>).</p>
<div class="sourceCode" id="cb224"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">out.H</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, y<span class="op">=</span><span class="va">out.H</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, geom<span class="op">=</span><span class="st">"line"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, ylab<span class="op">=</span><span class="st">"p"</span>, xlab<span class="op">=</span><span class="st">"time"</span><span class="op">)</span>  <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, <span class="fl">50</span>, <span class="fl">.25</span>, label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/bquote.html">bquote</a></span><span class="op">(</span><span class="fu">over</span><span class="op">(</span><span class="va">dp</span>,<span class="va">dt</span><span class="op">)</span><span class="op">==</span><span class="va">c</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">*</span><span class="fu">p</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">-</span><span class="fu">ep</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:hanski"></span>
<img src="figs/hanski-1.png" alt="The core-satellite metapopulation model, with the rescue effect." width="75%"><p class="caption">
Figure 6.7: The core-satellite metapopulation model, with the rescue effect.
</p>
</div>
<p>What is the equilibrium for the Hanski mode (eq. <a href="meta.html#eq:CoreSat1">(6.9)</a>)? We can rearrange this to further simplify solving for <span class="math inline">\(p^*\)</span>.
<span class="math display" id="eq:CoreSat2">\[\begin{align}
\tag{6.10}
  \frac{dp}{dt} &amp;= \left(c_i-e \right) p \left(1-p\right)
\end{align}\]</span>
This shows us that for any value of <span class="math inline">\(p\)</span> between zero and one, the sign of the growth rate (positive or negative) is determined by <span class="math inline">\(c_i\)</span> and <span class="math inline">\(e\)</span>.</p>
<p>If <span class="math inline">\(c_i&gt;e\)</span>, the rate of increase will always be positive, and because occupancy cannot exceed 1.0, the metapopulation will go to full occupancy (<span class="math inline">\(p^*=1\)</span>), and stay there. This equilibrium will be a <em>stable attractor</em> or stable equilibrium. What happens if for some reason the metapopulation becomes globally extinct, such that <span class="math inline">\(p=0\)</span>, even though <span class="math inline">\(c_i&gt;e\)</span>? If <span class="math inline">\(p=0\)</span>, then like logistic growth, the metapopulation stops changing and cannot increase. However, the slightest perturbation away from <span class="math inline">\(p=0\)</span> will lead to a positive growth rate, and increase toward the stable attractor, <span class="math inline">\(p^*=1\)</span>. In this case, we refer to <span class="math inline">\(p^*=0\)</span> as an unstable equilibrium and a <em>repellor</em>.</p>
<p>Let’s explore the stability of these equilibria by plotting the metapopulation growth rate as a function of <span class="math inline">\(p\)</span> (Fig. <a href="meta.html#fig:hanskiP">6.8</a>). When we set <span class="math inline">\(c_i&gt;e\)</span>, and examine the slope of that line at <span class="math inline">\(p^*=1\)</span>, we see the slope is negative, indicating a stable equilibrium. At <span class="math inline">\(p^*=0\)</span> the slope is positive, indicating an unstable equilibrium.</p>
<div class="sourceCode" id="cb225"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dpdtCS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="op">(</span><span class="va">ci</span><span class="op">-</span><span class="va">e</span><span class="op">)</span><span class="op">*</span><span class="va">p</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ci</span> <span class="op">&lt;-</span> <span class="fl">0.15</span>; <span class="va">e</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>, length<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">dp.dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="va">dpdtCS</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">dp.dt</span>, geom<span class="op">=</span><span class="st">"line"</span>, ylab<span class="op">=</span><span class="st">"dp/dt"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:hanskiP"></span>
<img src="figs/hanskiP-1.png" alt="Metapopulation growth rate as a function of $p$, in the core-satellite model when $c_i &gt; e$. We see that growth rate falls to zero at full occupancy (i.e., at $p^*=1$). At that point, the slope is negative, indicating that this equilibrium is stable." width="90%"><p class="caption">
Figure 6.8: Metapopulation growth rate as a function of <span class="math inline">\(p\)</span>, in the core-satellite model when <span class="math inline">\(c_i &gt; e\)</span>. We see that growth rate falls to zero at full occupancy (i.e., at <span class="math inline">\(p^*=1\)</span>). At that point, the slope is negative, indicating that this equilibrium is stable.
</p>
</div>
<p>If <span class="math inline">\(c_i&lt;e\)</span>, the rate of increase will always be negative, and because occupancy cannot be less than 0, the metapopulation will become extinct (<span class="math inline">\(p^*=0\)</span>), and stay there. Thus <span class="math inline">\(p^*=0\)</span> would be a stable equilibrium or attractor. What is predicted to happen if, for some odd reason this population achieved full occupancy, <span class="math inline">\(p=1\)</span>, even though <span class="math inline">\(c_i&lt;e\)</span>? In that case, <span class="math inline">\((1-p)=0\)</span>, and the rate of change goes to zero, and the population is predicted to stay there, even though extinction is greater than colonization. How weird is that? Is this fatal flaw in the model, or an interesting prediction resulting from a thorough examination of the model? How relevant is it? How could we evaluate how relevant it is? We will discuss this a little more below, when we discuss the effects of habitat destruction.</p>
<p>What happens when <span class="math inline">\(c_i=e\)</span>? In that case, <span class="math inline">\(c_i - e = 0\)</span>, and the population stops changing. What is the value of <span class="math inline">\(p\)</span> when it stops changing? It seems as though it could be any value of <span class="math inline">\(p\)</span>, because if <span class="math inline">\(c_i-e=0\)</span>, the rate change goes to zero. What will happen if the population gets perturbed — will it return to its previous value? Let’s return to question in a bit.</p>
<p>To analyze stability in logistic growth, we examined the slope of the partial derivative at the equilibrium, and we can do that here. We find that the partial derivative of <a href="meta.html#eq:CoreSat1">(6.9)</a> with respect to <span class="math inline">\(p\)</span> is
<span class="math display" id="eq:CoreSatPD1">\[\begin{equation}
  \tag{6.11}
  \frac{\partial \dot{p}}{\partial p} = c_i - 2c_i p - e + 2ep
\end{equation}\]</span>
where <span class="math inline">\(\dot{p}\)</span> is the time derivative <a href="meta.html#eq:CoreSat1">(6.9)</a>. A little puzzling and rearranging will make things a little simpler.
<span class="math display" id="eq:CoreSatPD2">\[\begin{equation}
  \tag{6.12}
  \frac{\partial \dot{p}}{\partial p} = \left(c_i - e\right)\left(1-2p\right)
\end{equation}\]</span>
Recall our rules with regard to stability (Chapter 5). If the partial derivative (the slope of the time derivative) is negative at an equilibrium, it means the the growth rate approaches zero following a perturbation, meaning that it is stable. If the partial derivative is positive, it means that the change accelerates away from zero following the perturbation, meaning that the equilibrium is unstable. So, we find the following guidelines:</p>
<ul>
<li>
<span class="math inline">\(c_i&gt;e\)</span>
<ul>
<li>
<span class="math inline">\(p=1\)</span>, <span class="math inline">\(\partial \dot{p}/ \partial p &lt; 0\)</span>, stable equilibrium.<br>
</li>
<li>
<span class="math inline">\(p=0\)</span>, <span class="math inline">\(\partial \dot{p}/ \partial p&gt;0\)</span>, unstable equilibrium.</li>
</ul>
</li>
<li>
<span class="math inline">\(c_i &lt; e\)</span>
<ul>
<li>
<span class="math inline">\(p=1\)</span>, <span class="math inline">\(\partial \dot{p}/ \partial p &gt; 0\)</span>, unstable equilibrium.<br>
</li>
<li>
<span class="math inline">\(p=0\)</span>, <span class="math inline">\(\partial \dot{p}/ \partial p &lt; 0\)</span>, stable equilibrium.</li>
</ul>
</li>
</ul>
<p>What if <span class="math inline">\(c_i=e\)</span>? In that case, both the time derivative (<span class="math inline">\(d p / dt\)</span>) and the partial derivative (<span class="math inline">\(\partial \dot{p}/ \partial p\)</span>) are zero <em>for all values of p</em>. Therefore, if the population gets displaced from any arbitrary point, it will remain unchanged, not recover, and will stay displaced. We call this odd state of affairs a <em>neutral equilibrium</em>. We revisit neutral equilibrium when we discuss interspecific competition and predation.</p>
</div>
<div id="parallels-with-logistic-growth" class="section level3" number="6.2.4">
<h3>
<span class="header-section-number">6.2.4</span> Parallels with Logistic Growth<a class="anchor" aria-label="anchor" href="#parallels-with-logistic-growth"><i class="fas fa-link"></i></a>
</h3>
<p>
It may have already occurred to you that the closed spatial population described here sounds a lot like simple logistic growth. A closed population, spatial or not, reproduces in proportion to its density, and is limited by its own density. Here we will make the connection a little more clear. It turns out that a simple rearrangement of <a href="meta.html#eq:intcol">(6.4)</a> will provide the explicit connection between logistic growth and the spatial population model with internal colonization <span class="citation">(<a href="references.html#ref-roughgarden1998" role="doc-biblioref">Roughgarden 1998</a>)</span>.</p>
<p>Imagine for a moment that you are an avid birder following a population of Song Sparrows in Darrtown, OH, USA (Ch. 5). If Song Sparrows are limited by the number of territories, and males are competing for territories, then you could think about male Song Sparrows as “filling up” some proportion, <span class="math inline">\(p\)</span>, of the available habitat. Each territory is thus like a local population, but where a pair of sparrows either occupies a site, or not, and the proportion of all territories that are occupied is <span class="math inline">\(p\)</span>. You therefore decide that you would like to use Levins’ spatially-implicit metapopulation model instead <a href="meta.html#eq:intcol">(6.4)</a>. How will you do it? You do it by <em>rescaling</em> logistic growth, <span class="math inline">\(dN/dt = rN(1-\alpha N)\)</span>.</p>
<p>Let us start by defining our logistic model variables in other terms. First we define <span class="math inline">\(N\)</span> as
<span class="math display">\[\begin{equation*}
  N=Hp
\end{equation*}\]</span>
where <span class="math inline">\(N\)</span> is the number of males defending territories, <span class="math inline">\(H\)</span> is the total number of possible territories, and <span class="math inline">\(p\)</span> is the proportion of possible territories occupied at any one time. At equilibrium, <span class="math inline">\(N^*=K=Hp^*\)</span>, and <span class="math inline">\(\alpha=1/(Hp^*)\)</span>. Recall that for the Levins model, <span class="math inline">\(p^*=(c_i-e)/c_i\)</span>, so therefore,
<span class="math display">\[\alpha = \frac{c_i}{H\left(c_i - e\right)}\]</span>
We now have <span class="math inline">\(N\)</span>, <span class="math inline">\(\alpha\)</span>, and <span class="math inline">\(K\)</span> in terms of <span class="math inline">\(p\)</span>, <span class="math inline">\(H\)</span>, <span class="math inline">\(c_i\)</span> and <span class="math inline">\(e\)</span>, so what about <span class="math inline">\(r\)</span>? Recall that for logistic growth, the per capita growth rate goes to <span class="math inline">\(r\)</span> as <span class="math inline">\(N \to 0\)</span> (Chapter 3). For the Levins metapopulation model, the per patch growth rate is
<span class="math display">\[\begin{align}
  \frac{1}{p}\frac{dp}{dt}&amp;=c_{i}\left(1-p\right) - e.
\end{align}\]</span>
As <span class="math inline">\(p \to 0\)</span> this expression simplifies to <span class="math inline">\(c_i-e\)</span>, which is equivalent to <span class="math inline">\(r\)</span>. Summarizing, then, we have,
<span class="math display" id="eq:5">\[\begin{gather}
  \tag{6.13}
  r=c_i-e\\
  N=Hp\\
  \alpha = \frac{1}{K} = \frac{1}{Hp^*} = \frac{c_i}{H\left(c_i-e\right)}
\end{gather}\]</span></p>
<p>Substituting into logistic growth (<span class="math inline">\(\dot{N} = rN(1-\alpha N)\)</span>), we now have
<span class="math display" id="eq:6">\[\begin{align}
\tag{6.14}
  \frac{d(pH)}{dt} &amp;= \left(c_i-e\right)pH\left(1-\frac{c_i}{H\left(c_i-e\right)}Hp\right)\\
  &amp;= \left(c_i-e\right)pH - \frac{ c_i-e }{c_i-e}c_ip^2H\\
  &amp;= H\left(c_ip\left(1-p\right) - ep \right)
\end{align}\]</span>
which is almost the Levins model. If we note that <span class="math inline">\(H\)</span> is a constant, we realize that we can divide both sides by <span class="math inline">\(H\)</span>, ending up with the Levins model <a href="meta.html#eq:intcol">(6.4)</a>.</p>
</div>
<div id="levins-vs.-hanski" class="section level3" number="6.2.5">
<h3>
<span class="header-section-number">6.2.5</span> Levins <span class="math inline">\(vs\)</span>. Hanski<a class="anchor" aria-label="anchor" href="#levins-vs.-hanski"><i class="fas fa-link"></i></a>
</h3>
<p>Why would we use Levins’ model instead of Hanski’s core-satellite model? To explore this possibility, let’s see how the Hanski model might change gradually into the Levins model. First we define the Hanski model with an extra parameter, <span class="math inline">\(a\)</span>,
<span class="math display" id="eq:7">\[\begin{equation}
  \tag{6.15}
  \frac{dp}{dt} = c_ip\left(1-p\right) - ep\left(1-ap\right).
\end{equation}\]</span>
Under Hanski’s model, <span class="math inline">\(a=1\)</span> and under Levins’ model <span class="math inline">\(a=0\)</span>. If we solve for the equilibrium, we see that
<span class="math display" id="eq:8hanski">\[\begin{equation}
  \tag{6.16}
  p^*=\frac{c-e}{c-ae}
\end{equation}\]</span>
so that we can derive either result for the two models. In the context of logistic growth, where <span class="math inline">\(K=Hp^*\)</span>, this result <a href="meta.html#eq:8hanski">(6.16)</a> implies that for the Hanski model, <span class="math inline">\(K\)</span> fills all available habitat, whereas the Levins model implies that <span class="math inline">\(K\)</span> fills only a fraction of the total available habitat. That fraction results from the dynamic balance between <span class="math inline">\(c_i\)</span> and <span class="math inline">\(e\)</span>.</p>
</div>
<div id="habitat-destruction" class="section level3" number="6.2.6">
<h3>
<span class="header-section-number">6.2.6</span> Habitat Destruction<a class="anchor" aria-label="anchor" href="#habitat-destruction"><i class="fas fa-link"></i></a>
</h3>
<p>Other researchers have investigated effects of habitat loss on metapopulation dynamics <span class="citation">(<a href="references.html#ref-kareiva:1995kx" role="doc-biblioref">Kareiva and Wennergren 1995</a>; <a href="references.html#ref-nee:1992vn" role="doc-biblioref">Nee and May 1992</a>; <a href="references.html#ref-tilman1994b" role="doc-biblioref">Tilman et al. 1994</a>)</span>. Taking inspiration from the work of Lande <span class="citation">(<a href="references.html#ref-lande:1987uq" role="doc-biblioref">Lande 1987</a>, <a href="references.html#ref-lande:1988ad" role="doc-biblioref">1988</a>)</span>, <span class="citation">Kareiva and Wennergren (<a href="references.html#ref-kareiva:1995kx" role="doc-biblioref">1995</a>)</span> modeled the effect of habitat destruction, <span class="math inline">\(D\)</span>, on overall immigration probability. They incorporated this into Levins’ model as
<span class="math display" id="eq:D">\[\begin{equation}
  \tag{6.17}
\frac{dp}{dt}=c_ip(1-D-p) - ep
\end{equation}\]</span>
where <span class="math inline">\(D\)</span> is the amount of habitat destroyed, expressed as a fraction of the original total available habitat.</p>
<p>To turn eq. <a href="meta.html#eq:D">(6.17)</a> into a function we can use with <code>ode</code>, we have,</p>
<div class="sourceCode" id="cb226"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lande</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">y</span>, <span class="va">parms</span><span class="op">)</span> <span class="op">{</span></span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">y</span>,<span class="va">parms</span><span class="op">)</span><span class="op">)</span>, <span class="op">{</span></span>
<span>       <span class="va">dp</span> <span class="op">&lt;-</span> <span class="va">ci</span> <span class="op">*</span> <span class="va">p</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">D</span><span class="op">-</span><span class="va">p</span><span class="op">)</span> <span class="op">-</span> <span class="va">e</span> <span class="op">*</span> <span class="va">p</span></span>
<span>       <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">dp</span><span class="op">)</span><span class="op">)</span></span>
<span>       <span class="op">}</span><span class="op">)</span> <span class="op">}</span></span>
<span><span class="va">prmsD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>ci<span class="op">=</span><span class="fl">0.15</span>, e<span class="op">=</span><span class="fl">0.05</span>, D<span class="op">=</span><span class="fl">.2</span><span class="op">)</span></span>
<span><span class="va">Initial.p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>p<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">out.D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/deSolve/man/ode.html">ode</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">Initial.p</span>, times<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, func<span class="op">=</span><span class="va">lande</span>, parms<span class="op">=</span><span class="va">prmsD</span> <span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">out.D</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, y<span class="op">=</span><span class="va">out.D</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, geom<span class="op">=</span><span class="st">"line"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, ylab<span class="op">=</span><span class="st">"p"</span>, xlab<span class="op">=</span><span class="st">"time"</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, <span class="fl">25</span>, <span class="fl">.75</span>, </span>
<span>           label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/bquote.html">bquote</a></span><span class="op">(</span> <span class="fu">over</span><span class="op">(</span><span class="va">dp</span>,<span class="va">dt</span><span class="op">)</span><span class="op">==</span><span class="va">c</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">*</span><span class="fu">p</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">D</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">-</span><span class="va">ep</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:lande"></span>
<img src="figs/lande-1.png" alt="A metapopulation model with habitat destruction." width="75%"><p class="caption">
Figure 6.9: A metapopulation model with habitat destruction.
</p>
</div>
<p>Habitat destruction, <span class="math inline">\(D\)</span>, may vary between 0 (<span class="math inline">\(=\)</span> Levins model) to complete habitat loss 1.0; obviously the most interesting results will come for intermediate values of <span class="math inline">\(D\)</span>, which we illustrate next.</p>
</div>
<div id="illustrating-the-effects-of-habitat-destruction" class="section level3" number="6.2.7">
<h3>
<span class="header-section-number">6.2.7</span> Illustrating the effects of habitat destruction<a class="anchor" aria-label="anchor" href="#illustrating-the-effects-of-habitat-destruction"><i class="fas fa-link"></i></a>
</h3>
<p>We can plot the dynamics for three levels of destruction, starting with none (<span class="math inline">\(D=0\)</span>). We first set all the parameters, and time.</p>
<div class="sourceCode" id="cb227"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">200</span></span>
<span><span class="va">prmsD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>ci<span class="op">=</span><span class="fl">0.15</span>, e<span class="op">=</span><span class="fl">0.05</span>, D<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">Initial.p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>p<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">200</span></span>
<span><span class="va">D0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/deSolve/man/ode.html">ode</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">Initial.p</span>, times<span class="op">=</span><span class="va">t</span>, func<span class="op">=</span><span class="va">lande</span>, parms<span class="op">=</span><span class="va">prmsD</span> <span class="op">)</span></span>
<span><span class="va">prmsD</span><span class="op">[</span><span class="st">"D"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span><span class="va">D.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/deSolve/man/ode.html">ode</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">Initial.p</span>, times<span class="op">=</span><span class="va">t</span>, func<span class="op">=</span><span class="va">lande</span>, parms<span class="op">=</span><span class="va">prmsD</span> <span class="op">)</span></span>
<span><span class="va">prmsD</span><span class="op">[</span><span class="st">"D"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">D.5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/deSolve/man/ode.html">ode</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">Initial.p</span>, times<span class="op">=</span><span class="va">t</span>, func<span class="op">=</span><span class="va">lande</span>, parms<span class="op">=</span><span class="va">prmsD</span> <span class="op">)</span></span>
<span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind.data.frame</a></span><span class="op">(</span><span class="va">D0</span>, <span class="va">D.2</span>, <span class="va">D.5</span><span class="op">)</span></span>
<span><span class="va">ps</span><span class="op">$</span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.2</span>, <span class="fl">.5</span><span class="op">)</span>, each<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<p>Last, we plot it and add some useful labels.</p>
<div class="sourceCode" id="cb228"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">ps</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">p</span>, linetype<span class="op">=</span><span class="va">D</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:lande3"></span>
<img src="figs/lande3-1.png" alt="Three different levels of habitat destruction." width="90%"><p class="caption">
Figure 6.10: Three different levels of habitat destruction.
</p>
</div>
<p>What is the equilibrium under this model? Setting eq. <span class="math inline">\(\ref{eq:D}\)</span> to zero, we can then solve for <span class="math inline">\(p\)</span>.
<span class="math display" id="eq:Deq">\[\begin{gather}
  \tag{6.18}
  0=c_i-c_iD-c_ip - e\\
  p^* = \frac{c_i-c_iD - e}{c_i} = 1 -  \frac{e}{c_i} - D
\end{gather}\]</span>
Thus we see that habitat destruction has a simple direct effect on the metapopulation.</p>
</div>
<div id="different-assumptions-lead-to-different-predictions-about-rates-of-extinction" class="section level3" number="6.2.8">
<h3>
<span class="header-section-number">6.2.8</span> Different assumptions lead to different predictions about rates of extinction<a class="anchor" aria-label="anchor" href="#different-assumptions-lead-to-different-predictions-about-rates-of-extinction"><i class="fas fa-link"></i></a>
</h3>
<p>Let us return now to the case in the core-satellite model where <span class="math inline">\(c_i &lt; e\)</span> and <span class="math inline">\(p=1\)</span>. Recall that in this case, <span class="math inline">\(p=1\)</span> is an <em>unstable</em> equilibrium (<span class="math inline">\(p=0\)</span> is the stable equilibrium for <span class="math inline">\(c_i&lt;e\)</span>).</p>
<p>Imagine that at one time, a metapopulation is regulated by the mechanisms in the core-satellite model, including the rescue effect, and <span class="math inline">\(c_i&gt;e\)</span>. We therefore pretend that, the metapopulation occupies virtually every habitable site (let <span class="math inline">\(p=0.999\)</span>). Now imagine that the environment changes, causing <span class="math inline">\(c_i&lt;e\)</span>. Perhaps climate change enhances extinction rates. All of a sudden, our metapopulation is poised near an unstable equilibrium, with
<span class="math display">\[p=0.999\quad ; \quad c_i &lt; e\]</span>.
What will happen and how might it differ with and without the assumption of the rescue effect?</p>
<p>When <span class="math inline">\(c_i &gt; e\)</span>, we see that <span class="math inline">\(p^*=1\)</span> is the stable attractor (Fig. <a href="meta.html#fig:hanski2">6.11</a>). If extinction rates rise so that <span class="math inline">\(c_i &lt; e\)</span>, we see the inevitable march toward extinction predicted by the core-satellite model (Fig. <a href="meta.html#fig:hanski2">6.11</a>). The decline starts slowly and remains slow, until it begins to gradually accelerate. Do all metapopulation models make the same predictions?</p>
<p>If we try this experiment with the Levins model, we see something very different. The Levins model predicts very rapid decline once <span class="math inline">\(c_i &lt; e\)</span>. Both models predict extinction, but the rescue effect delays the appearance of that extinction. It appears that the rescue effect (which is the difference between the two models) may act a bit like the ``extinction debt’’ <span class="citation">(<a href="references.html#ref-tilman1994b" role="doc-biblioref">Tilman et al. 1994</a>)</span> wherein deterministic extinction of a dominant species in a multi-species community is merely delayed, but not postponed indefinitely. Perhaps populations influenced by the rescue effect might be prone to unexpected collapse, if the only stable equilibria are 1 and 0. Thus simple theory can provide interesting insight, resulting in very different predictions for superficially similar processes.</p>
<p>Here we show the unexpected collapse of core populations, starting at or near equilbrium. The first two use the Hanski model, while the third uses Levins. The second and third use <span class="math inline">\(c_i &lt; e\)</span>.</p>
<div class="sourceCode" id="cb229"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">C1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/deSolve/man/ode.html">ode</a></span><span class="op">(</span>y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>p<span class="op">=</span><span class="fl">0.999</span><span class="op">)</span>, times<span class="op">=</span><span class="va">t</span>, func<span class="op">=</span><span class="va">hanski</span>, parms<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>ci<span class="op">=</span><span class="fl">0.2</span>, e<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">C2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/deSolve/man/ode.html">ode</a></span><span class="op">(</span>y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>p<span class="op">=</span><span class="fl">0.999</span><span class="op">)</span>, times<span class="op">=</span><span class="va">t</span>, func<span class="op">=</span><span class="va">hanski</span>, parms<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>ci<span class="op">=</span><span class="fl">0.2</span>, e<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">L2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/deSolve/man/ode.html">ode</a></span><span class="op">(</span>y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>p<span class="op">=</span><span class="fl">0.999</span><span class="op">)</span>, times<span class="op">=</span><span class="va">t</span>, func<span class="op">=</span><span class="va">levins</span>, parms<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>ci<span class="op">=</span><span class="fl">0.2</span>, e<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">coll</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind.data.frame</a></span><span class="op">(</span><span class="va">C1</span>, <span class="va">C2</span>, <span class="va">L2</span><span class="op">)</span></span>
<span><span class="va">coll</span><span class="op">$</span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"c&gt;e"</span>, <span class="st">"c&lt;e"</span>, <span class="st">"c&lt;e (Levins)"</span><span class="op">)</span>, each<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">L2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                     levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"c&gt;e"</span>, <span class="st">"c&lt;e"</span>, <span class="st">"c&lt;e (Levins)"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">coll</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">p</span>, linetype<span class="op">=</span><span class="va">model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:hanski2"></span>
<img src="figs/hanski2-1.png" alt="Metapopulation dynamics, starting from near equilibrium for $c_i=0.20$ and $e=0.01$. If the environment changes, causing extinction rate to increase until it is greater than colonization rate, we may observe greatly delayed, but inevitable, extinction (e.g., $c_i=0.20, e=0.25$)" width="90%"><p class="caption">
Figure 6.11: Metapopulation dynamics, starting from near equilibrium for <span class="math inline">\(c_i=0.20\)</span> and <span class="math inline">\(e=0.01\)</span>. If the environment changes, causing extinction rate to increase until it is greater than colonization rate, we may observe greatly delayed, but inevitable, extinction (e.g., <span class="math inline">\(c_i=0.20, e=0.25\)</span>)
</p>
</div>
</div>
</div>
<div id="hanskis-incidence-function" class="section level2" number="6.3">
<h2>
<span class="header-section-number">6.3</span> Hanski’s incidence function<a class="anchor" aria-label="anchor" href="#hanskis-incidence-function"><i class="fas fa-link"></i></a>
</h2>
<p>The above models of metapopulation dynamics provide an outline for understanding metapopulation dynamics. However, they do not necessarily provide a direct means to interrogate data or use data illuminate our understanding. One of the main reasons for this is that they do not address two important ecological realities: that patches will be differ in area and thus differ in population sizes, and that they are different distances from each other. <span class="citation">Robert H. MacArthur and Wilson (<a href="references.html#ref-macarthur1963" role="doc-biblioref">1963</a>)</span> argued persuasively that extinction risk should be related to area, and that distance from a source should influence the probability of colonization. <span class="citation">Ii. Hanski (<a href="references.html#ref-hanski1994" role="doc-biblioref">1994</a>)</span> provided an approach using <em>incidence functions</em>, which predict the probability of occurrence. They allow us to incorporate area and distance in our model, and uses easily acquired patch occupancy data (presence/absence data) to evaluate metapopulation characteristics.</p>
<p>The <strong>incidence of occupancy</strong> is determined by colonization and extinction probabilities. We will assume that if a patch <span class="math inline">\(i\)</span> is empty in year <span class="math inline">\(t\)</span>, it will be recolonized in year <span class="math inline">\(t+1\)</span> with a probability <span class="math inline">\(C_i\)</span>. This also means it will remain empty with probability of <span class="math inline">\(1-C_i\)</span>. If a patch <span class="math inline">\(j\)</span> is occupied in year <span class="math inline">\(t\)</span>, it will become extinct in year <span class="math inline">\(t+1\)</span> with probability <span class="math inline">\(E_i\)</span>. This also means that it will persist with probability <span class="math inline">\(1-E_i\)</span>.</p>
<p>The two states for one patch are illustrated with the code and figure below. Each column of the matrix is the probabilities for one state. Te first column comprises the probabilities of remaining empty or changing from empty to occupied. The second column comprises the probabilities that an occupied patch becomes empty or remains occupied.</p>
<div class="sourceCode" id="cb230"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">C</span> <span class="op">&lt;-</span> <span class="fl">.3</span>; <span class="va">E</span> <span class="op">&lt;-</span> <span class="fl">.5</span></span>
<span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">C</span>, <span class="va">E</span>,</span>
<span>              <span class="va">C</span>, <span class="fl">1</span><span class="op">-</span><span class="va">E</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"empty"</span>, <span class="st">"occupied"</span><span class="op">)</span></span>
<span><span class="va">M</span></span></code></pre></div>
<pre><code>##          empty occupied
## empty      0.7      0.5
## occupied   0.3      0.5</code></pre>
<div class="sourceCode" id="cb232"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">{</span></span>
<span>  <span class="fu">plotmat</span><span class="op">(</span><span class="va">M</span>, pos<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="co">#requires the diagram package</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span><span class="st">"The two states of one patch"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="inline-figure"><img src="figs/unnamed-chunk-76-1.png" width="90%"></div>
<p>The probability, <span class="math inline">\(J_i\)</span>, that a patch is occupied at any given time is,
<span class="math display">\[J_i = \frac{C_i}{C_i + E_i}.\]</span></p>
<p>We can show this by calculating the stable distribution of these states using eigenanalysis in the way we did for demographic matrices.</p>
<div class="sourceCode" id="cb233"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># J</span></span>
<span><span class="op">(</span><span class="va">J</span> <span class="op">&lt;-</span> <span class="va">C</span><span class="op">/</span><span class="op">(</span><span class="va">C</span><span class="op">+</span><span class="va">E</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.375</code></pre>
<div class="sourceCode" id="cb235"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The stationary distributions for the two states, empty and occupied</span></span>
<span><span class="va">eM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span></span>
<span><span class="va">eM</span><span class="op">$</span><span class="va">vectors</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">eM</span><span class="op">$</span><span class="va">vectors</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.625 0.375</code></pre>
<p>We see that <span class="math inline">\(J_i\)</span> is the stable state for being colonized.</p>
<p><strong>Extinction probability</strong>, <span class="math inline">\(E\)</span>, is determined by patch area <span class="math inline">\(A_i\)</span> in our simple model. This is because we will assume that all patches have a similar quality and so support equal densities (individuals per unit area). Larger areas have more individuals and thus have lower risk of extinction. <span class="citation">Ii. Hanski (<a href="references.html#ref-hanski1994" role="doc-biblioref">1994</a>)</span> described this mathematically as
<span class="math display">\[\begin{align*}
E_i = \frac{e}{A_i^x} \quad &amp;\mathrm{if} A_i &gt; e^{1/x}\\
E_i = 1 \quad &amp;\mathrm{if} A_i \le e^{1/x}
\end{align*}\]</span>
where <span class="math inline">\(e\)</span> and <span class="math inline">\(x\)</span> are constants letting <span class="math inline">\(E_i\)</span> vary for different systems. Parameter <span class="math inline">\(x\)</span> controls the effect of area, where larger values <span class="math inline">\(x&gt;1\)</span> mean that large patches have very low extinction risk. Smaller values of <span class="math inline">\(x\)</span> (<span class="math inline">\(x&lt;1\)</span>) mean that patches have to become exceedingly larger to appreciably reduce extinction risk. The parameter <span class="math inline">\(e\)</span> is the area-independent measure of extinction risk, and so is related to intrinsic population dynamics and environmental stochasticity.</p>
<p>We can illustrate extinction probability with toy code.</p>
<div class="sourceCode" id="cb237"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extinction probability</span></span>
<span><span class="va">E.p</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">A</span>, <span class="va">e</span><span class="op">=</span><span class="fl">0.01</span>, <span class="va">X</span><span class="op">=</span><span class="fl">1.009</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">Ei</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">A</span> <span class="op">&gt;</span> <span class="va">e</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">X</span><span class="op">)</span>, <span class="va">e</span><span class="op">/</span><span class="op">(</span><span class="va">A</span><span class="op">^</span><span class="va">X</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">Ei</span> <span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu">E.p</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">0.2</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:E"></span>
<img src="figs/e-1.png" alt="Extinction probabliity for a butterfly population (silver spotted skipper, Hanski 1994)." width="75%"><p class="caption">
Figure 6.12: Extinction probabliity for a butterfly population (silver spotted skipper, Hanski 1994).
</p>
</div>
<div class="sourceCode" id="cb238"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## The ggplot way</span></span>
<span><span class="co"># myData &lt;- data.frame( A=c(0, .2) ) # ggplot requires a data frame</span></span>
<span><span class="co"># ggplot(data=myData, aes(x=A)) + # set the basic properties of the plot</span></span>
<span><span class="co">#   # in the stat_function, we indicate the parameters in our equation.</span></span>
<span><span class="co">#   stat_function(fun=E.p, geom="line", </span></span>
<span><span class="co">#                 args=list(e = 0.01, X = 1.009)) </span></span></code></pre></div>
<p>Note that <span class="math inline">\(A_0 = e^{1/x}\)</span> is the critical patch size where a population is not expected to persist a year.</p>
<p><strong>Colonization probability</strong>, <span class="math inline">\(C_i\)</span>, is more complicated. It is a function of the number of arriving migrants, which are themselves a function of distances from other patches and the area (and thus population sizes) of those patches. It is
<span class="math display">\[C_i = \frac{1}{1+\left(\frac{y^\prime}{S_i}\right)^2}\]</span>
where <span class="math inline">\(y^\prime\)</span> is colonizing ability of the species, and <span class="math inline">\(S_i\)</span> can be thought of as a measure of isolation of patch <span class="math inline">\(i\)</span> from the rest of the patches. Formally, this is
<span class="math display">\[S_i = \sum_{j=1}^n\left(p_j \mathrm{exp}(-\alpha d_{ij}) A_j\right)\]</span>
where there are a total <span class="math inline">\(n\)</span> other patches <span class="math inline">\(j\)</span> that are habitats, <span class="math inline">\(p_j\)</span> is an indicator of whether a patch is currently occupied (0,1), <span class="math inline">\(d_{ij}\)</span> is the distance from patch <span class="math inline">\(j\)</span> to patch <span class="math inline">\(i\)</span>, <span class="math inline">\(\alpha\)</span> is the effect of distance, and <span class="math inline">\(A_j\)</span> is the area of patch <span class="math inline">\(j\)</span> and thus an index of population size.</p>
<p>We can illustrate extinction probability with toy code.</p>
<div class="sourceCode" id="cb239"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Colonization probability from one patch to another, as a function of distance</span></span>
<span><span class="va">C.p</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">d</span>, <span class="va">yprime</span>, <span class="va">alpha</span>, <span class="va">area</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">Sij</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">alpha</span><span class="op">*</span><span class="va">d</span> <span class="op">)</span> <span class="op">*</span> <span class="va">area</span></span>
<span>  <span class="va">Ci</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="va">yprime</span><span class="op">/</span><span class="va">Sij</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">)</span></span>
<span>  <span class="va">Ci</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># parameters</span></span>
<span><span class="va">yprime</span> <span class="op">&lt;-</span> <span class="fl">2.663</span>; <span class="va">ha</span> <span class="op">&lt;-</span> <span class="fl">0.94</span>; <span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">km</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.5</span>, by<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">km</span>, <span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op">{</span><span class="fu">C.p</span><span class="op">(</span>d<span class="op">=</span><span class="va">d</span>, yprime<span class="op">=</span><span class="va">yprime</span>, alpha<span class="op">=</span><span class="va">alpha</span>, area<span class="op">=</span><span class="va">ha</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span><span class="op">(</span><span class="va">km</span>, <span class="va">C</span>, geom<span class="op">=</span><span class="st">"line"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:C"></span>
<img src="figs/C-1.png" alt="Colonization probabliity for a butterfly population (silver spotted skipper, Hanski 1994)." width="75%"><p class="caption">
Figure 6.13: Colonization probabliity for a butterfly population (silver spotted skipper, Hanski 1994).
</p>
</div>
<p>There are additional details about the colonization function that I have buried, but the interested reader could consult sources of these ideas <span class="citation">(<a href="references.html#ref-hanski1994jae" role="doc-biblioref">I. Hanski 1994</a>; <a href="references.html#ref-hanski1994" role="doc-biblioref">Ii. Hanski 1994</a>)</span>.</p>
<p>Combining <span class="math inline">\(C_i\)</span> and <span class="math inline">\(E_i\)</span>, we can define the incidence function,
<span class="math display">\[J_i = \frac{1}{1+ \left(1+\left[\frac{y^\prime}{S_i}\right]^2\right)\frac{e}{A_i^x}}.\]</span></p>
<p>To use this model, we need the following data for each patch</p>
<ul>
<li>areas, <span class="math inline">\(A_i\)</span>, of each patch,</li>
<li>locations of each patch, from which to calculate the distances between each pair of patches <span class="math inline">\(i,j\)</span>,</li>
<li>presence or absence of the species in each patch,</li>
<li>the distance parameter <span class="math inline">\(\alpha\)</span>.</li>
</ul>
<p>From the distances, <span class="math inline">\(\alpha\)</span>, and presence/absences, we calculate <span class="math inline">\(S_i\)</span> for each patch. There are a couple of ways to estimate <span class="math inline">\(\alpha\)</span> but perhaps the best way is to do this using mark-recapture methods, but we will not explain those here. Other parameters, <span class="math inline">\(e,\,x,\,y^\prime\)</span>, are estimated using nonlinear regression methods; we use these below.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="DDgrowth.html"><span class="header-section-number">5</span> Density-dependent growth</a></div>
<div class="next"><a href="comp.html"><span class="header-section-number">7</span> Direct competition and mutualism</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#meta"><span class="header-section-number">6</span> Populations in Space</a></li>
<li>
<a class="nav-link" href="#source-sink-dynamics"><span class="header-section-number">6.1</span> Source-sink Dynamics</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#complications-and-cases"><span class="header-section-number">6.1.1</span> Complications and cases</a></li></ul>
</li>
<li>
<a class="nav-link" href="#metapopulations"><span class="header-section-number">6.2</span> Metapopulations</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#the-classic-levins-model"><span class="header-section-number">6.2.1</span> The classic Levins model</a></li>
<li><a class="nav-link" href="#propagule-rain"><span class="header-section-number">6.2.2</span> Propagule rain</a></li>
<li><a class="nav-link" href="#the-rescue-effect-and-the-core-satellite-model"><span class="header-section-number">6.2.3</span> The rescue effect and the core-satellite model</a></li>
<li><a class="nav-link" href="#parallels-with-logistic-growth"><span class="header-section-number">6.2.4</span> Parallels with Logistic Growth</a></li>
<li><a class="nav-link" href="#levins-vs.-hanski"><span class="header-section-number">6.2.5</span> Levins \(vs\). Hanski</a></li>
<li><a class="nav-link" href="#habitat-destruction"><span class="header-section-number">6.2.6</span> Habitat Destruction</a></li>
<li><a class="nav-link" href="#illustrating-the-effects-of-habitat-destruction"><span class="header-section-number">6.2.7</span> Illustrating the effects of habitat destruction</a></li>
<li><a class="nav-link" href="#different-assumptions-lead-to-different-predictions-about-rates-of-extinction"><span class="header-section-number">6.2.8</span> Different assumptions lead to different predictions about rates of extinction</a></li>
</ul>
</li>
<li><a class="nav-link" href="#hanskis-incidence-function"><span class="header-section-number">6.3</span> Hanski’s incidence function</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Primer of Ecology using R</strong>" was written by Hank Stevens. It was last built on 2022-12-19.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
