<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>13 Diversity | Primer of Ecology using R</title>
<meta name="author" content="Hank Stevens">
<meta name="description" content="13.1 Background   Figure 13.1: Empirical rank–abundance distributions of successional plant communities (old-fields) within the temperate deciduous forest biome of North America. ‘Year’ indicates...">
<meta name="generator" content="bookdown 0.23 with bs4_book()">
<meta property="og:title" content="13 Diversity | Primer of Ecology using R">
<meta property="og:type" content="book">
<meta property="og:description" content="13.1 Background   Figure 13.1: Empirical rank–abundance distributions of successional plant communities (old-fields) within the temperate deciduous forest biome of North America. ‘Year’ indicates...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="13 Diversity | Primer of Ecology using R">
<meta name="twitter:description" content="13.1 Background   Figure 13.1: Empirical rank–abundance distributions of successional plant communities (old-fields) within the temperate deciduous forest biome of North America. ‘Year’ indicates...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.10/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-VCV8MES4YY"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-VCV8MES4YY');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Primer of Ecology using R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="theory.html"><span class="header-section-number">1</span> Theory in Ecology</a></li>
<li><a class="" href="oft.html"><span class="header-section-number">2</span> Optimal Foraging</a></li>
<li><a class="" href="expo.html"><span class="header-section-number">3</span> Simple density-independent growth</a></li>
<li><a class="" href="DID.html"><span class="header-section-number">4</span> Density-independent Demography</a></li>
<li><a class="" href="DDgrowth.html"><span class="header-section-number">5</span> Density-dependent growth</a></li>
<li><a class="" href="meta.html"><span class="header-section-number">6</span> Populations in Space</a></li>
<li><a class="" href="direct-competition-and-mutualism.html"><span class="header-section-number">7</span> Direct competition and mutualism</a></li>
<li><a class="" href="cr.html"><span class="header-section-number">8</span> Consumer-resource Interactions</a></li>
<li><a class="" href="host-parasitoid-relations.html"><span class="header-section-number">9</span> Host-parasitoid relations</a></li>
<li><a class="" href="disease.html"><span class="header-section-number">10</span> Disease</a></li>
<li><a class="" href="consumer-resource-competition-and-mutualisms.html"><span class="header-section-number">11</span> Consumer-resource Competition and Mutualisms</a></li>
<li><a class="" href="food-webs-and-other-networks.html"><span class="header-section-number">12</span> Food webs and other networks</a></li>
<li><a class="active" href="diversity.html"><span class="header-section-number">13</span> Diversity</a></li>
<li><a class="" href="appendix.html"><span class="header-section-number">14</span> Appendix</a></li>
<li><a class="" href="references.html"><span class="header-section-number">15</span> References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="diversity" class="section level1" number="13">
<h1>
<span class="header-section-number">13</span> Diversity<a class="anchor" aria-label="anchor" href="#diversity"><i class="fas fa-link"></i></a>
</h1>
<div id="background-1" class="section level2" number="13.1">
<h2>
<span class="header-section-number">13.1</span> Background<a class="anchor" aria-label="anchor" href="#background-1"><i class="fas fa-link"></i></a>
</h2>
<div class="figure">
<span style="display:block;" id="fig:BSsuc"></span>
<img src="figs/BSsuc-1.png" alt="*Empirical rank--abundance distributions of successional plant communities (old-fields) within the temperate deciduous forest biome of North America. 'Year' indicates the time since abandonment from agriculture.  Data from the Buell-Small succession study* (http://www.ecostudies.org/bss/)." width="90%"><p class="caption">
Figure 13.1: <em>Empirical rank–abundance distributions of successional plant communities (old-fields) within the temperate deciduous forest biome of North America. ‘Year’ indicates the time since abandonment from agriculture. Data from the Buell-Small succession study</em> (<a href="http://www.ecostudies.org/bss/" class="uri">http://www.ecostudies.org/bss/</a>).
</p>
</div>
<p>It seems easy, or at least tractable, to compare the abundance of a single species in two samples. In this chapter, we introduce conceptsthat ecologists use to compare entire communities in two samples. We focus on two quantities: <em>species composition</em>, and <em>diversity</em>. We also discuss several issues related to this, including species–abundance distributions, ecological neutral theory, diversity partitioning, and species–area relations. Several packages in R include functions for dealing specifically with these topics.</p>
<p>Please see the “Environmetrics” link within the “Task Views” link at any CRAN website for downloading R packages. Perhaps the most comprehensive (including both diversity and composition) is the <code>vegan</code> package, but many others include important features as well.</p>
</div>
<div id="species-composition" class="section level2" number="13.2">
<h2>
<span class="header-section-number">13.2</span> Species Composition<a class="anchor" aria-label="anchor" href="#species-composition"><i class="fas fa-link"></i></a>
</h2>
<p>Differences in species composition among communities is a form of <span class="math inline">\(\beta\)</span>–diversity. Understanding the patterns and processes by which communities change or differs in space and time is perhaps the principal goal of community ecology. Beta-diversity is the term we give to these differences. Understanding precisely what we mean it is essential for correctly addressing our questions, and <span class="citation"><a href="references.html#ref-Anderson2011" role="doc-biblioref">Anderson et al.</a> (<a href="references.html#ref-Anderson2011" role="doc-biblioref">2011</a>)</span> have provided us with an excellent roadmap to help. All of the questions and their answers rely on a proper understanding of <em>multivariate distance.</em> And that requires us to start with species composition.</p>
<p>Species composition is merely the set of species in a site or a sample. Typically this includes some measure of abundance at each site, but it may also simply be a list of species at each site, where “abundance” is either presence or absence.</p>
<p>Imagine we have four sites (A–D) from which we collect density data on two species, <em>Salix whompii</em> and <em>Fraxinus virga</em>. We can enter hypothetical data of the following abundances.</p>
<div class="sourceCode" id="cb461"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Salwho<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, Fravir<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">21</span>,<span class="fl">8</span>,<span class="fl">13</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">dens</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>
<span class="va">dens</span></code></pre></div>
<pre><code>##   Salwho Fravir
## A      1     21
## B      0      8
## C      2     13
## D      3      5</code></pre>
<p>Next, we plot the abundances of both species; the plotted points then are the sites (Fig. <a href="diversity.html#fig:dens">13.2</a>).</p>
<div class="sourceCode" id="cb463"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">dens</span>, type<span class="op">=</span><span class="st">'n'</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="va">dens</span>, <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">dens</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:dens"></span>
<img src="figs/dens-1.png" alt="*Hypothetical species composition for four sites (A--D)*" width="90%"><p class="caption">
Figure 13.2: <em>Hypothetical species composition for four sites (A–D)</em>
</p>
</div>
<p>In Fig. <a href="diversity.html#fig:dens">13.2</a>, we see that the species composition in site A is most different from the composition of site D. That is, the distance between site A and D is greater than between any other sites. The next question, then, is <em>how</em> far apart are any two sites? Clearly, this depends on the scale of the measurement (e.g., the values on the axes), and also on how we measure distance through multivariate space.</p>
<div id="measures-of-abundance" class="section level3" number="13.2.1">
<h3>
<span class="header-section-number">13.2.1</span> Measures of abundance<a class="anchor" aria-label="anchor" href="#measures-of-abundance"><i class="fas fa-link"></i></a>
</h3>
<p>Above we pretended that the abundances were absolute densities (i.e., 1 = one stem per sample). We could of course represent all the abundances differently. For instance, we could calculate relative density, where each species in a sample is represented by the proportion of the sample comprised of that species. For site A, we divide each species by the sum of all species.</p>
<div class="sourceCode" id="cb464"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dens</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">dens</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>##       Salwho    Fravir
## A 0.04545455 0.9545455</code></pre>
<p>We see that <em>Salix</em> makes up about 5% of the sample for Site A, and <em>Fraxinus</em> makes up about 95% of the sample. Once we calculate relative densities for each species at each site, this eliminates differences in total density at each site because all sites then total to 1.</p>
<p>We could also calculate relative measures for any type of data, such as biomass or percent cover.</p>
<p>In most instances, <em>relative density</em> refers to the density of a species <em>relative</em> to the other species in a sample (above), but it can also be density in a sample relative to other samples. We would thus make each <em>species</em> total equal 1, and then its abundance at each site reflects the proportion of a species total abundance comprised by that site. For instance, we can make all <em>Salix</em> densities relative to each other.</p>
<div class="sourceCode" id="cb466"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dens</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">dens</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.1666667 0.0000000 0.3333333 0.5000000</code></pre>
<p>Here we see that sites A and B both have about 14% of all <em>Salix</em> stems, and site D has 43%.</p>
<p>Whether our measures of abundance are absolute or relative, we would like to know how different samples (or sites) are from each other. Perhaps the simplest way to describe the difference among the sites is to calculate the distances or dissimilarities between each pair of sites.</p>
</div>
<div id="dissimilarities-and-distances" class="section level3" number="13.2.2">
<h3>
<span class="header-section-number">13.2.2</span> Dissimilarities and Distances<a class="anchor" aria-label="anchor" href="#dissimilarities-and-distances"><i class="fas fa-link"></i></a>
</h3>
<p>When we have data on just the presence and absence of species, we can calculate a difference between sites using the <em>Jaccard index</em> of similarity,</p>
<p><span class="math display">\[J_{AB} = \frac{A \cap B}{A \cup B}\]</span>
where the numerator is the number of species in the set of shared species (present at both sites) and the denominator is the number of species in the set present at either site. Among our sites, the Jaccard index between site B and site A is
<span class="math display">\[J_{BA} = \frac{1}{2}\]</span>
and this is the same between site B and C and D as well. Jaccard dissimilarity is <span class="math inline">\(1 - J\)</span>. This would be <span class="math inline">\(0.5\)</span> for site B and any other site, and zero for the other pairs.</p>
<p>There is a quantitative version of this, which is
<span class="math display">\[J_{AB} = \frac{\sum_{i=1}^S \min (x_i)}{\sum_{i=1}^S \max (x_i)}\]</span>
where <span class="math inline">\(x_i\)</span> is the abundance of <span class="math inline">\(i\)</span>. For sites A and B, this would be,</p>
<p><span class="math display">\[J_{AB} = \frac{0+8}{1+21}=4/11 = 0.\overline{36}\]</span>
and so dissimilarity would again be <span class="math inline">\(1-J_{AB}\)</span>.</p>
<p><em>Euclidean distance</em> is another important way to measure differences between sites. With two species, we have two dimensional space, which is Fig. <a href="diversity.html#fig:dens">13.2</a>. The Euclidean distance between two sites is merely the length of the vector connecting those sites. We calculate this as <span class="math inline">\(\sqrt{x^2+y^2}\)</span>, where <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are the <span class="math inline">\((x,y)\)</span> distances between a pair of sites. The <span class="math inline">\(x\)</span> distance between sites B and C is the difference in <em>Salix</em> abundance between the two sites,</p>
<div class="sourceCode" id="cb468"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">dens</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">dens</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span></code></pre></div>
<p>where <code>dens</code> is the data frame with sites in rows, and species in different columns. The <span class="math inline">\(y\)</span> distance between sites B and C is difference in <em>Fraxinus</em> abundance between the two sites.</p>
<div class="sourceCode" id="cb469"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">dens</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">dens</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">]</span></code></pre></div>
<p>The Euclidean distance between these is therefore</p>
<div class="sourceCode" id="cb470"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">y</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 5.385165</code></pre>
<p>We calculate all pairwise Euclidean distances between sites A–D based on 2 species using built-in functions in R.</p>
<div class="sourceCode" id="cb472"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">alldists</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">dens</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##           A         B         C
## B 13.038405                    
## C  8.062258  5.385165          
## D 16.124515  4.242641  8.062258</code></pre>
<p>We can generalize this to include any number of species, but it becomes increasingly harder to visualize. We can add a third species, <em>Mandragora officinarum</em>, and recalculate pairwise distances between all sites, but now with three species.</p>
<div class="sourceCode" id="cb474"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dens</span><span class="op">[[</span><span class="st">"Manoff"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">11</span>,<span class="fl">3</span>,<span class="fl">7</span>,<span class="fl">5</span><span class="op">)</span>
<span class="op">(</span><span class="va">spp3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">dens</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##           A         B         C
## B 15.297059                    
## C  9.000000  6.708204          
## D 17.204651  4.690416  8.306624</code></pre>
<p>We can plot species abundances as we did above, and <code><a href="https://rdrr.io/r/graphics/pairs.html">pairs(dens)</a></code> would give us all the pairwise plots given three species. However, what we really want for species is a 3-D plot. Here we load another package and create a 3-D scatterplot.</p>
<div class="sourceCode" id="cb476"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">scatterplot3d</span><span class="op">)</span>
<span class="va">sc1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scatterplot3d/man/scatterplot3d.html">scatterplot3d</a></span><span class="op">(</span><span class="va">dens</span>,  type<span class="op">=</span><span class="st">'h'</span>, pch<span class="op">=</span><span class="st">""</span>,
      xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">25</span><span class="op">)</span>, zlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">15</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="va">sc1</span><span class="op">$</span><span class="fu">xyz.convert</span><span class="op">(</span><span class="va">dens</span><span class="op">)</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">dens</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="figs/unnamed-chunk-217-1.png" width="90%">
In three dimensions, Euclidean distances are calculated the same basic way, but we add a third species, and the calculation becomes <span class="math inline">\(\sqrt{x^2 + y^2 +z^2}\)</span>. Note that we take the square root (as opposed to the cube root) because we originally squared each distance. We can generalize this for two sites for <span class="math inline">\(S\)</span> species as
<span class="math display">\[D_E = \sqrt{\sum_{i=1}^S\left( x_{ai} - x_{bi}\right)^2}\]</span></p>
<p>Of course, it is difficult (impossible?) to visualize arrangements of sites with more than three axes (i.e., <span class="math inline">\(&gt;3\)</span> species), but we can always <em>calculate</em> the distances between pairs of sites, regardless of how many species we have.</p>
<p>There are many ways, in addition to Euclidean distances, to calculate differences. Among the most commonly used in ecology is
<em>Bray–Curtis</em> dissimilarity, which goes by other names, including Sørenson dissimilarity
<span class="math display">\[D_{BC} = \frac{\sum_{i=1}^S\left| x_{ai} - x_{bi}\right|}{\sum_{i=1}^S (x_{ai} + x_{bi})}\]</span>
where <span class="math inline">\(S\)</span> is the number of species in all samples. Bray–Curtis dissimilarity is merely the total difference in species abundances between two sites, divided by the total abundances at each site. Bray–Curtis dissimilarity (and a couple others) tends to result in more intuitively pleasing distances in which both common and rare species have relatively similar weights, whereas Euclidean distance depends more strongly on the most abundant species. This happens because Euclidean distances are based on squared differences, whereas Bray–Curtis uses absolute differences. Squaring always amplifies the importance of larger values. Fig. <a href="diversity.html#fig:mds">13.3</a> compares graphs based on Euclidean and Bray–Curtis differences of the same raw data.</p>
<p>[Add note on distance vs. dissimilarity, and the triangle inequality]</p>
</div>
<div id="displaying-multidimensional-distances" class="section level3" number="13.2.3">
<h3>
<span class="header-section-number">13.2.3</span> Displaying multidimensional distances<a class="anchor" aria-label="anchor" href="#displaying-multidimensional-distances"><i class="fas fa-link"></i></a>
</h3>
<p>A simple way to display distances for three or more species is to create a plot in two dimensions that attempts to arrange all sites so that they are <em>approximately</em> the correct distances apart. In general this is impossible to achieve precisely, but distances can be approximately correct. One technique that tries to create an optimal (albiet approximate) arrangement is <em>non-metric multidimensional scaling</em>. Here we add a fourth species (<em>Aconitum lycoctonum</em>) to our data set before plotting the distances.</p>
<div class="sourceCode" id="cb477"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dens</span><span class="op">$</span><span class="va">Acolyc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">0</span>, <span class="fl">9</span>,<span class="fl">4</span><span class="op">)</span></code></pre></div>
<p>The non-metric multidimensional scaling function is in the  package. It calculates distances for us using the original data. Here we display Euclidean distances among sites (Fig. <a href="diversity.html#fig:mds">13.3</a>).</p>
<div class="sourceCode" id="cb478"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ignore warnings for these toy examples</span>
<span class="va">mdsE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/metaMDS.html">metaMDS</a></span><span class="op">(</span><span class="va">dens</span>, distance<span class="op">=</span><span class="st">"euc"</span>, autotransform<span class="op">=</span><span class="cn">FALSE</span>, trace<span class="op">=</span><span class="fl">0</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mdsE</span>, display<span class="op">=</span><span class="st">"sites"</span>, type<span class="op">=</span><span class="st">"text"</span><span class="op">)</span>
<span class="va">mdsB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/metaMDS.html">metaMDS</a></span><span class="op">(</span><span class="va">dens</span>, distance<span class="op">=</span><span class="st">"bray"</span>, autotransform<span class="op">=</span><span class="cn">FALSE</span>, trace<span class="op">=</span><span class="fl">0</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mdsB</span>, display<span class="op">=</span><span class="st">"sites"</span>, type<span class="op">=</span><span class="st">"text"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:mds"></span>
<img src="figs/mds-1.png" alt="*Nonmetric multidimensional (NMDS) plots showing approximate distances between sites. These two figures display the same raw data, but Euclidean distances tend to emphasize differences due to the more abundant species, whereas Bray-Curtis does not. Because NMDS provides iterative optimizations, it will find slightly different arrangements each time you run it.*" width="45%"><img src="figs/mds-2.png" alt="*Nonmetric multidimensional (NMDS) plots showing approximate distances between sites. These two figures display the same raw data, but Euclidean distances tend to emphasize differences due to the more abundant species, whereas Bray-Curtis does not. Because NMDS provides iterative optimizations, it will find slightly different arrangements each time you run it.*" width="45%"><p class="caption">
Figure 13.3: <em>Nonmetric multidimensional (NMDS) plots showing approximate distances between sites. These two figures display the same raw data, but Euclidean distances tend to emphasize differences due to the more abundant species, whereas Bray-Curtis does not. Because NMDS provides iterative optimizations, it will find slightly different arrangements each time you run it.</em>
</p>
</div>
</div>
</div>
<div id="diversity-1" class="section level2" number="13.3">
<h2>
<span class="header-section-number">13.3</span> Diversity<a class="anchor" aria-label="anchor" href="#diversity-1"><i class="fas fa-link"></i></a>
</h2>
<p>To my mind, there is no more urgent or interesting goal in ecology and evolutionary biology than understanding the determinants of biodiversity. Biodiversity is many things to many people, but we typically think of it as a measure of the variety of biological life present, perhaps taking into account the relative abundances. For ecologists, we most often think of <em>species diversity</em> as some quantitative measure of the variety or number of different species. This has direct analogues to the genetic diversity within a population <span class="citation">(<a href="references.html#ref-Crow1970" role="doc-biblioref">Crow and Kimura 1970</a>; <a href="references.html#ref-Vellend2005a" role="doc-biblioref">Vellend and Geber 2005</a>)</span>, and the connections between species and genetic diversity include both shared patterns and shared mechanisms. Here we confine ourselves entirely to a discussion of species diversity, the variety of different species present.</p>
</div>
<div id="species-diversity" class="section level2" number="13.4">
<h2>
<span class="header-section-number">13.4</span> Species diversity<a class="anchor" aria-label="anchor" href="#species-diversity"><i class="fas fa-link"></i></a>
</h2>
<p>Species diversity represents the variety of species in a community or a sample of a community. Fig. <a href="diversity.html#fig:BSsuc">13.1</a> shows us at a glance the distributions of species abundances, and thus the diversities, of a plant community at different points in time as it undergoes secondary succession. In the figure we see the number of different species that are present (<em>x</em>-axis), and the relative abundances (<em>y</em>-axis). This image gives us an intuition about the variety of species we might encounter. It shows us whether we might expect to encounter many different species, or whether the community might be dominated by one or just a few species. The sense is what we try to capture in a single number that we call a “diversity index.”</p>
<p>Species diversity is closely allied with mechanisms of coexistence. When two areas differ in their diversity, we are likely to ask why this is so. The number and variety of species present will depend on how many species are available to colonize an area, and also on the mechanisms that allow them to coexist locally. <span class="citation"><a href="references.html#ref-MacArthur1963" role="doc-biblioref">MacArthur and Wilson</a> (<a href="references.html#ref-MacArthur1963" role="doc-biblioref">1963</a>)</span> envisioned this in terms of ecology, where the number of species in an area is s function of rates of immigration and local extinction,
<span class="math display">\[S = \Delta I - \Delta E\]</span>
where mechanisms of coexistence govern <span class="math inline">\(\Delta E\)</span>. This equation is the basis for the theory of island biogeography <span class="citation">(<a href="references.html#ref-MacArthur1963" role="doc-biblioref">MacArthur and Wilson 1963</a>, <a href="references.html#ref-MacArthur1967" role="doc-biblioref">1967</a>)</span>. More on that later.</p>
<p>There are many diversity indices that we could calculate; here, we will calculate four different measures: species richness, Shannon-Weiner diversity, Simpson’s diversity, and Simpson’s inverse diversity. These sometimes are referred to by slightly different names, so it is important to figure out exactly what someone has done.</p>
<p>Let’s start by creating two samples of two different communities.</p>
<div class="sourceCode" id="cb479"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">comm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X"</span>,<span class="st">"Y"</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">4</span><span class="op">)</span>
<span class="va">spp</span> <span class="op">&lt;-</span> <span class="va">letters</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span>
<span class="va">abun</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">0</span>, <span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">6</span>,<span class="fl">3</span><span class="op">)</span>
<span class="va">rank</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>, <span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>comm<span class="op">=</span><span class="va">comm</span>, spp<span class="op">=</span><span class="va">spp</span>, n<span class="op">=</span><span class="va">abun</span>, rank<span class="op">=</span><span class="va">rank</span><span class="op">)</span>
<span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">rank</span>, <span class="va">n</span>, colour<span class="op">=</span><span class="va">comm</span>, linetype<span class="op">=</span><span class="va">comm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">lims</span><span class="op">(</span>y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:toy"></span>
<img src="figs/toy-1.png" alt="*Two toy communities.*" width="90%"><p class="caption">
Figure 13.4: <em>Two toy communities.</em>
</p>
</div>
<p>These two samples have different numbers of species, and different distributions. Community Y has a more even distribution of species abundances, whereas community X is dominated by a single species. Now we’ll calculate our different measures of species diversity.</p>
<p><strong>Species richness</strong> is simply the number of different species in the sample. It is the value of the <em>x</em>-axis in the above figure. To calculate that from these data, we will determine the lengths of the vectors of nonzero abundances.</p>
<div class="sourceCode" id="cb480"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span><span class="op">(</span>X<span class="op">=</span><span class="va">df</span><span class="op">$</span><span class="va">n</span>, INDEX<span class="op">=</span><span class="va">df</span><span class="op">$</span><span class="va">comm</span>, 
       FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">x</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">]</span><span class="op">)</span><span class="op">}</span> <span class="op">)</span></code></pre></div>
<pre><code>## X Y 
## 3 4</code></pre>
<p>Species richness increases as the number of individuals in the sample increases. Therefore, care should be taken in comparing the richness of two different samples to make sure that they are sufficiently comparable.</p>
<p>When most ecologists use the term ‘species diversity’ they are not referring to species richness, but rather some index that incorporates relative abundance as well. One of the most common of these is <strong>Shannon-Weiner diversity</strong> or the Shannon index. This quantity has its roots in information theory and entropy. It measures the disorder in a data set. For instance, if nearly all of the individuals are a single species, then the data are highly predictable and ordered. In contrast, if there are many individuals of many different species, then it would be very difficult to describe in a simple way, and difficult to predict what a sample would look like–disorder, or entropy, would be high. The Shannon index is
<span class="math display">\[H=-\sum_{i-1}^Sp_i\log p_i\]</span>
where <span class="math inline">\(p_i\)</span> is the proportion of individuals belonging to species <span class="math inline">\(i\)</span>.</p>
<div class="sourceCode" id="cb482"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># a function that starts with abundances and calculates H</span>
<span class="va">shannon</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span> 
  <span class="va">n</span> <span class="op">&lt;-</span> <span class="va">n</span><span class="op">[</span><span class="va">n</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">]</span> <span class="co"># remove zero values</span>
  <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">n</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
  <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span> <span class="va">p</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">)</span>
  <span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span><span class="op">(</span>X<span class="op">=</span><span class="va">df</span><span class="op">$</span><span class="va">n</span>, INDEX<span class="op">=</span><span class="va">df</span><span class="op">$</span><span class="va">comm</span>, 
       FUN <span class="op">=</span> <span class="va">shannon</span><span class="op">)</span></code></pre></div>
<pre><code>##         X         Y 
## 0.7589368 1.2396594</code></pre>
<p>These numbers provide relative estimates of “variety.” They increase with increasing species richness and with increasing evenness of abundances. While there is no hypothetical upper limit, it ranges the minimum is zero for a single species, and five or six for hyper-diverse communities.</p>
<p><strong>Simpson diversity</strong> indices are based on the <strong>Simpson dominance</strong> index. The dominance index is the probability that two randomly selected individuals belong to the same species,
<span class="math display">\[D = \sum_{i=1}^S p_i^2\]</span>
which varies between 1 for a single species and declines toward zero with increasing numbers of species and increasing number of species. If we were describing alleles, instead of trees, this value is the inbreeding coefficient, of genetic homozygosity <span class="citation"><a href="references.html#ref-Nei1987" role="doc-biblioref">Nei</a> (<a href="references.html#ref-Nei1987" role="doc-biblioref">1987</a>)</span>. It is also referred to as the Gini coefficient, and was formulated to measure income inequality. This value is used in two ways in aid calculation of diversity. One Simpson’s diversity index is the arithmetic complement,
<span class="math display">\[S_c = 1-D\]</span>,
which is the probability that two randomly selected individuals belong to different species. It is also the initial slope of the expected individuals (<span class="math inline">\(x\)</span>) vs. species (<span class="math inline">\(y\)</span>) curve <span class="citation">(<a href="references.html#ref-Lande2000" role="doc-biblioref">R. Lande, DeVries, and Walla 2000</a>)</span>, and the variance of species composition <span class="citation">(<a href="references.html#ref-Lande1996" role="doc-biblioref">Russell Lande and May 1996</a>)</span>.</p>
<p>Here we show the equivalence of Simpson’s index and the variance of species composition. First, we reimagine community X as collections of individuals comprising different species identities. We we create a pretend community of six individuals (rows) and 3 species (columns). Somewhat oddly, we identify the degree to which each individual is comprised of each species; in this case, individuals can be only one species.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Imagine the case where the columns are traits, or genes. In that case, individuals could be characterized by affiliation with multiple columns, whether traits or genes.&lt;/p&gt;"><sup>71</sup></a> Here we let two individuals be each species.</p>
<div class="sourceCode" id="cb484"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow<span class="op">=</span><span class="fl">14</span>, ncol<span class="op">=</span><span class="fl">3</span>, 
            dimnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">X</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">X</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">13</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">X</span><span class="op">[</span><span class="fl">14</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></code></pre></div>
<pre><code>##   [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]
## A    1    1    1    1    1    1    1    1    1     1     0     0     0     0
## B    0    0    0    0    0    0    0    0    0     0     1     1     1     0
## C    0    0    0    0    0    0    0    0    0     0     0     0     0     1</code></pre>
<p>We transposed the matrix, so that individuals are columns and species membership or identity is in rows. The first individual belongs to species A, etc. We can plot these individuals in community space, if we like (Fig. <a href="diversity.html#fig:Xvar">13.5</a>).</p>
<div class="sourceCode" id="cb486"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">scatterplot3d</span><span class="op">)</span>
<span class="va">X3D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scatterplot3d/man/scatterplot3d.html">scatterplot3d</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/jitter.html">jitter</a></span><span class="op">(</span><span class="va">X</span>, <span class="fl">.1</span><span class="op">)</span>, type<span class="op">=</span><span class="st">'h'</span>, angle<span class="op">=</span><span class="fl">60</span>, pch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span>
<span class="va">X3D</span><span class="op">$</span><span class="fu">points3d</span><span class="op">(</span>x<span class="op">=</span><span class="fl">10</span><span class="op">/</span><span class="fl">14</span>, y<span class="op">=</span><span class="fl">3</span><span class="op">/</span><span class="fl">14</span>, z<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">14</span>,  type<span class="op">=</span><span class="st">'h'</span>, pch<span class="op">=</span><span class="fl">19</span>, cex<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:Xvar"></span>
<img src="figs/Xvar-1.png" alt="*Each of 14 individuals in a three species community, plotted in 'compsition space'. The large black dot is the multivariate mean, or centroid, which is the center of gravity in this composition space. Simpson's diversity is the variance of species composition of individuals.*" width="90%"><p class="caption">
Figure 13.5: <em>Each of 14 individuals in a three species community, plotted in ‘compsition space.’ The large black dot is the multivariate mean, or centroid, which is the center of gravity in this composition space. Simpson’s diversity is the variance of species composition of individuals.</em>
</p>
</div>
<p>Next we can calculate the centroid, or multivariate mean. It is merely the vector of species means.</p>
<div class="sourceCode" id="cb487"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">centroid1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##          A          B          C 
## 0.71428571 0.21428571 0.07142857</code></pre>
<p>Given this centroid, we begin to calculate a variance by (i) subtracting each species vector (0s, 1s) from its mean, (ii) squaring each of these deviates, and (3) summing to get the sum of squares.</p>
<div class="sourceCode" id="cb489"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">SS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="kw">function</span><span class="op">(</span><span class="va">j</span><span class="op">)</span> <span class="op">(</span><span class="va">X</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span> <span class="op">-</span> <span class="va">centroid1</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">)</span></code></pre></div>
<pre><code>## [1] 6.142857</code></pre>
<p>We then divide this sum by the number of individuals that were in the community (<span class="math inline">\(N\)</span>)</p>
<div class="sourceCode" id="cb491"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SS</span><span class="op">/</span><span class="fl">14</span></code></pre></div>
<pre><code>## [1] 0.4387755</code></pre>
<p>When you compare this to the calculation of Simpson’s complement below, you will find that they are the same. Further, the finite sample size correction is the same for both.</p>
<p>Simpson’s complement diversity index converges quickly with increasing sample size, making it the most reliable index for small sample sizes. It also has an unbiased estimator <span class="citation">(<a href="references.html#ref-Lande1996" role="doc-biblioref">Russell Lande and May 1996</a>)</span>, which is
<span class="math display">\[\hat{S_c} = \frac{N}{N-1}(1-D)\]</span></p>
<p><strong>Simpson’s inverse diversity index</strong> is the inverse of dominance,
<span class="math display">\[S_I = \frac{1}{D}\]</span>
This value could be considered the ‘effective’ number of species, which discounts the rarest species <span class="citation">(<a href="references.html#ref-Nee2005" role="doc-biblioref">Nee 2005</a>)</span> and which is closely allied to population genetics theory as one definition for the ‘effective number of alleles’ <span class="citation">(<a href="references.html#ref-Nee2005" role="doc-biblioref">Nee 2005</a>; <a href="references.html#ref-Crow1970" role="doc-biblioref">Crow and Kimura 1970</a>)</span>.</p>
<p>We can calculate these by defining our own functions. We then create a grouped data frame and calculate our summary statistics, using the <code>dplyr</code> package (part of <code>tidyverse</code>).</p>
<div class="sourceCode" id="cb493"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Sc</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
  <span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">p</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">Si</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
  <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">p</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">dfg</span> <span class="op">&lt;-</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">df</span>, <span class="va">comm</span><span class="op">)</span> <span class="co"># group by community</span>

<span class="co"># calculate indices for each community type.</span>
<span class="fu">summarize</span><span class="op">(</span><span class="va">dfg</span>,
          richness <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span> <span class="va">n</span><span class="op">[</span><span class="va">n</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">]</span><span class="op">)</span>,
          H <span class="op">=</span> <span class="fu">shannon</span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,
          Sc <span class="op">=</span> <span class="fu">Sc</span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,
          Si <span class="op">=</span> <span class="fu">Si</span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
          <span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 5
##   comm  richness     H    Sc    Si
##   &lt;chr&gt;    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 X            3 0.759 0.439  1.78
## 2 Y            4 1.24  0.684  3.16</code></pre>
<p>In this case, all of these indices agree with each other, and our intuition: community Y is more ‘diverse.’</p>
<p>These diversity indices are actually directly related to each other — they comprise estimates of <em>entropy</em>, the amount of disorder or the multiplicity of possible states of a system, that are directly related via a single constant <span class="citation">(<a href="references.html#ref-Keylock:2005fy" role="doc-biblioref">Keylock 2005</a>)</span>. However, an important consequence of their differences is that richness depends most heavily on rare species, Simpson’s complement depends most heavily on the relative abundance of common species, and Shannon-Wiener stands somewhere between the two.</p>
</div>
<div id="rarefaction-and-total-species-richness" class="section level2" number="13.5">
<h2>
<span class="header-section-number">13.5</span> Rarefaction and total species richness<a class="anchor" aria-label="anchor" href="#rarefaction-and-total-species-richness"><i class="fas fa-link"></i></a>
</h2>
<p>Rarefaction is the process of generating the relationship between the number of species <em>vs.</em> the number of individuals in a sample. It is typically determined by randomly resampling individuals <span class="citation">(<a href="references.html#ref-Gotelli2001a" role="doc-biblioref">N. J. Gotelli and Colwell 2001</a>)</span>. Rarefaction allows direct comparison of the richness of two samples, corrected for numbers of individuals. This is particularly important because richness depends so heavily on the number of individuals in a sample. Thus rarefaction finds the general relation between the number of species <em>vs.</em> the number of individuals, and is limited to less than or equal to the number of species you actually observed. A related curve is the species-accumulation curve or collector’s curve, but this is simply a useful but haphazard accumulation of new species (a cumulative sum) as the investigator samples new individuals.</p>
<p>Another issue that ecologists face is trying to estimate the true number of species in an area, given the samples collected. This number of species would be larger than the number of species you observed, and is often referred to as <em>total species richness</em> or <em>asymptotic richness</em>. Samples almost always find only a subset of the species present in an area or region, but we might prefer to know how many species are really there, in the general area we sampled. There are many ways to do this, and while some are better than others, none is perfect. These methods estimate minimum numbers of species, and assume that the unsampled areas are homogeneous and similar to the sampled areas.</p>
<p>Before using these methods seriously, the inquisitive reader should consult <span class="citation">(<a href="references.html#ref-Gotelli2001a" role="doc-biblioref">N. J. Gotelli and Colwell 2001</a>; <a href="references.html#ref-Magurran2004" role="doc-biblioref">Magurran 2004</a>)</span> and references at <a href="http://viceroy.eeb.uconn.edu/EstimateS" class="uri">http://viceroy.eeb.uconn.edu/EstimateS</a>. Below, we briefly explore an example in R.</p>
<div id="an-example-of-rarefaction-and-total-species-richness" class="section level3" number="13.5.1">
<h3>
<span class="header-section-number">13.5.1</span> An example of rarefaction and total species richness<a class="anchor" aria-label="anchor" href="#an-example-of-rarefaction-and-total-species-richness"><i class="fas fa-link"></i></a>
</h3>
<p>Let us sample a seasonal tropical rainforest on Barro Colorado Island (BCI) Our goal will be to provide baseline data for later comparison to other such studies.</p>
<p>We will use some of the data from a 50 ha plot that is included in the <code>vegan</code> package <span class="citation">(<a href="references.html#ref-Condit2002" role="doc-biblioref">Condit et al. 2002</a>; <a href="references.html#ref-Oksanen:2019vg" role="doc-biblioref">Oksanen et al. 2019</a>)</span>. We will pretend that we sampled every tree over 10 cm DBH,<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;DBH is diameter at 1.37 m above the ground.&lt;/p&gt;"><sup>72</sup></a> in each of 10 plots scattered throughout the 50 ha area. What could we say about the forest within which the plots were located? We have to consider the scale of the sampling. Both the experimental unit and the grain are the 1 ha plots. Imagine that the plots were scattered throughout the 50 ha plot, so that the extent of the sampling was a full 50 ha <span class="citation">(sensu <a href="references.html#ref-Wiens1989" role="doc-biblioref">Wiens 1989</a>)</span>.</p>
<p>First, let’s pretend we have sampled 10 1 ha plots by extracting the samples out of the larger dataset.</p>
<div class="sourceCode" id="cb495"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://cran.r-project.org">vegan</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">BCI</span><span class="op">)</span>;
<span class="va">bci</span> <span class="op">&lt;-</span> <span class="va">BCI</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">50</span>, by<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,<span class="op">]</span>
<span class="va">bci</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<pre><code>##    Abarema.macradenia Adelia.triloba
## 5                   0              1
## 10                  1              0
## 15                  0              2
## 20                  0              0
## 25                  0              0</code></pre>
<p>This data set has plots in rows and species names in columns; the data are numbers of individuals of each species (columns) in each plot (rows).</p>
<p>Next, we total the numbers for each species, pooling all plots together. We sum the columns, and remove zeroes.</p>
<div class="sourceCode" id="cb497"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">bci</span><span class="op">)</span> 
<span class="va">N</span> <span class="op">&lt;-</span> <span class="va">N</span><span class="op">[</span><span class="va">N</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">]</span></code></pre></div>
<p>Based on this sample, we find that the species richness in all our samples pooled is the tally of all non-zero species.</p>
<div class="sourceCode" id="cb498"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">N</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 179</code></pre>
<p>Our goal is to estimate the number of species in the area. For that we need estimators of total species richness, if we can assume that the surrounding forest is homogeneous. First, we’ll use abundance-based coverage estimators, ACE and Chao 1, that appear to give reasonable estimates <span class="citation">(<a href="references.html#ref-Magurran2004" role="doc-biblioref">Magurran 2004</a>)</span>.</p>
<div class="sourceCode" id="cb500"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/specpool.html">estimateR</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span></code></pre></div>
<pre><code>##      S.obs    S.chao1   se.chao1      S.ACE     se.ACE 
## 179.000000 202.000000  12.763215 190.638313   6.779286</code></pre>
<p>Here we see the observed number of species and two estimators, with standard errors.</p>
<p>Next we use a frequency-based estimator, Chao 2, where the data only need to be presence/absence, and for which we also need multiple sample plots. By using multiple plots, we get some idea of of how rare some species are and use that to estimate how many more rare species there might be which are unsampled.</p>
<div class="sourceCode" id="cb502"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">chaoF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/specpool.html">specpool</a></span><span class="op">(</span><span class="va">bci</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##     Species     chao  chao.se jack1 jack1.se    jack2     boot  boot.se  n
## All     179 202.4321 11.99975 203.3 8.606393 214.9444 190.7196 5.146857 10</code></pre>
<p>We also get a jackknifed estimate. All of these give some estimate as to the minimum true number of species in an area around our samples.</p>
<p>Typically the use of these estimators is accompanied by some form of rarefaction. To perform rarefaction, we need to select numbers of individuals for which we want rarefied samples. We will use multiples of 500 and also the total number of individuals in the sample. We then use a built-in function to draw species at random for these numbers of individuals, that is, perform rarefaction.</p>
<div class="sourceCode" id="cb504"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">no.of.inds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">4500</span>, by<span class="op">=</span><span class="fl">500</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">)</span>
<span class="va">rar3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/rarefy.html">rarefy</a></span><span class="op">(</span><span class="va">N</span>, sample<span class="op">=</span><span class="va">no.of.inds</span>, se<span class="op">=</span><span class="cn">T</span>, MARG<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p>Next we want to graph it, with a few bells and whistles. We set up the graph of the 10 plot, individual-based rarefaction, and leave room to graph total richness estimators as well (Fig. <a href="diversity.html#fig:estS">13.6</a>).</p>
<div class="sourceCode" id="cb505"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">no.of.inds</span> , <span class="va">rar3</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>,  ylab<span class="op">=</span><span class="st">"Species Richness"</span>, axes<span class="op">=</span><span class="cn">FALSE</span>,
     xlab<span class="op">=</span><span class="st">"No. of Individuals"</span>, type<span class="op">=</span><span class="st">'n'</span>,  ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">250</span><span class="op">)</span>, 
     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">500</span>,<span class="fl">5900</span><span class="op">)</span> <span class="op">)</span>
<span class="co"># estimate</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">no.of.inds</span>, <span class="va">rar3</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>, type<span class="op">=</span><span class="st">'b'</span><span class="op">)</span>
<span class="co"># approximate confidence intervals</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">no.of.inds</span>, <span class="va">rar3</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="va">rar3</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">no.of.inds</span>, <span class="va">rar3</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">rar3</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span>, at<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">*</span><span class="fl">1000</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span><span class="op">(</span><span class="op">)</span>; 
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">2500</span>, <span class="fl">200</span>, <span class="st">"Individual-based rarefaction (10 plots)"</span><span class="op">)</span>

<span class="co"># add the Chao 2 estimator</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span><span class="fl">5500</span>, <span class="va">chaoF</span><span class="op">[</span><span class="fl">1</span>,<span class="st">'chao'</span><span class="op">]</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="va">chaoF</span><span class="op">[</span><span class="fl">1</span>,<span class="st">'chao.se'</span><span class="op">]</span>, 
         <span class="fl">5500</span>, <span class="va">chaoF</span><span class="op">[</span><span class="fl">1</span>,<span class="st">'chao'</span><span class="op">]</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">chaoF</span><span class="op">[</span><span class="fl">1</span>,<span class="st">'chao.se'</span><span class="op">]</span>, 
         lwd<span class="op">=</span><span class="fl">3</span>, col<span class="op">=</span><span class="st">'darkgrey'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">5500</span>, <span class="fl">150</span>, <span class="st">"Chao 2 estimate"</span>, srt<span class="op">=</span><span class="fl">90</span>, adj<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">.5</span><span class="op">)</span> <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fl">5800</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">BCI</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, pch<span class="op">=</span><span class="fl">19</span>, cex<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">5800</span>, <span class="fl">150</span>, <span class="st">"Obs. S in 50 ha"</span>, srt<span class="op">=</span><span class="fl">90</span>, adj<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">.5</span><span class="op">)</span> <span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:estS"></span>
<img src="figs/estS-1.png" alt="*Baseline tree species richness estimation based on ten 1 ha plots, using individual-based rarefaction. We also include the Chao 2 total richness estimators and the observed total tree richness in the 50 ha plot for comparison (black dot).*" width="90%"><p class="caption">
Figure 13.6: <em>Baseline tree species richness estimation based on ten 1 ha plots, using individual-based rarefaction. We also include the Chao 2 total richness estimators and the observed total tree richness in the 50 ha plot for comparison (black dot).</em>
</p>
</div>
<p>This shows us that the total richness estimator did not overestimate the total number of species within the extent of this relatively homogenous sample area (Fig. <a href="diversity.html#fig:estS">13.6</a>). In that sense, these estimators are estimating the minimum total number of species and are thus conservative.</p>
<p>Simpson’s diversity provides an interesting description of a rarifcation curve. The expected number of species in a sample of <span class="math inline">\(N\)</span> individuals drawn from a community with total species richness <span class="math inline">\(S\)</span>, is
<span class="math display">\[\mathrm{E}[\hat{S}] = S-\sum_{i=1}^S (1-p_i)^N\]</span>
where <span class="math inline">\(p_i\)</span> is the frequency or relative abundance of species <span class="math inline">\(i\)</span>. The initial slope of the rarifaction curve, is
<span class="math display">\[\frac{\Delta \mathrm{E}[\hat{S}]}{\Delta N}\]</span>
where <span class="math inline">\(\Delta N = 2-1=1\)</span>. The numerator is is the difference between the expected number of species in a sample of two vs. one individual. We can work through this here, if only to remind ourselves of rules about working with sums, and that the sum of all <span class="math inline">\(p_i\)</span> is 1, by definition. Also, it helps to realize that when <span class="math inline">\(N=1\)</span>, <span class="math inline">\(E[\hat{S}] = 1\)</span>.</p>
<p><span class="math display">\[\begin{align*}
\Delta E[\hat{S}] &amp;= S-\sum_{i=1}^S(1-p_i)^2 - \left( S-\sum_{i=1}^S(1-p_i) \right)\\
  &amp;= S - \sum_{i=1}^S(1-2p_i+p_i^2) - 1\\
 &amp;= S - \sum_{i=1}^S(1) + \sum_{i=1}^S (2p_i) - \sum_{i=1}^S(p_i^2) - 1\\
 &amp;= S - S + 2 - \sum_{i=1}^S(p_i^2) - 1\\
 &amp; = 1 - \sum_{i=1}^S(p_i^2)
\end{align*}\]</span></p>
<p>So, all else being equal, Simpson’s diversity is an important part of the shape of the species accumulation curve. And that slope is the probability that two individuals drawn at random belong to two different species. :)</p>
</div>
</div>
<div id="distributions" class="section level2" number="13.6">
<h2>
<span class="header-section-number">13.6</span> Distributions<a class="anchor" aria-label="anchor" href="#distributions"><i class="fas fa-link"></i></a>
</h2>
<p>The above estimators for total species richness each assume that species abundances follow some sort of distribution where some species are common, and most are rare. Here we explore some particular types of distributions that have been used to quantify this aspect of community structure.</p>
<p>Like any other vector of numbers, we can make a histogram of species abundances. As an example, here we make a histogram of bci tree densities, where each species has its own density (left, Fig. <a href="diversity.html#fig:bci">13.7</a>). This shows us what is patently true for nearly all ecological communities, that <em>most species are rare</em>.</p>
<div class="figure">
<span style="display:block;" id="fig:bci"></span>
<img src="figs/bci1.png" alt="*Three related types of distributions of tree species densities from Barro Colorado Island. Left, histogram of raw data; center, the species--abundance distribution, which is a histogram of log-transformed abundances, accompanied here by the normal probability density function; right, the rank--abundance distribution, as typically presented with the log-transformed data, with the complement of the cumulative probability density function (1-pdf). Normal distributions were applied using the mean and standard deviation from the log-transformed data, times the total number of species.*" width="33%"><img src="figs/bci2.png" alt="*Three related types of distributions of tree species densities from Barro Colorado Island. Left, histogram of raw data; center, the species--abundance distribution, which is a histogram of log-transformed abundances, accompanied here by the normal probability density function; right, the rank--abundance distribution, as typically presented with the log-transformed data, with the complement of the cumulative probability density function (1-pdf). Normal distributions were applied using the mean and standard deviation from the log-transformed data, times the total number of species.*" width="33%"><img src="figs/bci3.png" alt="*Three related types of distributions of tree species densities from Barro Colorado Island. Left, histogram of raw data; center, the species--abundance distribution, which is a histogram of log-transformed abundances, accompanied here by the normal probability density function; right, the rank--abundance distribution, as typically presented with the log-transformed data, with the complement of the cumulative probability density function (1-pdf). Normal distributions were applied using the mean and standard deviation from the log-transformed data, times the total number of species.*" width="33%"><p class="caption">
Figure 13.7: <em>Three related types of distributions of tree species densities from Barro Colorado Island. Left, histogram of raw data; center, the species–abundance distribution, which is a histogram of log-transformed abundances, accompanied here by the normal probability density function; right, the rank–abundance distribution, as typically presented with the log-transformed data, with the complement of the cumulative probability density function (1-pdf). Normal distributions were applied using the mean and standard deviation from the log-transformed data, times the total number of species.</em>
</p>
</div>
<div id="log-normal-distribution" class="section level3" number="13.6.1">
<h3>
<span class="header-section-number">13.6.1</span> Log-normal distribution<a class="anchor" aria-label="anchor" href="#log-normal-distribution"><i class="fas fa-link"></i></a>
</h3>
<p>Given general empirical patterns, that most species are rare, Frank Preston <span class="citation">(<a href="references.html#ref-Preston1948" role="doc-biblioref">Preston 1948</a>, <a href="references.html#ref-Preston1962" role="doc-biblioref">1962</a>)</span> proposed that we describe communities using the logarithms of species abundances (center, Fig. <a href="diversity.html#fig:bci">13.7</a>).<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Preston used base 2 logs to make his histogram bins, and his practice remains standard; we use the natural log.&lt;/p&gt;"><sup>73</sup></a> This often reveals that a community can be described approximately with the normal distribution applied to the log-transformed data, or the <em>log-normal ditribution</em>. We can also display this as a <em>rank–abundance distribution</em> (right, Fig. <a href="diversity.html#fig:bci">13.7</a>). To do this, we assign the most abundant species as rank = 1, and the least abundant has rank = <span class="math inline">\(S\)</span>, in a sample of <span class="math inline">\(S\)</span> species, and plot log-abundance <em>vs.</em> rank.</p>
<p><span class="citation"><a href="references.html#ref-May1975" role="doc-biblioref">R. M. May</a> (<a href="references.html#ref-May1975" role="doc-biblioref">1975</a>)</span> described several ways in which common processes may drive log-normal distributions, and cause them to be common in data sets. Most commonly cited is to note that log-normal distributions arise when each observation (i.e., each random variable) results from the product of independent factors. That is, if each species’ density is determined by largely independent factors which act multiplicatively on each species, the resulting densities would be log-normally distributed. In the process known as <em>ecological drift</em>, pure demographic stochasticity where all species have equal fitness will drive a log-normal-like distribution (see later section on neutral theory).</p>
<p>Well over a dozen other types of abundance distributions exist to describe abundance patterns, other than the log-normal <span class="citation">(<a href="references.html#ref-Magurran2004" role="doc-biblioref">Magurran 2004</a>)</span>. They can all be represented as <em>rank–abundance distributions</em>.</p>
</div>
<div id="other-distributions" class="section level3" number="13.6.2">
<h3>
<span class="header-section-number">13.6.2</span> Other distributions<a class="anchor" aria-label="anchor" href="#other-distributions"><i class="fas fa-link"></i></a>
</h3>
<p>The geometric distribution, also known as the niche preemption distribution, reflects a simple idea, wherein each species pre-empts a constant fraction of the remaining niche space <span class="citation">(<a href="references.html#ref-May1975" role="doc-biblioref">R. M. May 1975</a>; <a href="references.html#ref-Motomura1932" role="doc-biblioref">Motomura 1932</a>)</span>. For instance, if the first species uses 20% of the niche space, the second species uses 20% of the remaining 80%, etc. The frequency of the <span class="math inline">\(i\)</span>th most abundant species is
<span class="math display">\[N_i = \frac{N_T}{C}d\left(1-d\right)^{i-1}\]</span>
where <span class="math inline">\(d\)</span> is the abundance of the most common species, and <span class="math inline">\(C\)</span> is just a constant to make <span class="math inline">\(\sum N_i = N_T\)</span>, where <span class="math inline">\(C=1-\left(1-d\right)^{S_T}\)</span>. Thus this describes the geometric rank–abundance distribution.</p>
<p>The <em>log-series distribution</em> <span class="citation">(<a href="references.html#ref-Fisher1943" role="doc-biblioref">Fisher, Corbet, and Williams 1943</a>)</span> describes the expected frequency of species with <span class="math inline">\(n\)</span> individuals,
<span class="math display" id="eq:fisher">\[\begin{equation}
\tag{13.1} 
F\left(S_n\right) = \frac{\alpha x^n}{n}
\end{equation}\]</span>
where <span class="math inline">\(\alpha\)</span> is a constant that represents diversity (greater <span class="math inline">\(\alpha\)</span> means greater diversity); the <span class="math inline">\(\alpha\)</span> for a diverse rainforest might be 30–100. The constant <span class="math inline">\(x\)</span> is a fitted free parameter, and it is always true that <span class="math inline">\(0.9 &lt; x &lt; 1.0\)</span> and <span class="math inline">\(x\)</span> increases toward 0.99 as <span class="math inline">\(N/S \to 20\)</span> <span class="citation">(<a href="references.html#ref-Magurran2004" role="doc-biblioref">Magurran 2004</a>)</span>. <span class="math inline">\(x\)</span> can be estimated from <span class="math inline">\(S/N=[(1-x)/x] \cdot [-\ln(1-x)]\)</span>. Note that this is not described as a rank–abundance distribution, but species abundances and ranks can nonetheless be plotted in that manner <span class="citation">(<a href="references.html#ref-May1975" role="doc-biblioref">R. M. May 1975</a>)</span>.</p>
<p>We can estimate Fisher’s alpha using <code><a href="https://rdrr.io/pkg/untb/man/optimal.prob.html">optimal.theta()</a></code> in the <code>untb</code> library.</p>
<p>The log-series rank–abundance distribution is thus a bit of a pain, where we are relying on the standard exponential integral <span class="citation">(<a href="references.html#ref-May1975" role="doc-biblioref">R. M. May 1975</a>)</span>, <span class="math inline">\(E_1(s) = \int_s^\infty exp(-t)/t\,dt\)</span>. Given a range of <span class="math inline">\(N\)</span>, we calculate ranks as
<span class="math display">\[F\left(N\right) = \alpha \int_s^\infty exp(-t)/t\,dt\]</span>
where we can let <span class="math inline">\(t=1\)</span> and <span class="math inline">\(s = N \log \left(1 + \alpha/N_T\right)\)</span>. We code for this below.</p>
<p>The log-series distribution has the interesting property that the total number of species in a sample of <span class="math inline">\(N\)</span> individuals would be <span class="math inline">\(S_T = \alpha \log(1+N/\alpha)\)</span>. The parameter <span class="math inline">\(\alpha\)</span> is sometimes used as a measure of diversity. If your data are log-series distributed, then <span class="math inline">\(\alpha\)</span> is approximately the number of species for which you expect 1 individual, because <span class="math inline">\(x\approx 1\)</span>. Two very general theories predict a log-series distribution, including neutral theory, and maximum entropy. Oddly, these two theories both predict a log-series distribution, but make opposite assumptions about niches and individuals (see next section).</p>
<p>MacArthur’s <em>broken stick distribution</em> is a classic distribution that results in a very even distribution of species abundances <span class="citation">(<a href="references.html#ref-MacArthur1957" role="doc-biblioref">MacArthur 1957</a>)</span>. The expected number of individuals of each species <span class="math inline">\(i\)</span> is
<span class="math display">\[N_i = \frac{N_T}{S_T}\sum_{n=i}^{S_T}\frac{1}{n}\]</span>
where <span class="math inline">\(N_T\)</span> and <span class="math inline">\(S_T\)</span> are the total number of individuals and species in the sample, respectively. MacArthur described this as resulting from the simultaneous breakage of a stick at random points along the stick. The resulting size fragments are the <span class="math inline">\(N_i\)</span> above. MacArthur’s broken stick model is thus both a stochastic and a deterministic model. It has a simulation of stick breakage that is the direct analogue of the deterministic analytical expression.</p>
<p>Other similarly tactile stick-breaking distributions create a host of different rank–abundance patterns <span class="citation">(<a href="references.html#ref-Tokeshi:1999fv" role="doc-biblioref">Tokeshi 1999</a>)</span>. In particular, the stick can be broken <em>sequentially</em>, first at one random point, then at a random point along one of two newly broken fragments, then at an additional point along any one of the <em>three</em> broken fragments, <em>etc.</em>, with <span class="math inline">\(S_T-1\)</span> breaks creating <span class="math inline">\(S_T\)</span> species. The critical difference between the models then becomes <em>how each subsequent fragment is selected</em>. If the probability of selecting each fragment is related directly to its size, then this becomes identical to MacArthur’s broken stick model. On the other hand, if each subsequent piece is selected randomly, regardless of its size, then this results in something very similar to the log-normal distribution <span class="citation">(<a href="references.html#ref-Sugihara1980" role="doc-biblioref">Sugihara 1980</a>; <a href="references.html#ref-Tokeshi1990" role="doc-biblioref">Tokeshi 1990</a>)</span>. Other variations on fragment selection generate other patterns <span class="citation">(<a href="references.html#ref-Tokeshi:1999fv" role="doc-biblioref">Tokeshi 1999</a>)</span>.</p>
<p>Here we plot the empirical rank-abundance distribution of all of the BCI data from this census of the 50 ha plot, along with several fitted distributions. They are fit using the <code>radfit</code> function in the <code>vegan</code> package. We then add the log series distribution.</p>
<div class="sourceCode" id="cb506"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># fit the distributions</span>
<span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">BCI</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co"># get the expected ranks for the log series distribution</span>
<span class="co"># standard exponential integral</span>
<span class="va">sei</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">t</span><span class="op">)</span><span class="op">/</span><span class="va">t</span>
<span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu">optimal.theta</span><span class="op">(</span><span class="va">N</span><span class="op">)</span>
<span class="va">Nt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>
<span class="va">rank.logseries</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">N</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">n</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">alpha</span><span class="op">/</span><span class="va">Nt</span> <span class="op">)</span>
  <span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/integrate.html">integrate</a></span><span class="op">(</span><span class="va">sei</span>, <span class="va">n</span>, <span class="cn">Inf</span><span class="op">)</span>
  <span class="va">fv</span> <span class="op">&lt;-</span> <span class="va">f</span><span class="op">[[</span><span class="st">"value"</span><span class="op">]</span><span class="op">]</span>
  <span class="va">alpha</span> <span class="op">*</span> <span class="va">fv</span> <span class="op">}</span> <span class="op">)</span>

<span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/radfit.html">radfit</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">rank.logseries</span>, <span class="va">N</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:bcifit"></span>
<img src="figs/bcifit-1.png" alt="*Entire BCI rank abundance distribution with several fitted models. 'Null' is the broken stick distribution, and the dashed line is the log series.*" width="90%"><p class="caption">
Figure 13.8: <em>Entire BCI rank abundance distribution with several fitted models. ‘Null’ is the broken stick distribution, and the dashed line is the log series.</em>
</p>
</div>
</div>
<div id="pattern-vs.-process" class="section level3" number="13.6.3">
<h3>
<span class="header-section-number">13.6.3</span> Pattern <em>vs.</em> process<a class="anchor" aria-label="anchor" href="#pattern-vs.-process"><i class="fas fa-link"></i></a>
</h3>
<p>Note the resemblance between stick-breaking and niche evolution — if we envision the whole stick as all of the available niche space, or energy, or limiting resources, then each fragment represents a portion of the total occupied by each species. Thus, various patterns of breakage act as models for niche partitioning and relative abundance patterns. Other biological and stochastic processes create specific distributions. For instance, completely random births, deaths, migration, and speciation will create the log-series distribution and the log-normal-like distributions (see <em>neutral theory</em> below). We noted above that independent, multiplicatively interacting factors can create the log-normal distribution.</p>
<p>Although it is intriguing to ponder the processes that can generate particular patterns, we cannot infer definitively the underlying processes from the patterns we observe. That is because different processes can generate the same pattern. Nonetheless, particuar patterns can suggest certain hypotheses about the underlying processes. Many ecologists argue that describing patterns and predicting them are the most important goals of ecology <span class="citation">(<a href="references.html#ref-Peters1988" role="doc-biblioref">Peters 1988</a>)</span>, while others argue that understanding the mechanistic process is the only important goal. Regardless, both of these camps would agree that we can’t draw firm conclusions about processes based solely on patterns — nowhere in ecology has this fallacy been more prevalent than with abundance distributions <span class="citation">(<a href="references.html#ref-Hairston:1991sf" role="doc-biblioref">Hairston Sr. 1991</a>)</span>.</p>
</div>
</div>
<div id="neutral-theory-of-biodiversity-and-biogeography" class="section level2" number="13.7">
<h2>
<span class="header-section-number">13.7</span> Neutral Theory of Biodiversity and Biogeography<a class="anchor" aria-label="anchor" href="#neutral-theory-of-biodiversity-and-biogeography"><i class="fas fa-link"></i></a>
</h2>
<p>One model of abundance distributions is particularly important, and we elaborate on it here. It is referred to variously as the <em>unified neutral theory of biodiversity and biogeography</em> <span class="citation">(<a href="references.html#ref-Hubbell2001" role="doc-biblioref">Hubbell 2001</a>)</span> or often ‘neutral theory’ or ‘eccological drift’ for short. Neutral theory is important because it does much more than most other models of abundance distributions. It is a testable theory that makes quantitative predictions across several levels of organization, for both evolutionary and ecological processes.</p>
<p>Just as evolutionary biology has neutral theories of gene and allele frequencies, ecology has neutral theories of population and community structure and dynamics <span class="citation">(<a href="references.html#ref-Bell2000" role="doc-biblioref">Bell 2000</a>; <a href="references.html#ref-Caswell1976" role="doc-biblioref">Caswell 1976</a>; <a href="references.html#ref-Hubbell2001" role="doc-biblioref">Hubbell 2001</a>)</span>. Neutral communities of species are computationally and mathematically related and often identical to models of genes and alleles <span class="citation">(<a href="references.html#ref-Ewens:2004zp" role="doc-biblioref">Ewens 2004</a>)</span> (Table <a href="diversity.html#tab:jargon">13.1</a>). Thus, lessons you have learned about genetic drift often apply to neutral models of communities. Indeed, neutral ecological dynamics at the local scale are often referred to as ecological drift, and populations change via demographic stochasticity.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Some have called neutral theory a null model, but others disagree &lt;span class="citation"&gt;(&lt;a href="references.html#ref-Gotelli:2006bv" role="doc-biblioref"&gt;N. J. Gotelli and McGill 2006&lt;/a&gt;)&lt;/span&gt;, describing distinctions between dynamical, process-based neutral models with fitted parameters, &lt;em&gt;vs.&lt;/em&gt; static data-based null models &lt;span class="citation"&gt;(&lt;a href="references.html#ref-Gotelli1996" role="doc-biblioref"&gt;N. J. Gotelli and Graves 1996&lt;/a&gt;)&lt;/span&gt;. Both can be used as benchmarks against which to measure other phenomena.&lt;/p&gt;'><sup>74</sup></a></p>
<p>Stephen Hubbell proposed his unified neutral theory of biodiversity and biogeography (hereafter NTBB, <span class="citation">(<a href="references.html#ref-Hubbell2001" role="doc-biblioref">Hubbell 2001</a>)</span>) as a null expectation of the dynamics of individuals, to help explain relative abundances of tropical trees. Hubbell describes it as a direct descendant of MacArthur and Wilson’s theory of island biogeography <span class="citation">(<a href="references.html#ref-MacArthur1963" role="doc-biblioref">MacArthur and Wilson 1963</a>, <a href="references.html#ref-MacArthur1967" role="doc-biblioref">1967</a>)</span> (see below, species–area relations). Hubbell proposed it both as a null hypothesis and also — and this is the controversial part — as a model of community dynamics that closely approximates reality.</p>
<div class="figure">
<span style="display:block;" id="fig:meta"></span>
<img src="figs/meta-1.png" alt="***Left:** A local community of forest canopy trees (small box) nested inside part of the metacommunity of a tropical forest. The true metaccommunity would extend far beyond the boundaries of this figure to include the true potential source of propagules. Shades of grey indicate different species. The local community is a sample of the larger community (such as the 50 ha forest dynamics plot on BCI) and receives migrants from the metacommunity. Mutation gives rise to new species in the metacommunity. For a particular local community, such as a 50 ha plot on an island in the Panama canal, the metacommunity will include not only the surrounding forest on the island, but also Panama, and perhaps much of the neotropics. **Right:** Neutral ecological drift. Ten species, each of 90 individuals, undergo random walks within a finite local community, with no immigration. Here, one generation is equal to nine deaths and nine births. Note the slow decline in unevenness --- after 1000 deaths, no species has become extinct." width="50%"><img src="figs/meta-2.png" alt="***Left:** A local community of forest canopy trees (small box) nested inside part of the metacommunity of a tropical forest. The true metaccommunity would extend far beyond the boundaries of this figure to include the true potential source of propagules. Shades of grey indicate different species. The local community is a sample of the larger community (such as the 50 ha forest dynamics plot on BCI) and receives migrants from the metacommunity. Mutation gives rise to new species in the metacommunity. For a particular local community, such as a 50 ha plot on an island in the Panama canal, the metacommunity will include not only the surrounding forest on the island, but also Panama, and perhaps much of the neotropics. **Right:** Neutral ecological drift. Ten species, each of 90 individuals, undergo random walks within a finite local community, with no immigration. Here, one generation is equal to nine deaths and nine births. Note the slow decline in unevenness --- after 1000 deaths, no species has become extinct." width="50%"><p class="caption">
Figure 13.9: *<strong>Left:</strong> A local community of forest canopy trees (small box) nested inside part of the metacommunity of a tropical forest. The true metaccommunity would extend far beyond the boundaries of this figure to include the true potential source of propagules. Shades of grey indicate different species. The local community is a sample of the larger community (such as the 50 ha forest dynamics plot on BCI) and receives migrants from the metacommunity. Mutation gives rise to new species in the metacommunity. For a particular local community, such as a 50 ha plot on an island in the Panama canal, the metacommunity will include not only the surrounding forest on the island, but also Panama, and perhaps much of the neotropics. <strong>Right:</strong> Neutral ecological drift. Ten species, each of 90 individuals, undergo random walks within a finite local community, with no immigration. Here, one generation is equal to nine deaths and nine births. Note the slow decline in unevenness — after 1000 deaths, no species has become extinct.
</p>
</div>
<p>The relevant world of the NTBB is a metacommunity (left, Fig. <a href="diversity.html#fig:meta">13.9</a>), that is, a collection of local communities connected by dispersal <span class="citation">(<a href="references.html#ref-Leibold:2004fe" role="doc-biblioref">Leibold et al. 2004</a>)</span>.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;The metacommunity concept is quite general, and a neutral metacommunity is but one caricature.&lt;/p&gt;"><sup>75</sup></a> The metacommunity is populated entirely by individuals that are functionally identical. The NTBB is a theory of the dynamics of individuals, modeling individual births, deaths, migration and mutation. It assumes that within a guild, such as late successional tropical trees, species are essentially neutral with respect to their fitness, that is, they exhibit <em>fitness equivalence</em>. This means that the probabilities of birth, death, mutation and migration are identical for all individuals. Therefore, changes in population sizes occur via random walks, that is, via stochastic increases and decreases with time step (right, Fig. <a href="diversity.html#fig:meta">13.9</a>). Random walks do not imply an absence of competition or other indirect enemy mediated negative density dependence. Rather, competition is thought to be diffuse, and equal among individuals. We discuss details of this in the context of simulation. Negative density dependence arises either through a specific constraint on the total number of individuals in a community <span class="citation">(<a href="references.html#ref-Hubbell2001" role="doc-biblioref">Hubbell 2001</a>)</span>, or as traits of individuals related to the probabilities of births, deaths, and speciation <span class="citation">(<a href="references.html#ref-Volkov:2005rt" role="doc-biblioref">Volkov et al. 2005</a>)</span>.</p>
<p>A basic paradox of the NTBB, is that in the absence of migration or mutation, diversity gradually declines to zero, or monodominance. A random walk due to fitness equivalence will eventually result in the loss of all species except one. However, the loss of diversity in any single local community is predicted to be very, very slow, and is countered by immigration and speciation (we discuss more details below). Thus, species do not increase deterministically when rare — this makes the concept of coexistence different than the stable coexistance criteria discussed in previous chapters. Coexistance here <em>is not stable</em> but rather only a stochastic event with a limited time horizon which is balanced by the emergence of new species.</p>
<p>If all communities are thought to undergo random walks toward monodominance, how is diversity maintained in any particular region? Two factors maintain species in any local community. First, immigration into the local community from the metacommunity can bring in new species. Even though each local community is undergoing a random walk toward monodominance, each local community may become dominated by any one of the species in the pool because all species have equal fitness. Thus separate local communities are predicted to become dominated by different species, and these differences among local communities help maintain diversity in the metacommunity landscape.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;This is the same as how genetic drift operates across subpopulations connected by low rates of gene exchange.&lt;/p&gt;"><sup>76</sup></a> Second, at longer time scales and larger spatial scales, speciation (i.e., mutation and lineage-splitting) within the entire metacommunity maintains biodiversity. Mutation and the consequent speciation provide the ultimate source of variation. Random walks toward extinction in large communities are so lengthy that the extinctions are balanced by speciation.</p>
<p>Introducing new symbols and jargon for ecological neutral theory, we state that the diversity of the metacommunity, <span class="math inline">\(\theta\)</span>, is a function of the number of individuals in the metacommunity, <span class="math inline">\(J_M\)</span>, and the per capita rate at which new species arise (via mutation) <span class="math inline">\(\nu\)</span> (<span class="math inline">\(\theta = 2J_M \nu\)</span>; Table <a href="diversity.html#tab:jargon">13.1</a>). A local community undergoes ecological drift; drift causes the slow loss of diversity, which is balanced by a per capita (<span class="math inline">\(J_L\)</span>) immigration rate <span class="math inline">\(m\)</span>.</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:jargon">Table 13.1: </span>Comparison of properties and jargon used in ecological and population genetic neutral theory <span class="citation">(<a href="references.html#ref-Alonso:2006pi" role="doc-biblioref">Alonso, Etienne, and McKane 2006</a>)</span>. Here <span class="math inline">\(x\)</span> is a continuous variable for relative abundance of a species or allele (<span class="math inline">\(0 \le x \le 1\)</span>, <span class="math inline">\(x = n/J\)</span>). Note this is potentially confused with Fisher’s log-series <span class="math inline">\(\langle \phi_n \rangle = \theta x^n /n\)</span>, which is a discrete species abundance distribution in terms of numbers of individuals, <span class="math inline">\(n\)</span> (not relative abundance), and where <span class="math inline">\(x=b/d\)</span>.
</caption>
<thead><tr>
<th style="text-align:left;">
Property
</th>
<th style="text-align:center;">
Ecology
</th>
<th style="text-align:center;">
Evolution
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Entire System (size)
</td>
<td style="text-align:center;">
Metacommunity (<span class="math inline">\(J_M\)</span>)
</td>
<td style="text-align:center;">
Population (<span class="math inline">\(N\)</span>)
</td>
</tr>
<tr>
<td style="text-align:left;">
Nested subsystem (size)
</td>
<td style="text-align:center;">
Local community (<span class="math inline">\(J_L\)</span>)
</td>
<td style="text-align:center;">
Subpop. or Deme (<span class="math inline">\(N\)</span>)
</td>
</tr>
<tr>
<td style="text-align:left;">
Smallest neutral system unit
</td>
<td style="text-align:center;">
Individual organism
</td>
<td style="text-align:center;">
Individual gene
</td>
</tr>
<tr>
<td style="text-align:left;">
Diversity unit
</td>
<td style="text-align:center;">
Species
</td>
<td style="text-align:center;">
Allele
</td>
</tr>
<tr>
<td style="text-align:left;">
Stochastic process
</td>
<td style="text-align:center;">
Ecological drift
</td>
<td style="text-align:center;">
Genetic drift
</td>
</tr>
<tr>
<td style="text-align:left;">
Generator of diversity (rate symbol)
</td>
<td style="text-align:center;">
Speciation (<span class="math inline">\(\nu\)</span>)
</td>
<td style="text-align:center;">
Mutation (<span class="math inline">\(\mu\)</span>)
</td>
</tr>
<tr>
<td style="text-align:left;">
Fundamental diversity number
</td>
<td style="text-align:center;">
<span class="math inline">\(\theta \approx 2J_M\nu\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\theta \approx 4N\mu\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Fundamental dispersal number
</td>
<td style="text-align:center;">
<span class="math inline">\(I \approx 2J_L m\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\theta \approx 4Nm\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Relative abundance distribution (<span class="math inline">\(\Phi \left(x \right)\)</span>)
</td>
<td style="text-align:center;">
<span class="math inline">\(\frac{\theta}{x}\left(1-x\right)^{\theta - 1}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\frac{\theta}{x}\left(1-x\right)^{\theta - 1}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Time to common ancestor
</td>
<td style="text-align:center;">
<span class="math inline">\(\frac{-J_M x}{1-x}\log x\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\frac{-N x}{1-x} \log x\)</span>
</td>
</tr>
</tbody>
</table></div>
<p>It turns out that the abundance distribution of an infinitely large
metacommunity is Fisher’s log-series distribution, and that <span class="math inline">\(\theta\)</span>
of neutral theory is <span class="math inline">\(\alpha\)</span> of Fisher’s log-series <span class="citation">(<a href="references.html#ref-Alonso2004" role="doc-biblioref">Alonso and McKane 2004</a>; <a href="references.html#ref-Leigh:1999qr" role="doc-biblioref">Leigh E. G. 1999</a>; <a href="references.html#ref-Volkov:2003ly" role="doc-biblioref">Volkov et al. 2003</a>)</span>. However, in any one local community, random walks of rare species are likely to include zero, and thus become extinct in the local community by chance alone. This causes a deviation from Fisher’s log-series in any <em>local community</em> by reducing the number of the the rarest species below that predicted by Fisher’s log-series. In particular, it tends to create a log-normal–like distribution, much as we often see in real data (Fig. <a href="diversity.html#fig:bci">13.7</a>). These theoretical findings and their match with observed data are thus consistent with the hypothesis that communities may be governed, in some substantive part, by neutral drift and migration.</p>
<p>Both theory and empirical data show that species which coexist may be more similar than predicted by chance alone <span class="citation">(<a href="references.html#ref-Leibold:2006ey" role="doc-biblioref">Leibold and McPeek 2006</a>)</span>, and that similarity (i.e., fitness equality) among species helps maintain higher diversity than would otherwise be possible <span class="citation">(<a href="references.html#ref-Chesson2000" role="doc-biblioref">Chesson 2000a</a>)</span>. Chesson makes an important distinction between <em>stabilizing mechanisms</em>, which create attractors, and <em>equalizing mechanisms</em>, which reduce differences among species, slow competitive exclusion and facilitate stabilization <span class="citation">(<a href="references.html#ref-Chesson2000" role="doc-biblioref">Chesson 2000a</a>)</span>.</p>
<p>The NTBB spurred tremendous debate about the roles of chance and determinism, of dispersal-assembly and niche-assembly, of evolutionary processes in ecology, and how we go about ‘doing community ecology’ (see, e.g., articles in <em>Functional Ecology</em>, 19(1), 2005; <em>Ecology</em>, 87(6), 2006). This theory in its narrowest sense has been falsified with a few field experiments and observation studies [<span class="citation"><a href="references.html#ref-Clark2003c" role="doc-biblioref">Clark and McLachlan</a> (<a href="references.html#ref-Clark2003c" role="doc-biblioref">2003</a>)</span>; Wootton2005]. However, the <em>degree</em> to which stochasticity and
dispersal <em>versus</em> niche partitioning structure communities
remains generally unknown. Continued refinements and elaboration (e.g., [<span class="citation"><a href="references.html#ref-Alonso2004" role="doc-biblioref">Alonso and McKane</a> (<a href="references.html#ref-Alonso2004" role="doc-biblioref">2004</a>)</span>; <span class="citation"><a href="references.html#ref-Etienne:2007fe" role="doc-biblioref">R. S. Etienne</a> (<a href="references.html#ref-Etienne:2007fe" role="doc-biblioref">2007</a>)</span>; <span class="citation"><a href="references.html#ref-Green:2007nx" role="doc-biblioref">Green and Plotkin</a> (<a href="references.html#ref-Green:2007nx" role="doc-biblioref">2007</a>)</span>, <span class="citation"><a href="references.html#ref-Volkov:2007sy" role="doc-biblioref">Volkov et al.</a> (<a href="references.html#ref-Volkov:2007sy" role="doc-biblioref">2007</a>)</span>) seem promising, continuing to intrigue scientists with different perspectives on natural communities <span class="citation"><a href="references.html#ref-Latimer:2005ft" role="doc-biblioref">Latimer, Silander, and Cowling</a> (<a href="references.html#ref-Latimer:2005ft" role="doc-biblioref">2005</a>)</span>.</p>
<p>Even if communities turn out to be completely non-neutral, NTBB provides a baseline for community dynamics and patterns that has increased the rigor of evidence required to demonstrate mechanisms controlling coexistence and diversity. As <span class="citation"><a href="references.html#ref-Alonso:2006pi" role="doc-biblioref">Alonso, Etienne, and McKane</a> (<a href="references.html#ref-Alonso:2006pi" role="doc-biblioref">2006</a>)</span> state, “… good theory has more predictions per free parameter than bad theory. By this yardstick, neutral theory fares fairly well.” <span class="citation">(see also <a href="references.html#ref-Marquet2014" role="doc-biblioref">Marquet et al. 2014</a>)</span>.</p>
<div id="different-flavors-of-neutral-communities" class="section level3" number="13.7.1">
<h3>
<span class="header-section-number">13.7.1</span> Different flavors of neutral communities<a class="anchor" aria-label="anchor" href="#different-flavors-of-neutral-communities"><i class="fas fa-link"></i></a>
</h3>
<p>Neutral dynamics in a local community can be simulated in slightly different ways, but they are all envisioned as some type of <em>random walk</em>. A random walk occurs when individuals reproduce or die at random, with the consequence that each population increases or decreases by chance.</p>
<p>The simplest version of a random walk assumes that births and deaths and consequent increases and decreases in population size are equally likely and equal in magnitude. A problem with this type of random walk is that a community can increase in size (number of individuals) without upper bound, or can disappear entirely, by chance. We know this doesn’t happen, but it is a critically important first step in conceptualizing a neutral dynamic <span class="citation">(<a href="references.html#ref-Caswell1976" role="doc-biblioref">Caswell 1976</a>)</span>.</p>
<p>Hubbell added another level of biological reality by fixing the total number of individuals in a local community, <span class="math inline">\(J_L\)</span>, as constant. When an individual dies, it is replaced with another individual, thus keeping the population size constant. Replacements come from within the local community with probability <span class="math inline">\(1-m\)</span>, and replacements come from the greater metacommunity with probability <span class="math inline">\(m\)</span>. The dynamics of the metacommunity are so slow compared to the local community that we can safely pretend that it is fixed, unchanging.</p>
<p><span class="citation"><a href="references.html#ref-Volkov:2003ly" role="doc-biblioref">Volkov et al.</a> (<a href="references.html#ref-Volkov:2003ly" role="doc-biblioref">2003</a>)</span> took a different approach by assuming that each species undergoes independent <em>biased</em> random walks. We imagine that each species undergoes its own completely independent random walk, <em>as if</em> it is not interacting with any other species. The key is that the birth rate, <span class="math inline">\(b\)</span>, is slightly less than the death rate, <span class="math inline">\(d\)</span> — this bias toward death gives us the name <em>biased random walk</em>. In a deterministic model with no immigration or speciation, this would result in a slow population decline to zero. In a stochastic model, however, some populations will increase in abundance by chance alone. Slow random walks toward extinctions are balanced by speciation in the metacommunity (with probability~<span class="math inline">\(\nu\)</span>).</p>
<p>If species all undergo independent biased random walks, does this mean species don’t compete and otherwise struggle for existence? No. The reason that <span class="math inline">\(b &lt; d\)</span> is precisely because all species struggle for existence, and only those with sufficiently high fitness, and which are lucky, survive. Neutral theory predicts that it is these species that we observe in nature — those which are lucky, and also have sufficiently high fitness.</p>
<p>In the metacommunity, the average number of species, <span class="math inline">\(\langle \phi_n^M \rangle\)</span>, with population size <span class="math inline">\(n\)</span> is
<span class="math display" id="eq:meta">\[\begin{equation}
\tag{13.2}
  \langle \phi_n^M \rangle = \theta \frac{x^n}{n}
\end{equation}\]</span>
where <span class="math inline">\(x = b/d\)</span>, and <span class="math inline">\(\theta = 2J_M\nu\)</span> <span class="citation">(<a href="references.html#ref-Volkov:2003ly" role="doc-biblioref">Volkov et al. 2003</a>)</span>. The <span class="math inline">\(M\)</span> superscript refers to the metacommunity, and the angle brackets indicate merely that this is the average. Here <span class="math inline">\(b/d\)</span> is barely less than one, because it a biased random walk which is then offset by speciation, <span class="math inline">\(\nu\)</span>. Now we see that this is exactly Fisher’s log-series distribution <a href="diversity.html#eq:fisher">(13.1)</a>, where that <span class="math inline">\(x=b/d\)</span> and <span class="math inline">\(\theta = \alpha\)</span>. Volkov <em>et al.</em> thus show that in a neutral metacommunity, <span class="math inline">\(x\)</span> has a biological interpretation.</p>
<p>The expected size of the entire metacommunity is simply the sum of all of the average species’ <span class="math inline">\(n\)</span>.
<span class="math display" id="eq:Jm">\[\begin{equation}
  \tag{13.3}
  J_M = \sum_{n=1}^{\infty} n \langle \phi_n^M \rangle = 
  \theta \frac{x}{1-x}
\end{equation}\]</span>
Thus the size of the metacommunity is an emergent property of the dynamics, rather than an external constraint. To my mind, it seems that the number of individuals in the metacommunity must result from responses of individuals to their external environment.</p>
<p>Volkov <em>et al.</em> went on to derive expressions for births, deaths,
and average relative abundances in the local community. Given that each individual has an equal probability of dying and reproducing, and that replacements can also come from the metacommunity with a probability proportional to their abundance in the metacommunity, one can specify rules for populations in local communities of a fixed size. These are the probability of increase, <span class="math inline">\(b_{n,k}\)</span>, or decrease, <span class="math inline">\(d_{n,k}\)</span>, in a species, <span class="math inline">\(k\)</span>, of population size <span class="math inline">\(n\)</span>.
<span class="math display" id="eq:d">\[\begin{align}
  b_{n,k} &amp; = \left(1-m\right)\frac{n}{J_L}\frac{J_L-n}{J_L-1} + m\frac{\mu_k}{J_M}\left(1-\frac{n}{J_L}\right)   \tag{13.4}\\
  d_{n,k}&amp;=(1-m)\frac{n}{J_L}\frac{J_L-n}{J_L-1} + m\left(1-\frac{\mu_k}{J_M}\right)\frac{n}{J_L} \tag{13.5}
\end{align}\]</span>
These expressions are the sum of two joint probabilities, each of which is comprised of several independent events. These events are immigration, and birth and death of individuals of different species. Here we describe these probabilities. For a population of size <span class="math inline">\(n\)</span> of species <span class="math inline">\(k\)</span>, we can indicate per capita, per death probabilities including</p>
<ul>
<li>
<span class="math inline">\(m\)</span>, the probability that a replacement is immigrant from the metacommunity, and <span class="math inline">\(1-m\)</span>, the probability that the replacement is from the local community.</li>
<li>
<span class="math inline">\(n/J_L\)</span>, the probability that an individual selected
randomly from the local community belongs to species <span class="math inline">\(k\)</span>, and <span class="math inline">\(1  - n/J_L\)</span> or <span class="math inline">\((J-n)/(J_L)\)</span>, the probability that an individual
selected randomly from the local community belongs to any species other than <span class="math inline">\(k\)</span>.</li>
<li>
<span class="math inline">\((J-n)/(J_L-1)\)</span>, the conditional probability that, given
that an individual of species <span class="math inline">\(k\)</span> has already been drawn from
the population, an individual selected randomly from the local
community belongs to any species other than to species <span class="math inline">\(k\)</span>.</li>
<li>
<span class="math inline">\(\mu_k/J_M\)</span>, the probability that an individual randomly
selected from the metacommunity belongs to species <span class="math inline">\(k\)</span>, and <span class="math inline">\(1 -  n/J_M\)</span>, the probability that an individual randomly selected from
the metacommunity belongs to any species other than <span class="math inline">\(k\)</span>.</li>
</ul>
<p>Each of these probabilities is the probability of some unspecified event — that event might be birth, death, or immigration.</p>
<p>Before we translate <a href="diversity.html#eq:b">(13.4)</a>, <a href="diversity.html#eq:d">(13.5)</a> literally, we note
that <span class="math inline">\(b\)</span> and <span class="math inline">\(d\)</span> each have two terms. The first term is for dynamics
related to the local community, which happen with probability <span class="math inline">\(1-m\)</span>. The second is related to immigration from the metacommunity which occurs with probability <span class="math inline">\(m\)</span>. Consider also that if a death is replaced by a birth of the same species, or a birth is countered by a death of the same species, they cancel each other out, as if nothing ever happened. Therefore each term requires a probability related to species <span class="math inline">\(k\)</span> and to non-<span class="math inline">\(k\)</span>.</p>
<p>Eq. <a href="diversity.html#eq:b">(13.4)</a>, <span class="math inline">\(b_{n,k}\)</span>, is the probability that an individual will be added to the population of species <span class="math inline">\(k\)</span>. The first term is the joint probability that an addition to the population comes from within the local community (<span class="math inline">\(1-m\)</span>) <em>and</em> the birth comes from species <span class="math inline">\(k\)</span> (<span class="math inline">\(n/J_L\)</span>) <em>and</em> there is a death of an individual of any other species (<span class="math inline">\((J_L-n)/(J_L-1)\)</span>).<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;The denominator of the death probability is &lt;span class="math inline"&gt;\(J_L-1\)&lt;/span&gt; instead of &lt;span class="math inline"&gt;\(J_L\)&lt;/span&gt; because we have already selected the first individual who will do the reproduction, so the total number of remaining individuals is &lt;span class="math inline"&gt;\(J_L-1\)&lt;/span&gt; rather than &lt;span class="math inline"&gt;\(J_L\)&lt;/span&gt;; the number of non-&lt;span class="math inline"&gt;\(k\)&lt;/span&gt; individuals remains &lt;span class="math inline"&gt;\(J_L-n\)&lt;/span&gt;&lt;/p&gt;'><sup>77</sup></a> The second term is the joint probability that the addition to the population comes from the metacommunity via immigration (<span class="math inline">\(m\)</span>) <em>and</em> that the immigrant is of species <span class="math inline">\(k\)</span> (<span class="math inline">\(\mu_k/J_M\)</span>) <em>and</em> is not accompanied by a death of an individual of its species (<span class="math inline">\(n/J_L\)</span>).</p>
<p>An individual may be subtracted from the population following similar logic. Eq. , <span class="math inline">\(d_{n.k}\)</span>, is the probability that a death will remove an individual from the population of species <span class="math inline">\(k\)</span>. The first term is the joint probability that the death occurs in species <span class="math inline">\(k\)</span> (<span class="math inline">\(n/J_L\)</span>) and the replacement comes from the local community (<span class="math inline">\(1-m\)</span>) and is some species other than <span class="math inline">\(k\)</span> (<span class="math inline">\((J_L-n)/(J_L-1)\)</span>). The second term is the joint probability that the death occurs in species <span class="math inline">\(k\)</span> (<span class="math inline">\(n/J_L\)</span>), and that it is replaced by an immigrant (<span class="math inline">\(m\)</span>) <em>and</em> the immigrant is any species in the metacommunity other than <span class="math inline">\(k\)</span> (<span class="math inline">\(1-\mu_k/J_M\)</span>).</p>
</div>
<div id="investigating-neutral-communities" class="section level3" number="13.7.2">
<h3>
<span class="header-section-number">13.7.2</span> Investigating neutral communities<a class="anchor" aria-label="anchor" href="#investigating-neutral-communities"><i class="fas fa-link"></i></a>
</h3>
<p>Here we explore netural communities using the <code>untb</code> package, which contains a variety of functions for teaching and research on neutral theory.</p>
<p><strong>Pure drift</strong></p>
<p>After loading the package and setting graphical parameters, let’s run a simulation of drift. Recall that drift results in the slow extinction of all but one species. We start with a local community with 20 species, each with 25 individuals<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;This happens to be the approximate tree density (450 trees,ha&lt;span class="math inline"&gt;\(^{-1}\)&lt;/span&gt;, for trees &lt;span class="math inline"&gt;\(&amp;gt;10\)&lt;/span&gt;,cm DBH) on BCI.&lt;/p&gt;'><sup>78</sup></a> The simulation then runs for 1000 generations (where 9/900 individuals die per generation). Note that <code><a href="https://rdrr.io/pkg/untb/man/display.untb.html">display.untb()</a></code> is great for pretty pictures, whereas <code><a href="https://rdrr.io/pkg/untb/man/untb.html">untb()</a></code> is better for more serious simulations.]</p>
<div class="sourceCode" id="cb507"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RobinHankin/untb.git">untb</a></span><span class="op">)</span>
<span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/untb/man/untb.html">untb</a></span><span class="op">(</span>start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">25</span><span class="op">)</span>, prob<span class="op">=</span><span class="fl">0</span>, gens<span class="op">=</span><span class="fl">2500</span>, D<span class="op">=</span><span class="fl">9</span>, keep<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>We <code>keep</code> in a matrix all 450 trees from each of the 1000
time steps so that we can investigate the properties of the
community. The output is a matrix where each element is an integer
whose value represents a species ID. Rows are time steps and we can
think of columns as spots on the ground occupied by trees. Thus a
particular spot of ground may be occupied by an individual of one
species for a long time, and suddenly switch identity, because it dies
and is replaced by an individual of another species. Thus the
community always has 450 individuals (columns), but the identities of
those 450 change through time, according to the rules laid out in
<a href="diversity.html#eq:b">(13.4)</a>, <a href="diversity.html#eq:d">(13.5)</a>. Each different species is represented by a different integer; here we show the identities of ten individuals (columns) for generations 901–3.</p>
<div class="sourceCode" id="cb508"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span> <span class="va">a2</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">[</span><span class="fl">901</span><span class="op">:</span><span class="fl">903</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> <span class="op">]</span> <span class="op">)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
## [1,]    6    2   20   20   20   10   10    6   15    15
## [2,]    6    2   20   20   20   10   10    6   15    15
## [3,]    6    2   20   20   20   10   10    6   15    15</code></pre>
<p>Thus, in generation 901, tree no. 1 is species <code>6</code> and in generation 902, tree no. 3 is species <code>20</code>.</p>
<p>We can make pretty pictures of the communities at time steps 1, 100, and 2500, by having a single point for each tree, and coding species identity by shades of grey. We could use a nice color palette, <code><a href="https://rdrr.io/r/grDevices/hcl.html">hcl()</a></code>, based on hue, chroma, and luminance, for instance <code><a href="https://rdrr.io/r/grDevices/hcl.html">hcl(a[i,]*30+50)</a></code>.</p>
<div class="sourceCode" id="cb510"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">50</span>,<span class="fl">2500</span><span class="op">)</span>
<span class="va">sppcolors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">times</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html">grey</a></span><span class="op">(</span><span class="op">(</span><span class="va">a</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">20</span><span class="op">)</span> <span class="op">)</span></code></pre></div>
<p>This function applies to the community, at each time step, the <code><a href="https://rdrr.io/r/grDevices/gray.html">grey()</a></code> function. Recall that species identity is an integer; we use that integer to characterize each species’ shade of grey.</p>
<p>Next we create the three graphs at three time points, with the appropriate data, colors, and titles.</p>
<div class="sourceCode" id="cb511"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, nr<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">20</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">25</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"n"</span>, axes<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="fl">25</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">25</span>,each<span class="op">=</span><span class="fl">20</span><span class="op">)</span>, pch<span class="op">=</span><span class="fl">19</span>, cex<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="va">sppcolors</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Time = "</span>, <span class="va">times</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="inline-figure"><img src="figs/unnamed-chunk-235-1.png" width="90%"></div>
<div class="sourceCode" id="cb512"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span>, nr<span class="op">=</span><span class="fl">3</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">20</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">25</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"n"</span>, axes<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="fl">25</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">25</span>,each<span class="op">=</span><span class="fl">20</span><span class="op">)</span>, pch<span class="op">=</span><span class="fl">19</span>, cex<span class="op">=</span><span class="fl">1.5</span>, col<span class="op">=</span><span class="va">sppcolors</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Time = "</span>, <span class="va">times</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">times</span><span class="op">)</span><span class="op">{</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/untb/man/count.html">as.count</a></span><span class="op">(</span><span class="va">a</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">)</span>, 
     ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/untb/man/count.html">as.count</a></span><span class="op">(</span><span class="va">a</span><span class="op">[</span><span class="fl">2000</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">20</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">times</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span>  <span class="fu"><a href="https://rdrr.io/pkg/untb/man/preston.html">preston</a></span><span class="op">(</span><span class="va">a</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">)</span> <span class="op">)</span>
<span class="va">bins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow<span class="op">=</span><span class="fl">3</span>, ncol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">out</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="va">bins</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">out</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>
<span class="va">bins</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]
## [1,]    0    0    0    0    0   20    0    0    0
## [2,]    0    0    0    0    0   18    2    0    0
## [3,]    0    0    0    1    1    1    3    0    2</code></pre>
<div class="sourceCode" id="cb514"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">bins</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/untb/man/preston.html">preston</a></span><span class="op">(</span><span class="va">a</span><span class="op">[</span><span class="va">times</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>las<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">bins</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">20</span><span class="op">)</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">8</span><span class="op">)</span>, ylab<span class="op">=</span><span class="st">"No. of Species"</span>, xlab<span class="op">=</span><span class="st">"Abundance Category"</span> <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:comms"></span>
<img src="figs/comms-1.png" alt="*Three snapshots of one community, drifting through time. Shades of grey represent different species. The second and third rows are the rank-abundances and species -abundance distributions corresponding to the communities above. Drift results in the slow loss of diversity.*" width="90%"><p class="caption">
Figure 13.10: <em>Three snapshots of one community, drifting through time. Shades of grey represent different species. The second and third rows are the rank-abundances and species -abundance distributions corresponding to the communities above. Drift results in the slow loss of diversity.</em>
</p>
</div>
<p>Bottom line: drift causes the slow loss of species from local communities (Fig. <a href="diversity.html#fig:comms">13.10</a>). What is not illustrated here is that without dispersal, drift will cause different species to become abundant in different places because the variation is random. In that way, drift maintains diversity at large scales, in the metacommunity. Last, low rates of dispersal among local communities maintains some diversity in local communities without changing the entire metacommunity into a single large local community. Thus dispersal limitiation, but not its absence, maintains diversity.</p>
<p>Next, let’s examine the dynamics through time. We will plot individual species trajectories (Fig. ).</p>
<div class="sourceCode" id="cb515"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sppmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/untb/man/species.count.html">species.table</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html">matplot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">times</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">sppmat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">times</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,<span class="op">]</span>, type<span class="op">=</span><span class="st">'l'</span>, ylab<span class="op">=</span><span class="st">"Population Density"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure">
<img src="figs/spptable-1.png" width="90%">
The trajectories all start at the same abundance, but they need not have. The trajectories would still have the same drifting quality.</div>
<p>For random walks in general, the observed variance and coefficient of variation (<span class="math inline">\(CV=\hat{\sigma}/\bar{x}\)</span>) of a population will grow over time <span class="citation">(<a href="references.html#ref-Clark2003c" role="doc-biblioref">Clark and McLachlan 2003</a>)</span>. Here we calculate the average population <span class="math inline">\(CV\)</span> of cumulative observations (note the convenient use of nested <code>(s)apply</code> functions). Let’s calculate the <span class="math inline">\(CV\)</span>’s for every tenth time step.</p>
<div class="sourceCode" id="cb516"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cvtimes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2500</span>, by<span class="op">=</span><span class="fl">10</span><span class="op">)</span>
<span class="va">CV.within</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">cvtimes</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span><span class="co"># Use sapply with i as a row counter</span>
  <span class="co">## For each row i, use apply to caluculate the variance for each</span>
  <span class="co">## population from 1:i</span>
  <span class="va">cvs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">sppmat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">i</span>,<span class="op">]</span>,<span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">cvs</span><span class="op">)</span> <span class="co"># get the mean among populations (for each i).</span>
  <span class="op">}</span> <span class="op">)</span>
<span class="co">#popvar.among &lt;- apply(sppmat, 1, var)</span></code></pre></div>
<p>Now plot the average <span class="math inline">\(CV\)</span> through time. The average observed <span class="math inline">\(CV\)</span> should increase (Fig. ).</p>
<div class="sourceCode" id="cb517"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span> <span class="va">cvtimes</span>, <span class="va">CV.within</span>, type<span class="op">=</span><span class="st">'l'</span> <span class="op">)</span></code></pre></div>
<div class="inline-figure">
<img src="figs/unnamed-chunk-237-1.png" width="90%">
This shows us that the populations never approach an equilibrium, but wander aimlessly.</div>
<p><strong>Real data</strong></p>
<p>Last, we examine the BCI data set <span class="citation">(<a href="references.html#ref-Condit2002" role="doc-biblioref">Condit et al. 2002</a>)</span>. We load the data (data from 50 1,ha plots <span class="math inline">\(\times\)</span> 225 species, from the <code>vegan</code> package), and sum species abundances to get each species total for the entire 50,h plot (Fig. <a href="#fig:bcipreston"><strong>??</strong></a>).</p>
<div class="sourceCode" id="cb518"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">BCI</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>las<span class="op">=</span><span class="fl">2</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">xs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/untb/man/preston.html">preston</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">225</span>,<span class="va">n</span><span class="op">)</span>, n<span class="op">=</span><span class="fl">12</span>, original<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="figs/unnamed-chunk-238-1.png" width="90%">
We would like to estimate <span class="math inline">\(\theta\)</span> and <span class="math inline">\(m\)</span> from these data, but that
requires specialized software for any data set with a realistic number
of individuals. Specialized software would provide maximum likelihood
estimates (in a reasonable amount of computing time) for <span class="math inline">\(m\)</span> and
<span class="math inline">\(\theta\)</span> for large communities <span class="citation">(<a href="references.html#ref-Etienne2005" role="doc-biblioref">Rampal S. Etienne 2005</a>; <a href="references.html#ref-Hankin:2007zm" role="doc-biblioref">Hankin, R.K.S 2007</a>; <a href="references.html#ref-Jabot:2009mi" role="doc-biblioref">Jabot and Chave 2009</a>)</span>. The BCI data have been used repeatedly, so we rely on estimates from the literature (<span class="math inline">\(\theta \approx 48\)</span>, <span class="math inline">\(m \approx 0.1\)</span>) [<span class="citation"><a href="references.html#ref-Etienne2005" role="doc-biblioref">Rampal S. Etienne</a> (<a href="references.html#ref-Etienne2005" role="doc-biblioref">2005</a>)</span>;Volkov:2003ly]. We use the approach of <span class="citation"><a href="references.html#ref-Volkov:2003ly" role="doc-biblioref">Volkov et al.</a> (<a href="references.html#ref-Volkov:2003ly" role="doc-biblioref">2003</a>)</span> to generate expected species abundances (Fig. <a href="#fig:bcipreston"><strong>??</strong></a>).</p>
<div class="sourceCode" id="cb519"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">v1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/untb/man/volkov.html">volkov</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">48</span>, <span class="fl">0.1</span><span class="op">)</span>, bins<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/untb/man/preston.html">preston</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">225</span>,<span class="va">n</span><span class="op">)</span>, n<span class="op">=</span><span class="fl">12</span>, original<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">xs</span>, <span class="va">v1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span>, type<span class="op">=</span><span class="st">'b'</span><span class="op">)</span></code></pre></div>
<p><img src="figs/unnamed-chunk-239-1.png" width="90%"><span class="citation"><a href="references.html#ref-Jabot:2009mi" role="doc-biblioref">Jabot and Chave</a> (<a href="references.html#ref-Jabot:2009mi" role="doc-biblioref">2009</a>)</span> arrived at estimates that differed from previous estimates by orders of magnitude. Their novel approach estimated <span class="math inline">\(\theta\)</span> and <span class="math inline">\(m\)</span> were derived from <em>both</em> species abundance data and from phylogenetic data (<span class="math inline">\(\theta \approx 571\)</span>, <span class="math inline">\(m \approx 0.002\)</span>). This is possible because neutral theory makes a rich array of predictions, based on both ecological and evolutionary processes. Their data were only a little bit different (due to a later census), but their analyses revealed radically different estimates, with a much greater diversity and larger metacommunity (greater <span class="math inline">\(\theta\)</span>), and much lower immigration rates (smaller <span class="math inline">\(m\)</span>).</p>
<p>Here we derive expected species abundance distributions. The first is based solely on census data, and is similar to previous expections. However, when they also included phylogenetic data, they found very different expected species abundance distributions (Fig. <a href="diversity.html#fig:bciJabot">13.11</a>).</p>
<div class="sourceCode" id="cb520"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Census data only</span>
<span class="va">v2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/untb/man/volkov.html">volkov</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">48</span>, <span class="fl">0.1</span><span class="op">)</span>, bins<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="co"># With phylogenetic data as well.</span>
<span class="va">v4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/untb/man/volkov.html">volkov</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">571</span>, <span class="fl">0.002</span><span class="op">)</span>, bins<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/untb/man/preston.html">preston</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">225</span>,<span class="va">n</span><span class="op">)</span>, n<span class="op">=</span><span class="fl">12</span>, original<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="va">xs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/untb/man/preston.html">preston</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">225</span>,<span class="va">n</span><span class="op">)</span>, n<span class="op">=</span><span class="fl">12</span>, original<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span>, at<span class="op">=</span><span class="va">xs</span>, labels<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">xs</span>, <span class="va">v2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span>, type<span class="op">=</span><span class="st">'b'</span>, lty<span class="op">=</span><span class="fl">1</span>, col<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">xs</span>, <span class="va">v4</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span>, type<span class="op">=</span><span class="st">'b'</span>, lty<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:bciJabot"></span>
<img src="figs/bciJabot-1.png" alt="*Jabot and Chave found that when they used only species abundances (as did previous investigators) their pattern was similar to previous findings (solid line). However, adding phylogenetic information led to very different expectations (dashed line)*" width="90%"><p class="caption">
Figure 13.11: <em>Jabot and Chave found that when they used only species abundances (as did previous investigators) their pattern was similar to previous findings (solid line). However, adding phylogenetic information led to very different expectations (dashed line)</em>
</p>
</div>
<p><strong>Symmetry and the rare species advantage</strong></p>
<p>An important aspect of neutral theory is the quantification of a <em>symmetric rare species advantage</em>. The symmetry hypothesis posits that all species have a symmetrical rare species advantage <span class="citation">(<a href="references.html#ref-Volkov:2005rt" role="doc-biblioref">Volkov et al. 2005</a>, <a href="references.html#ref-Volkov:2007sy" role="doc-biblioref">2007</a>)</span>. That is, all species increase when rare to the same degree (equal negative density dependence). In a strict sense, all individuals remain the same in that their birth and death probabilities change with population size in the same manner for all species. This obviously reduces the chance of random walks to extinction, but is nonetheless the same among all species. Estimation of the magnitude of the rare species advantage is interesting addition to stepwise increasing complexity.</p>
<p>To sum up: it is safe to say that neutral theory has already made our thinking about community structure and dynamics more sophisticated and subtle, by extending island biogeography to individuals. The theory is providing quantitative, pattern-generating models, that are analogous to null hypotheses. With the advent of specialized software, theory is now becoming more useful in our analysis of data <span class="citation">(<a href="references.html#ref-Etienne2005" role="doc-biblioref">Rampal S. Etienne 2005</a>; <a href="references.html#ref-Hankin:2007zm" role="doc-biblioref">Hankin, R.K.S 2007</a>; <a href="references.html#ref-Jabot:2009mi" role="doc-biblioref">Jabot and Chave 2009</a>)</span>.</p>
</div>
</div>
<div id="speciesarea-relations" class="section level2" number="13.8">
<h2>
<span class="header-section-number">13.8</span> Species–area relations<a class="anchor" aria-label="anchor" href="#speciesarea-relations"><i class="fas fa-link"></i></a>
</h2>
<p>The number of species we observe clearly depends on the number of individuals we sample, which in turn may depend on the size of the area in which we count individuals. For this reason alone, we may be interested in the relation between species and area. However, area is alos important because it is likely correlated with habitat heterogeneity, dispersal limitation, and even reproductive isolation. The study of species-area relations includes understanding how all these things fit together.</p>
<p>The relation between the number of species found in samples of different area has a long tradition <span class="citation">(<a href="references.html#ref-Arrhenius1921" role="doc-biblioref">Arrhenius 1921</a>; <a href="references.html#ref-MacArthur1972" role="doc-biblioref">MacArthur 1972</a>; <a href="references.html#ref-MacArthur1963" role="doc-biblioref">MacArthur and Wilson 1963, MacArthur1967</a>; <a href="references.html#ref-Preston:1960uq" role="doc-biblioref">Preston 1960</a>; <a href="references.html#ref-Rosenzweig1995" role="doc-biblioref">Rosenzweig 1995</a>)</span>, and is now an important part of the subdiscipline of <em>macroecology</em> <span class="citation">(<a href="references.html#ref-Brown1995" role="doc-biblioref">Brown 1995</a>; <a href="references.html#ref-Harte:2008nq" role="doc-biblioref">J. Harte et al. 2008</a>)</span>.</p>
<p>Most generally, the species–area relation (SAR) is simply an empirical pattern of the number of species found in patches of different size, plotted as a function of the sizes of the respective patches (Fig. <a href="#fig:sars"><strong>??</strong></a>). These patches may be isolated from each other, as islands in the South Pacific <span class="citation">(<a href="references.html#ref-MacArthur1963" role="doc-biblioref">MacArthur and Wilson 1963</a>)</span>, or mountaintops covered in coniferous forest surrounded by a sea of desert <span class="citation">(<a href="references.html#ref-Brown1977" role="doc-biblioref">Brown and Davidson 1977</a>)</span>, or calcareous grasslands in an agricultural landscape <span class="citation">(<a href="references.html#ref-Hamback:2007yj" role="doc-biblioref">Hambäack et al. 2007</a>)</span>. On the other hand, these patches might be nested sets, where each larger patch contains all others <span class="citation">(<a href="references.html#ref-Crawley2001a" role="doc-biblioref">Crawley and Harral 2001</a>; <a href="references.html#ref-Plotkin:2000qe" role="doc-biblioref">Plotkin et al. 2000</a>)</span>.</p>
<p>Quantitatively, the relation is most often proposed as a simple power law,
<span class="math display" id="eq:area1">\[\begin{equation}
  \tag{13.6}
  S = cA^z
\end{equation}\]</span>
where <span class="math inline">\(S\)</span> is the number of species in a patch of size <span class="math inline">\(A\)</span>, and <span class="math inline">\(c\)</span> and <span class="math inline">\(z\)</span> are fitted constants. This is most often plotted as a log–log relation, which makes it linear.
<span class="math display" id="eq:area2">\[\begin{equation}
  \tag{13.7}
  \log\left(S\right) = b + z \log(A)
\end{equation}\]</span>
where <span class="math inline">\(b\)</span> is the intercept (equal to <span class="math inline">\(\log c\)</span>) and <span class="math inline">\(z\)</span> is the slope. Other forms have been used, and sometimes better capture the relation <span class="citation">(<a href="references.html#ref-Scheiner:2003aa" role="doc-biblioref">S. M. Scheiner 2003</a>)</span>.</p>
<p>Here we simply draw some species area curves.</p>
<div class="sourceCode" id="cb521"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">A</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>; <span class="va">c</span> <span class="op">&lt;-</span> <span class="fl">1.5</span>; <span class="va">z</span> <span class="op">&lt;-</span> <span class="fl">0.25</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="va">c</span><span class="op">*</span><span class="va">x</span><span class="op">^</span><span class="va">z</span>, <span class="fl">10</span>, <span class="fl">10</span><span class="op">^</span><span class="fl">10</span>, n<span class="op">=</span><span class="fl">500</span>, ylab<span class="op">=</span><span class="st">"No. of Species"</span>, xlab<span class="op">=</span><span class="st">"Area (ha)"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="figs/unnamed-chunk-240-1.png" width="90%"></div>
<div class="sourceCode" id="cb522"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">c</span>,<span class="fl">10</span><span class="op">)</span> <span class="op">+</span> <span class="va">z</span><span class="op">*</span><span class="va">x</span>, <span class="fl">1</span>, <span class="fl">10</span>, ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span><span class="op">(</span><span class="va">log</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span><span class="op">(</span><span class="st">"No. of Species"</span><span class="op">)</span><span class="op">)</span>, 
      xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span><span class="op">(</span><span class="va">log</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span><span class="op">(</span><span class="st">"Area (ha)"</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="figs/unnamed-chunk-240-2.png" width="90%"></div>
<p>Here we fit a species–area curve to data, and examine the slope. We could fit a nonlinear power relation (<span class="math inline">\(y=cA^z\)</span>); this would be appropriate, for instance, if the residual noise around the line were of the same magnitude for all patch areas. We could use reduced major axis regression, which is appropriate when there is equivalent uncertainty or error on both <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. Last (and most often), we could use a simple linear regression on the log-transformed data, which is appropriate when we know <span class="math inline">\(x\)</span> to a high degree of accuracy, but measure <span class="math inline">\(y\)</span> with some error, and the transformation causes the residual errors to be of similar magnitude at all areas. We start with the last (log-transformed). Here we plot the data, and fit a linear model to the common log-transformed data.</p>
<div class="sourceCode" id="cb523"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">moths</span><span class="op">)</span>
<span class="va">mod.nonlin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">spp</span> <span class="op">~</span> <span class="va">a</span><span class="op">*</span><span class="va">area</span><span class="op">^</span><span class="va">z</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">1</span>, z<span class="op">=</span><span class="fl">.2</span><span class="op">)</span>,data<span class="op">=</span><span class="va">moths</span><span class="op">)</span>
<span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">spp</span>,<span class="fl">10</span><span class="op">)</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">area</span>,<span class="fl">10</span><span class="op">)</span>, data<span class="op">=</span><span class="va">moths</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">spp</span>,<span class="fl">10</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">area</span>,<span class="fl">10</span><span class="op">)</span>, <span class="va">moths</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod.nonlin</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="fl">10</span><span class="op">)</span> <span class="op">+</span>  <span class="va">x</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod.nonlin</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, 
      <span class="fl">0</span>, <span class="fl">3</span>, add<span class="op">=</span><span class="cn">TRUE</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:sarsfit"></span>
<img src="figs/sarsfit-1.png" alt="*Two different fits to the moth species-area data.*" width="90%"><p class="caption">
Figure 13.12: <em>Two different fits to the moth species-area data.</em>
</p>
</div>
<p>Note that in Figure <a href="diversity.html#fig:sarsfit">13.12</a>, the fits differ slightly between the two methods. Let’s compare the confidence intervals of the slopes — we certainly expect them to be similar, given the picture we just drew.</p>
<div class="sourceCode" id="cb524"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># linear fit to transformed data</span>
<span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></code></pre></div>
<pre><code>##                    2.5 %   97.5 %
## (Intercept)   1.50842866 1.677286
## log(area, 10) 0.09025952 0.196390</code></pre>
<div class="sourceCode" id="cb526"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># nonlinear fit to raw data</span>
<span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">mod.nonlin</span><span class="op">)</span></code></pre></div>
<pre><code>##          2.5%      97.5%
## a 31.61609496 50.1918074
## z  0.08491709  0.1957816</code></pre>
<p>We note that the estimates of the slopes are quite similar. In addition, <span class="math inline">\(\log a\)</span> is also similar to the intercept of the linear model. Determining the better of the two methods (or others) is beyond the scope of this book, but be aware that methods can matter.</p>
<p>The major impetus for the species–area relation came from (i) Preston’s work on connections between the species–area relation and the log-normal species abundance distribution <span class="citation">(<a href="references.html#ref-Preston:1960uq" role="doc-biblioref">Preston 1960</a>, <a href="references.html#ref-Preston1962" role="doc-biblioref">1962</a>)</span>, and (ii) MacArthur and Wilson’s theory of island biogeography <span class="citation">(<a href="references.html#ref-MacArthur1967" role="doc-biblioref">MacArthur and Wilson 1967</a>)</span>.</p>
<p>Preston posited that, given the log-normal species abundance distributions (see above), then increasingly large samples should accumulate species at particular rates. Direct extensions of this work, linking neutral theory and maximum entropy theory to species abundances and species–area relations continued <span class="citation">(<a href="references.html#ref-Bell2001" role="doc-biblioref">Bell 2001</a>; <a href="references.html#ref-Harte:2008nq" role="doc-biblioref">J. Harte et al. 2008</a>; <a href="references.html#ref-Hubbell2001" role="doc-biblioref">Hubbell 2001</a>)</span>.</p>
<div id="island-biogeography" class="section level3" number="13.8.1">
<h3>
<span class="header-section-number">13.8.1</span> Island biogeography<a class="anchor" aria-label="anchor" href="#island-biogeography"><i class="fas fa-link"></i></a>
</h3>
<p>MacArthur and Wilson proposed a simple theory wherein the number of species on an oceanic island was a function of the immigration rate of new species, and extinction rate of existing species (Fig. <a href="diversity.html#fig:IE">13.13</a>). The number of species at any one time was a <em>dynamic equilibrium</em>, resulting from both slow inevitable extinction and slow continual arrival of replacements. Thus species composition on the island was predicted to change over time, that is, to undergo turnover. Our appreciation of the ecological and evolution processes that govern the number and variety of species on islands continues to grow <span class="citation">(<a href="references.html#ref-Whittaker:2017aa" role="doc-biblioref">R. J. Whittaker et al. 2017</a>)</span>.</p>
<p>Let us imagine immigration rate, <span class="math inline">\(y\)</span>, as a function of the number of species already on an island, <span class="math inline">\(x\)</span> (Fig. <a href="diversity.html#fig:IE">13.13</a>). This relation will have a negative slope, because as the number of species rises, that chance that a new individual actually represents a new species will decline. The immigration rate will be highest when there are no species on the island, <span class="math inline">\(x=0\)</span>, and will fall to zero when every conceivable species is already there. In addition, the slope should be decelerating (concave up) because some species will be much more likely than others to immigrate. This means that the immigration rate drops steeply as the most likely immigrants arrive, and only the unlikely immigrants are missing. Immigrants may colonize quickly for two reasons. First, as Preston noted, some species are simply much more common than others. Second, some species are much better dispersers than others.</p>
<p>Now let us imagine extinction rate, <span class="math inline">\(y\)</span>, as a function of the number of species, <span class="math inline">\(x\)</span> (Fig. <a href="diversity.html#fig:IE">13.13</a>). This relation will have a positive slope, such that the probability of extinction increases with the number of species. This is predicted to have an accelerating slope (concave-up), for essentially the same sorts of reasons governing the shape of the immigration curve: Some species are less common than others, and therefore more likely to become extinct due to demographic and environmental stochasticity, and second, some species will have lower fitness for any number of reasons. As the number of species accumulates, the more likely it will become that these extinction-prone species (rare and/or lower fitness) will be present, and therefore able to become extinct.</p>
<p>The <em>rate of change</em> of the number of species on the island,
<span class="math inline">\(\Delta S\)</span>, will be the difference between immimigration, <span class="math inline">\(I\)</span>, and extinction, <span class="math inline">\(E\)</span>, or
<span class="math display" id="eq:deltaS">\[\begin{equation}
  \tag{13.8}
   \Delta S = I - E.
\end{equation}\]</span>
When <span class="math inline">\(\Delta S = 0\)</span>, we have an equilibrium. If we knew the quantitative form of immigration and extinction, we could solve for the equilibrium. That equilibrium would be the point on the <span class="math inline">\(x\)</span> axis, <span class="math inline">\(S\)</span>, where the two rates cross (Fig. <a href="diversity.html#fig:IE">13.13</a>).</p>
<p>In MacArthur and Wilson’s theory of island biogeography, these rates could be driven by the <em>sizes</em> of the islands, where</p>
<ul>
<li>larger islands had lower extinction rates because of larger average population sizes, and</li>
<li>larger islands had higher colonization rates because they were larger targets for dispersing species.</li>
</ul>
<p>The distance between an island and sources of propagules was also predicted to influence these rates, where</p>
<ul>
<li>islands closer to mainlands had higher colonization rates of new species because more propagules would be more likely to arrive there, and</li>
<li>the effect of area would be more important for islands far from mainlands than for islands close to mainlands.</li>
</ul>
<p>Like much good theory, these were simple ideas, but had profound
effects on the way ecologists thought about communities. Now these
ideas, of dispersal mediated coexistence and landscape structure,
continue to influence community ecologists.</p>
<p><strong>Drawing immigration and extinction curves</strong></p>
It would be fun to derive a model of immigration and extinction rates from first principles <span class="citation">(<a href="references.html#ref-MacArthur1963" role="doc-biblioref">MacArthur and Wilson 1963</a>)</span>, but here we can illustrate these relations with some simple phenomenological graphs. The code that follows recreates Fig. <a href="diversity.html#fig:IE">13.13</a>, and also estimates <span class="math inline">\(S\)</span>.
<div class="figure">
<span style="display:block;" id="fig:IE"></span>
<img src="figs/IE-1.png" alt="*Immigration and extinction curves for the theory of island biogeography. The declining curves represent immigration rates as functions of the number of species present on an island. The increasing curves represent extinction rates, also as functions of island richness. See text for discussion of the heights of these curves, i.e.,  controls on these rates. Here the dashed lines represent an island that is shrinking in size.*" width="90%"><p class="caption">
Figure 13.13: <em>Immigration and extinction curves for the theory of island biogeography. The declining curves represent immigration rates as functions of the number of species present on an island. The increasing curves represent extinction rates, also as functions of island richness. See text for discussion of the heights of these curves, i.e., controls on these rates. Here the dashed lines represent an island that is shrinking in size.</em>
</p>
</div>
<p>We will assume that immigration rate, <span class="math inline">\(I\)</span>, can be represented as a simple negative exponential function <span class="math inline">\(\exp (I_0 - iS)\)</span>, where <span class="math inline">\(I_0\)</span> is the rate of immigration to an empty island, and <span class="math inline">\(-i\)</span> is the per species negative effect on immigration rate.</p>
<div class="sourceCode" id="cb528"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">I0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">.1</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">I0</span> <span class="op">-</span> <span class="va">b</span><span class="op">*</span><span class="va">x</span><span class="op">)</span>,<span class="fl">0</span>, <span class="fl">50</span>, 
      xlab<span class="op">=</span><span class="st">'No. of Species (R)'</span>, ylab<span class="op">=</span><span class="st">"Rate (I or E)"</span><span class="op">)</span></code></pre></div>
<p><img src="figs/unnamed-chunk-242-1.png" width="90%">
Note that extinction rate, <span class="math inline">\(E\)</span>, must be zero if there are no species present. Imagine that extinction rate is a function of density and that average density declines as the number of species increases, or <span class="math inline">\(\bar{N} = 1/S\)</span>.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Why would this make sense ecologically?&lt;/p&gt;"><sup>79</sup></a></p>
<div class="sourceCode" id="cb529"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d</span> <span class="op">&lt;-</span> <span class="fl">.01</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">d</span><span class="op">*</span><span class="va">x</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">50</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="figs/unnamed-chunk-243-1.png" width="90%"></div>
<div class="sourceCode" id="cb530"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># use add=TRUE to add the line to a previous graph</span></code></pre></div>
<p>We subtract 1 merely to make sure that <span class="math inline">\(E=0\)</span> when <span class="math inline">\(R=0\)</span>.</p>
<p>The number of species, <span class="math inline">\(R\)</span>, will result from <span class="math inline">\(\Delta S = 0= I-E\)</span>, the point at which the lines cross.
<span class="math display">\[\begin{gather}
  I = e^{I_0 - bS}\\
  E = e^{dS}-1 \\
\delta S = 0 = I-E
\end{gather}\]</span>
Here we find this empirically by creating a function of <span class="math inline">\(S\)</span> to
minimize — we will minimize <span class="math inline">\((I-E)^2\)</span>; squaring the difference gives
the quantity the convenient property that the minimum will be approached from either positive or negative values.</p>
<div class="sourceCode" id="cb531"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">deltaS</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">S</span><span class="op">)</span> <span class="op">{</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">I0</span><span class="op">-</span><span class="va">b</span><span class="op">*</span><span class="va">S</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">d</span><span class="op">*</span><span class="va">S</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">}</span></code></pre></div>
<p>We feed this into an optimizer for one-parameter functions, and specify that we know the optimum will be achieved somewhere in the interval between 1 and 50.</p>
<div class="sourceCode" id="cb532"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/optimize.html">optimize</a></span><span class="op">(</span>f<span class="op">=</span><span class="va">deltaS</span>, interval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">50</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="st">"minimum"</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code>## [1] 16.91321</code></pre>
<p>The output tells us that the minimum was achieved when <span class="math inline">\(S \approx 16.9\)</span>.</p>
<p>Now imagine that rising sea level causes island area to shrink. What is this predicted to do? It could</p>
<ol style="list-style-type: decimal">
<li>reduce the base immigration rate because the island is a smaller target,</li>
<li>increase extinction rate because of reduced densities.</li>
</ol>
<p>Let us represent reduced immigration rate by reducing <span class="math inline">\(I_0\)</span>.</p>
<div class="sourceCode" id="cb534"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">I0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">I0</span> <span class="op">-</span> <span class="va">b</span><span class="op">*</span><span class="va">x</span><span class="op">)</span>, <span class="fl">0</span>,<span class="fl">50</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="figs/unnamed-chunk-246-1.png" width="90%"></div>
<div class="sourceCode" id="cb535"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># use add=TRUE to add to a previous plot</span></code></pre></div>
<p>Next we increase extinction rate by increasing the per species rate.</p>
<div class="sourceCode" id="cb536"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d</span> <span class="op">&lt;-</span> <span class="fl">.014</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">d</span><span class="op">*</span><span class="va">x</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">50</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure">
<img src="figs/unnamed-chunk-247-1.png" width="90%">
If we note where the rates cross, we find that the number of predicted species has declined. With these new immigration and extinciton rates the predicted number of species is</div>
<div class="sourceCode" id="cb537"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/optimize.html">optimize</a></span><span class="op">(</span>f<span class="op">=</span><span class="va">deltaS</span>, interval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">50</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="st">"minimum"</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code>## [1] 10.99834</code></pre>
<p>or 11 species, roughly a 35% decline (<span class="math inline">\((17-11)/17 = 0.35\)</span>).</p>
<p>The beauty of this theory is that it focuses our attention on <em>landscape level processes</em>, often outside the spatial and temporal limits of our sampling regimes. It specifies that any factor which helps determine the immigration rate or extinction rate, including island area or proximity to a source of propagules, is predicted to alter the equilibrium number of species at any point in time. We should further emphasize that the <em>identity</em> of species should change over time, that is, undergo turnover, because new species arrive and old species become extinct. The rate of turnover, however, is likely to be slow, because the species that are most likely to immigrate and least likely to become extinct will be the same species from year to year.</p>
</div>
</div>
<div id="diversity-partitioning" class="section level2" number="13.9">
<h2>
<span class="header-section-number">13.9</span> Diversity Partitioning<a class="anchor" aria-label="anchor" href="#diversity-partitioning"><i class="fas fa-link"></i></a>
</h2>
<p>We frequently refer to biodiversity (i.e., richness, Simpson’s, and Shannon-Wiener diversity) at different spatial scales as <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span>, and <span class="math inline">\(\gamma\)</span> diversity.</p>
<ul>
<li>Alpha diversity, <span class="math inline">\(\alpha\)</span>, is the diversity of a point location or of a single sample.</li>
<li>Beta diversity, <span class="math inline">\(\beta\)</span>, is the diversity due to multiple localities. As we saw above, <span class="math inline">\(\beta\)</span> diversity is also used to describe differences in species composition among sites.</li>
<li>Gamma diversity, <span class="math inline">\(\gamma\)</span>, is the diversity of a region, or at least the diversity of all the species in a set of samples collected over a large area (with large extent relatve to a single sample).</li>
</ul>
<p>Diversity across spatial scales can be further be partitioned in one of two ways, either using additive ormultiplicative partitioning.</p>
<p><em>Additive partitioning</em> [<span class="citation"><a href="references.html#ref-Crist:2006lr" role="doc-biblioref">Crist and Veech</a> (<a href="references.html#ref-Crist:2006lr" role="doc-biblioref">2006</a>)</span>; Crist:2003ym; <span class="citation"><a href="references.html#ref-Lande1996" role="doc-biblioref">Russell Lande and May</a> (<a href="references.html#ref-Lande1996" role="doc-biblioref">1996</a>)</span>] is represented as
<span class="math display" id="eq:add">\[\begin{equation}
  \tag{13.9}
  \bar{\alpha} + \beta = \gamma 
\end{equation}\]</span>
where <span class="math inline">\(\bar{\alpha}\)</span> is the average diversity of samples, <span class="math inline">\(\gamma\)</span> is typically the diversity of the pooled samples, and <span class="math inline">\(\beta\)</span> is found by difference (<span class="math inline">\(\beta = \gamma - \bar{\alpha}\)</span>). We can think of <span class="math inline">\(\beta\)</span> as the average number of species <em>not</em> found in a sample, but which we know to be in the region. Additive partitioning allows direct comparison of average richness among samples at any hierarchical level of organization because all three measures of diversity (<span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span>, and <span class="math inline">\(\gamma\)</span>) are expressed in the same units. This makes it analogous to partitioning variance in ANOVA. This is not the case for multiplicative partitioning diversity.</p>
<p><span class="citation"><a href="references.html#ref-Whittaker:1960it" role="doc-biblioref">R. H. Whittaker</a> (<a href="references.html#ref-Whittaker:1960it" role="doc-biblioref">1960</a>)</span> proposed a <em>multiplicative</em> partitioning of diversity,<br><span class="math display" id="eq:mult">\[\begin{equation}
\tag{13.10}
  \bar{\alpha}\beta = \gamma 
\end{equation}\]</span>
where <span class="math inline">\(\beta\)</span> is a conversion factor that describes the relative change in species composition among samples. Sometimes this type of <span class="math inline">\(\beta\)</span> diversity is thought of as the number of different community types in a set of samples. However, one must use this interpretation with great caution, as either meaning of <span class="math inline">\(\beta\)</span> diversity depends completely on the sizes or extent of the samples used for <span class="math inline">\(\alpha\)</span> diversity.</p>
<div class="figure">
<span style="display:block;" id="fig:moths"></span>
<img src="figs/moths-1.png" alt="*Hierarchical sampling of moth species richness in forest patches in Indiana and Ohio, USA. $\alpha$-diversity is the diversity of a single site (richness indicated by numbers). $\gamma$-diversity is the total number of species found in any of the samples (here $\gamma=230$ spp.). Additive $\beta$-diversity is the difference, $\gamma - \bar{\alpha}$, or the average number of species not observed in a single sample. Diversity partitioning can be done at two levels, sites within ecoregions and ecoregions within the geographic region (see example in text for details).*" width="90%"><p class="caption">
Figure 13.14: <em>Hierarchical sampling of moth species richness in forest patches in Indiana and Ohio, USA. <span class="math inline">\(\alpha\)</span>-diversity is the diversity of a single site (richness indicated by numbers). <span class="math inline">\(\gamma\)</span>-diversity is the total number of species found in any of the samples (here <span class="math inline">\(\gamma=230\)</span> spp.). Additive <span class="math inline">\(\beta\)</span>-diversity is the difference, <span class="math inline">\(\gamma - \bar{\alpha}\)</span>, or the average number of species not observed in a single sample. Diversity partitioning can be done at two levels, sites within ecoregions and ecoregions within the geographic region (see example in text for details).</em>
</p>
</div>
<p>Let us examine the limits of <span class="math inline">\(\beta\)</span> diversity in extremely small and extremely large samples. Imagine that our sample units each contain, on average, one individual (and therefore one species) and we have 10<span class="math inline">\(^6\)</span> samples. If richness is our measure of diversity, then <span class="math inline">\(\bar{\alpha}=1\)</span>. Now imagine that in all of our samples we find a total of 100 species, or <span class="math inline">\(\gamma=100\)</span>. Our additive and multiplicative partitions would then be <span class="math inline">\(\beta_{A}=99\)</span>, and <span class="math inline">\(\beta_{M}=100\)</span>, respectively. If the size of the sample unit increases, each sample will include more and more individuals and therefore more of the diversity, and by definition, <span class="math inline">\(\beta\)</span> will decline. If each sample gets large enough, then each sample will capture more and more of the species until a sample gets so large that it includes all of the species (i.e., <span class="math inline">\(\bar{\alpha} \to \gamma\)</span>). At this point, <span class="math inline">\(\beta_A \to 0\)</span> and <span class="math inline">\(\beta_M \to 1\)</span>.</p>
<div class="sourceCode" id="cb539"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">100</span>, by<span class="op">=</span><span class="fl">.1</span><span class="op">)</span>
<span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>
<span class="va">bA</span> <span class="op">&lt;-</span> <span class="va">g</span><span class="op">-</span><span class="va">a</span>
<span class="va">bM</span> <span class="op">&lt;-</span> <span class="va">g</span><span class="op">/</span><span class="va">a</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html">matplot</a></span><span class="op">(</span><span class="va">a</span>, <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">bA</span>, <span class="va">bM</span><span class="op">)</span>, type<span class="op">=</span><span class="st">'l'</span>, xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html">bar</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span>, col<span class="op">=</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:beta"></span>
<img src="figs/beta-1.png" alt="*Relations of $eta_A$ (with additive partitioning) and $\beta_M$ (with multiplicative partitioning) to $\bar{\alpha}$, for a fixed $\gamma=500$ species. In our example, we defined diversityas species richness, so the units of $\beta_A$ and $\alpha$ are number of species per sample, and $\bar{\alpha}$ is the mean number of species in a sample. In contrast, in a multiplicative partition, $\beta$ is the number of communities.*" width="90%"><p class="caption">
Figure 13.15: <em>Relations of <span class="math inline">\(eta_A\)</span> (with additive partitioning) and <span class="math inline">\(\beta_M\)</span> (with multiplicative partitioning) to <span class="math inline">\(\bar{\alpha}\)</span>, for a fixed <span class="math inline">\(\gamma=500\)</span> species. In our example, we defined diversityas species richness, so the units of <span class="math inline">\(\beta_A\)</span> and <span class="math inline">\(\alpha\)</span> are number of species per sample, and <span class="math inline">\(\bar{\alpha}\)</span> is the mean number of species in a sample. In contrast, in a multiplicative partition, <span class="math inline">\(\beta\)</span> is the number of communities.</em>
</p>
</div>
<p>Note that <span class="math inline">\(\beta_A\)</span> and <span class="math inline">\(\beta_M\)</span> do not change at the same rates (Fig. ). When we increase sample size so that each sample includes an average of two species (<span class="math inline">\(\bar{\alpha} = 2\)</span>), then <span class="math inline">\(\beta_A = 98\)</span> and <span class="math inline">\(\beta_M =50\)</span>. If each sample were big enough to have on average 50 species (<span class="math inline">\(\bar{\alpha} = 50\)</span>), then <span class="math inline">\(\beta_A = 50\)</span> and <span class="math inline">\(\beta_M =2\)</span>.</p>
<p>Multiplicative <span class="math inline">\(\beta_M\)</span> is sometimes thought of as the number of independent “communities” in a set of samples. This would make sense if our sampling regime were designed to capture representative parts of different communities. For example, if we sampled an elevational gradient, or a productivity gradient, and our smallest sample was sufficiently large so as to be representative of that point along the gradient<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;One type of sample that attempts to do this is a relev'e.&lt;/p&gt;"><sup>80</sup></a> then <span class="math inline">\(\beta_M\)</span> could provide a measure of the relative turnover in composition or “number of different communities.” However, we know that, all else being equal, composition is also predicted to vary randomly across the landscape. Therefore, if each sample is small, and not really representative of a community, then the small size of the samples will inflate <span class="math inline">\(\beta_M\)</span> and change the interpretation.</p>
<p>As an example, consider the BCI data, which consists of 50 contiguous 1,ha plots. First, we find <span class="math inline">\(\gamma\)</span> (all species in the data set, or the number of columns), and <span class="math inline">\(\bar{\alpha}\)</span> (mean species number per 1,ha plot).</p>
<div class="sourceCode" id="cb540"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">BCI</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 225</code></pre>
<div class="sourceCode" id="cb542"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">alpha.bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/diversity.html">specnumber</a></span><span class="op">(</span><span class="va">BCI</span><span class="op">)</span> <span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 90.78</code></pre>
<p>Next we find additive <span class="math inline">\(\beta\)</span>-diversity and multiplicative <span class="math inline">\(\beta\)</span>-diversity.</p>
<div class="sourceCode" id="cb544"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">beta.A</span> <span class="op">&lt;-</span> <span class="va">gamma</span> <span class="op">-</span> <span class="va">alpha.bar</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 134.22</code></pre>
<div class="sourceCode" id="cb546"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">beta.M</span> <span class="op">&lt;-</span> <span class="va">gamma</span><span class="op">/</span><span class="va">alpha.bar</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 2.478519</code></pre>
<p>Now we interpret them. These plots are located in a relatively uniform tropical rainforest. Therefore, they each are samples drawn from a single community type. However, the samples are small. Therefore, each 1 ha plot (<span class="math inline">\(10^4\)</span> m<span class="math inline">\(^2\)</span> in size) misses more species than it finds, on average (<span class="math inline">\(\beta_A &gt; \bar{\alpha}\)</span>). In addition, <span class="math inline">\(\beta_M=2.48\)</span>, indicating a great deal of turnover in species composition. We could mistakenly interpret this as indicating something like <span class="math inline">\(\sim 2.5\)</span> independent community types in our samples. Here, however, we have a single community type — additive partitioning is a little simpler and transparent in its interpretation.</p>
<p>For other meanings of <span class="math inline">\(\beta\)</span>-diversity, linked to neutral theory, see <span class="citation">(<a href="references.html#ref-Morlon:2008tx" role="doc-biblioref">Morlon et al. 2008</a>)</span>.</p>
<div id="partitioning-speciesarea-relations" class="section level3" number="13.9.1">
<h3>
<span class="header-section-number">13.9.1</span> Partitioning species–area relations<a class="anchor" aria-label="anchor" href="#partitioning-speciesarea-relations"><i class="fas fa-link"></i></a>
</h3>
<p>You may already be wondering if there is a link between island biogeography and <span class="math inline">\(\beta\)</span>-diversity. After all, as we move from island to island, and as we move from small islands to large islands, we typically encounter additional species, and that is what we mean by <span class="math inline">\(\beta\)</span>-diversity. Sure enough, there are connections <span class="citation">(<a href="references.html#ref-Crist:2006lr" role="doc-biblioref">Crist and Veech 2006</a>)</span>, and the older edition of this primer walks you through them.</p>
<p>Let us consider a study of moth diversity (Fig. <a href="diversity.html#fig:moths">13.14</a>) by Keith Summerville and Thomas Crist <span class="citation">(<a href="references.html#ref-Summerville2003" role="doc-biblioref">Summerville and Crist 2003</a>, <a href="references.html#ref-Summerville:2004ym" role="doc-biblioref">2004</a>)</span>. The subset of their data presented here consists of woody plant feeding moths collected in southwest Ohio, USA. Thousands of individuals were trapped in 21 forest patches, distributed in two adjacent ecoregions (12 sites - North Central Tillplain [NCT], and 9 sites - Western Allegheny Plateau [WAP], Fig. <a href="diversity.html#fig:moths">13.14</a>). This data set includes a total of 230 species, with 179 species present in the NCT ecoregion and 173 species present in the WAP ecoregion. From these subtotals, we can already see that each ecoregion had most of the combined total species (<span class="math inline">\(\gamma\)</span>).</p>
<p>We will partition richness at three spatial scales: sites within ecoregions (<span class="math inline">\(\bar{\alpha}_1\)</span>), ecoregions (<span class="math inline">\(\bar{\alpha}_2\)</span>), and overall (<span class="math inline">\(\gamma\)</span>). This will result in two <span class="math inline">\(\beta\)</span>-diversities: <span class="math inline">\(\beta_1\)</span> among sites within each ecoregion, and <span class="math inline">\(\beta_2\)</span> between ecoregions. The relations among these are straightforward.
<span class="math display" id="eq:part2">\[\begin{gather}
  \tag{13.11}
  \bar{\alpha}_2 = \bar{\alpha}_1 + \beta_1\\
  \gamma = \bar{\alpha}_2 +  \beta_2 \\
  \gamma = \bar{\alpha}_1 + \beta_1 + \beta_2
\end{gather}\]</span></p>
<p>To do this in R, we merely implement the above equations using the
data in Fig. <a href="diversity.html#fig:moths">13.14</a>. First, we get
the average site richness, <span class="math inline">\(\bar{\alpha}_1\)</span>. Because we have different
numbers of individuals from different site, and richness depends strongly on the number of individuals in our sample, we may want to weight the sites by the number of individuals. However, I will make the perhaps questionable argument for the moment that because trapping effort was similar at all sites, we will not adjust for numbers of individuals. We will assume that different numbers of individuals reflect different population sizes, and let number of individuals be one of the local determinants of richness.</p>
<div class="sourceCode" id="cb548"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">moths</span><span class="op">[[</span><span class="st">'spp'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p>Next we calculate average richness richness for the ecoregions. Because we had 12 sites in NCT, and only nine sites in WAP for what might be argued are landscape constraints, we will use the weighted average richness, adjusted for the number of sites.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;The arithmetic mean is &lt;span class="math inline"&gt;\(\sum{a_i Y_i}\)&lt;/span&gt;, where all &lt;span class="math inline"&gt;\(a_i = 1/n\)&lt;/span&gt;, and &lt;span class="math inline"&gt;\(n\)&lt;/span&gt; is the total number of observations. A weighted average is the case where the &lt;span class="math inline"&gt;\(a_i\)&lt;/span&gt; represent unequal &lt;em&gt;weights&lt;/em&gt;, often the fraction of &lt;span class="math inline"&gt;\(n\)&lt;/span&gt; on which each &lt;span class="math inline"&gt;\(Y_i\)&lt;/span&gt; is based. In both cases, &lt;span class="math inline"&gt;\(\sum{a}=1\)&lt;/span&gt;.&lt;/p&gt;'><sup>81</sup></a> We also create an object for <span class="math inline">\(\gamma=230\)</span>.</p>
<div class="sourceCode" id="cb549"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>NCT<span class="op">=</span><span class="fl">179</span>, WAP<span class="op">=</span><span class="fl">173</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">12</span>,<span class="fl">9</span><span class="op">)</span><span class="op">/</span><span class="fl">21</span><span class="op">)</span>
<span class="va">g</span> <span class="op">&lt;-</span> <span class="fl">230</span></code></pre></div>
<p>Next, we get the remaining quantities of interest, and show that the partition is consistent.</p>
<div class="sourceCode" id="cb550"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">b1</span> <span class="op">&lt;-</span> <span class="va">a2</span><span class="op">-</span><span class="va">a1</span>
<span class="va">b2</span> <span class="op">&lt;-</span> <span class="va">g</span><span class="op">-</span><span class="va">a2</span>
<span class="va">abg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>a1<span class="op">=</span><span class="va">a1</span>, b1<span class="op">=</span><span class="va">b1</span>, a2<span class="op">=</span><span class="va">a2</span>, b2<span class="op">=</span><span class="va">b2</span>, g<span class="op">=</span><span class="va">g</span><span class="op">)</span>
<span class="va">abg</span></code></pre></div>
<pre><code>##        a1        b1        a2        b2         g 
##  65.42857 111.00000 176.42857  53.57143 230.00000</code></pre>
<div class="sourceCode" id="cb552"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a1</span> <span class="op">+</span> <span class="va">b1</span> <span class="op">+</span> <span class="va">b2</span> <span class="op">==</span> <span class="va">g</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="figure">
<span style="display:block;" id="fig:partplot"></span>
<img src="figs/partplot-1.png" alt="*Hierarchical partitioning of moth species richness in forest patches.*" width="90%"><p class="caption">
Figure 13.16: <em>Hierarchical partitioning of moth species richness in forest patches.</em>
</p>
</div>
<p>The partitioning reveals that <span class="math inline">\(\beta_1\)</span> is the largest fraction of overall <span class="math inline">\(\gamma\)</span>-richness (Fig. <a href="diversity.html#fig:partplot">13.16</a>). This indicates that in spite of the large distance between sampling areas located in different ecoregions, and the different soil types and associated flora, most of the variation occurs <em>among sites within regions</em>. If there had been a greater difference in moth community composition among ecoregions, then <span class="math inline">\(\beta_2\)</span>-richness would have made up a greater proportion of the total.</p>
<p>These calculations show us how simple this additive partition can be, although more complicated analyses are certainly possible. It can be very important to weight appropriately the various measures of diversity (e.g., the number of individuals in each sample, or number of samples per hierarchical level). The number of individuals in particular has a tremendous influence on richness, but has less influence on Simpson’s diversity partitioning. The freely available PARTITION software will perform this additive partitioning (with sample sizes weights) and perform statistical tests <span class="citation">(<a href="references.html#ref-Veech:2007cr" role="doc-biblioref">Veech and Crist 2007</a>)</span>.</p>
<p><strong>Connecting to the species–area curve</strong></p>
<p>The total number of moth species in all of the patches is, as before, <span class="math inline">\(\gamma\)</span>. The average richness of these patches is <span class="math inline">\(\bar{\alpha}\)</span>, and also note that <em>part of what determines that average is the area of the patch</em>. That is, when a species is missing from a patch, part of the reason might be that the patch is smaller than it could be. We will therefore partition <span class="math inline">\(\beta\)</span> into yet one more category: species missing due to patch size, <span class="math inline">\(\beta_{area}\)</span>. This new quantity is the average difference between <span class="math inline">\(\bar{\alpha}\)</span> and the diversity <em>predicted</em> for the largest patch (Fig. <a href="diversity.html#fig:SARpart">13.17</a>). In general then,
<span class="math display" id="eq:partSAR">\[\begin{equation}
  \tag{13.12}
  \beta = \beta_{area} + \beta_{replace}
\end{equation}\]</span>
where <span class="math inline">\(\beta_{replace}\)</span> is the average number of species missing that are not explained by patch size.</p>
<p>In the context of these data (Fig. <a href="diversity.html#fig:SARpart">13.17</a>), we now realize that <span class="math inline">\(\beta_1 = \beta_{area} + \beta_{ecoregion}\)</span>, so the full partition becomes
<span class="math display" id="eq:partfull">\[\begin{equation}
  \tag{13.13}
\gamma = \bar{\alpha}_1 + \beta_{area} + \beta_{ecoregion} + \beta_{geogr.region}
\end{equation}\]</span>
where <span class="math inline">\(\beta_{replace} = \beta_{ecoregion} + \beta_{geogr.region}\)</span>. Note that earlier in the chapter, we did not explore the effect of area. In that case, <span class="math inline">\(\beta_{ecoregion}\)</span> included both the effect of area and the effect of ecoregion; here we have further partitioned this variation into variation due to patch size, as well as variation due to ecoregion. This reduces the amount of unexplained variation among sites within each ecoregion.</p>
<p>Let’s calculate those differences now. We will use quantities we calculated above for <span class="math inline">\(\bar{\alpha}_1\)</span>, <span class="math inline">\(\bar{\alpha}_2\)</span>, <span class="math inline">\(\gamma\)</span>, and a nonlinear species–area model from above. We can start to create a graph similar to Fig. <a href="diversity.html#fig:SARpart">13.17</a>. We’ll start with fitting again a model we used above.</p>
<div class="sourceCode" id="cb554"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod.nonlin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">spp</span> <span class="op">~</span> <span class="va">a</span><span class="op">*</span><span class="va">area</span><span class="op">^</span><span class="va">z</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">1</span>, z<span class="op">=</span><span class="fl">.2</span><span class="op">)</span>,data<span class="op">=</span><span class="va">moths</span><span class="op">)</span></code></pre></div>
<p>Now to plot data and draw a fitted line.</p>
<div class="sourceCode" id="cb555"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">spp</span> <span class="op">~</span> <span class="va">area</span>, data<span class="op">=</span><span class="va">moths</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">230</span><span class="op">)</span>, <span class="co">#log='y',</span>
     xlab<span class="op">=</span><span class="st">"Area (ha)"</span>, ylab<span class="op">=</span><span class="st">"No. of Species (R)"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod.nonlin</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">x</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod.nonlin</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, 
      <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">moths</span><span class="op">[[</span><span class="st">'area'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, add<span class="op">=</span><span class="cn">TRUE</span>, lty<span class="op">=</span><span class="fl">2</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="co">#text(150, 200, </span>
 <span class="co">#    bquote(italic("R") == .(round(coef(mod.nonlin)[1],1)) * </span>
  <span class="co">#                  italic("A")^.(round(coef(mod.nonlin)[2],2)) )</span>
   <span class="co">#  )</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="va">g</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">275</span>, <span class="va">g</span>, <span class="fu"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span><span class="op">(</span><span class="va">gamma</span><span class="op">)</span>, adj<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="fl">1.5</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></code></pre></div>
<p>Next we need to find the <em>predicted richness</em> for the maximum
area. We use our statistical model to find that.</p>
<div class="sourceCode" id="cb556"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">MaxR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod.nonlin</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>area<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">moths</span><span class="op">[[</span><span class="st">'area'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">)</span><span class="op">)</span> <span class="op">)</span></code></pre></div>
<pre><code>## [1] 88.6185</code></pre>
<p>We can now find <span class="math inline">\(\beta_{area}\)</span>, <span class="math inline">\(\beta_{eco}\)</span> and <span class="math inline">\(\beta_{geo}\)</span>.</p>
<div class="sourceCode" id="cb558"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">b.area</span> <span class="op">&lt;-</span> <span class="va">MaxR</span> <span class="op">-</span> <span class="va">a1</span>
<span class="va">b.eco</span> <span class="op">&lt;-</span> <span class="va">a2</span><span class="op">-</span><span class="op">(</span><span class="va">b.area</span><span class="op">+</span><span class="va">a1</span><span class="op">)</span>
<span class="va">b.geo</span> <span class="op">&lt;-</span> <span class="va">g</span> <span class="op">-</span> <span class="va">a2</span></code></pre></div>
<p>Now we have partitioned <span class="math inline">\(\gamma\)</span> a little bit more finely with a beastiary of <span class="math inline">\(\beta\)</span>’s, where</p>
<ul>
<li>
<span class="math inline">\(\bar{\alpha}_1\)</span> is the average site richness.</li>
<li>
<span class="math inline">\(\beta_{area}\)</span> is the average number of species not observed, due to different patch sizes.</li>
<li>
<span class="math inline">\(\beta_{eco}\)</span> is the average number of species not observed at a site, is not missing due to patch size, but is in the ecoregion.</li>
<li>
<span class="math inline">\(\beta_{geo}\)</span> is the average number of species not found in the samples from different ecoregions.</li>
</ul>
<p>Finally, we add lines to our graph to show the partitions.</p>
<div class="sourceCode" id="cb559"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="va">g</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="va">b.eco</span><span class="op">+</span><span class="va">b.area</span><span class="op">+</span><span class="va">a1</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="va">b.area</span><span class="op">+</span><span class="va">a1</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="va">a1</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<p>Now we have further quantified how forest fragment area explains moth species richness. Such understanding of the spatial distribution of biodiversity provides a way to better quantify patterns governed by both dispersal and habitat preference, and allows us to better describe and manage biodiversity in human-dominated landscapes.</p>
<div class="figure">
<span style="display:block;" id="fig:SARpart"></span>
<img src="figs/SARpart-1.png" alt="*Combining species--area relations with additive diversity partitioning. Forest fragment area explains relatively little of the diversity which accumulates in isolated patches distributed in space. However, it is likely that area associated with the collection of samples (i.e., the distances among fragments) contributes to beta[eco] and beta[geo].*" width="90%"><p class="caption">
Figure 13.17: <em>Combining species–area relations with additive diversity partitioning. Forest fragment area explains relatively little of the diversity which accumulates in isolated patches distributed in space. However, it is likely that area associated with the collection of samples (i.e., the distances among fragments) contributes to beta[eco] and beta[geo].</em>
</p>
</div>
</div>
</div>
<div id="summary-1" class="section level2" number="13.10">
<h2>
<span class="header-section-number">13.10</span> Summary<a class="anchor" aria-label="anchor" href="#summary-1"><i class="fas fa-link"></i></a>
</h2>
<p>We have examined communities as multivariate entities which we can describe and compare in a variety of ways.</p>
<ul>
<li>Composition includes all species (multivariate data), whereas species diversity is a univariate description of the variety of species present.</li>
<li>There are many ways to quantify species diversity, and they tend to be correlated. The simplest of these is richness (the number of species present), whereas other statistics take species’ relative abundances into account.</li>
<li>Species abundance distributions and rank abundance distributions are analogous to probability distributions, and provide more thorough ways to describe the patterns of abundance and variety in communities. These all illustrate a basic law of community ecology: most species are rare. Null models of community structure and processes make predictions about the shape of these distributions.</li>
<li>Ecological neutral theory provides a dynamical model, not unlike a null model, which allows quantitative predictions relating demographic, immigration, and speciation rates, species abundance distributions, and patterns of variation in space and time.</li>
<li>Another law of community ecology is that the number of species increases with sample area and appears to be influenced by immigration and extinction rates.</li>
<li>We can partition diversity at different spatial scales to understand the structure of communities in landscapes.</li>
</ul>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="food-webs-and-other-networks.html"><span class="header-section-number">12</span> Food webs and other networks</a></div>
<div class="next"><a href="appendix.html"><span class="header-section-number">14</span> Appendix</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#diversity"><span class="header-section-number">13</span> Diversity</a></li>
<li><a class="nav-link" href="#background-1"><span class="header-section-number">13.1</span> Background</a></li>
<li>
<a class="nav-link" href="#species-composition"><span class="header-section-number">13.2</span> Species Composition</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#measures-of-abundance"><span class="header-section-number">13.2.1</span> Measures of abundance</a></li>
<li><a class="nav-link" href="#dissimilarities-and-distances"><span class="header-section-number">13.2.2</span> Dissimilarities and Distances</a></li>
<li><a class="nav-link" href="#displaying-multidimensional-distances"><span class="header-section-number">13.2.3</span> Displaying multidimensional distances</a></li>
</ul>
</li>
<li><a class="nav-link" href="#diversity-1"><span class="header-section-number">13.3</span> Diversity</a></li>
<li><a class="nav-link" href="#species-diversity"><span class="header-section-number">13.4</span> Species diversity</a></li>
<li>
<a class="nav-link" href="#rarefaction-and-total-species-richness"><span class="header-section-number">13.5</span> Rarefaction and total species richness</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#an-example-of-rarefaction-and-total-species-richness"><span class="header-section-number">13.5.1</span> An example of rarefaction and total species richness</a></li></ul>
</li>
<li>
<a class="nav-link" href="#distributions"><span class="header-section-number">13.6</span> Distributions</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#log-normal-distribution"><span class="header-section-number">13.6.1</span> Log-normal distribution</a></li>
<li><a class="nav-link" href="#other-distributions"><span class="header-section-number">13.6.2</span> Other distributions</a></li>
<li><a class="nav-link" href="#pattern-vs.-process"><span class="header-section-number">13.6.3</span> Pattern vs. process</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#neutral-theory-of-biodiversity-and-biogeography"><span class="header-section-number">13.7</span> Neutral Theory of Biodiversity and Biogeography</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#different-flavors-of-neutral-communities"><span class="header-section-number">13.7.1</span> Different flavors of neutral communities</a></li>
<li><a class="nav-link" href="#investigating-neutral-communities"><span class="header-section-number">13.7.2</span> Investigating neutral communities</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#speciesarea-relations"><span class="header-section-number">13.8</span> Species–area relations</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#island-biogeography"><span class="header-section-number">13.8.1</span> Island biogeography</a></li></ul>
</li>
<li>
<a class="nav-link" href="#diversity-partitioning"><span class="header-section-number">13.9</span> Diversity Partitioning</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#partitioning-speciesarea-relations"><span class="header-section-number">13.9.1</span> Partitioning species–area relations</a></li></ul>
</li>
<li><a class="nav-link" href="#summary-1"><span class="header-section-number">13.10</span> Summary</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Primer of Ecology using R</strong>" was written by Hank Stevens. It was last built on 2021-08-28.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
