<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>11 Consumer-resource Competition and Mutualisms | Primer of Ecology using R</title>
  <meta name="description" content="11 Consumer-resource Competition and Mutualisms | Primer of Ecology using R" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="11 Consumer-resource Competition and Mutualisms | Primer of Ecology using R" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="HankStevens/Primer-of-Ecology" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="11 Consumer-resource Competition and Mutualisms | Primer of Ecology using R" />
  
  
  

<meta name="author" content="Hank Stevens" />


<meta name="date" content="2021-08-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="disease.html"/>
<link rel="next" href="food-webs-and-other-networks.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-VCV8MES4YY"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-VCV8MES4YY');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="theory.html"><a href="theory.html"><i class="fa fa-check"></i><b>1</b> Theory in Ecology</a>
<ul>
<li class="chapter" data-level="1.1" data-path="theory.html"><a href="theory.html#examples-of-theories"><i class="fa fa-check"></i><b>1.1</b> Examples of theories</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="theory.html"><a href="theory.html#hierarchy-theory"><i class="fa fa-check"></i><b>1.1.1</b> Hierarchy theory</a></li>
<li class="chapter" data-level="1.1.2" data-path="theory.html"><a href="theory.html#a-general-theory-of-ecology"><i class="fa fa-check"></i><b>1.1.2</b> A general theory of ecology</a></li>
<li class="chapter" data-level="1.1.3" data-path="theory.html"><a href="theory.html#efficient-theory"><i class="fa fa-check"></i><b>1.1.3</b> Efficient theory</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="theory.html"><a href="theory.html#metabolic_scaling"><i class="fa fa-check"></i><b>1.2</b> An example: Metabolic Theory of Ecology</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="theory.html"><a href="theory.html#body-size-dependence"><i class="fa fa-check"></i><b>1.2.1</b> Body-size dependence</a></li>
<li class="chapter" data-level="1.2.2" data-path="theory.html"><a href="theory.html#temperature-dependence"><i class="fa fa-check"></i><b>1.2.2</b> Temperature dependence</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="theory.html"><a href="theory.html#power-law-scaling-implies-constant-relative-differences"><i class="fa fa-check"></i><b>1.3</b> Power law scaling implies constant relative differences</a></li>
<li class="chapter" data-level="1.4" data-path="theory.html"><a href="theory.html#meet-mete-maximum-entropy-theory-of-ecology"><i class="fa fa-check"></i><b>1.4</b> Meet METE: Maximum Entropy Theory of Ecology</a></li>
<li class="chapter" data-level="1.5" data-path="theory.html"><a href="theory.html#in-fine"><i class="fa fa-check"></i><b>1.5</b> <em>In fine</em></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="oft.html"><a href="oft.html"><i class="fa fa-check"></i><b>2</b> Optimal Foraging</a>
<ul>
<li class="chapter" data-level="2.1" data-path="oft.html"><a href="oft.html#a-prey-model"><i class="fa fa-check"></i><b>2.1</b> A prey model</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="oft.html"><a href="oft.html#our-intuition"><i class="fa fa-check"></i><b>2.1.1</b> Our intuition</a></li>
<li class="chapter" data-level="2.1.2" data-path="oft.html"><a href="oft.html#mathematical-support"><i class="fa fa-check"></i><b>2.1.2</b> Mathematical support</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="oft.html"><a href="oft.html#the-patch-model"><i class="fa fa-check"></i><b>2.2</b> The patch model</a></li>
<li class="chapter" data-level="2.3" data-path="oft.html"><a href="oft.html#a-simulation-of-a-prey-model"><i class="fa fa-check"></i><b>2.3</b> A simulation of a prey model</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="oft.html"><a href="oft.html#lab-exercise"><i class="fa fa-check"></i><b>2.3.1</b> Lab exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="expo.html"><a href="expo.html"><i class="fa fa-check"></i><b>3</b> Simple density-independent growth</a>
<ul>
<li class="chapter" data-level="3.1" data-path="expo.html"><a href="expo.html#discrete-growth-rates-of-fruit-flies-in-my-kitchen"><i class="fa fa-check"></i><b>3.1</b> Discrete growth rates of fruit flies in my kitchen</a></li>
<li class="chapter" data-level="3.2" data-path="expo.html"><a href="expo.html#fruit-flies-with-continuous-overlapping-generations"><i class="fa fa-check"></i><b>3.2</b> Fruit flies with continuous overlapping generations</a></li>
<li class="chapter" data-level="3.3" data-path="expo.html"><a href="expo.html#properties-of-geometric-and-exponential-growth"><i class="fa fa-check"></i><b>3.3</b> Properties of geometric and exponential growth</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="expo.html"><a href="expo.html#average-growth-rate"><i class="fa fa-check"></i><b>3.3.1</b> Average growth rate</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="expo.html"><a href="expo.html#modeling-with-data-simulated-dynamics"><i class="fa fa-check"></i><b>3.4</b> Modeling with Data: Simulated Dynamics</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="expo.html"><a href="expo.html#data-based-approaches"><i class="fa fa-check"></i><b>3.4.1</b> Data-based approaches</a></li>
<li class="chapter" data-level="3.4.2" data-path="expo.html"><a href="expo.html#creating-and-visualizing-the-data"><i class="fa fa-check"></i><b>3.4.2</b> Creating and visualizing the data</a></li>
<li class="chapter" data-level="3.4.3" data-path="expo.html"><a href="expo.html#one-simulation"><i class="fa fa-check"></i><b>3.4.3</b> One simulation</a></li>
<li class="chapter" data-level="3.4.4" data-path="expo.html"><a href="expo.html#multiple-simulations"><i class="fa fa-check"></i><b>3.4.4</b> Multiple simulations</a></li>
<li class="chapter" data-level="3.4.5" data-path="expo.html"><a href="expo.html#a-distribution-of-possible-futures"><i class="fa fa-check"></i><b>3.4.5</b> A distribution of possible futures</a></li>
<li class="chapter" data-level="3.4.6" data-path="expo.html"><a href="expo.html#analyzing-results"><i class="fa fa-check"></i><b>3.4.6</b> Analyzing results</a></li>
<li class="chapter" data-level="3.4.7" data-path="expo.html"><a href="expo.html#inferring-processes-underlying-growth-rate"><i class="fa fa-check"></i><b>3.4.7</b> Inferring processes underlying growth rate</a></li>
<li class="chapter" data-level="3.4.8" data-path="expo.html"><a href="expo.html#f-environmental-noise"><i class="fa fa-check"></i><b>3.4.8</b> 1/<span class="math inline">\(f\)</span> environmental noise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="DID.html"><a href="DID.html"><i class="fa fa-check"></i><b>4</b> Density-independent Demography</a>
<ul>
<li class="chapter" data-level="4.1" data-path="DID.html"><a href="DID.html#a-two-stage-matrix-model"><i class="fa fa-check"></i><b>4.1</b> A two stage matrix model</a></li>
<li class="chapter" data-level="4.2" data-path="DID.html"><a href="DID.html#a-brief-primer-on-matrices"><i class="fa fa-check"></i><b>4.2</b> A brief primer on matrices</a></li>
<li class="chapter" data-level="4.3" data-path="DID.html"><a href="DID.html#decomposing-a"><i class="fa fa-check"></i><b>4.3</b> Decomposing <strong>A</strong></a></li>
<li class="chapter" data-level="4.4" data-path="DID.html"><a href="DID.html#a-three-stage-model"><i class="fa fa-check"></i><b>4.4</b> A three stage model</a></li>
<li class="chapter" data-level="4.5" data-path="DID.html"><a href="DID.html#projection"><i class="fa fa-check"></i><b>4.5</b> Projection</a></li>
<li class="chapter" data-level="4.6" data-path="DID.html"><a href="DID.html#analyzing-the-transition-matrix"><i class="fa fa-check"></i><b>4.6</b> Analyzing the transition matrix</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="DID.html"><a href="DID.html#eigenanalysis"><i class="fa fa-check"></i><b>4.6.1</b> Eigenanalysis</a></li>
<li class="chapter" data-level="4.6.2" data-path="DID.html"><a href="DID.html#finite-rate-of-increase"><i class="fa fa-check"></i><b>4.6.2</b> Finite rate of increase</a></li>
<li class="chapter" data-level="4.6.3" data-path="DID.html"><a href="DID.html#stable-stage-distribution"><i class="fa fa-check"></i><b>4.6.3</b> Stable stage distribution</a></li>
<li class="chapter" data-level="4.6.4" data-path="DID.html"><a href="DID.html#calculating-the-stable-stage-distribution"><i class="fa fa-check"></i><b>4.6.4</b> Calculating the stable stage distribution</a></li>
<li class="chapter" data-level="4.6.5" data-path="DID.html"><a href="DID.html#reproductive-value"><i class="fa fa-check"></i><b>4.6.5</b> Reproductive value</a></li>
<li class="chapter" data-level="4.6.6" data-path="DID.html"><a href="DID.html#sensitivity-and-elasticity"><i class="fa fa-check"></i><b>4.6.6</b> Sensitivity and elasticity</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="DID.html"><a href="DID.html#integral-projection"><i class="fa fa-check"></i><b>4.7</b> Integral projection</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="DID.html"><a href="DID.html#a-size-based-ipm-of-smooth-coneflower"><i class="fa fa-check"></i><b>4.7.1</b> A size-based IPM of smooth coneflower</a></li>
<li class="chapter" data-level="4.7.2" data-path="DID.html"><a href="DID.html#population-summaries"><i class="fa fa-check"></i><b>4.7.2</b> Population summaries</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="DID.html"><a href="DID.html#r-packges-for-demography"><i class="fa fa-check"></i><b>4.8</b> R packges for demography</a></li>
<li class="chapter" data-level="4.9" data-path="DID.html"><a href="DID.html#exploring-a-real-population"><i class="fa fa-check"></i><b>4.9</b> Exploring a real population</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="DDgrowth.html"><a href="DDgrowth.html"><i class="fa fa-check"></i><b>5</b> Density-dependent growth</a>
<ul>
<li class="chapter" data-level="5.1" data-path="DDgrowth.html"><a href="DDgrowth.html#continuous-logistic-growth"><i class="fa fa-check"></i><b>5.1</b> Continuous logistic growth</a></li>
<li class="chapter" data-level="5.2" data-path="DDgrowth.html"><a href="DDgrowth.html#dynamics-around-the-equilibria-stability"><i class="fa fa-check"></i><b>5.2</b> Dynamics around the equilibria — stability</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="DDgrowth.html"><a href="DDgrowth.html#analytical-linear-stability-analysis"><i class="fa fa-check"></i><b>5.2.1</b> Analytical linear stability analysis</a></li>
<li class="chapter" data-level="5.2.2" data-path="DDgrowth.html"><a href="DDgrowth.html#projection-with-numerical-integration"><i class="fa fa-check"></i><b>5.2.2</b> Projection with numerical integration</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="DDgrowth.html"><a href="DDgrowth.html#other-forms-of-density-dependent-growth"><i class="fa fa-check"></i><b>5.3</b> Other forms of density-dependent growth</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="DDgrowth.html"><a href="DDgrowth.html#effects-of-n-on-birth-and-death-rates"><i class="fa fa-check"></i><b>5.3.1</b> Effects of N on birth and death rates</a></li>
<li class="chapter" data-level="5.3.2" data-path="DDgrowth.html"><a href="DDgrowth.html#theta-logistic-growth"><i class="fa fa-check"></i><b>5.3.2</b> Theta-logistic growth</a></li>
<li class="chapter" data-level="5.3.3" data-path="DDgrowth.html"><a href="DDgrowth.html#allee-effect"><i class="fa fa-check"></i><b>5.3.3</b> Allee effect</a></li>
<li class="chapter" data-level="5.3.4" data-path="DDgrowth.html"><a href="DDgrowth.html#the-integral-of-logistic-growth"><i class="fa fa-check"></i><b>5.3.4</b> The integral of logistic growth</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="DDgrowth.html"><a href="DDgrowth.html#discrete-density-dependent-growth"><i class="fa fa-check"></i><b>5.4</b> Discrete Density-dependent Growth</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="DDgrowth.html"><a href="DDgrowth.html#effects-of-r_d"><i class="fa fa-check"></i><b>5.4.1</b> Effects of <span class="math inline">\(r_d\)</span></a></li>
<li class="chapter" data-level="5.4.2" data-path="DDgrowth.html"><a href="DDgrowth.html#bifurcations"><i class="fa fa-check"></i><b>5.4.2</b> Bifurcations</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="DDgrowth.html"><a href="DDgrowth.html#maximum-sustained-yield"><i class="fa fa-check"></i><b>5.5</b> Maximum Sustained Yield</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="meta.html"><a href="meta.html"><i class="fa fa-check"></i><b>6</b> Populations in Space</a>
<ul>
<li class="chapter" data-level="6.1" data-path="meta.html"><a href="meta.html#source-sink-dynamics"><i class="fa fa-check"></i><b>6.1</b> Source-sink Dynamics</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="meta.html"><a href="meta.html#complications-and-cases"><i class="fa fa-check"></i><b>6.1.1</b> Complications and cases</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="meta.html"><a href="meta.html#metapopulations"><i class="fa fa-check"></i><b>6.2</b> Metapopulations</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="meta.html"><a href="meta.html#the-classic-levins-model"><i class="fa fa-check"></i><b>6.2.1</b> The classic Levins model</a></li>
<li class="chapter" data-level="6.2.2" data-path="meta.html"><a href="meta.html#propagule-rain"><i class="fa fa-check"></i><b>6.2.2</b> Propagule rain</a></li>
<li class="chapter" data-level="6.2.3" data-path="meta.html"><a href="meta.html#the-rescue-effect-and-the-core-satellite-model"><i class="fa fa-check"></i><b>6.2.3</b> The rescue effect and the core-satellite model</a></li>
<li class="chapter" data-level="6.2.4" data-path="meta.html"><a href="meta.html#parallels-with-logistic-growth"><i class="fa fa-check"></i><b>6.2.4</b> Parallels with Logistic Growth</a></li>
<li class="chapter" data-level="6.2.5" data-path="meta.html"><a href="meta.html#levins-vs.-hanski"><i class="fa fa-check"></i><b>6.2.5</b> Levins <span class="math inline">\(vs\)</span>. Hanski</a></li>
<li class="chapter" data-level="6.2.6" data-path="meta.html"><a href="meta.html#habitat-destruction"><i class="fa fa-check"></i><b>6.2.6</b> Habitat Destruction</a></li>
<li class="chapter" data-level="6.2.7" data-path="meta.html"><a href="meta.html#illustrating-the-effects-of-habitat-destruction"><i class="fa fa-check"></i><b>6.2.7</b> Illustrating the effects of habitat destruction</a></li>
<li class="chapter" data-level="6.2.8" data-path="meta.html"><a href="meta.html#different-assumptions-lead-to-different-predictions-about-rates-of-extinction"><i class="fa fa-check"></i><b>6.2.8</b> Different assumptions lead to different predictions about rates of extinction</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="meta.html"><a href="meta.html#hanskis-incidence-function"><i class="fa fa-check"></i><b>6.3</b> Hanski’s incidence function</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="direct-competition-and-mutualism.html"><a href="direct-competition-and-mutualism.html"><i class="fa fa-check"></i><b>7</b> Direct competition and mutualism</a>
<ul>
<li class="chapter" data-level="7.1" data-path="direct-competition-and-mutualism.html"><a href="direct-competition-and-mutualism.html#interspecific-competition"><i class="fa fa-check"></i><b>7.1</b> Interspecific competition</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="direct-competition-and-mutualism.html"><a href="direct-competition-and-mutualism.html#equilbria"><i class="fa fa-check"></i><b>7.1.1</b> Equilbria</a></li>
<li class="chapter" data-level="7.1.2" data-path="direct-competition-and-mutualism.html"><a href="direct-competition-and-mutualism.html#dynamics-at-the-equilibria"><i class="fa fa-check"></i><b>7.1.2</b> Dynamics at the Equilibria</a></li>
<li class="chapter" data-level="7.1.3" data-path="direct-competition-and-mutualism.html"><a href="direct-competition-and-mutualism.html#return-time-and-the-effect-of-r"><i class="fa fa-check"></i><b>7.1.3</b> Return Time and the Effect of <span class="math inline">\(r\)</span></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="direct-competition-and-mutualism.html"><a href="direct-competition-and-mutualism.html#interspecific-mutualism"><i class="fa fa-check"></i><b>7.2</b> Interspecific mutualism</a></li>
<li class="chapter" data-level="7.3" data-path="direct-competition-and-mutualism.html"><a href="direct-competition-and-mutualism.html#generalized-lotka-volterra-models"><i class="fa fa-check"></i><b>7.3</b> Generalized Lotka-Volterra models</a></li>
<li class="chapter" data-level="7.4" data-path="direct-competition-and-mutualism.html"><a href="direct-competition-and-mutualism.html#summary"><i class="fa fa-check"></i><b>7.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="cr.html"><a href="cr.html"><i class="fa fa-check"></i><b>8</b> Consumer-resource Interactions</a>
<ul>
<li class="chapter" data-level="8.1" data-path="cr.html"><a href="cr.html#ratio-dependence"><i class="fa fa-check"></i><b>8.1</b> Ratio dependence</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="cr.html"><a href="cr.html#dynamics-of-ratio-dependent-predation"><i class="fa fa-check"></i><b>8.1.1</b> Dynamics of ratio dependent predation</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="cr.html"><a href="cr.html#prey-dependence"><i class="fa fa-check"></i><b>8.2</b> Prey dependence</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="cr.html"><a href="cr.html#dyanmics-of-prey-dependent-predation"><i class="fa fa-check"></i><b>8.2.1</b> Dyanmics of prey-dependent predation</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="cr.html"><a href="cr.html#interlude-functional-response---what-an-individual-predator-does-fr"><i class="fa fa-check"></i><b>8.3</b> Interlude: Functional response - what an individual predator does (#fr)</a></li>
<li class="chapter" data-level="8.4" data-path="cr.html"><a href="cr.html#stability-analysis-for-the-prey-dependent-lotkavolterra-model"><i class="fa fa-check"></i><b>8.4</b> Stability analysis for the prey-dependent Lotka–Volterra model</a></li>
<li class="chapter" data-level="8.5" data-path="cr.html"><a href="cr.html#resource-growth-functions"><i class="fa fa-check"></i><b>8.5</b> Resource growth functions</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="cr.html"><a href="cr.html#consumption-of-a-renewable-resource"><i class="fa fa-check"></i><b>8.5.1</b> Consumption of a renewable resource</a></li>
<li class="chapter" data-level="8.5.2" data-path="cr.html"><a href="cr.html#prey-carrying-capacity-and-type-ii-functional-response"><i class="fa fa-check"></i><b>8.5.2</b> Prey carrying capacity and type II functional response</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="cr.html"><a href="cr.html#paradox-of-enrichment"><i class="fa fa-check"></i><b>8.6</b> Paradox of enrichment</a></li>
<li class="chapter" data-level="8.7" data-path="cr.html"><a href="cr.html#consumption-of-two-resources"><i class="fa fa-check"></i><b>8.7</b> Consumption of two resources</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="cr.html"><a href="cr.html#interpreting-consumption-and-assimilation"><i class="fa fa-check"></i><b>8.7.1</b> Interpreting consumption and assimilation</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="cr.html"><a href="cr.html#in-fine-1"><i class="fa fa-check"></i><b>8.8</b> In fine</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="host-parasitoid-relations.html"><a href="host-parasitoid-relations.html"><i class="fa fa-check"></i><b>9</b> Host-parasitoid relations</a>
<ul>
<li class="chapter" data-level="9.1" data-path="host-parasitoid-relations.html"><a href="host-parasitoid-relations.html#independent-and-random-attacks"><i class="fa fa-check"></i><b>9.1</b> Independent and random attacks</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="host-parasitoid-relations.html"><a href="host-parasitoid-relations.html#simulating-simple-host-parasitoid-dynamics"><i class="fa fa-check"></i><b>9.1.1</b> Simulating simple host-parasitoid dynamics</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="host-parasitoid-relations.html"><a href="host-parasitoid-relations.html#aggregation-leads-to-coexistence"><i class="fa fa-check"></i><b>9.2</b> Aggregation leads to coexistence</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="host-parasitoid-relations.html"><a href="host-parasitoid-relations.html#equilibria-for-a-discrete-time-model"><i class="fa fa-check"></i><b>9.2.1</b> Equilibria for a discrete-time model</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="host-parasitoid-relations.html"><a href="host-parasitoid-relations.html#stability-of-hostparasitoid-dynamics"><i class="fa fa-check"></i><b>9.3</b> Stability of host–parasitoid dynamics</a></li>
<li class="chapter" data-level="9.4" data-path="host-parasitoid-relations.html"><a href="host-parasitoid-relations.html#in-fine-2"><i class="fa fa-check"></i><b>9.4</b> <em>In Fine</em></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="disease.html"><a href="disease.html"><i class="fa fa-check"></i><b>10</b> Disease</a>
<ul>
<li class="chapter" data-level="10.1" data-path="disease.html"><a href="disease.html#closed-epidemics"><i class="fa fa-check"></i><b>10.1</b> Closed epidemics</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="disease.html"><a href="disease.html#density-dependent-transmission"><i class="fa fa-check"></i><b>10.1.1</b> Density-dependent transmission</a></li>
<li class="chapter" data-level="10.1.2" data-path="disease.html"><a href="disease.html#frequency-dependent-transmission"><i class="fa fa-check"></i><b>10.1.2</b> Frequency-dependent transmission</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="disease.html"><a href="disease.html#open-epidemics"><i class="fa fa-check"></i><b>10.2</b> Open epidemics</a></li>
<li class="chapter" data-level="10.3" data-path="disease.html"><a href="disease.html#modeling-data-from-bombay"><i class="fa fa-check"></i><b>10.3</b> Modeling data from Bombay</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="disease.html"><a href="disease.html#optimization"><i class="fa fa-check"></i><b>10.3.1</b> Optimization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="consumer-resource-competition-and-mutualisms.html"><a href="consumer-resource-competition-and-mutualisms.html"><i class="fa fa-check"></i><b>11</b> Consumer-resource Competition and Mutualisms</a>
<ul>
<li class="chapter" data-level="11.1" data-path="consumer-resource-competition-and-mutualisms.html"><a href="consumer-resource-competition-and-mutualisms.html#competition-for-one-resource"><i class="fa fa-check"></i><b>11.1</b> Competition for one resource</a></li>
<li class="chapter" data-level="11.2" data-path="consumer-resource-competition-and-mutualisms.html"><a href="consumer-resource-competition-and-mutualisms.html#competition-for-substitutable-resources"><i class="fa fa-check"></i><b>11.2</b> Competition for Substitutable resources</a></li>
<li class="chapter" data-level="11.3" data-path="consumer-resource-competition-and-mutualisms.html"><a href="consumer-resource-competition-and-mutualisms.html#tilmans-resource-ratio-with-essential-resources"><i class="fa fa-check"></i><b>11.3</b> Tilman’s resource ratio with essential resources</a></li>
<li class="chapter" data-level="11.4" data-path="consumer-resource-competition-and-mutualisms.html"><a href="consumer-resource-competition-and-mutualisms.html#consumer-resource-mutualism"><i class="fa fa-check"></i><b>11.4</b> Consumer-resource mutualism</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="consumer-resource-competition-and-mutualisms.html"><a href="consumer-resource-competition-and-mutualisms.html#a-model-of-uni-directional-mutualism"><i class="fa fa-check"></i><b>11.4.1</b> A model of uni-directional mutualism</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="consumer-resource-competition-and-mutualisms.html"><a href="consumer-resource-competition-and-mutualisms.html#plant-soil-feedbacks"><i class="fa fa-check"></i><b>11.5</b> Plant-soil feedbacks</a></li>
<li class="chapter" data-level="11.6" data-path="consumer-resource-competition-and-mutualisms.html"><a href="consumer-resource-competition-and-mutualisms.html#simulations-for-learning"><i class="fa fa-check"></i><b>11.6</b> Simulations for learning</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="consumer-resource-competition-and-mutualisms.html"><a href="consumer-resource-competition-and-mutualisms.html#lvg"><i class="fa fa-check"></i><b>11.6.1</b> <code>lvg()</code></a></li>
<li class="chapter" data-level="11.6.2" data-path="consumer-resource-competition-and-mutualisms.html"><a href="consumer-resource-competition-and-mutualisms.html#systematic-simulations"><i class="fa fa-check"></i><b>11.6.2</b> Systematic simulations</a></li>
<li class="chapter" data-level="11.6.3" data-path="consumer-resource-competition-and-mutualisms.html"><a href="consumer-resource-competition-and-mutualisms.html#checking-simulation-results"><i class="fa fa-check"></i><b>11.6.3</b> Checking simulation results</a></li>
<li class="chapter" data-level="11.6.4" data-path="consumer-resource-competition-and-mutualisms.html"><a href="consumer-resource-competition-and-mutualisms.html#comparing-simulation-results-to-analytical-solutions"><i class="fa fa-check"></i><b>11.6.4</b> Comparing simulation results to analytical solutions</a></li>
<li class="chapter" data-level="11.6.5" data-path="consumer-resource-competition-and-mutualisms.html"><a href="consumer-resource-competition-and-mutualisms.html#one-last-thing-using-the-jacobian-matrix"><i class="fa fa-check"></i><b>11.6.5</b> One last thing: using the Jacobian matrix</a></li>
<li class="chapter" data-level="11.6.6" data-path="consumer-resource-competition-and-mutualisms.html"><a href="consumer-resource-competition-and-mutualisms.html#in-fine-3"><i class="fa fa-check"></i><b>11.6.6</b> <em>In Fine</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html"><i class="fa fa-check"></i><b>12</b> Food webs and other networks</a>
<ul>
<li class="chapter" data-level="12.1" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#food-web-characteristics"><i class="fa fa-check"></i><b>12.1</b> Food Web Characteristics</a></li>
<li class="chapter" data-level="12.2" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#does-omnivory-destablize-food-chains"><i class="fa fa-check"></i><b>12.2</b> Does omnivory destablize food chains?</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#multi-species-lotkavolterra-notation"><i class="fa fa-check"></i><b>12.2.1</b> Multi-species Lotka–Volterra notation</a></li>
<li class="chapter" data-level="12.2.2" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#background"><i class="fa fa-check"></i><b>12.2.2</b> Background</a></li>
<li class="chapter" data-level="12.2.3" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#implementing-pimm-and-lawtons-methods"><i class="fa fa-check"></i><b>12.2.3</b> Implementing Pimm and Lawton’s Methods</a></li>
<li class="chapter" data-level="12.2.4" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#shortening-the-chain"><i class="fa fa-check"></i><b>12.2.4</b> Shortening the Chain</a></li>
<li class="chapter" data-level="12.2.5" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#adding-omnivory"><i class="fa fa-check"></i><b>12.2.5</b> Adding Omnivory</a></li>
<li class="chapter" data-level="12.2.6" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#comparing-chain-a-versus-b"><i class="fa fa-check"></i><b>12.2.6</b> Comparing Chain A versus B</a></li>
<li class="chapter" data-level="12.2.7" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#re-evaluating-take-home-messages"><i class="fa fa-check"></i><b>12.2.7</b> Re-evaluating Take-Home Messages</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#perhaps-mutualism-stabilizes-bipartite-networks"><i class="fa fa-check"></i><b>12.3</b> Perhaps mutualism stabilizes bipartite networks</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#creating-bipartite-webs"><i class="fa fa-check"></i><b>12.3.1</b> Creating bipartite webs</a></li>
<li class="chapter" data-level="12.3.2" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#testing-effects-of-nestedness-and-modularity-on-network-resilience."><i class="fa fa-check"></i><b>12.3.2</b> Testing effects of nestedness and modularity on network resilience.</a></li>
<li class="chapter" data-level="12.3.3" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#path-analysis"><i class="fa fa-check"></i><b>12.3.3</b> Path Analysis</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#exploring-pandora-right-here-at-home"><i class="fa fa-check"></i><b>12.4</b> Exploring Pandora, right here at home</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#properties-assessed"><i class="fa fa-check"></i><b>12.4.1</b> Properties assessed</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="diversity.html"><a href="diversity.html"><i class="fa fa-check"></i><b>13</b> Diversity</a>
<ul>
<li class="chapter" data-level="13.1" data-path="diversity.html"><a href="diversity.html#background-1"><i class="fa fa-check"></i><b>13.1</b> Background</a></li>
<li class="chapter" data-level="13.2" data-path="diversity.html"><a href="diversity.html#species-composition"><i class="fa fa-check"></i><b>13.2</b> Species Composition</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="diversity.html"><a href="diversity.html#measures-of-abundance"><i class="fa fa-check"></i><b>13.2.1</b> Measures of abundance</a></li>
<li class="chapter" data-level="13.2.2" data-path="diversity.html"><a href="diversity.html#dissimilarities-and-distances"><i class="fa fa-check"></i><b>13.2.2</b> Dissimilarities and Distances</a></li>
<li class="chapter" data-level="13.2.3" data-path="diversity.html"><a href="diversity.html#displaying-multidimensional-distances"><i class="fa fa-check"></i><b>13.2.3</b> Displaying multidimensional distances</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="diversity.html"><a href="diversity.html#diversity-1"><i class="fa fa-check"></i><b>13.3</b> Diversity</a></li>
<li class="chapter" data-level="13.4" data-path="diversity.html"><a href="diversity.html#species-diversity"><i class="fa fa-check"></i><b>13.4</b> Species diversity</a></li>
<li class="chapter" data-level="13.5" data-path="diversity.html"><a href="diversity.html#rarefaction-and-total-species-richness"><i class="fa fa-check"></i><b>13.5</b> Rarefaction and total species richness</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="diversity.html"><a href="diversity.html#an-example-of-rarefaction-and-total-species-richness"><i class="fa fa-check"></i><b>13.5.1</b> An example of rarefaction and total species richness</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="diversity.html"><a href="diversity.html#distributions"><i class="fa fa-check"></i><b>13.6</b> Distributions</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="diversity.html"><a href="diversity.html#log-normal-distribution"><i class="fa fa-check"></i><b>13.6.1</b> Log-normal distribution</a></li>
<li class="chapter" data-level="13.6.2" data-path="diversity.html"><a href="diversity.html#other-distributions"><i class="fa fa-check"></i><b>13.6.2</b> Other distributions</a></li>
<li class="chapter" data-level="13.6.3" data-path="diversity.html"><a href="diversity.html#pattern-vs.-process"><i class="fa fa-check"></i><b>13.6.3</b> Pattern <em>vs.</em> process</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="diversity.html"><a href="diversity.html#neutral-theory-of-biodiversity-and-biogeography"><i class="fa fa-check"></i><b>13.7</b> Neutral Theory of Biodiversity and Biogeography</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="diversity.html"><a href="diversity.html#different-flavors-of-neutral-communities"><i class="fa fa-check"></i><b>13.7.1</b> Different flavors of neutral communities</a></li>
<li class="chapter" data-level="13.7.2" data-path="diversity.html"><a href="diversity.html#investigating-neutral-communities"><i class="fa fa-check"></i><b>13.7.2</b> Investigating neutral communities</a></li>
</ul></li>
<li class="chapter" data-level="13.8" data-path="diversity.html"><a href="diversity.html#speciesarea-relations"><i class="fa fa-check"></i><b>13.8</b> Species–area relations</a>
<ul>
<li class="chapter" data-level="13.8.1" data-path="diversity.html"><a href="diversity.html#island-biogeography"><i class="fa fa-check"></i><b>13.8.1</b> Island biogeography</a></li>
</ul></li>
<li class="chapter" data-level="13.9" data-path="diversity.html"><a href="diversity.html#diversity-partitioning"><i class="fa fa-check"></i><b>13.9</b> Diversity Partitioning</a>
<ul>
<li class="chapter" data-level="13.9.1" data-path="diversity.html"><a href="diversity.html#partitioning-speciesarea-relations"><i class="fa fa-check"></i><b>13.9.1</b> Partitioning species–area relations</a></li>
</ul></li>
<li class="chapter" data-level="13.10" data-path="diversity.html"><a href="diversity.html#summary-1"><i class="fa fa-check"></i><b>13.10</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>14</b> Appendix</a>
<ul>
<li class="chapter" data-level="14.1" data-path="appendix.html"><a href="appendix.html#very-introductory-materials"><i class="fa fa-check"></i><b>14.1</b> Very introductory materials</a></li>
<li class="chapter" data-level="14.2" data-path="appendix.html"><a href="appendix.html#writing-your-own-functions"><i class="fa fa-check"></i><b>14.2</b> Writing your own functions</a></li>
<li class="chapter" data-level="14.3" data-path="appendix.html"><a href="appendix.html#iterated-actions-the-apply-family-and-loops"><i class="fa fa-check"></i><b>14.3</b> Iterated Actions: the <code>apply</code> Family and Loops</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="appendix.html"><a href="appendix.html#iterations-of-independent-actions"><i class="fa fa-check"></i><b>14.3.1</b> Iterations of independent actions</a></li>
<li class="chapter" data-level="14.3.2" data-path="appendix.html"><a href="appendix.html#dependent-iterations"><i class="fa fa-check"></i><b>14.3.2</b> Dependent iterations</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="appendix.html"><a href="appendix.html#probability-distributions-and-randomization"><i class="fa fa-check"></i><b>14.4</b> Probability Distributions and Randomization</a></li>
<li class="chapter" data-level="14.5" data-path="appendix.html"><a href="appendix.html#numerical-integration-of-ordinary-differential-equations"><i class="fa fa-check"></i><b>14.5</b> Numerical integration of ordinary differential equations</a></li>
<li class="chapter" data-level="14.6" data-path="appendix.html"><a href="appendix.html#eigenanalysis-1"><i class="fa fa-check"></i><b>14.6</b> Eigenanalysis</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="appendix.html"><a href="appendix.html#eigenanalysis-of-demographic-versus-jacobian-matrices"><i class="fa fa-check"></i><b>14.6.1</b> Eigenanalysis of demographic versus Jacobian matrices</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="appendix.html"><a href="appendix.html#derivation-of-the-right-eigenvalues"><i class="fa fa-check"></i><b>14.7</b> Derivation of the right eigenvalues</a></li>
<li class="chapter" data-level="14.8" data-path="appendix.html"><a href="appendix.html#symbols-used-in-this-book"><i class="fa fa-check"></i><b>14.8</b> Symbols used in this book</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>15</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Primer of Ecology using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="consumer-resource-competition-and-mutualisms" class="section level1" number="11">
<h1><span class="header-section-number">11</span> Consumer-resource Competition and Mutualisms</h1>
<p>In an earlier chapter, we used Lotka-Volterra models of competition and mutualism to learn about some fundamental properties of (-,-) and and (+,+) interactions. Here we add some model complexity to illustrate a more mechanistic approach to modeling greater biological reality.</p>
<p>In <a href="cr.html#cr">Chapter 8</a>, on consumer-resource interactions, we learned a variety of approaches to representing different types of resources or prey, and different ways consumers consume them. <strong>Please read chapter 8 before proceeding here.</strong> There are a lot of terms and parameters we use here that are more fully explained in <a href="cr.html#cr">Chapter 8</a>.</p>
<div id="competition-for-one-resource" class="section level2" number="11.1">
<h2><span class="header-section-number">11.1</span> Competition for one resource</h2>
<p>Let’s imagine we have competition between two species for the shared limiting inorganic resource,
<span class="math display">\[\frac{dN_1}{dt}= N\left(e_1a_1R - d_1\right)\]</span>
<span class="math display">\[\frac{dN_2}{dt}= N_2\left(e_2a_2R - d_2\right)\]</span>
where <span class="math inline">\(e\)</span> is assimilation efficiency, <span class="math inline">\(a\)</span> is consumption rate, and <span class="math inline">\(d\)</span> is mortality. As we can see, these two species do not interact directly–<span class="math inline">\(N_2\)</span> is not in the expression for <span class="math inline">\(dN_1/dt\)</span> and vice versa.</p>
<p>The expression for <span class="math inline">\(dR/dt\)</span> includes a renewing resource,
<span class="math display">\[\frac{dR}{dt} = r(S-R) - e_1a_1N_1R - e_2a_2N_2R\]</span>
where <span class="math inline">\(S\)</span> is background resource supply rate, and <span class="math inline">\(r\)</span> is resource renewal rate.</p>
<p>Here we graph mass-specific or per capita growth rates as functions of resource concentrations. These curves are simply,
<span class="math display">\[y = e_ia_i x - d_i\]</span>
where <span class="math inline">\(y\)</span> is the per capita or mass-specific growth rate (dN/dt), and <span class="math inline">\(x\)</span> is resource concentration or density (<span class="math inline">\(R\)</span>).</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="consumer-resource-competition-and-mutualisms.html#cb318-1" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> <span class="fl">0.1</span>; a1 <span class="ot">&lt;-</span> <span class="dv">1</span>; d1 <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb318-2"><a href="consumer-resource-competition-and-mutualisms.html#cb318-2" aria-hidden="true" tabindex="-1"></a>e2 <span class="ot">&lt;-</span> <span class="fl">0.1</span>; a2 <span class="ot">&lt;-</span> .<span class="dv">5</span>; d2 <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb318-3"><a href="consumer-resource-competition-and-mutualisms.html#cb318-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-4"><a href="consumer-resource-competition-and-mutualisms.html#cb318-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb318-5"><a href="consumer-resource-competition-and-mutualisms.html#cb318-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># setting the margins of the plot</span></span>
<span id="cb318-6"><a href="consumer-resource-competition-and-mutualisms.html#cb318-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar=</span>(<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>,.<span class="dv">5</span>,.<span class="dv">5</span>)))</span>
<span id="cb318-7"><a href="consumer-resource-competition-and-mutualisms.html#cb318-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb318-8"><a href="consumer-resource-competition-and-mutualisms.html#cb318-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># making the graph</span></span>
<span id="cb318-9"><a href="consumer-resource-competition-and-mutualisms.html#cb318-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(e1<span class="sc">*</span>a1<span class="sc">*</span>x <span class="sc">-</span> d1, <span class="dv">0</span>,<span class="dv">10</span>, <span class="at">ylab=</span><span class="st">&quot;dN/(Ndt)&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Resource concentration&quot;</span>)</span>
<span id="cb318-10"><a href="consumer-resource-competition-and-mutualisms.html#cb318-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(e2<span class="sc">*</span>a2<span class="sc">*</span>x <span class="sc">-</span> d2, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb318-11"><a href="consumer-resource-competition-and-mutualisms.html#cb318-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb318-12"><a href="consumer-resource-competition-and-mutualisms.html#cb318-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;Sp. 1&quot;</span>, <span class="st">&quot;Sp. 2&quot;</span>), <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">bty=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb318-13"><a href="consumer-resource-competition-and-mutualisms.html#cb318-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb318-14"><a href="consumer-resource-competition-and-mutualisms.html#cb318-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#adding the arrows</span></span>
<span id="cb318-15"><a href="consumer-resource-competition-and-mutualisms.html#cb318-15" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> d1<span class="sc">/</span>(e1<span class="sc">*</span>a1); x2 <span class="ot">&lt;-</span> d2<span class="sc">/</span>(e2<span class="sc">*</span>a2); len <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb318-16"><a href="consumer-resource-competition-and-mutualisms.html#cb318-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrows</span>(<span class="fu">c</span>(x1,x2), <span class="fu">c</span>(<span class="sc">-</span>len, len), <span class="fu">c</span>(x1,x2), <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">length=</span><span class="fl">0.1</span>)</span>
<span id="cb318-17"><a href="consumer-resource-competition-and-mutualisms.html#cb318-17" aria-hidden="true" tabindex="-1"></a>  }      </span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:dN"></span>
<img src="figs/dN-1.png" alt="*Mass-specific growth rates of two species across a range of resource concentrations. Note that where growth rates equal death rates, consumer growth is zero (arrows) and this determines each species' $R^*$s.*" width="75%" />
<p class="caption">
Figure 11.1: <em>Mass-specific growth rates of two species across a range of resource concentrations. Note that where growth rates equal death rates, consumer growth is zero (arrows) and this determines each species’ <span class="math inline">\(R^*\)</span>s.</em>
</p>
</div>
<p>We can calculate the equilibrium resource concentration that each species would create on its own, their <span class="math inline">\(R^*\)</span>s. Recall that we find this by setting each species per capita growth rates to zero, and solving for <span class="math inline">\(R\)</span>.</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="consumer-resource-competition-and-mutualisms.html#cb319-1" aria-hidden="true" tabindex="-1"></a>R.star.sp1 <span class="ot">&lt;-</span> d1<span class="sc">/</span>(e1<span class="sc">*</span>a1)</span>
<span id="cb319-2"><a href="consumer-resource-competition-and-mutualisms.html#cb319-2" aria-hidden="true" tabindex="-1"></a>R.star.sp2 <span class="ot">&lt;-</span> d2<span class="sc">/</span>(e2<span class="sc">*</span>a2)</span>
<span id="cb319-3"><a href="consumer-resource-competition-and-mutualisms.html#cb319-3" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(R.star.sp1, R.star.sp2)</span></code></pre></div>
<pre><code>## [1] 3 2</code></pre>
<p>From Fig. <a href="consumer-resource-competition-and-mutualisms.html#fig:dN">11.1</a>, we see that at high resource concentrations, species 1 grows faster than species 2. However, at low resource concentrations, species 2 grows faster than species 1. Resource concentrations change as consumers take up resources, so when does the whole system reach an equilibrium?</p>
<p>Both species (Fig. <a href="consumer-resource-competition-and-mutualisms.html#fig:dN">11.1</a>) increase in biomass as long as resources are high enough to allow growth, whereas resources will decline as consumers grow more and more and take up increasing amounts of resources. Eventually consumer biomass is high enough to drive down resources so low that mass-specific growth rate is zero. This will happen at different resource concentrations for our two species. We see that species 2 has a positive growth rate when species 1 does not (Fig. <a href="consumer-resource-competition-and-mutualisms.html#fig:dN">11.1</a>). This type of resource competition for a single limiting resource was named the <span class="math inline">\(R^*\)</span> rule (“R-star”):</p>
<p><strong>The species with the lowest <span class="math inline">\(R^*\)</span> for the shared limiting resource will exclude all others.</strong></p>
<p>We refer to this type of resource competition as <span class="math inline">\(R^*\)</span> competition.</p>
<p>We can create a model to integrate the dynamics of these three components.</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="consumer-resource-competition-and-mutualisms.html#cb321-1" aria-hidden="true" tabindex="-1"></a>cr_2plants  <span class="ot">&lt;-</span> <span class="cf">function</span>(t,y,p){</span>
<span id="cb321-2"><a href="consumer-resource-competition-and-mutualisms.html#cb321-2" aria-hidden="true" tabindex="-1"></a>  N1 <span class="ot">&lt;-</span> y[<span class="dv">1</span>]; N2 <span class="ot">&lt;-</span> y[<span class="dv">2</span>]; R <span class="ot">&lt;-</span> y[<span class="dv">3</span>]</span>
<span id="cb321-3"><a href="consumer-resource-competition-and-mutualisms.html#cb321-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(p),{</span>
<span id="cb321-4"><a href="consumer-resource-competition-and-mutualisms.html#cb321-4" aria-hidden="true" tabindex="-1"></a>    dN1 <span class="ot">&lt;-</span> N1<span class="sc">*</span>(e1<span class="sc">*</span>a1<span class="sc">*</span>R <span class="sc">-</span> d1)</span>
<span id="cb321-5"><a href="consumer-resource-competition-and-mutualisms.html#cb321-5" aria-hidden="true" tabindex="-1"></a>    dN2 <span class="ot">&lt;-</span> N2<span class="sc">*</span>(e2<span class="sc">*</span>a2<span class="sc">*</span>R <span class="sc">-</span> d2)</span>
<span id="cb321-6"><a href="consumer-resource-competition-and-mutualisms.html#cb321-6" aria-hidden="true" tabindex="-1"></a>    dR <span class="ot">&lt;-</span> r<span class="sc">*</span>(S<span class="sc">-</span>R) <span class="sc">-</span> a1<span class="sc">*</span>N1<span class="sc">*</span>R <span class="sc">-</span> a2<span class="sc">*</span>N2<span class="sc">*</span>R</span>
<span id="cb321-7"><a href="consumer-resource-competition-and-mutualisms.html#cb321-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dN1,dN2,dR)))</span>
<span id="cb321-8"><a href="consumer-resource-competition-and-mutualisms.html#cb321-8" aria-hidden="true" tabindex="-1"></a>  } )</span>
<span id="cb321-9"><a href="consumer-resource-competition-and-mutualisms.html#cb321-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now we run the model.</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="consumer-resource-competition-and-mutualisms.html#cb322-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by=</span>.<span class="dv">5</span>)</span>
<span id="cb322-2"><a href="consumer-resource-competition-and-mutualisms.html#cb322-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">e1=</span><span class="fl">0.1</span>, <span class="at">a1=</span><span class="dv">1</span>, <span class="at">d1=</span><span class="fl">0.3</span>, </span>
<span id="cb322-3"><a href="consumer-resource-competition-and-mutualisms.html#cb322-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">e2=</span><span class="fl">0.1</span>, <span class="at">a2=</span>.<span class="dv">5</span>, <span class="at">d2=</span><span class="fl">0.1</span>,</span>
<span id="cb322-4"><a href="consumer-resource-competition-and-mutualisms.html#cb322-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">S=</span><span class="dv">5</span>, <span class="at">r=</span><span class="dv">1</span>)</span>
<span id="cb322-5"><a href="consumer-resource-competition-and-mutualisms.html#cb322-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-6"><a href="consumer-resource-competition-and-mutualisms.html#cb322-6" aria-hidden="true" tabindex="-1"></a>y.initial <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">N1=</span>.<span class="dv">1</span>, <span class="at">N2=</span>.<span class="dv">1</span>, <span class="at">R=</span><span class="dv">4</span>)</span>
<span id="cb322-7"><a href="consumer-resource-competition-and-mutualisms.html#cb322-7" aria-hidden="true" tabindex="-1"></a>rout <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="at">y=</span>y.initial, <span class="at">time=</span>t, <span class="at">fun=</span>cr_2plants, <span class="at">parms=</span>p)</span>
<span id="cb322-8"><a href="consumer-resource-competition-and-mutualisms.html#cb322-8" aria-hidden="true" tabindex="-1"></a>r.long <span class="ot">&lt;-</span> rout <span class="sc">%&gt;%</span> as.data.frame <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="sc">-</span>time, <span class="at">names_to =</span> <span class="st">&quot;State&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Grams&quot;</span>)</span>
<span id="cb322-9"><a href="consumer-resource-competition-and-mutualisms.html#cb322-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>r.long, <span class="fu">aes</span>(time, Grams, <span class="at">colour=</span>State, <span class="at">linetype=</span>State)) <span class="sc">+</span> </span>
<span id="cb322-10"><a href="consumer-resource-competition-and-mutualisms.html#cb322-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() </span></code></pre></div>
<p><img src="figs/unnamed-chunk-143-1.png" width="90%" /></p>
<p>Now if we like, we can find <span class="math inline">\(N_2^*\)</span> when <span class="math inline">\(R^*=d_2/(e_2a_2)\)</span>, and <span class="math inline">\(N_1 =0\)</span>.
<span class="math display">\[\frac{dR}{dt} = 0 = r\left(S-R\right) - a_2N_2R\]</span>
Substituting <span class="math inline">\(R^*\)</span> in for <span class="math inline">\(R\)</span> gives us this solution:</p>
<p><span class="math display">\[N^*_2 = r\left(S\frac{e_2}{d_2} - \frac{1}{a_2}\right)\]</span>
It is clear from this expression that increasing the death rate (<span class="math inline">\(d\)</span>) will drive down <span class="math inline">\(N^*_2\)</span>. However, increasing resource turnover rate, <span class="math inline">\(b\)</span>, assimilation efficiency, <span class="math inline">\(e\)</span>, or uptake rate, <span class="math inline">\(a\)</span>, will all cause <span class="math inline">\(N_2^*\)</span> to increase.</p>
<p>In the above model, per capita growth rates were linear functions of resource concentration. It more common to use a type II <a href="#fr">functional response</a> for the consumers <span class="citation">(<a href="#ref-Tilman1982" role="doc-biblioref">Tilman 1982</a>)</span> (Fig. <a href="consumer-resource-competition-and-mutualisms.html#fig:monod">11.2</a>), which we described in Chapter 8.
<span class="math display">\[\frac{dN_i}{Ndt}= b_i\frac{R}{k_i + R} - d_i\]</span></p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="consumer-resource-competition-and-mutualisms.html#cb323-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>, .<span class="dv">5</span>); k<span class="ot">=</span><span class="fu">c</span>(<span class="dv">5</span>, .<span class="dv">1</span>); d <span class="ot">=</span> <span class="fl">0.3</span></span>
<span id="cb323-2"><a href="consumer-resource-competition-and-mutualisms.html#cb323-2" aria-hidden="true" tabindex="-1"></a>{<span class="fu">curve</span>(b[<span class="dv">1</span>]<span class="sc">*</span>x<span class="sc">/</span>(k[<span class="dv">1</span>]<span class="sc">+</span>x) <span class="sc">-</span> d, <span class="dv">0</span>, <span class="dv">10</span>, <span class="at">ylab=</span><span class="fu">bquote</span>(dP<span class="sc">/</span>(Pdt)), <span class="at">xlab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb323-3"><a href="consumer-resource-competition-and-mutualisms.html#cb323-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(b[<span class="dv">2</span>]<span class="sc">*</span>x<span class="sc">/</span>(k[<span class="dv">2</span>] <span class="sc">+</span> x) <span class="sc">-</span> d, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb323-4"><a href="consumer-resource-competition-and-mutualisms.html#cb323-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">3</span>); <span class="fu">text</span>(<span class="fl">7.5</span>, <span class="dv">0</span>, <span class="st">&quot;gain = loss&quot;</span>, <span class="at">adj=</span><span class="fu">c</span>(.<span class="dv">5</span>, <span class="sc">-</span>.<span class="dv">3</span>))</span>
<span id="cb323-5"><a href="consumer-resource-competition-and-mutualisms.html#cb323-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:monod"></span>
<img src="figs/monod-1.png" alt="*The Monod function for per capita resource-dependent growth rates of two different populations. These are a type II functional responses.*" width="67%" />
<p class="caption">
Figure 11.2: <em>The Monod function for per capita resource-dependent growth rates of two different populations. These are a type II functional responses.</em>
</p>
</div>
<p>As we saw earlier with linear mass-specific growth rates, one species will have a lower <span class="math inline">\(R^*\)</span> than the other, and this model predicts that it will out-compete the other.</p>
</div>
<div id="competition-for-substitutable-resources" class="section level2" number="11.2">
<h2><span class="header-section-number">11.2</span> Competition for Substitutable resources</h2>
<p>For two species, <span class="math inline">\(N_1\)</span> and <span class="math inline">\(N_2\)</span>, competing for two shared and substitutable resources, <span class="math inline">\(R_1,\,R_2\)</span>, we will identify <span class="math inline">\(e_{ij}\)</span> and <span class="math inline">\(a_{ij}\)</span>, where <span class="math inline">\(e\)</span> is assimilation efficiency, <span class="math inline">\(a\)</span> is feeding rate. They now have two subscripts, where <span class="math inline">\(i\)</span> refers to the consumer species <span class="math inline">\(N_{i}\)</span>, and <span class="math inline">\(j\)</span> refers to either resource 1 or 2 (<span class="math inline">\(R_1\)</span>, <span class="math inline">\(R_2\)</span>). With that, we have the following relations.</p>
<p><span class="math display">\[\frac{dN_1}{dt}= N_1\left(e_{11} a_{11} R_1 + e_{12} a_{12} R_2 - d_1\right)\]</span>
<span class="math display">\[\frac{dN_2}{dt}= N_2\left(e_{21} a_{21} R_1 + e_{22} a_{22} R_2 - d_2\right)\]</span></p>
<p><span class="math display">\[\frac{dR_1}{dt}= r_1\left(S-R_1\right) - a_{11}N_1R_1 - a_{21}N_2 R_1\]</span>
<span class="math display">\[\frac{dR_2}{dt}= r_2\left(S-R_2\right) - a_{12}N_1R_2 - a_{22}N_2R_2\]</span></p>
<p>where <span class="math inline">\(a_i\)</span> is the per capita feeding rate of a consumer on a resource, <span class="math inline">\(e_i\)</span> is the efficiency with which a consumer converts a unit of resource into new biomass, <span class="math inline">\(d_i\)</span> is the per capita death rate of consumers, <span class="math inline">\(S\)</span> is the background supply rate of a resoure, and <span class="math inline">\(r(S-R)\)</span> is the turnover rate of resources that are part of the available <span class="math inline">\(R\)</span> pool.</p>
<p>The differential feeding rates, <span class="math inline">\(a_{i1}\)</span> and <span class="math inline">\(a_{i2}\)</span>, tell us a lot about the relative requirements and limitations experienced by the two consumers. If
<span class="math display">\[a_{i1} &gt; a_{i2}\]</span>
then, all else being equal, species <span class="math inline">\(i\)</span> requires more <span class="math inline">\(R_1\)</span> than <span class="math inline">\(R_2\)</span> in the environment.</p>
<p>Here we create an R function for the 4-D system of ODEs.</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="consumer-resource-competition-and-mutualisms.html#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb324-2"><a href="consumer-resource-competition-and-mutualisms.html#cb324-2" aria-hidden="true" tabindex="-1"></a>cr_2substitutable <span class="ot">&lt;-</span> <span class="cf">function</span>(t, y, parameters){</span>
<span id="cb324-3"><a href="consumer-resource-competition-and-mutualisms.html#cb324-3" aria-hidden="true" tabindex="-1"></a>  N1 <span class="ot">&lt;-</span> y[<span class="dv">1</span>] ; N2 <span class="ot">&lt;-</span> y[<span class="dv">2</span>] ; R1 <span class="ot">&lt;-</span> y[<span class="dv">3</span>]; R2 <span class="ot">&lt;-</span> y[<span class="dv">4</span>]; </span>
<span id="cb324-4"><a href="consumer-resource-competition-and-mutualisms.html#cb324-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(parameters), {</span>
<span id="cb324-5"><a href="consumer-resource-competition-and-mutualisms.html#cb324-5" aria-hidden="true" tabindex="-1"></a>    N1.dot <span class="ot">&lt;-</span> N1 <span class="sc">*</span> ( e11<span class="sc">*</span>a11<span class="sc">*</span>R1 <span class="sc">+</span> e12<span class="sc">*</span>a12<span class="sc">*</span>R2  <span class="sc">-</span> d1 )</span>
<span id="cb324-6"><a href="consumer-resource-competition-and-mutualisms.html#cb324-6" aria-hidden="true" tabindex="-1"></a>    N2.dot <span class="ot">&lt;-</span> N2 <span class="sc">*</span> ( e21<span class="sc">*</span>a21<span class="sc">*</span>R1 <span class="sc">+</span> e22<span class="sc">*</span>a22<span class="sc">*</span>R2  <span class="sc">-</span> d2 )</span>
<span id="cb324-7"><a href="consumer-resource-competition-and-mutualisms.html#cb324-7" aria-hidden="true" tabindex="-1"></a>    R1.dot <span class="ot">&lt;-</span> r1 <span class="sc">*</span> (S1 <span class="sc">-</span> R1) <span class="sc">-</span> (a11<span class="sc">*</span>N1 <span class="sc">+</span> a21<span class="sc">*</span>N2)<span class="sc">*</span>R1</span>
<span id="cb324-8"><a href="consumer-resource-competition-and-mutualisms.html#cb324-8" aria-hidden="true" tabindex="-1"></a>    R2.dot <span class="ot">&lt;-</span> r2 <span class="sc">*</span> (S2 <span class="sc">-</span> R2) <span class="sc">-</span> (a12<span class="sc">*</span>N1 <span class="sc">+</span> a22<span class="sc">*</span>N2)<span class="sc">*</span>R2</span>
<span id="cb324-9"><a href="consumer-resource-competition-and-mutualisms.html#cb324-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>( <span class="fu">list</span>(<span class="fu">c</span>(N1.dot, N2.dot, R1.dot, R2.dot)) )</span>
<span id="cb324-10"><a href="consumer-resource-competition-and-mutualisms.html#cb324-10" aria-hidden="true" tabindex="-1"></a>  } )</span>
<span id="cb324-11"><a href="consumer-resource-competition-and-mutualisms.html#cb324-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Next we create a parameter set in which species 1 grows more with each unit of <span class="math inline">\(R_1\)</span> and also consumes more of it than <span class="math inline">\(R_2\)</span>.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="consumer-resource-competition-and-mutualisms.html#cb325-1" aria-hidden="true" tabindex="-1"></a>parameters <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="co"># the environment supplies slightly more of resources 1</span></span>
<span id="cb325-2"><a href="consumer-resource-competition-and-mutualisms.html#cb325-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">r1 =</span> <span class="dv">1</span>, <span class="at">r2=</span><span class="dv">1</span>, <span class="at">S1=</span><span class="fl">1.8</span>, <span class="at">S2=</span><span class="fl">1.2</span>, </span>
<span id="cb325-3"><a href="consumer-resource-competition-and-mutualisms.html#cb325-3" aria-hidden="true" tabindex="-1"></a>                <span class="co"># sp 1 grows more with each unit of R1</span></span>
<span id="cb325-4"><a href="consumer-resource-competition-and-mutualisms.html#cb325-4" aria-hidden="true" tabindex="-1"></a>                <span class="co"># sp 2 grows more with each unit of R2</span></span>
<span id="cb325-5"><a href="consumer-resource-competition-and-mutualisms.html#cb325-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">e11=</span>.<span class="dv">1</span>, <span class="at">e12=</span>.<span class="dv">1</span>, <span class="at">e21=</span>.<span class="dv">1</span>, <span class="at">e22=</span>.<span class="dv">1</span>,</span>
<span id="cb325-6"><a href="consumer-resource-competition-and-mutualisms.html#cb325-6" aria-hidden="true" tabindex="-1"></a>                <span class="co"># sp 1 consumes more R1 than R2 and more than sp 2</span></span>
<span id="cb325-7"><a href="consumer-resource-competition-and-mutualisms.html#cb325-7" aria-hidden="true" tabindex="-1"></a>                <span class="co"># sp 2 consumes more R2 than R1 and more than sp 1</span></span>
<span id="cb325-8"><a href="consumer-resource-competition-and-mutualisms.html#cb325-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">a11=</span><span class="dv">2</span>, <span class="at">a12=</span><span class="dv">1</span>, <span class="at">a21=</span><span class="dv">1</span>, <span class="at">a22=</span><span class="dv">2</span>, </span>
<span id="cb325-9"><a href="consumer-resource-competition-and-mutualisms.html#cb325-9" aria-hidden="true" tabindex="-1"></a>                <span class="co"># both spp die at the same rate</span></span>
<span id="cb325-10"><a href="consumer-resource-competition-and-mutualisms.html#cb325-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">d1=</span>.<span class="dv">1</span>, <span class="at">d2=</span>.<span class="dv">1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="consumer-resource-competition-and-mutualisms.html#cb326-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="at">by=</span>.<span class="dv">1</span>); y.init <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">N1=</span><span class="dv">1</span>, <span class="at">N2=</span><span class="dv">1</span>, <span class="at">R1=</span><span class="fl">1.8</span>, <span class="at">R2=</span><span class="fl">1.2</span>)</span>
<span id="cb326-2"><a href="consumer-resource-competition-and-mutualisms.html#cb326-2" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="at">y =</span> y.init, <span class="at">times=</span>t, <span class="at">func=</span>cr_2substitutable, </span>
<span id="cb326-3"><a href="consumer-resource-competition-and-mutualisms.html#cb326-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">parms=</span>parameters)</span>
<span id="cb326-4"><a href="consumer-resource-competition-and-mutualisms.html#cb326-4" aria-hidden="true" tabindex="-1"></a>outL <span class="ot">&lt;-</span> out <span class="sc">%&gt;%</span> as.data.frame <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span>time, <span class="at">names_to=</span><span class="st">&quot;State_vars&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;abun.&quot;</span>)</span>
<span id="cb326-5"><a href="consumer-resource-competition-and-mutualisms.html#cb326-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(outL, <span class="fu">aes</span>(time, abun., <span class="at">colour=</span>State_vars)) <span class="sc">+</span> <span class="fu">geom_line</span>()</span></code></pre></div>
<div class="figure">
<img src="figs/cr_2x2-1.png" alt="*Initial dynamics of two species competing for two shared substitutable resources. Species 1 uses resource 1 more efficiently than it does resource 2 and also consumes more of it, per capita. Conversely, species 2 uses resource 2 more efficiently than it does resource 1 and also consumes more of it per capita.*" width="90%" />
<p class="caption">
(#fig:cr_2x2)<em>Initial dynamics of two species competing for two shared substitutable resources. Species 1 uses resource 1 more efficiently than it does resource 2 and also consumes more of it, per capita. Conversely, species 2 uses resource 2 more efficiently than it does resource 1 and also consumes more of it per capita.</em>
</p>
</div>
<p>It is</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="consumer-resource-competition-and-mutualisms.html#cb327-1" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">cr_2subst_graph</span>(parameters)</span></code></pre></div>
<p><img src="figs/unnamed-chunk-146-1.png" width="90%" /></p>
</div>
<div id="tilmans-resource-ratio-with-essential-resources" class="section level2" number="11.3">
<h2><span class="header-section-number">11.3</span> Tilman’s resource ratio with essential resources</h2>
<p>Coefficients reflect resources 1 and 2, and species <span class="math inline">\(i\)</span>.</p>
<ul>
<li><span class="math inline">\(a_i\)</span> = relative resource production rate</li>
<li><span class="math inline">\(e_{ij}\)</span></li>
</ul>
<p><span class="math display">\[ \dot{R_1} = a_1\left(S_1-R_1\right) - \left( \dot{N_1} + m_1 \right) - \left( \dot{N_2} + m_2 \right)\]</span>
<span class="math display">\[ \dot{R_2} = a_2\left(S_2-R_2\right) - \left( \dot{N_1} + m_1 \right)  - \left( \dot{N_2} + m_2 \right) \]</span></p>
<p><span class="math display">\[\dot{N_1} = r_1 \,\mathrm{MIN}\left(e_{11}c_{11}\frac{R_1}{k_{11} + R_1} \, , \, e_{12}c_{21}\frac{R_2}{k_{21} + R_1}\right) - m_1\]</span></p>
<p><span class="math display">\[\dot{N_2} = r_2 \,\mathrm{MIN}\left(e_{21}c_{12}\frac{R_1}{k_{12} + R_1} \, , \, e_{22}c_{22}\frac{R_2}{k_{22} + R_1}\right) - m_2\]</span></p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="consumer-resource-competition-and-mutualisms.html#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Something is not right here</span></span>
<span id="cb328-2"><a href="consumer-resource-competition-and-mutualisms.html#cb328-2" aria-hidden="true" tabindex="-1"></a>resratio <span class="ot">&lt;-</span> <span class="cf">function</span>(t, y, parameters){</span>
<span id="cb328-3"><a href="consumer-resource-competition-and-mutualisms.html#cb328-3" aria-hidden="true" tabindex="-1"></a>  R1 <span class="ot">&lt;-</span> y[<span class="dv">1</span>]; R2 <span class="ot">&lt;-</span> y[<span class="dv">2</span>]; N1 <span class="ot">&lt;-</span> y[<span class="dv">3</span>] ; N2 <span class="ot">&lt;-</span> y[<span class="dv">4</span>] ;</span>
<span id="cb328-4"><a href="consumer-resource-competition-and-mutualisms.html#cb328-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(parameters), {</span>
<span id="cb328-5"><a href="consumer-resource-competition-and-mutualisms.html#cb328-5" aria-hidden="true" tabindex="-1"></a>    N1.dot <span class="ot">&lt;-</span> r1 <span class="sc">*</span> N1 <span class="sc">*</span> ( <span class="fu">min</span>( <span class="fu">c</span>( c11<span class="sc">*</span>R1<span class="sc">/</span>(k11 <span class="sc">+</span> R1), c21<span class="sc">*</span>R2<span class="sc">/</span>(k21 <span class="sc">+</span> R2) ) ) <span class="sc">-</span> m1 )</span>
<span id="cb328-6"><a href="consumer-resource-competition-and-mutualisms.html#cb328-6" aria-hidden="true" tabindex="-1"></a>    N2.dot <span class="ot">&lt;-</span> r2 <span class="sc">*</span> N2 <span class="sc">*</span> ( <span class="fu">min</span>( <span class="fu">c</span>( c12<span class="sc">*</span>R1<span class="sc">/</span>(k12 <span class="sc">+</span> R1), c22<span class="sc">*</span>R2<span class="sc">/</span>(k22 <span class="sc">+</span> R2) ) ) <span class="sc">-</span> m2 )</span>
<span id="cb328-7"><a href="consumer-resource-competition-and-mutualisms.html#cb328-7" aria-hidden="true" tabindex="-1"></a>    <span class="do">## R.dot must follow N.dot if we use N.dot in R.dot</span></span>
<span id="cb328-8"><a href="consumer-resource-competition-and-mutualisms.html#cb328-8" aria-hidden="true" tabindex="-1"></a>    R1.dot <span class="ot">&lt;-</span> a1 <span class="sc">*</span> (S1 <span class="sc">-</span> R1) <span class="sc">-</span> </span>
<span id="cb328-9"><a href="consumer-resource-competition-and-mutualisms.html#cb328-9" aria-hidden="true" tabindex="-1"></a>      r1 <span class="sc">*</span> N1 <span class="sc">*</span> ( <span class="fu">min</span>( <span class="fu">c</span>( c11<span class="sc">*</span>R1<span class="sc">/</span>(k11 <span class="sc">+</span> R1), c21<span class="sc">*</span>R2<span class="sc">/</span>(k21 <span class="sc">+</span> R2) ) ))<span class="sc">/</span>e11 <span class="sc">-</span> </span>
<span id="cb328-10"><a href="consumer-resource-competition-and-mutualisms.html#cb328-10" aria-hidden="true" tabindex="-1"></a>      r2 <span class="sc">*</span> N2 <span class="sc">*</span> ( <span class="fu">min</span>( <span class="fu">c</span>( c12<span class="sc">*</span>R1<span class="sc">/</span>(k12 <span class="sc">+</span> R1), c22<span class="sc">*</span>R2<span class="sc">/</span>(k22 <span class="sc">+</span> R2) ) ))<span class="sc">/</span>e12 </span>
<span id="cb328-11"><a href="consumer-resource-competition-and-mutualisms.html#cb328-11" aria-hidden="true" tabindex="-1"></a>    R2.dot <span class="ot">&lt;-</span> a2 <span class="sc">*</span> (S2 <span class="sc">-</span> R2) <span class="sc">-</span> </span>
<span id="cb328-12"><a href="consumer-resource-competition-and-mutualisms.html#cb328-12" aria-hidden="true" tabindex="-1"></a>      r1 <span class="sc">*</span> N1 <span class="sc">*</span> ( <span class="fu">min</span>( <span class="fu">c</span>( c11<span class="sc">*</span>R1<span class="sc">/</span>(k11 <span class="sc">+</span> R1), c21<span class="sc">*</span>R2<span class="sc">/</span>(k21 <span class="sc">+</span> R2) ) ))<span class="sc">/</span>e21 <span class="sc">-</span> </span>
<span id="cb328-13"><a href="consumer-resource-competition-and-mutualisms.html#cb328-13" aria-hidden="true" tabindex="-1"></a>      r2 <span class="sc">*</span> N2 <span class="sc">*</span> ( <span class="fu">min</span>( <span class="fu">c</span>( c12<span class="sc">*</span>R1<span class="sc">/</span>(k12 <span class="sc">+</span> R1), c22<span class="sc">*</span>R2<span class="sc">/</span>(k22 <span class="sc">+</span> R2) ) ))<span class="sc">/</span>e22 </span>
<span id="cb328-14"><a href="consumer-resource-competition-and-mutualisms.html#cb328-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>( <span class="fu">list</span>(<span class="fu">c</span>(R1.dot, R2.dot, N1.dot, N2.dot)) )</span>
<span id="cb328-15"><a href="consumer-resource-competition-and-mutualisms.html#cb328-15" aria-hidden="true" tabindex="-1"></a>  } )</span>
<span id="cb328-16"><a href="consumer-resource-competition-and-mutualisms.html#cb328-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb328-17"><a href="consumer-resource-competition-and-mutualisms.html#cb328-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-18"><a href="consumer-resource-competition-and-mutualisms.html#cb328-18" aria-hidden="true" tabindex="-1"></a>parameters <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a1 =</span> <span class="dv">1</span>, <span class="at">a2=</span><span class="dv">1</span>, <span class="at">S1=</span><span class="dv">10</span>, <span class="at">S2=</span><span class="dv">10</span>, </span>
<span id="cb328-19"><a href="consumer-resource-competition-and-mutualisms.html#cb328-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">r1=</span><span class="dv">1</span>, <span class="at">r2=</span><span class="dv">1</span>, <span class="at">m1=</span>.<span class="dv">1</span>, <span class="at">m2=</span>.<span class="dv">1</span>, </span>
<span id="cb328-20"><a href="consumer-resource-competition-and-mutualisms.html#cb328-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">c11=</span><span class="dv">1</span>, <span class="at">c21=</span><span class="dv">1</span>, <span class="at">c12=</span><span class="dv">1</span>, <span class="at">c22=</span><span class="dv">1</span>, </span>
<span id="cb328-21"><a href="consumer-resource-competition-and-mutualisms.html#cb328-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">k11=</span>.<span class="dv">1</span>, <span class="at">k21=</span><span class="dv">1</span>, <span class="at">k12=</span><span class="dv">1</span>, <span class="at">k22=</span>.<span class="dv">1</span>,</span>
<span id="cb328-22"><a href="consumer-resource-competition-and-mutualisms.html#cb328-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">e11=</span>.<span class="dv">1</span>, <span class="at">e21=</span>.<span class="dv">1</span>, <span class="at">e12=</span>.<span class="dv">1</span>, <span class="at">e22=</span>.<span class="dv">1</span>)</span>
<span id="cb328-23"><a href="consumer-resource-competition-and-mutualisms.html#cb328-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-24"><a href="consumer-resource-competition-and-mutualisms.html#cb328-24" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(<span class="fu">as.list</span>(parameters),{</span>
<span id="cb328-25"><a href="consumer-resource-competition-and-mutualisms.html#cb328-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(r1<span class="sc">*</span>c11<span class="sc">*</span>x<span class="sc">/</span>(k11 <span class="sc">+</span> x)<span class="sc">-</span>m1, <span class="dv">0</span>, <span class="dv">3</span>, <span class="at">xlab=</span><span class="fu">expression</span>(<span class="st">&quot;R&quot;</span>[<span class="st">&quot;j&quot;</span>]), </span>
<span id="cb328-26"><a href="consumer-resource-competition-and-mutualisms.html#cb328-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="fu">expression</span>(<span class="st">&quot;r&quot;</span>[<span class="st">&quot;i&quot;</span>]<span class="sc">*</span><span class="st">&quot;c&quot;</span>[<span class="st">&quot;i&quot;</span>]<span class="sc">*</span><span class="st">&quot;R&quot;</span>[<span class="st">&quot;j&quot;</span>] <span class="sc">/</span>( <span class="st">&quot;k&quot;</span>[<span class="st">&quot;ji&quot;</span>] <span class="sc">+</span> <span class="st">&quot;R&quot;</span>[<span class="st">&quot;j&quot;</span>]) <span class="sc">-</span> <span class="st">&quot;m&quot;</span>[<span class="st">&quot;i&quot;</span>] ) )</span>
<span id="cb328-27"><a href="consumer-resource-competition-and-mutualisms.html#cb328-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(r1<span class="sc">*</span>c21<span class="sc">*</span>x<span class="sc">/</span>(k21 <span class="sc">+</span> x)<span class="sc">-</span>m1, <span class="dv">0</span>, <span class="dv">3</span>, <span class="at">add=</span>T, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb328-28"><a href="consumer-resource-competition-and-mutualisms.html#cb328-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(r2<span class="sc">*</span>c12<span class="sc">*</span>x<span class="sc">/</span>(k12 <span class="sc">+</span> x)<span class="sc">-</span>m2, <span class="dv">0</span>, <span class="dv">3</span>, <span class="at">col=</span><span class="dv">4</span>, <span class="at">add=</span>T)</span>
<span id="cb328-29"><a href="consumer-resource-competition-and-mutualisms.html#cb328-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(r2<span class="sc">*</span>c22<span class="sc">*</span>x<span class="sc">/</span>(k22 <span class="sc">+</span> x)<span class="sc">-</span>m2, <span class="dv">0</span>, <span class="dv">3</span>, <span class="at">add=</span>T, <span class="at">col=</span><span class="dv">4</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb328-30"><a href="consumer-resource-competition-and-mutualisms.html#cb328-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb328-31"><a href="consumer-resource-competition-and-mutualisms.html#cb328-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&#39;right&#39;</span>, <span class="fu">c</span>(<span class="st">&#39;N1(R1)&#39;</span>, <span class="st">&#39;N1(R2)&#39;</span>, <span class="st">&#39;N2(R1)&#39;</span>, <span class="st">&#39;N2(R2)&#39;</span>), </span>
<span id="cb328-32"><a href="consumer-resource-competition-and-mutualisms.html#cb328-32" aria-hidden="true" tabindex="-1"></a>         <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">4</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">bty=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb328-33"><a href="consumer-resource-competition-and-mutualisms.html#cb328-33" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p><img src="figs/unnamed-chunk-147-1.png" width="90%" /></p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="consumer-resource-competition-and-mutualisms.html#cb329-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">100</span></span>
<span id="cb329-2"><a href="consumer-resource-competition-and-mutualisms.html#cb329-2" aria-hidden="true" tabindex="-1"></a>y0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">R1=</span>.<span class="dv">5</span>, <span class="at">R2=</span>.<span class="dv">5</span>, <span class="at">N1=</span><span class="dv">10</span>, <span class="at">N2=</span><span class="dv">10</span>)</span>
<span id="cb329-3"><a href="consumer-resource-competition-and-mutualisms.html#cb329-3" aria-hidden="true" tabindex="-1"></a>run1 <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="at">y=</span>y0, <span class="at">times=</span>t, <span class="at">func=</span>resratio, <span class="at">parms=</span>parameters)</span>
<span id="cb329-4"><a href="consumer-resource-competition-and-mutualisms.html#cb329-4" aria-hidden="true" tabindex="-1"></a>parameters; <span class="fu">plot</span>(run1)</span></code></pre></div>
<pre><code>##   a1   a2   S1   S2   r1   r2   m1   m2  c11  c21  c12  c22  k11  k21  k12  k22 
##  1.0  1.0 10.0 10.0  1.0  1.0  0.1  0.1  1.0  1.0  1.0  1.0  0.1  1.0  1.0  0.1 
##  e11  e21  e12  e22 
##  0.1  0.1  0.1  0.1</code></pre>
<p><img src="figs/ode-1.png" width="90%" /></p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="consumer-resource-competition-and-mutualisms.html#cb331-1" aria-hidden="true" tabindex="-1"></a>run1[<span class="dv">101</span>,]</span></code></pre></div>
<pre><code>##        time          R1          R2          N1          N2 
## 100.0000000   0.1111048   0.1111048   4.9447001   4.9447001</code></pre>
<p><span class="math display">\[R_{j}^* = \frac{k_{ji}m_i}{r_i-m_i}\]</span></p>
</div>
<div id="consumer-resource-mutualism" class="section level2" number="11.4">
<h2><span class="header-section-number">11.4</span> Consumer-resource mutualism</h2>
<p>In this section, we will model mutualisms using a framework that, unlike our Lotka-Volterra approach, is intended specifically to describe resource consumption by one or both partners <span class="citation">(<a href="#ref-MacArthur1972" role="doc-biblioref">MacArthur 1972</a>)</span>.</p>
Sometimes mutualists share resources, as with mycorrhizal
associations, where species share a resource or a product that they
can acquire or manufacture in surplus and trade it for a resource or product that is limiting. This is a bi-drectional mutualism (Fig. <a href="consumer-resource-competition-and-mutualisms.html#fig:mut3">11.3</a>) because the flow of  are bidirectional: both species provide a resource to the other <span class="citation">(<a href="#ref-Holland2010" role="doc-biblioref">Holland and Deangelis 2010</a>)</span>.
<div class="figure"><span style="display:block;" id="fig:mut3"></span>
<img src="bimut.png" alt="Bidirection, unidirectional, and indirect mutualisms. Normal arrowhead is a positive effect, whereas an open dot arrowhead is a negative effect. A dashed line indicates a service, and a solid line indicates a consumable resource." width="33%" /><img src="umut.png" alt="Bidirection, unidirectional, and indirect mutualisms. Normal arrowhead is a positive effect, whereas an open dot arrowhead is a negative effect. A dashed line indicates a service, and a solid line indicates a consumable resource." width="33%" /><img src="imut.png" alt="Bidirection, unidirectional, and indirect mutualisms. Normal arrowhead is a positive effect, whereas an open dot arrowhead is a negative effect. A dashed line indicates a service, and a solid line indicates a consumable resource." width="33%" />
<p class="caption">
Figure 11.3: Bidirection, unidirectional, and indirect mutualisms. Normal arrowhead is a positive effect, whereas an open dot arrowhead is a negative effect. A dashed line indicates a service, and a solid line indicates a consumable resource.
</p>
</div>
<p>In other cases, mutualists may share services, as with moray
eel-grouper foraging. In this particular case, grouper and the giant
moray eel have different foraging strategies, with the eel going into
reef crevices and the grouper waiting outside to pick off prey that
escape the eel <span class="citation">(<a href="#ref-Bshary2006" role="doc-biblioref">Bshary et al. 2006</a>)</span>. Sometimes these mutualisms are
called <em>by-product</em> mutualisms, in cases where there is no
evidence of coordinated behavior, but nonetheless a mutualism arises via the independent activities of each species.</p>
<p>In the following, we explore the type of mutualism in which one
species provides a resource and the other species provides a
service (Fig. <a href="consumer-resource-competition-and-mutualisms.html#fig:mut3">11.3</a>). This is a uni-directional mutualism because the flow of <em>resources</em> is only unidrectional, from one species to the other <span class="citation">(<a href="#ref-Holland2010" role="doc-biblioref">Holland and Deangelis 2010</a>)</span>.</p>
<p>A good example of a uni-directional of mutualism is seed dispersal via
a frugivore that disperses seeds. A plant species provides a
fruit that is nutritious for an animal. A primary benefit for the
plant is that seeds are carried away from the parent plant. This may
help seeds escape enemies that accumulate near parent plants
(Connell-Janzen hypothesis). In addition, it provides a bet hedging
opportunity wherein seeds are dispersed to a variety of habitats any
one of which may be better for survival than the current location. It
is even possible that dispersal is <em>directed</em> to preferred
habitat that is consistently better than under the parent plant due to
better resource levels or environmental conditions
<span class="citation">(<a href="#ref-Wenny1998" role="doc-biblioref">Wenny and Levey 1998</a>)</span>. The animal benefits by consuming the fleshy part of
the fruit surrounding the seed. An interesting case arises when seed
predators collect seeds but do not kill them before having buried,
cached, or moved seeds.</p>
<p>Another very important example example of this type of mutualism is pollination. Pollinators (bats, insects, birds) receive resources (nectar, pollen) and provide services (pollination, gene flow).</p>
<div id="a-model-of-uni-directional-mutualism" class="section level3" number="11.4.1">
<h3><span class="header-section-number">11.4.1</span> A model of uni-directional mutualism</h3>
<p>Here we describe a model of a facultative unidirectional mutualism that uses type II foraging model for both consumption of the resource and provision of the service.</p>
<p>The growth equation for the plant species, <span class="math inline">\(M_1\)</span>, includes logistic growth, and has terms for the benefit it receives from its mutualist frugivore and the cost paid to that frugivore.</p>
<p><span class="math display">\[\frac{dM_1}{dt} = r_1 M_1\left(1-d_1M_1\right)  - aM_2\left(\frac{M_1}{h_1 + M_1}\right) + sM_1\left(\frac{M_2}{h_2 + M_2}\right)\]</span></p>
<p>The plant species (<span class="math inline">\(M_1\)</span>) grows logistically in the absence of fruit consumption or seed dispersal <span class="math inline">\(r_1 M_1\left(1-d_1M_1\right)\)</span>. Consumption of fruits are governed by a type II functional response by the frugivore <span class="math inline">\(aM_2\left(\frac{M_1}{h_1 + M_1}\right)\)</span>, so that the consumption rate of a single frugivore has an upper limit (Fig. <a href="consumer-resource-competition-and-mutualisms.html#fig:funcResp">11.4</a>). Successful seed dispersal and establishment is also governed by a type II functional response. The success of a single seed reaches an upper limit as the number of frugivores continues to increase, <span class="math inline">\(c_1M_1\left(\frac{M_2}{h_2 + M_2}\right)\)</span> (Fig. <a href="consumer-resource-competition-and-mutualisms.html#fig:funcResp">11.4</a>).</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="consumer-resource-competition-and-mutualisms.html#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)), <span class="fu">aes</span>(<span class="at">x=</span>x) ) <span class="sc">+</span> </span>
<span id="cb333-2"><a href="consumer-resource-competition-and-mutualisms.html#cb333-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun=</span><span class="cf">function</span>(x) { <span class="dv">10</span><span class="sc">*</span>x<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="dv">10</span><span class="sc">*</span>x) }) <span class="sc">+</span></span>
<span id="cb333-3"><a href="consumer-resource-competition-and-mutualisms.html#cb333-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">x=</span><span class="st">&quot;Fruit abundance&quot;</span>, <span class="at">y=</span><span class="st">&quot;Consumption Rate of a frugivore&quot;</span>)</span>
<span id="cb333-4"><a href="consumer-resource-competition-and-mutualisms.html#cb333-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-5"><a href="consumer-resource-competition-and-mutualisms.html#cb333-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-6"><a href="consumer-resource-competition-and-mutualisms.html#cb333-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)), <span class="fu">aes</span>(<span class="at">x=</span>x) ) <span class="sc">+</span> </span>
<span id="cb333-7"><a href="consumer-resource-competition-and-mutualisms.html#cb333-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun=</span><span class="cf">function</span>(x) { <span class="dv">10</span><span class="sc">*</span>x<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="dv">10</span><span class="sc">*</span>x) }) <span class="sc">+</span></span>
<span id="cb333-8"><a href="consumer-resource-competition-and-mutualisms.html#cb333-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">x=</span><span class="st">&quot;Frugivore abundance&quot;</span>, <span class="at">y=</span><span class="st">&quot;Dispersal rate of a seed&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:funcResp"></span>
<img src="figs/funcResp-1.png" alt="Fruit consumption by a single frugivore is governed by a type II functional response as fruit abundance increases. Successful seed dispersal and establishment is governed by a type II functional response as frugivores increase." width="40%" /><img src="figs/funcResp-2.png" alt="Fruit consumption by a single frugivore is governed by a type II functional response as fruit abundance increases. Successful seed dispersal and establishment is governed by a type II functional response as frugivores increase." width="40%" />
<p class="caption">
Figure 11.4: Fruit consumption by a single frugivore is governed by a type II functional response as fruit abundance increases. Successful seed dispersal and establishment is governed by a type II functional response as frugivores increase.
</p>
</div>
<p>The growth equation for the frugivore species, <span class="math inline">\(M_2\)</span>, includes logistic growth, and one term for the benefit gained from the plant.</p>
<p><span class="math display">\[\frac{dM_2}{dt} =  r_2M_2\left(1-d_2M_2\right) + eaM_2\left(\frac{M_1}{h_1+M_1}\right) \]</span>
The animal seed disperser grows logistically in in the absence of consuming this particular plant species <span class="math inline">\(r_2M_2\left(1-d_2M_2\right)\)</span>. The animal benefits from consuming the fruit which it attacks at the same rate as for <span class="math inline">\(M_1\)</span>, <span class="math inline">\(aM_2\left(\frac{M_1}{h_1+M_1}\right)\)</span>, but converts the fruit into new individuals with efficiency <span class="math inline">\(e\)</span>.</p>
<ul>
<li>consumption &gt; service = net predation</li>
<li>service &gt; consumption = net mutualism</li>
</ul>
<p>Here we provide code for the ODE for the complete bidirectional mutualism. When we define the parameters, we will set some of them equal to zero so that it represents a unidirectional consumer-resource mutualism.</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="consumer-resource-competition-and-mutualisms.html#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The derivative </span></span>
<span id="cb334-2"><a href="consumer-resource-competition-and-mutualisms.html#cb334-2" aria-hidden="true" tabindex="-1"></a><span class="do">## A two-species consumer-resource mutualism</span></span>
<span id="cb334-3"><a href="consumer-resource-competition-and-mutualisms.html#cb334-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Holland and DeAngelis 2009, Ecology Letters Ecology Letters, 12: 1357–1366.</span></span>
<span id="cb334-4"><a href="consumer-resource-competition-and-mutualisms.html#cb334-4" aria-hidden="true" tabindex="-1"></a><span class="do">## The parameterization follows that in this article. It differs from those </span></span>
<span id="cb334-5"><a href="consumer-resource-competition-and-mutualisms.html#cb334-5" aria-hidden="true" tabindex="-1"></a><span class="do">## in the above equations. Can you see the differences?</span></span>
<span id="cb334-6"><a href="consumer-resource-competition-and-mutualisms.html#cb334-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-7"><a href="consumer-resource-competition-and-mutualisms.html#cb334-7" aria-hidden="true" tabindex="-1"></a>cr_bimut <span class="ot">&lt;-</span> <span class="cf">function</span>(t,y,parameters) {</span>
<span id="cb334-8"><a href="consumer-resource-competition-and-mutualisms.html#cb334-8" aria-hidden="true" tabindex="-1"></a>  M1 <span class="ot">&lt;-</span> y[<span class="dv">1</span>] <span class="co"># </span></span>
<span id="cb334-9"><a href="consumer-resource-competition-and-mutualisms.html#cb334-9" aria-hidden="true" tabindex="-1"></a>  M2 <span class="ot">&lt;-</span> y[<span class="dv">2</span>] <span class="co"># </span></span>
<span id="cb334-10"><a href="consumer-resource-competition-and-mutualisms.html#cb334-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>( <span class="fu">as.list</span>( parameters ), {</span>
<span id="cb334-11"><a href="consumer-resource-competition-and-mutualisms.html#cb334-11" aria-hidden="true" tabindex="-1"></a>    dM1 <span class="ot">&lt;-</span> M1 <span class="sc">*</span> (r1 <span class="sc">-</span> d1<span class="sc">*</span>M1 <span class="sc">+</span> a12<span class="sc">*</span>M2<span class="sc">/</span>(h2 <span class="sc">+</span> M2) <span class="sc">-</span> B1<span class="sc">*</span>M2<span class="sc">/</span>(e1<span class="sc">+</span>M1) )</span>
<span id="cb334-12"><a href="consumer-resource-competition-and-mutualisms.html#cb334-12" aria-hidden="true" tabindex="-1"></a>    dM2 <span class="ot">&lt;-</span> M2 <span class="sc">*</span> (r2 <span class="sc">-</span> d2<span class="sc">*</span>M2 <span class="sc">+</span> a21<span class="sc">*</span>M1<span class="sc">/</span>(h1 <span class="sc">+</span> M1) <span class="sc">-</span> B2<span class="sc">*</span>M1<span class="sc">/</span>(e2<span class="sc">+</span>M2) )</span>
<span id="cb334-13"><a href="consumer-resource-competition-and-mutualisms.html#cb334-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>( <span class="fu">c</span>( dM1, dM2 ))</span>
<span id="cb334-14"><a href="consumer-resource-competition-and-mutualisms.html#cb334-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb334-15"><a href="consumer-resource-competition-and-mutualisms.html#cb334-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb334-16"><a href="consumer-resource-competition-and-mutualisms.html#cb334-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>And here are the parameters, and we graph the time series.</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="consumer-resource-competition-and-mutualisms.html#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="do">### These parameters create a unidirectional, resource-service mutualism (B2 = 0)</span></span>
<span id="cb335-2"><a href="consumer-resource-competition-and-mutualisms.html#cb335-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Translating, a12 = a above, and a21 = ea above, and B1 = s above</span></span>
<span id="cb335-3"><a href="consumer-resource-competition-and-mutualisms.html#cb335-3" aria-hidden="true" tabindex="-1"></a><span class="do">## therefore e = a21/a12</span></span>
<span id="cb335-4"><a href="consumer-resource-competition-and-mutualisms.html#cb335-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-5"><a href="consumer-resource-competition-and-mutualisms.html#cb335-5" aria-hidden="true" tabindex="-1"></a>p.u <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">r1 =</span> <span class="dv">1</span>, <span class="at">r2 =</span> <span class="dv">1</span>, <span class="at">d1=</span><span class="fl">0.01</span>, <span class="at">d2=</span><span class="fl">0.01</span>, </span>
<span id="cb335-6"><a href="consumer-resource-competition-and-mutualisms.html#cb335-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">a12 =</span> <span class="fl">0.4</span>, <span class="at">a21 =</span> <span class="fl">0.25</span>, <span class="at">B1 =</span> <span class="fl">0.3</span>, <span class="at">B2 =</span> <span class="dv">0</span>, </span>
<span id="cb335-7"><a href="consumer-resource-competition-and-mutualisms.html#cb335-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">h1=</span><span class="fl">0.3</span>, <span class="at">h2=</span><span class="fl">0.3</span>, <span class="at">e1=</span><span class="fl">0.3</span>, <span class="at">e2=</span><span class="fl">0.3</span>)</span>
<span id="cb335-8"><a href="consumer-resource-competition-and-mutualisms.html#cb335-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-9"><a href="consumer-resource-competition-and-mutualisms.html#cb335-9" aria-hidden="true" tabindex="-1"></a><span class="do">#####</span></span>
<span id="cb335-10"><a href="consumer-resource-competition-and-mutualisms.html#cb335-10" aria-hidden="true" tabindex="-1"></a><span class="co"># times series</span></span>
<span id="cb335-11"><a href="consumer-resource-competition-and-mutualisms.html#cb335-11" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">25</span>, <span class="at">by=</span>.<span class="dv">1</span>)</span>
<span id="cb335-12"><a href="consumer-resource-competition-and-mutualisms.html#cb335-12" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">M1=</span><span class="dv">50</span>, <span class="at">M2=</span><span class="dv">1</span>)</span>
<span id="cb335-13"><a href="consumer-resource-competition-and-mutualisms.html#cb335-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-14"><a href="consumer-resource-competition-and-mutualisms.html#cb335-14" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="at">y=</span>y, <span class="at">times=</span>t, <span class="at">func=</span> cr_bimut, <span class="at">parms=</span>p.u)</span>
<span id="cb335-15"><a href="consumer-resource-competition-and-mutualisms.html#cb335-15" aria-hidden="true" tabindex="-1"></a>outdf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(out)</span>
<span id="cb335-16"><a href="consumer-resource-competition-and-mutualisms.html#cb335-16" aria-hidden="true" tabindex="-1"></a>outL <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(outdf, <span class="sc">-</span>time, </span>
<span id="cb335-17"><a href="consumer-resource-competition-and-mutualisms.html#cb335-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">names_to=</span><span class="st">&quot;State_var&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;N&quot;</span>)</span>
<span id="cb335-18"><a href="consumer-resource-competition-and-mutualisms.html#cb335-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(outL, <span class="fu">aes</span>(time, N, <span class="at">colour=</span>State_var)) <span class="sc">+</span> <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="figs/unnamed-chunk-149-1.png" width="90%" /></p>
<p>The dynamics can result in <em>multiple basins of attraction</em> or <em>alternative stable states</em> (Fig. <a href="consumer-resource-competition-and-mutualisms.html#fig:mba">11.5</a>).</p>
<div class="figure"><span style="display:block;" id="fig:mba"></span>
<img src="figs/mba-1.png" alt="A resource-service mutualism may result in alternative stable states. If both species achieve moderate abundance, then both species increase toward a stable mutualism. However, if the frugivore is too abundant relative to the plant, then its consumption dominates the interaction and drives the equilibrium mutualism." width="75%" />
<p class="caption">
Figure 11.5: A resource-service mutualism may result in alternative stable states. If both species achieve moderate abundance, then both species increase toward a stable mutualism. However, if the frugivore is too abundant relative to the plant, then its consumption dominates the interaction and drives the equilibrium mutualism.
</p>
</div>
<p>Holland and DeAngelis (2009) vary <span class="math inline">\(a_{21}\)</span> between <span class="math inline">\((0.25,\ldots,\,0.4)\)</span> to vary the relation from mutualism to predation. Try that now. Save a picture of your results.</p>
</div>
</div>
<div id="plant-soil-feedbacks" class="section level2" number="11.5">
<h2><span class="header-section-number">11.5</span> Plant-soil feedbacks</h2>
<p>Vascular plants form the basis of terrestrial
ecosystems, and they live in intimate contact with the most diverse
group of organisms on Earth–soil microbes. Ecologists have
begun to focus on this intimate relationship, and Jim Bever <span class="citation">(<a href="#ref-Bever2003" role="doc-biblioref">Bever 2003</a>)</span> has been
one of ecologists helping lead the way (Fig. <a href="consumer-resource-competition-and-mutualisms.html#fig:beverfig">11.6</a>).</p>
<div class="figure"><span style="display:block;" id="fig:beverfig"></span>
<img src="figs/beverfig-1.png" alt="Plants and soil microbes can interact in negative or positive ways. Plants may grow more poorly with their own soil flora than with that of a competitor's." width="75%" />
<p class="caption">
Figure 11.6: Plants and soil microbes can interact in negative or positive ways. Plants may grow more poorly with their own soil flora than with that of a competitor’s.
</p>
</div>
<p>Fig. <a href="consumer-resource-competition-and-mutualisms.html#fig:beverfig">11.6</a> reflects the following Lotka-Volterra style model of plant species <span class="math inline">\(N_A\)</span> and <span class="math inline">\(N_B\)</span>, and soil microbial floras <span class="math inline">\(S_A\)</span> and <span class="math inline">\(S_B\)</span>:
<span class="math display">\[\begin{equation}
\frac{dN_A}{dt} = r_A N_A \left( 1 + \alpha_A S_A + \beta_A S_B -
                                   \frac{N_A + c_B N_B}{K_A}\right) 
\end{equation}\]</span>
where the effects of microbes (<span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span>) could be positive or negative (e.g. pathogenic). The plants each have their own carrying capacities (<span class="math inline">\(K\)</span>), and negative effects on each other (<span class="math inline">\(c\)</span>).</p>
<p>The corresponding equation for the other plant species is
<span class="math display">\[\begin{equation}
\frac{dN_B}{dt} = r_B N_B \left( 1 + \alpha_B S_A + \beta_B S_B -
                                   \frac{c_A N_A + N_B}{K_B}\right).
\end{equation}\]</span></p>
<p>We often refer to the soil flora associated with a single plant species as its <em>home</em> flora, and the other as the <em>away</em> flora. Each microbial flora comprises many, many species and we aggregate the net effects. Bever (2003) further simplified his model by placing constraints on soil microbes, so that <span class="math inline">\(S_A + S_B=1\)</span>. This allows him to focus on the relations among microbes and plants. With these assumptions, he showed that the net effect of each flora as a single state variable for the home flora of each species:
<span class="math display">\[\frac{dS_A}{dt} = S_A(1-S_A) \left( \frac{N_A}{N_A + N_B} - \nu\frac{N_B}{N_A + N_B}\right)\]</span>
and that <span class="math display">\[S_B=1-S_A\]</span>.</p>
<p><strong>Coexistence criteria</strong>
Bever states that (2003, p. 467, bottom of the second column) out that the interactions are more stable if
<span class="math display">\[\alpha_A + \beta_B &lt; \alpha_B + \beta_A \]</span>
which means that the effects of the home floras own their home plants are less positive (or more negative) then on the other species.</p>
<p>Bever also argued that for either plant species to increase when rare (i.e. coexist), that the interspecific competition has to be less than the benefits of the interactions of the soil floras. However, his criterion in eqn 5 (p. 469) is not sufficient, and this is revealed by its lack of consistency with the parameter set and outcomes in Fig. 4. So, we will alter his equation a bit to reveal what probably would work. We use the parameterization from Chapter <a href="#Competition"><strong>??</strong></a> so that it is consistent with others <span class="citation">(<a href="#ref-Bolker2003a" role="doc-biblioref">Bolker, Pacala, and Neuhauser 2003</a>; <a href="#ref-Chesson2000a" role="doc-biblioref">Chesson 2000b</a>)</span>. We reformulate the carrying capacities and <span class="math inline">\(c_A\)</span> and <span class="math inline">\(c_B\)</span> as</p>
<p><span class="math display">\[\alpha_{AA}=1/K_A;\,\alpha_{BB}=K_B;\,\alpha_{BA}= c_A/K_B;\,\alpha_{AB}=c_B/K_A\]</span>
If we recall our earlier work, we showed that each species <span class="math inline">\(i\)</span> can invade when
<span class="math display">\[\frac{\alpha_{ij}}{\alpha_{jj}} &lt; 0\]</span>
This translates to the Lotka-Volterra invasion criterion for species A is
<span class="math display">\[\frac{\alpha_{AB}}{\alpha_{BB}} =\frac{c_b}{K_A}K_B\]</span>
The invasion criterion for species B is
<span class="math display">\[\frac{\alpha_{BA}}{\alpha_{AA}} =\frac{c_a}{K_B}K_A\]</span>
The coexistence criterion is that each species must be able to invade when rare, including when the soil flora has no effect. Therefore, we have</p>
<p><span class="math display" id="eq:bevercrit">\[\begin{equation}
\left(\frac{c_b}{K_A}K_B,\, \frac{c_a}{K_B}K_A\right) &lt; \frac{(1+\alpha_B)(1+\beta_A)}{(1+\alpha_A)(1+\beta_B)}
\tag{11.1}
\end{equation}\]</span></p>
<p>where both conditions on the left must be satisfied. In the numerator on the right, we have the effect of each soil flora on their away plant species. In the denominator, we have the effects of each flora on the home plant species. Thus, the fraction on the right is the relative benefit of the soil flora.</p>
<p>Now we will create an ODE function that will let us see the dynamics play out. We need only model one soil flora because <span class="math inline">\(S_B = 1-S_A\)</span>.</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="consumer-resource-competition-and-mutualisms.html#cb336-1" aria-hidden="true" tabindex="-1"></a>bever3 <span class="ot">&lt;-</span> <span class="cf">function</span>(t,y,p){</span>
<span id="cb336-2"><a href="consumer-resource-competition-and-mutualisms.html#cb336-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(y,p)), {</span>
<span id="cb336-3"><a href="consumer-resource-competition-and-mutualisms.html#cb336-3" aria-hidden="true" tabindex="-1"></a>    dNa <span class="ot">&lt;-</span> ra <span class="sc">*</span> Na <span class="sc">*</span> (<span class="dv">1</span><span class="sc">+</span>alphaA<span class="sc">*</span>SA <span class="sc">+</span> betaA<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>SA) <span class="sc">-</span> (Na <span class="sc">+</span> cB<span class="sc">*</span>Nb)<span class="sc">/</span>Ka)</span>
<span id="cb336-4"><a href="consumer-resource-competition-and-mutualisms.html#cb336-4" aria-hidden="true" tabindex="-1"></a>    dNb <span class="ot">&lt;-</span> rb <span class="sc">*</span> Nb <span class="sc">*</span> (<span class="dv">1</span><span class="sc">+</span>alphaB<span class="sc">*</span>SA <span class="sc">+</span> betaB<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>SA) <span class="sc">-</span> (cA<span class="sc">*</span>Na <span class="sc">+</span> Nb)<span class="sc">/</span>Kb)</span>
<span id="cb336-5"><a href="consumer-resource-competition-and-mutualisms.html#cb336-5" aria-hidden="true" tabindex="-1"></a>    dSA <span class="ot">&lt;-</span> SA<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>SA) <span class="sc">*</span> ( Na<span class="sc">/</span>(Na<span class="sc">+</span>Nb) <span class="sc">-</span> nu<span class="sc">*</span>Nb<span class="sc">/</span>(Na<span class="sc">+</span>Nb) )</span>
<span id="cb336-6"><a href="consumer-resource-competition-and-mutualisms.html#cb336-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dNa, dNb, dSA), <span class="at">SB=</span><span class="dv">1</span><span class="sc">-</span>SA))</span>
<span id="cb336-7"><a href="consumer-resource-competition-and-mutualisms.html#cb336-7" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb336-8"><a href="consumer-resource-competition-and-mutualisms.html#cb336-8" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
<p>We will parameterize the model in a way that reveals the importance of the soil floras to coexistence, according to criteria stated above <a href="consumer-resource-competition-and-mutualisms.html#eq:bevercrit">(11.1)</a>. We will create a vector of parameters, and then test whether the inequality in <a href="consumer-resource-competition-and-mutualisms.html#eq:bevercrit">(11.1)</a> is true. We start with an absence of a soil flora effect.</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="consumer-resource-competition-and-mutualisms.html#cb337-1" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">ra=</span><span class="fl">0.7</span>, <span class="at">rb=</span><span class="fl">0.5</span>, <span class="at">Ka =</span> <span class="dv">10</span>, <span class="at">Kb=</span><span class="dv">12</span>, <span class="at">cA=</span>.<span class="dv">98</span>, <span class="at">cB=</span>.<span class="dv">98</span>, </span>
<span id="cb337-2"><a href="consumer-resource-competition-and-mutualisms.html#cb337-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">alphaA=</span><span class="dv">0</span>, <span class="at">alphaB=</span><span class="dv">0</span>, <span class="at">betaA=</span><span class="dv">0</span>, <span class="at">betaB=</span><span class="dv">0</span>, <span class="at">nu=</span><span class="fl">0.8</span>)</span></code></pre></div>
<p>Use the criterion above, and paper and a pencil, and see what you discover. We could also do it in R.</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="consumer-resource-competition-and-mutualisms.html#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(p0, { cA<span class="sc">/</span>Kb<span class="sc">*</span>Ka  <span class="sc">&lt;</span> (<span class="dv">1</span><span class="sc">+</span>alphaB)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>betaA) <span class="sc">/</span> ( (<span class="dv">1</span><span class="sc">+</span>alphaA)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>betaB)) })</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="consumer-resource-competition-and-mutualisms.html#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(p0, { cB<span class="sc">/</span>Ka<span class="sc">*</span>Kb <span class="sc">&lt;</span> (<span class="dv">1</span><span class="sc">+</span>alphaB)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>betaA) <span class="sc">/</span> ( (<span class="dv">1</span><span class="sc">+</span>alphaA)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>betaB)) })</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<pre><code>                                                                            This shows us we will not get coexistence in the absence of soil flora. Now we add the soil flora.
                                                                            </code></pre>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="consumer-resource-competition-and-mutualisms.html#cb343-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">ra=</span><span class="fl">0.7</span>, <span class="at">rb=</span><span class="fl">0.5</span>, <span class="at">Ka =</span> <span class="dv">10</span>, <span class="at">Kb=</span><span class="dv">12</span>, <span class="at">cA=</span>.<span class="dv">98</span>, <span class="at">cB=</span>.<span class="dv">98</span>, <span class="at">alphaA=</span><span class="sc">-</span><span class="fl">0.03</span>, <span class="at">alphaB=</span><span class="fl">0.1</span>, <span class="at">betaA=</span><span class="fl">0.1</span>, <span class="at">betaB=</span><span class="sc">-</span><span class="fl">0.2</span>, <span class="at">nu=</span><span class="fl">0.8</span>)</span></code></pre></div>
<p>Try your hand again, with paper and pencil. And then do it in R.</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="consumer-resource-competition-and-mutualisms.html#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(p, { cA<span class="sc">/</span>Kb<span class="sc">*</span>Ka  <span class="sc">&lt;</span> (<span class="dv">1</span><span class="sc">+</span>alphaB)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>betaA) <span class="sc">/</span> ( (<span class="dv">1</span><span class="sc">+</span>alphaA)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>betaB)) })</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="consumer-resource-competition-and-mutualisms.html#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(p, { cB<span class="sc">/</span>Ka<span class="sc">*</span>Kb <span class="sc">&lt;</span> (<span class="dv">1</span><span class="sc">+</span>alphaB)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>betaA) <span class="sc">/</span> ( (<span class="dv">1</span><span class="sc">+</span>alphaA)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>betaB)) })</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
On this basis, we should see that each species can invade when rare.
Now let’s see the dynamics play out.
<div class="figure"><span style="display:block;" id="fig:beverplot"></span>
<img src="figs/beverplot-1.png" alt="Dynamics of competing plant species, subject to self-limiting negative feedbacks with soil pathogens." width="50%" /><img src="figs/beverplot-2.png" alt="Dynamics of competing plant species, subject to self-limiting negative feedbacks with soil pathogens." width="50%" />
<p class="caption">
Figure 11.7: Dynamics of competing plant species, subject to self-limiting negative feedbacks with soil pathogens.
</p>
</div>
</div>
<div id="simulations-for-learning" class="section level2" number="11.6">
<h2><span class="header-section-number">11.6</span> Simulations for learning</h2>
<p>Often, we learn a lot by describing interactions in simple enough terms that we can analyze the interaction analytically, such as the way we analyzed Lotka-Volterra competition and mutualism. In more complex cases, we often cannot find an analytical, or <em>closed form</em>, solution, or if we do, it is so complex that it is difficult to extract meaning. In those cases, we may be able to learn a lot about the consequences of our model’s assumptions through simulation. Using simulation, we examine the observed dynamics for a wide range of parameter values and then infer general rules about how parameters or parameter combinations influence dynamics.</p>
<p>In this study, we will use simulations to attempt to determine rules that govern the long-term dynamics of the mutualism model with linear density dependence in both intra- and interspecific interactions. We will also use simulation to confirm our earlier analytical solution and <em>vice versa</em>.</p>
<div id="lvg" class="section level3" number="11.6.1">
<h3><span class="header-section-number">11.6.1</span> <code>lvg()</code></h3>
<p>The core of our simulations will use a general purpose Lotka-Volterra model that simpy takes an interaction matrix and <span class="math inline">\(r\)</span> as inputs.</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="consumer-resource-competition-and-mutualisms.html#cb348-1" aria-hidden="true" tabindex="-1"></a>lvg <span class="ot">&lt;-</span> <span class="cf">function</span> (time, n, parameters) </span>
<span id="cb348-2"><a href="consumer-resource-competition-and-mutualisms.html#cb348-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb348-3"><a href="consumer-resource-competition-and-mutualisms.html#cb348-3" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> parameters[[<span class="dv">1</span>]]</span>
<span id="cb348-4"><a href="consumer-resource-competition-and-mutualisms.html#cb348-4" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> parameters[[<span class="dv">2</span>]]</span>
<span id="cb348-5"><a href="consumer-resource-competition-and-mutualisms.html#cb348-5" aria-hidden="true" tabindex="-1"></a>  dns.dt <span class="ot">&lt;-</span> r <span class="sc">*</span> n <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> (a <span class="sc">%*%</span> n))</span>
<span id="cb348-6"><a href="consumer-resource-competition-and-mutualisms.html#cb348-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dns.dt)))</span>
<span id="cb348-7"><a href="consumer-resource-competition-and-mutualisms.html#cb348-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>In this model, the parameters are a <em>list</em> (a type of R data object) with two components. The first is a vector of <em>r</em>, one for each species we want to model. The second component of the list is the matrix of interaction coefficients. This matrix is square (same number of rows and columns). The elements of this matrix must have the correct sign. For instance, to represent competition, the relevant elements would have to be negative.</p>
<p>Here we create an interaction matrix for a two-species Lotka-Volterra mutualism, where each species suffers from intraspecific competition, and benefits from its mutualist.</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="consumer-resource-competition-and-mutualisms.html#cb349-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>( <span class="sc">-</span>.<span class="dv">1</span>, .<span class="dv">02</span>,</span>
<span id="cb349-2"><a href="consumer-resource-competition-and-mutualisms.html#cb349-2" aria-hidden="true" tabindex="-1"></a>               .<span class="dv">02</span>, <span class="sc">-</span>.<span class="dv">09</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb349-3"><a href="consumer-resource-competition-and-mutualisms.html#cb349-3" aria-hidden="true" tabindex="-1"></a>a</span></code></pre></div>
<pre><code>##       [,1]  [,2]
## [1,] -0.10  0.02
## [2,]  0.02 -0.09</code></pre>
<p>Now let’s numerically integrate, or simulate, the model and plot the outcome. Comment your code to help remind you what is going on.</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="consumer-resource-competition-and-mutualisms.html#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let r be the same fpor each species</span></span>
<span id="cb351-2"><a href="consumer-resource-competition-and-mutualisms.html#cb351-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb351-3"><a href="consumer-resource-competition-and-mutualisms.html#cb351-3" aria-hidden="true" tabindex="-1"></a>parms <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">r=</span>r, <span class="at">a=</span>a)</span>
<span id="cb351-4"><a href="consumer-resource-competition-and-mutualisms.html#cb351-4" aria-hidden="true" tabindex="-1"></a>parms</span></code></pre></div>
<pre><code>## $r
## [1] 1 1
## 
## $a
##       [,1]  [,2]
## [1,] -0.10  0.02
## [2,]  0.02 -0.09</code></pre>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="consumer-resource-competition-and-mutualisms.html#cb353-1" aria-hidden="true" tabindex="-1"></a>t<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">30</span>, <span class="at">by=</span>.<span class="dv">1</span>)</span>
<span id="cb353-2"><a href="consumer-resource-competition-and-mutualisms.html#cb353-2" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">N1=</span><span class="dv">20</span>, <span class="at">N2=</span><span class="dv">5</span>)</span>
<span id="cb353-3"><a href="consumer-resource-competition-and-mutualisms.html#cb353-3" aria-hidden="true" tabindex="-1"></a>lvout <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>( <span class="fu">ode</span>(N0, t, lvg, parms) )</span>
<span id="cb353-4"><a href="consumer-resource-competition-and-mutualisms.html#cb353-4" aria-hidden="true" tabindex="-1"></a>lvL <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(lvout, <span class="sc">-</span>time, <span class="at">names_to=</span><span class="st">&quot;State_vars&quot;</span>, </span>
<span id="cb353-5"><a href="consumer-resource-competition-and-mutualisms.html#cb353-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">values_to=</span><span class="st">&quot;N&quot;</span>)</span>
<span id="cb353-6"><a href="consumer-resource-competition-and-mutualisms.html#cb353-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-7"><a href="consumer-resource-competition-and-mutualisms.html#cb353-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lvL, <span class="fu">aes</span>(time, N, <span class="at">colour=</span>State_vars, <span class="at">linetype=</span>State_vars)) <span class="sc">+</span> </span>
<span id="cb353-8"><a href="consumer-resource-competition-and-mutualisms.html#cb353-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb353-9"><a href="consumer-resource-competition-and-mutualisms.html#cb353-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>a[<span class="dv">1</span>,<span class="dv">1</span>], <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>a[<span class="dv">2</span>,<span class="dv">2</span>]), <span class="at">linetype=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb353-10"><a href="consumer-resource-competition-and-mutualisms.html#cb353-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom=</span><span class="st">&quot;text&quot;</span>, </span>
<span id="cb353-11"><a href="consumer-resource-competition-and-mutualisms.html#cb353-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">x=</span><span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">20</span>),<span class="at">y=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>a[<span class="dv">1</span>,<span class="dv">1</span>], <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>a[<span class="dv">2</span>,<span class="dv">2</span>]), <span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;K1&quot;</span>, <span class="st">&quot;K2&quot;</span>), <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.2</span> )</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-158"></span>
<img src="figs/unnamed-chunk-158-1.png" alt="Dyanmics of a Lotka-Volterra mutualism. " width="90%" />
<p class="caption">
Figure 11.8: Dyanmics of a Lotka-Volterra mutualism.
</p>
</div>
</div>
<div id="systematic-simulations" class="section level3" number="11.6.2">
<h3><span class="header-section-number">11.6.2</span> Systematic simulations</h3>
<p>When we use a model to explore the consequences of our assumptions, we want to use a range of plausible assumptions. In a case like this one where we are exploring a model more than the natural phenomenon it represents, we should use a wide range of parameter values that include cases where it is likely to fail. In our case, we will hold intraspecific density dependence constant and vary interspecific interaction coefficients from zero to twice the value of intraspecific interactions.</p>
<p>We start with building the bits and pieces that the simulation will use, and then use a for-loop to cycle through all the parameter combinations we are interested in.</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="consumer-resource-competition-and-mutualisms.html#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use expand.grid to create systematically combinations of parameters</span></span>
<span id="cb354-2"><a href="consumer-resource-competition-and-mutualisms.html#cb354-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">a11 =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">a12=</span><span class="fu">seq</span>(<span class="dv">0</span>, .<span class="dv">2</span>, <span class="at">by =</span>.<span class="dv">02</span>),</span>
<span id="cb354-3"><a href="consumer-resource-competition-and-mutualisms.html#cb354-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">a21 =</span> <span class="fu">seq</span>(<span class="dv">0</span>, .<span class="dv">2</span>, <span class="at">by=</span>.<span class="dv">02</span>),  <span class="at">a22=</span><span class="sc">-</span><span class="fl">0.1</span> )</span>
<span id="cb354-4"><a href="consumer-resource-competition-and-mutualisms.html#cb354-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(df) <span class="co"># The number of rows and columns</span></span></code></pre></div>
<pre><code>## [1] 121   4</code></pre>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="consumer-resource-competition-and-mutualisms.html#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df) <span class="co"># the top of the data frame</span></span></code></pre></div>
<pre><code>##    a11  a12 a21  a22
## 1 -0.1 0.00   0 -0.1
## 2 -0.1 0.02   0 -0.1
## 3 -0.1 0.04   0 -0.1
## 4 -0.1 0.06   0 -0.1
## 5 -0.1 0.08   0 -0.1
## 6 -0.1 0.10   0 -0.1</code></pre>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="consumer-resource-competition-and-mutualisms.html#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set intrinsic rates of increase...</span></span>
<span id="cb358-2"><a href="consumer-resource-competition-and-mutualisms.html#cb358-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb358-3"><a href="consumer-resource-competition-and-mutualisms.html#cb358-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-4"><a href="consumer-resource-competition-and-mutualisms.html#cb358-4" aria-hidden="true" tabindex="-1"></a><span class="co"># and starting values...</span></span>
<span id="cb358-5"><a href="consumer-resource-competition-and-mutualisms.html#cb358-5" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">N1 =</span> <span class="dv">10</span>, <span class="at">N2=</span> <span class="fl">10.001</span>)</span>
<span id="cb358-6"><a href="consumer-resource-competition-and-mutualisms.html#cb358-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-7"><a href="consumer-resource-competition-and-mutualisms.html#cb358-7" aria-hidden="true" tabindex="-1"></a><span class="co"># and times for which to return output.</span></span>
<span id="cb358-8"><a href="consumer-resource-competition-and-mutualisms.html#cb358-8" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">200</span></span>
<span id="cb358-9"><a href="consumer-resource-competition-and-mutualisms.html#cb358-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-10"><a href="consumer-resource-competition-and-mutualisms.html#cb358-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Set values that will be useful later on in our for-loop.</span></span>
<span id="cb358-11"><a href="consumer-resource-competition-and-mutualisms.html#cb358-11" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>( t <span class="sc">+</span> <span class="dv">1</span> )</span>
<span id="cb358-12"><a href="consumer-resource-competition-and-mutualisms.html#cb358-12" aria-hidden="true" tabindex="-1"></a>npar <span class="ot">&lt;-</span> <span class="fu">nrow</span>( df ) </span>
<span id="cb358-13"><a href="consumer-resource-competition-and-mutualisms.html#cb358-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-14"><a href="consumer-resource-competition-and-mutualisms.html#cb358-14" aria-hidden="true" tabindex="-1"></a><span class="co"># create an empty data frame to hold our simulation output.</span></span>
<span id="cb358-15"><a href="consumer-resource-competition-and-mutualisms.html#cb358-15" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="at">t =</span> <span class="fu">numeric</span>(npar), <span class="at">N1 =</span> <span class="fu">numeric</span>( npar ), </span>
<span id="cb358-16"><a href="consumer-resource-competition-and-mutualisms.html#cb358-16" aria-hidden="true" tabindex="-1"></a>                      <span class="at">N2 =</span> <span class="fu">numeric</span>( npar ) )</span>
<span id="cb358-17"><a href="consumer-resource-competition-and-mutualisms.html#cb358-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-18"><a href="consumer-resource-competition-and-mutualisms.html#cb358-18" aria-hidden="true" tabindex="-1"></a><span class="do">### USE A  FOR-LOOP TO INTEGRATE THE MODEL FOR EACH COMBINATION OF PARAMETERS</span></span>
<span id="cb358-19"><a href="consumer-resource-competition-and-mutualisms.html#cb358-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>npar ) {</span>
<span id="cb358-20"><a href="consumer-resource-competition-and-mutualisms.html#cb358-20" aria-hidden="true" tabindex="-1"></a>  coefs.true <span class="ot">&lt;-</span> <span class="fu">matrix</span>( <span class="fu">as.numeric</span>( df[i,] ), </span>
<span id="cb358-21"><a href="consumer-resource-competition-and-mutualisms.html#cb358-21" aria-hidden="true" tabindex="-1"></a>                        <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb358-22"><a href="consumer-resource-competition-and-mutualisms.html#cb358-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(</span>
<span id="cb358-23"><a href="consumer-resource-competition-and-mutualisms.html#cb358-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">capture.output</span>( </span>
<span id="cb358-24"><a href="consumer-resource-competition-and-mutualisms.html#cb358-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># capture.output is a function that allows us to avoid seeing warnings...</span></span>
<span id="cb358-25"><a href="consumer-resource-competition-and-mutualisms.html#cb358-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># not usually a good idea to ignore warnings!!!</span></span>
<span id="cb358-26"><a href="consumer-resource-competition-and-mutualisms.html#cb358-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># but it is OK here....</span></span>
<span id="cb358-27"><a href="consumer-resource-competition-and-mutualisms.html#cb358-27" aria-hidden="true" tabindex="-1"></a>    lvout <span class="ot">&lt;-</span> <span class="fu">ode</span>(N0, t, lvg, <span class="at">parms =</span> <span class="fu">list</span>(r, coefs.true) )</span>
<span id="cb358-28"><a href="consumer-resource-competition-and-mutualisms.html#cb358-28" aria-hidden="true" tabindex="-1"></a>  ) )</span>
<span id="cb358-29"><a href="consumer-resource-competition-and-mutualisms.html#cb358-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb358-30"><a href="consumer-resource-competition-and-mutualisms.html#cb358-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># hang on to only the last row of output, and  </span></span>
<span id="cb358-31"><a href="consumer-resource-competition-and-mutualisms.html#cb358-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># put it in the i-th row of our output data frame.</span></span>
<span id="cb358-32"><a href="consumer-resource-competition-and-mutualisms.html#cb358-32" aria-hidden="true" tabindex="-1"></a>  last <span class="ot">&lt;-</span> <span class="fu">nrow</span>(lvout)</span>
<span id="cb358-33"><a href="consumer-resource-competition-and-mutualisms.html#cb358-33" aria-hidden="true" tabindex="-1"></a>   output[i,] <span class="ot">&lt;-</span> lvout[last,]</span>
<span id="cb358-34"><a href="consumer-resource-competition-and-mutualisms.html#cb358-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb358-35"><a href="consumer-resource-competition-and-mutualisms.html#cb358-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-36"><a href="consumer-resource-competition-and-mutualisms.html#cb358-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine columns of parameters and output.</span></span>
<span id="cb358-37"><a href="consumer-resource-competition-and-mutualisms.html#cb358-37" aria-hidden="true" tabindex="-1"></a>simdat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(df, output)</span></code></pre></div>
</div>
<div id="checking-simulation-results" class="section level3" number="11.6.3">
<h3><span class="header-section-number">11.6.3</span> Checking simulation results</h3>
<p>Let’s look for anomalous results, such as negative population sizes, or infinite or “too” large sizes.</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="consumer-resource-competition-and-mutualisms.html#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Do simplistic numerical summaries.</span></span>
<span id="cb359-2"><a href="consumer-resource-competition-and-mutualisms.html#cb359-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(simdat[,<span class="dv">5</span><span class="sc">:</span><span class="dv">7</span>])</span></code></pre></div>
<pre><code>##        t                  N1                   N2            
##  Min.   :  0.6931   Min.   : 1.000e+01   Min.   : 1.000e+01  
##  1st Qu.:  1.5576   1st Qu.: 2.100e+01   1st Qu.: 2.100e+01  
##  Median :200.0000   Median : 7.000e+01   Median : 7.000e+01  
##  Mean   :122.9019   Mean   :3.355e+146   Mean   :3.355e+146  
##  3rd Qu.:200.0000   3rd Qu.:8.858e+145   3rd Qu.:8.858e+145  
##  Max.   :200.0000   Max.   :8.187e+147   Max.   :8.187e+147</code></pre>
<p>If we run this, we see some strange population sizes and time was not always 200, showing that the numerical integration failed before completing. Also, <span class="math inline">\(N\)</span> included unreasonably large values.</p>
<p>Let’s look for all rows in which <em>either</em> <span class="math inline">\(N_1\)</span> <em>or</em> <span class="math inline">\(N_2\)</span> are huge (<span class="math inline">\(&gt; 10\,000\)</span>).</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="consumer-resource-competition-and-mutualisms.html#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the vertical bar | means &quot;or&quot;</span></span>
<span id="cb361-2"><a href="consumer-resource-competition-and-mutualisms.html#cb361-2" aria-hidden="true" tabindex="-1"></a>sim.N <span class="ot">&lt;-</span> <span class="fu">subset</span>(simdat, N1 <span class="sc">&gt;</span> <span class="dv">10000</span> <span class="sc">|</span> N2 <span class="sc">&gt;</span> <span class="dv">10000</span>)</span>
<span id="cb361-3"><a href="consumer-resource-competition-and-mutualisms.html#cb361-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sim.N)</span></code></pre></div>
<pre><code>##     a11  a12  a21  a22        t            N1            N2
## 43 -0.1 0.18 0.06 -0.1 3.241398 2.434044e+103 1.390882e+103
## 44 -0.1 0.20 0.06 -0.1 2.399838  1.164783e+99  6.212179e+98
## 52 -0.1 0.14 0.08 -0.1 2.889456  1.856660e+65  1.392495e+65
## 53 -0.1 0.16 0.08 -0.1 2.139629 1.175804e+109 8.140182e+108
## 54 -0.1 0.18 0.08 -0.1 1.774181 9.054385e+146 5.820676e+146
## 55 -0.1 0.20 0.08 -0.1 1.541959 1.041579e+147 6.249472e+146</code></pre>
<p>Notice also that values for <span class="math inline">\(t\)</span> indicate that the integration couldn’t find values beyond a certain time point. Hmm. For now, let’s assume our simulation is doing what we think it is and that these results indicate a true lack of equilibrium.</p>
<p>What could we do to learn the emerging rules? What if we just plot the values of <span class="math inline">\(\alpha_{ij},\,\alpha_{ji}\)</span> where <span class="math inline">\(N\)</span> is really, really big?</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="consumer-resource-competition-and-mutualisms.html#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sim.N, <span class="fu">aes</span>(a12, a21)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-163"></span>
<img src="figs/unnamed-chunk-163-1.png" alt="*Values of $alpha$ when N is extraordinarily large.*" width="50%" />
<p class="caption">
Figure 11.9: <em>Values of <span class="math inline">\(alpha\)</span> when N is extraordinarily large.</em>
</p>
</div>
<p>What do we learn from just this figure? Write down a possible set of conditions necessary to get these anomalous results.</p>
</div>
<div id="comparing-simulation-results-to-analytical-solutions" class="section level3" number="11.6.4">
<h3><span class="header-section-number">11.6.4</span> Comparing simulation results to analytical solutions</h3>
<p>Any time we do something novel in our modeling, we need to find a way to evaluate the novel approach to make sure it is doing what we think it is. When we have an analytical solution for our model, it is great to compare the analytical solution to the simulations.</p>
<p>One thing we can do is to compare the long-term steady state values we get in simulation to the analytical equilibria of this mutualism model.</p>
<p>First, we find analytical solutions for all of the equilibria predicted by the coefficients. Consult the equilibrium solution in the first section of the chapter. We then compare these to numerical solutions.</p>
<p>Here we calculate the predicted equilibria for each row of our coefficients, using the above solution.</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="consumer-resource-competition-and-mutualisms.html#cb364-1" aria-hidden="true" tabindex="-1"></a>denom <span class="ot">&lt;-</span> simdat[,<span class="dv">1</span>] <span class="sc">*</span> simdat[,<span class="dv">4</span>] <span class="sc">-</span> simdat[,<span class="dv">2</span>] <span class="sc">*</span> simdat[,<span class="dv">3</span>]</span>
<span id="cb364-2"><a href="consumer-resource-competition-and-mutualisms.html#cb364-2" aria-hidden="true" tabindex="-1"></a><span class="co"># note this solution is subtracting the negative intraspecific comp coef.</span></span>
<span id="cb364-3"><a href="consumer-resource-competition-and-mutualisms.html#cb364-3" aria-hidden="true" tabindex="-1"></a><span class="co"># making it consistent with our equations in section 1</span></span>
<span id="cb364-4"><a href="consumer-resource-competition-and-mutualisms.html#cb364-4" aria-hidden="true" tabindex="-1"></a>num1 <span class="ot">&lt;-</span> simdat[,<span class="dv">2</span>] <span class="sc">-</span> simdat[,<span class="dv">4</span>]</span>
<span id="cb364-5"><a href="consumer-resource-competition-and-mutualisms.html#cb364-5" aria-hidden="true" tabindex="-1"></a>num2 <span class="ot">&lt;-</span> simdat[,<span class="dv">3</span>] <span class="sc">-</span> simdat[,<span class="dv">1</span>]</span>
<span id="cb364-6"><a href="consumer-resource-competition-and-mutualisms.html#cb364-6" aria-hidden="true" tabindex="-1"></a>N1.eq <span class="ot">&lt;-</span> num1 <span class="sc">/</span> denom</span>
<span id="cb364-7"><a href="consumer-resource-competition-and-mutualisms.html#cb364-7" aria-hidden="true" tabindex="-1"></a>N2.eq <span class="ot">&lt;-</span>num2 <span class="sc">/</span> denom</span>
<span id="cb364-8"><a href="consumer-resource-competition-and-mutualisms.html#cb364-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb364-9"><a href="consumer-resource-competition-and-mutualisms.html#cb364-9" aria-hidden="true" tabindex="-1"></a><span class="co"># combine with simulation data set</span></span>
<span id="cb364-10"><a href="consumer-resource-competition-and-mutualisms.html#cb364-10" aria-hidden="true" tabindex="-1"></a>sim.check1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(simdat, N1.eq, N2.eq)</span>
<span id="cb364-11"><a href="consumer-resource-competition-and-mutualisms.html#cb364-11" aria-hidden="true" tabindex="-1"></a><span class="co"># sim.check1[order(sim.check1$a12, sim.check1$a21),]</span></span></code></pre></div>
<p>Let’s find the subset with potential problems, such as for <span class="math inline">\(N_1\)</span> or <span class="math inline">\(N_2\)</span> less than than zero or really, really big (<span class="math inline">\(&gt;10000\)</span>).</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="consumer-resource-competition-and-mutualisms.html#cb365-1" aria-hidden="true" tabindex="-1"></a>problems1 <span class="ot">&lt;-</span> <span class="fu">subset</span>(sim.check1, (N1 <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">|</span> N2 <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">|</span> N1 <span class="sc">&gt;</span> <span class="fl">1e4</span> <span class="sc">|</span> N2 <span class="sc">&gt;</span> <span class="fl">1e4</span> ) )</span>
<span id="cb365-2"><a href="consumer-resource-competition-and-mutualisms.html#cb365-2" aria-hidden="true" tabindex="-1"></a><span class="co"># look at the subset</span></span>
<span id="cb365-3"><a href="consumer-resource-competition-and-mutualisms.html#cb365-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(problems1, <span class="fu">aes</span>(N1, N1.eq)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-165"></span>
<img src="figs/unnamed-chunk-165-1.png" alt="*Analytically calculated predictions for $N^*$* vs. observed simulated $N$." width="50%" />
<p class="caption">
Figure 11.10: <em>Analytically calculated predictions for <span class="math inline">\(N^*\)</span></em> vs. observed simulated <span class="math inline">\(N\)</span>.
</p>
</div>
<p>Fascinating! Both the analytical and the simulated results give us wacky, but very different results. Let’s examine the coefficients that generated these results.</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="consumer-resource-competition-and-mutualisms.html#cb366-1" aria-hidden="true" tabindex="-1"></a>problems1[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,]</span></code></pre></div>
<pre><code>##     a11  a12  a21  a22        t            N1            N2      N1.eq
## 43 -0.1 0.18 0.06 -0.1 3.241398 2.434044e+103 1.390882e+103 -350.00000
## 44 -0.1 0.20 0.06 -0.1 2.399838  1.164783e+99  6.212179e+98 -150.00000
## 52 -0.1 0.14 0.08 -0.1 2.889456  1.856660e+65  1.392495e+65 -200.00000
## 53 -0.1 0.16 0.08 -0.1 2.139629 1.175804e+109 8.140182e+108  -92.85714
## 54 -0.1 0.18 0.08 -0.1 1.774181 9.054385e+146 5.820676e+146  -63.63636
##         N2.eq
## 43 -200.00000
## 44  -80.00000
## 52 -150.00000
## 53  -64.28571
## 54  -40.90909</code></pre>
<p>What do you notice about these coefficients?</p>
<ul>
<li>What would you get for each term in the for the analytical equilibrium using the first row of data?</li>
<li>How do you reconcile these results?</li>
</ul>
<p>Once we understand the anomalous results above, let’s compare the simulated and the analytical solutions for <span class="math inline">\(N_1\)</span> and <span class="math inline">\(N_2\)</span> both greater than zero and both less than a huge number.</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="consumer-resource-competition-and-mutualisms.html#cb368-1" aria-hidden="true" tabindex="-1"></a>check2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(sim.check1, (N1.eq <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> N2.eq <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">&amp;</span> (N1 <span class="sc">&lt;</span> <span class="fl">1e4</span> <span class="sc">&amp;</span> N2 <span class="sc">&lt;</span> <span class="fl">1e4</span> ))</span></code></pre></div>
<p>Next we calculate the differences between the analytical solutions and the simulated values.</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="consumer-resource-competition-and-mutualisms.html#cb369-1" aria-hidden="true" tabindex="-1"></a>N1.diff <span class="ot">&lt;-</span> check2<span class="sc">$</span>N1 <span class="sc">-</span> check2<span class="sc">$</span>N1.eq</span>
<span id="cb369-2"><a href="consumer-resource-competition-and-mutualisms.html#cb369-2" aria-hidden="true" tabindex="-1"></a>N2.diff <span class="ot">&lt;-</span> check2<span class="sc">$</span>N2 <span class="sc">-</span> check2<span class="sc">$</span>N2.eq</span>
<span id="cb369-3"><a href="consumer-resource-competition-and-mutualisms.html#cb369-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(N1.diff); <span class="fu">summary</span>(N2.diff)</span></code></pre></div>
<pre><code>##       Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
## -1.421e-14  1.776e-15  3.553e-15  1.363e-13  7.105e-15  3.183e-12</code></pre>
<pre><code>##       Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
## -2.842e-14  1.776e-15  3.553e-15  1.558e-13  7.105e-15  5.230e-12</code></pre>
<p>These summaries show us that the differences between the analytical solutions and the numerical approximations are very, very, very small. That is a good thing. It gives us confidence that our simulations are doing what we think they are doing.</p>
<p>So, we can now tentatively assume that our simulations are doing what we think they are, and we could have confidence with results that we generate.</p>
<p>In practice, sometimes we simulate a very complex model and compare the results with a simpler, tractable analytical solution. Here, we get the hang of the approach by comparing simulations against known solutions.</p>
</div>
<div id="one-last-thing-using-the-jacobian-matrix" class="section level3" number="11.6.5">
<h3><span class="header-section-number">11.6.5</span> One last thing: using the Jacobian matrix</h3>
<p>Use eigenanalysis of the Jacobian matrix to assess the stability of these equilibria. Consult eq. 5.21 and Table 5.2 of Stevens (2009).</p>
<p>A sensible equilibrium.</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="consumer-resource-competition-and-mutualisms.html#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(sim.check1, a12 <span class="sc">==</span> .<span class="dv">02</span> <span class="sc">&amp;</span> a21 <span class="sc">==</span> .<span class="dv">02</span>)</span></code></pre></div>
<pre><code>##     a11  a12  a21  a22   t   N1   N2 N1.eq N2.eq
## 13 -0.1 0.02 0.02 -0.1 200 12.5 12.5  12.5  12.5</code></pre>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="consumer-resource-competition-and-mutualisms.html#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="co"># form remember that we set r = 1</span></span>
<span id="cb374-2"><a href="consumer-resource-competition-and-mutualisms.html#cb374-2" aria-hidden="true" tabindex="-1"></a>J1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span><span class="sc">*</span><span class="fl">12.5</span>, <span class="sc">-</span>.<span class="dv">02</span><span class="sc">*</span><span class="fl">12.5</span>,</span>
<span id="cb374-3"><a href="consumer-resource-competition-and-mutualisms.html#cb374-3" aria-hidden="true" tabindex="-1"></a>               <span class="sc">-</span>.<span class="dv">02</span><span class="sc">*</span><span class="fl">12.5</span>, <span class="sc">-</span>.<span class="dv">1</span><span class="sc">*</span><span class="fl">12.5</span>), <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb374-4"><a href="consumer-resource-competition-and-mutualisms.html#cb374-4" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(J1)</span></code></pre></div>
<pre><code>## eigen() decomposition
## $values
## [1] -1.0 -1.5
## 
## $vectors
##            [,1]      [,2]
## [1,] -0.7071068 0.7071068
## [2,]  0.7071068 0.7071068</code></pre>
<p>What do these results mean?</p>
<p></p>
<p>A nonsensical equilibrium</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="consumer-resource-competition-and-mutualisms.html#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(sim.check1, a12 <span class="sc">==</span> .<span class="dv">2</span> <span class="sc">&amp;</span> a21 <span class="sc">==</span> .<span class="dv">2</span>)</span></code></pre></div>
<pre><code>##      a11 a12 a21  a22         t            N1            N2 N1.eq N2.eq
## 121 -0.1 0.2 0.2 -0.1 0.6931166 8.389656e+145 8.389656e+145   -10   -10</code></pre>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="consumer-resource-competition-and-mutualisms.html#cb378-1" aria-hidden="true" tabindex="-1"></a>J2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>( <span class="fu">c</span>( <span class="sc">-</span>.<span class="dv">1</span><span class="sc">*</span>(<span class="sc">-</span><span class="dv">10</span>), <span class="sc">-</span>.<span class="dv">2</span><span class="sc">*</span>(<span class="sc">-</span><span class="dv">10</span>), </span>
<span id="cb378-2"><a href="consumer-resource-competition-and-mutualisms.html#cb378-2" aria-hidden="true" tabindex="-1"></a>                 <span class="sc">-</span>.<span class="dv">2</span><span class="sc">*</span>(<span class="sc">-</span><span class="dv">10</span>), <span class="sc">-</span>.<span class="dv">1</span><span class="sc">*</span>(<span class="sc">-</span><span class="dv">10</span>)), <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>) </span>
<span id="cb378-3"><a href="consumer-resource-competition-and-mutualisms.html#cb378-3" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(J2)</span></code></pre></div>
<pre><code>## eigen() decomposition
## $values
## [1]  3 -1
## 
## $vectors
##           [,1]       [,2]
## [1,] 0.7071068 -0.7071068
## [2,] 0.7071068  0.7071068</code></pre>
<p>What do these results mean?</p>
</div>
<div id="in-fine-3" class="section level3" number="11.6.6">
<h3><span class="header-section-number">11.6.6</span> <em>In Fine</em></h3>
<p>So, how can you digest and communicate what you have found? You should be able to answer these questions:</p>
<ol style="list-style-type: decimal">
<li>Did the simulation perform as you thought and how do you know?</li>
<li>Did the simulation <em>confirm</em> something we first assessed analytically? If so, how?</li>
<li>How do you explain the differences between the simulations and analytical equilibrium (extremely large vs. negative population sizes)?</li>
</ol>

</div>
</div>
</div>
<h3> References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Bever2003" class="csl-entry">
Bever, James D. 2003. <span>“<span class="nocase">Soil community feedback and the coexistence of competitors: Conceptual frameworks and empirical tests</span>.”</span> <em>New Phytologist</em> 157 (3): 465–73.
</div>
<div id="ref-Bolker2003a" class="csl-entry">
Bolker, B M, S W Pacala, and C Neuhauser. 2003. <span>“<span class="nocase">Spatial dynamics in model plant communities: <span>{</span>W<span>}</span>hat do we really know?</span>”</span> <em>American Naturalist</em> 162: 135–48.
</div>
<div id="ref-Bshary2006" class="csl-entry">
Bshary, Redouan, Andrea Hohner, Karim Ait-el-Djoudi, and Hans Fricke. 2006. <span>“<span class="nocase">Interspecific communicative and coordinated hunting between groupers and giant moray eels in the red sea</span>.”</span> <em>PLoS Biology</em> 4 (12): 2393–98.
</div>
<div id="ref-Chesson2000a" class="csl-entry">
———. 2000b. <span>“<span class="nocase">Mechanisms of maintenance of species diversity</span>.”</span> <em>Annual Review of Ecology and Systematics</em> 31: 343–66.
</div>
<div id="ref-Holland2010" class="csl-entry">
Holland, J. Nathaniel, and Donald L. Deangelis. 2010. <span>“<span class="nocase">A consumer-resource approach to the density-dependent population dynamics of mutualism</span>.”</span> <em>Ecology</em> 91 (5): 1286–95.
</div>
<div id="ref-MacArthur1972" class="csl-entry">
———. 1972. <em><span class="nocase">Geographical Ecology: Patterns in the Distribution of Species</span></em>. New York: Harper <span>&amp;</span> Row.
</div>
<div id="ref-Tilman1982" class="csl-entry">
Tilman, D. 1982. <em><span class="nocase">Resource <span>{</span>C<span>}</span>ompetition and <span>{</span>C<span>}</span>ommunity <span>{</span>S<span>}</span>tructure</span></em>. Monographs in Population Biology. Princeton, NJ: Princeton University Press.
</div>
<div id="ref-Wenny1998" class="csl-entry">
Wenny, D G, and D J Levey. 1998. <span>“<span class="nocase">Directed seed dispersal by bellbirds in a tropical cloud forest.</span>”</span> <em>Proceedings of the National Academy of Sciences of the United States of America</em> 95 (11): 6204–7.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="disease.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="food-webs-and-other-networks.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
