<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>3 Simple density-independent growth | Primer of Ecology using R</title>
<meta name="author" content="Hank Stevens">
<meta name="description" content="Figure 3.1: Song Sparrow (Melospiza melodia) counts in Darrtown, OH, USA. From Sauer, J. R., J.E. Hines, and J. Fallon. 2005. The North American Breeding Bird Survey, Results and Analysis...">
<meta name="generator" content="bookdown 0.27 with bs4_book()">
<meta property="og:title" content="3 Simple density-independent growth | Primer of Ecology using R">
<meta property="og:type" content="book">
<meta property="og:description" content="Figure 3.1: Song Sparrow (Melospiza melodia) counts in Darrtown, OH, USA. From Sauer, J. R., J.E. Hines, and J. Fallon. 2005. The North American Breeding Bird Survey, Results and Analysis...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="3 Simple density-independent growth | Primer of Ecology using R">
<meta name="twitter:description" content="Figure 3.1: Song Sparrow (Melospiza melodia) counts in Darrtown, OH, USA. From Sauer, J. R., J.E. Hines, and J. Fallon. 2005. The North American Breeding Bird Survey, Results and Analysis...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-VCV8MES4YY"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-VCV8MES4YY');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Primer of Ecology using R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="theory.html"><span class="header-section-number">1</span> Theory in Ecology</a></li>
<li><a class="" href="oft.html"><span class="header-section-number">2</span> Optimal Foraging</a></li>
<li><a class="active" href="expo.html"><span class="header-section-number">3</span> Simple density-independent growth</a></li>
<li><a class="" href="DID.html"><span class="header-section-number">4</span> Density-independent Demography</a></li>
<li><a class="" href="DDgrowth.html"><span class="header-section-number">5</span> Density-dependent growth</a></li>
<li><a class="" href="meta.html"><span class="header-section-number">6</span> Populations in Space</a></li>
<li><a class="" href="comp.html"><span class="header-section-number">7</span> Direct competition and mutualism</a></li>
<li><a class="" href="cr.html"><span class="header-section-number">8</span> Consumer-resource Interactions</a></li>
<li><a class="" href="host-parasitoid-relations.html"><span class="header-section-number">9</span> Host-parasitoid relations</a></li>
<li><a class="" href="disease.html"><span class="header-section-number">10</span> Disease</a></li>
<li><a class="" href="consumer-resource-competition-and-mutualisms.html"><span class="header-section-number">11</span> Consumer-resource Competition and Mutualisms</a></li>
<li><a class="" href="food-webs-and-other-networks.html"><span class="header-section-number">12</span> Food webs and other networks</a></li>
<li><a class="" href="diversity.html"><span class="header-section-number">13</span> Diversity</a></li>
<li><a class="" href="references.html"><span class="header-section-number">14</span> References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="expo" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Simple density-independent growth<a class="anchor" aria-label="anchor" href="#expo"><i class="fas fa-link"></i></a>
</h1>
<div class="figure">
<span style="display:block;" id="fig:Melospiza1"></span>
<img src="figs/Melospiza1-1.png" alt="Song Sparrow (Melospiza melodia) counts in Darrtown, OH, USA. From  Sauer, J. R., J.E. Hines, and  J. Fallon. 2005. The North American Breeding Bird Survey, Results and Analysis 1966--2004. Version 2005.2. USGS Patuxent Wildlife Research Center, Laurel, MD." width="70%"><p class="caption">
Figure 3.1: Song Sparrow (Melospiza melodia) counts in Darrtown, OH, USA. From Sauer, J. R., J.E. Hines, and J. Fallon. 2005. The North American Breeding Bird Survey, Results and Analysis 1966–2004. Version 2005.2. USGS Patuxent Wildlife Research Center, Laurel, MD.
</p>
</div>
<div class="figure">
<span style="display:block;" id="fig:Melospiza2"></span>
<img src="figs/Melospiza2-1.png" alt="Song Sparrow (Melospiza melodia) annual changes in population size as a function of population size." width="70%"><p class="caption">
Figure 3.2: Song Sparrow (Melospiza melodia) annual changes in population size as a function of population size.
</p>
</div>
<p>Between 1966 and 1971, Song Sparrow (<em>Melospiza melodia</em>) abundance in Darrtown, OH, USA, seemed to increase very quickly, perhaps unimpeded by any particular factor (Fig. <a href="expo.html#fig:Melospiza1">3.1</a>, <a href="expo.html#fig:Melospiza2">3.2</a>). In an effort to manage this population, we may want to predict its future population size. We may also want to describe its growth rate and population size in terms of mechanisms that could influence its growth rate. We may want to compare its growth and relevant mechanisms to those of other Song Sparrow populations or to other passerine populations. To do this, we start with the simplest of all population phenomena, geometric and exponential growth.</p>
<p>Geometric and exponential growth are examples of <em>density-independent growth</em>. This captures the fundamental process of reproduction (e.g., making seeds or babies) results in a <em>geometric series</em>.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;A constatnt ratio between successive numbers.&lt;/p&gt;"><sup>13</sup></a> For instance, one cell divides to make two, those two cells each divide to make four, and so on, where reproduction for each cell results in two cells, <em>regardless of how many other cells are in the population</em>—that is what we mean by <em>density-independent</em>. This myopically observed event of reproduction, whether one cell into two, or one plant producing many seeds, is the genesis of a geometric series. Therefore, most models of populations include this
fundamental process of geometric increase. Second, populations can grow in a density-independent fashion when resources are plentiful. It behooves us to start with this simple model because most, more complex population models include this process.</p>
<p><span class="citation">A. Hastings (<a href="references.html#ref-hastings2011" role="doc-biblioref">2011</a>)</span> proposes that we can approach single species poulation growth from either a microscopic or macroscopic point of view. The microscopic approach begins with two propositions. The first is that if we know the location, timing, and traits of all individuals, we can predict perfectly population dynamics; the second is that we can never predict dynamics perfectly because births and deaths are fundamentally random and can be described only with probabilities.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;A zen koan, if there ever was one.&lt;/p&gt;"><sup>14</sup></a> With this microscopic approach, we would seek a very detailed description of individuals and build a complex model to understand the consequences of the characteristics of all these interacting individuals, including the growth of the population.</p>
<p>In this chapter, I choose to start with Hastings’ macroscopic approach. These propositions appear simpler.</p>
<ol style="list-style-type: decimal">
<li>A population grows exponentially in the absence of other forces.</li>
<li>There are forces that can prevent a population from growing exponentially.</li>
</ol>
<p>These are the consequences of the following assumptions.</p>
<ol style="list-style-type: lower-alpha">
<li>all individuals in a population are identical.</li>
<li>there is no migration in or out of the population.</li>
<li><ol style="list-style-type: lower-roman">
<li>the number of offspring per individual (or the per capita birth and death rates) are constant through time, and (ii) independent of the number of individuals in the population.</li>
</ol></li>
</ol>
<p>Deviations from these assumptions lead to all of the most interesting parts of single species population dynamics <span class="citation">(<a href="references.html#ref-hastings2011" role="doc-biblioref">A. Hastings 2011</a>)</span>. The only deviation we play with in this chapter concerns assumption c; we model stochastic variation in population growth rate to investigate extinction risk. It is also worth mentioning that, although propositions 1 and 2 follow from assumptions a-d, they are not strictly necessary <span class="citation">(<a href="references.html#ref-hastings2011" role="doc-biblioref">A. Hastings 2011</a>)</span>. For instance, individuals need not be identical, and we deal with a big exception in the next chapter where we introduce structured population growth. Also, migration is admissable, provided immigration = emigration and it does not alter growth rates. Nonetheless, other deviations from a. and b. can have very important consequences for single species population dynamics.</p>
<p>Here we define Density-independence in a real population as a lack of a statistical relation between the density of a population, and its <em>per capita</em> growth rate<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;No observed relation between &lt;span class="math inline"&gt;\(\frac{\Delta N}{N}\)&lt;/span&gt; vs. &lt;span class="math inline"&gt;\(N\)&lt;/span&gt;&lt;/p&gt;'><sup>15</sup></a>. The power to detect a significant relation between any two continuous variables depends on those factors which govern statistical power, such as the number of observations, the range of the predictor variable, and the strength of the underlying relation. Therefore, our conclusion, that a particular population exhibits density-independent growth, may be trivial if our sample size is small, with few generations sampled, or if we sampled the population over a very narrow range of densities. Nonetheless, it behooves us to come back to this definition if, or when, we get caught up in the biology of a particular organism.</p>
<p>In this chapter, we’ll introduce density-independent population <em>projection</em>, <em>growth</em>, and <em>per capita growth</em>, for populations with synchronous reproduction (discrete models), and continuous reproduction (continuous models).</p>
<div id="discrete-growth-rates-of-fruit-flies-in-my-kitchen" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Discrete growth rates of fruit flies in my kitchen<a class="anchor" aria-label="anchor" href="#discrete-growth-rates-of-fruit-flies-in-my-kitchen"><i class="fas fa-link"></i></a>
</h2>
<p>Summertime, and the living is easy. Fruit flies in my kitchen, and their number’s quite high. Flies love my ripe fruit, and my red wine. They drown in the wine–I am not sure if that is good or bad.</p>
<p>For now, we’ll treat fruit flies as if they grow in discrete generations. This is very common for populatilons that live in seasonal habitats - their reproduction is timed to the season, and they breed altogether in one bout.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;discrete generations are common in nature.&lt;/p&gt;"><sup>16</sup></a></p>
<p>I count the number of flies every week, and I find these numbers:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">16</span><span class="op">)</span></span>
<span><span class="fu">qplot</span><span class="op">(</span>x<span class="op">=</span><span class="va">t</span>, y<span class="op">=</span><span class="va">N</span>, geom<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"line"</span>, <span class="st">"point"</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="figs/flies-1.png" width="60%"></div>
<p>There are several ways we can describe fruit fly population growth. Here, we choose to begin by considering the proximate causes of change to population size per unit time: the numbers of births, immigration, death and emigration (Fig. <a href="expo.html#fig:fliesi">3.3</a>). Those are the only options, and we state it thus:
<span class="math display">\[\frac{\Delta N}{\Delta t} = \frac{B + I - D - E}{\Delta t}\]</span>
that is, the change in numbers of individuals per unit time<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;“Delta” N is the change in N.&lt;/p&gt;"><sup>17</sup></a> is determined by the numbers of births, deaths, and migrants per unit time.</p>
<p>Over the past month, I suspect the fruit flies are increasing primarily through reproduction in my kitchen. Clearly, at some point in the past, a fly or two (or three) must have immigrated into my kitchen, either as adults or as eggs or larvae in fruit I brought home (<span class="math inline">\(I&gt;0\)</span>). For now, I will assume fruit fly population dynamics in my kitchen are governed by only births and deaths (<span class="math inline">\(I=E=0\)</span>). We refer to a population like this as <em>closed</em>, because it is closed to migration in or out.</p>
<p>If I counted the number of flies last week and again this week, I can calculate the change over one month. We have
<span class="math display">\[ \frac{N_{t+1} - N_t}{(t+1) - t}=\frac{\Delta N}{\Delta t}=\frac{B+D}{\Delta t}\]</span>
In this equation, <span class="math inline">\(t\)</span> has a particular time unit, one week, so <span class="math inline">\(t+1\)</span> is one additional week.</p>
<div class="figure">
<span style="display:block;" id="fig:fliesi"></span>
<img src="figs/fliesi-1.png" alt="The number of fruit flies in my kitchen depends on immigration and emigration, and births and deaths. In the text, we assume that immigration and emigration are zero. All rates are individuals per unit time." width="100%"><p class="caption">
Figure 3.3: The number of fruit flies in my kitchen depends on immigration and emigration, and births and deaths. In the text, we assume that immigration and emigration are zero. All rates are individuals per unit time.
</p>
</div>
<p>Because adults give rise to offspring, we can represent births and deaths as proportions of existing adults. That is, as per capita rates of birth and death, as
<span class="math display">\[B = bN;\quad D=dN\]</span>
This reflects the biological realities that adults produce offspring, and everyone has some chance of dying. The parameter <span class="math inline">\(b\)</span> could be any positive real number, <span class="math inline">\(b \ge 0\)</span>. This model of births reflects the geometric property of reproduction: over a specified time interval <span class="math inline">\(\Delta t\)</span>, an average parent makes <span class="math inline">\(b\)</span> babies. Parameter <span class="math inline">\(d\)</span> is any real number between zero and one, <span class="math inline">\(0 \le d \le 1\)</span>. Both <span class="math inline">\(b\)</span> and <span class="math inline">\(d\)</span> have units of individuals per individual per unit time. They depend on that unit of time.</p>
<p><em>What if offspring die before the next census?</em></p>
<p>Fig. <a href="expo.html#fig:fliesi">3.3</a> helps us think about these things. Simplifying, we’ll assume births occur first, and then death comes to offspring and adults.</p>
<p>Let’s define a few terms.</p>
<ul>
<li>
<span class="math inline">\(N_0\)</span>, <span class="math inline">\(N_1\)</span> - the number of flies at the start and after the first time interval.</li>
<li>
<span class="math inline">\(N^\prime\)</span>, <span class="math inline">\(N^{\prime\prime}\)</span> - distinct values of <span class="math inline">\(N\)</span>, after births, but before <span class="math inline">\(N_1\)</span>.</li>
<li>
<span class="math inline">\(\Delta N\)</span> - the <em>change</em> in <span class="math inline">\(N\)</span> from one point in time to another.</li>
<li>
<span class="math inline">\(t\)</span> is time, so <span class="math inline">\(\Delta t\)</span> is the time interval over which <span class="math inline">\(N\)</span> may change.</li>
</ul>
<p>Let’s match these numbers to what is going on in my kitchen. For my first census count, at <span class="math inline">\(t=0\)</span>, I counted the adults and label that number <span class="math inline">\(N_0\)</span>. These adults lay eggs which hatch, and then larvae and pupae develop, and become adults, giving us a population of
<span class="math display">\[N^\prime = N_0 + bN\]</span></p>
<p>Some of the eggs fail to hatch, and some of the larvae die
before maturing. Many of the adults die as well. If we assume the eggs, larvae, and adults all die at the same rate, then by the end of one generation we have
<span class="math display">\[N_1 = N^\prime - dN^\prime\]</span></p>
<p>Substituting, we get
<span class="math display">\[ N_1 = N_0 + bN_0 - d\left(N_0 + bN_0\right)\]</span></p>
<p>We see that by the next time point, <span class="math inline">\(t=1\)</span>, the number of fruit flies should be equal to the number we started with, <span class="math inline">\(N_0\)</span>, plus the number of new individuals, <span class="math inline">\(bN_0\)</span>, minus the number of original adults that die, <span class="math inline">\(dN_0\)</span>, and minus the number of new individuals that die, <span class="math inline">\(dbN_0\)</span>.</p>
<p>We can pull all of these parameters together,
<span class="math display">\[ N_1 = N_0 + bN_0 - dN_0 - dbN_0 \]</span>
<span class="math display" id="eq:bddb">\[ N_1 - N_0 =  N_0 \left(b - d - db\rig\tag{3.1}_d (#eq:bddb)\]</span></p>
<p>where $r_d = b - d - db $.</p>
<p>The <em>growth rate</em> of the population is <span class="math inline">\(\Delta N / \Delta t\)</span>, or, at <span class="math inline">\(t=0\)</span>, is
<span class="math display">\[\frac{\Delta N}{\Delta t} = \frac{N_1 - N_0}{t_1-t_0} = \frac{(N_0 + r_dN_0) - N_0}{t_1-t_0} = r_d N_0 \]</span>
If we generalize, we drop the zero, to get <span class="math inline">\(r_dN\)</span>. The <em>per capita</em> population growth rate is <span class="math inline">\(r_dN/N =r_d\)</span>. If our time step were something other than 1, we would also divide by <span class="math inline">\(\Delta t\)</span>.</p>
<p>With the simple census data above, we can
estimate <span class="math inline">\(r_d\)</span> for the first time step.
<span class="math display">\[N_1 = N_0 + r_dN_0=  2 + r_d (2) \implies r_d=1\]</span>
If we know that <span class="math inline">\(r_d\)</span> is constant over time, we can infer a general rule to project the population forward in time an arbitrary number of time steps. We will let <span class="math inline">\(\lambda = 1+r_d\)</span>.
<span class="math display">\[N_1 = N_0 + r_dN_0 = N_0(1 + r_d) = N_0\lambda\]</span>
<span class="math display">\[N_2 = N_1\lambda=  (N_0 \lambda)\lambda\]</span>
<span class="math display">\[N_3 = N_2\lambda=  (N_0 \lambda)\lambda\lambda\]</span>
or simply,
<span class="math display">\[N_t = N_0\lambda^t\]</span></p>
<p>To summarize our model of discrete population growth, we have the following statements:</p>
<p><strong>Projection:</strong>
<span class="math display">\[N_t = N_0\lambda^t\]</span></p>
<p><strong>Population growth rate:</strong>
<span class="math display">\[\frac{\Delta N}{\Delta t} = r_dN; \quad \mathrm{where~} \lambda=1+r_d\]</span></p>
<p><strong>Per capita opulation growth rate:</strong>
<span class="math display">\[\frac{\Delta N}{N\Delta t} = r_d\]</span></p>
<p>At last, we see how this is a model of density-independent growth: per capita growth rate does not include <span class="math inline">\(N\)</span>.</p>
</div>
<div id="fruit-flies-with-continuous-overlapping-generations" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Fruit flies with continuous overlapping generations<a class="anchor" aria-label="anchor" href="#fruit-flies-with-continuous-overlapping-generations"><i class="fas fa-link"></i></a>
</h2>
<p>In the reality that is my kitchen, individual fruit flies are having sex and reproducing on their own schedules. As a population, they breed continuously, so the cohorts are not synchronous. For populations like that, we need to describe instantaneous growth rates, where <span class="math inline">\(\Delta t\)</span> is no longer a fixed period of time, but is an instant, or infinity small.</p>
<p>We return to our example above (Fig. <a href="expo.html#fig:fliesi">3.3</a>), which we summarize in <a href="expo.html#eq:bddb">(3.1)</a>. Please take a look at that equation. In what follows, we make time more explicit so that it appears in the equation. We begin by remembering that <span class="math inline">\(b\)</span> and <span class="math inline">\(d\)</span> have time units.</p>
<ul>
<li>Let <span class="math inline">\(\Delta t\)</span> be a small fraction of <span class="math inline">\(1\)</span>, so that the time step goes from <span class="math inline">\(t\)</span> to <span class="math inline">\(t + \Delta t\)</span>.</li>
<li>As <span class="math inline">\(\Delta t\)</span>, shrinks, <span class="math inline">\(b\)</span> and <span class="math inline">\(d\)</span> need to shrink as well, to <span class="math inline">\(\Delta t b\)</span> and <span class="math inline">\(\Delta t d\)</span>.</li>
<li>
<span class="math inline">\(dN/dt\)</span> is how we symbolize the instantaneous rate of population growth, with lower case <span class="math inline">\(d\)</span> symbolizing infinitesimally small change; it is a <em>differential equation.</em>
</li>
</ul>
<p>We now have to solve for the limit of <span class="math inline">\(\Delta N /\Delta t\)</span> as <span class="math inline">\(\Delta t\)</span> goes to zero.
<span class="math display">\[\frac{dN}{dt}=\lim_{\Delta t \rightarrow 0} \frac{N_{t+\Delta t} - N_t}{\Delta t}  \]</span>
This means that the instantaneous rate of change of <span class="math inline">\(N\)</span> is equal to the limit (as delta t approaches zero) of the difference in <span class="math inline">\(N\)</span>’s of the time interval, delta t.</p>
<p>Substituting, we get,
<span class="math display">\[\frac{dN}{dt} = \lim_{\Delta t \rightarrow 0} \frac{\Delta t\,bN_t - \Delta t \,dN_t - \Delta t\, d (\Delta t\, b)N_t}{\Delta t} \]</span></p>
<p>If we divide through by <span class="math inline">\(\Delta t\)</span> and then let <span class="math inline">\(\Delta t \rightarrow 0\)</span>, we get
<span class="math display">\[\frac{dN}{dt}=\lim_{\Delta t \rightarrow 0} bN_t - dN_t - \Delta t\, d bN_t = bN_t - dN_t=rN\]</span></p>
<p>To arrive at the projection equation for a continuously growing population, we integrate <span class="math inline">\(rN\)</span> with respect to time. Integration is the cumulative summing of <span class="math inline">\(y\)</span> across a range of <span class="math inline">\(x\)</span>. It even uses an exagerated “S” to indicate summation, <span class="math inline">\(\int\)</span>. Here we integrate population growth across time. We start by rearranging
<span class="math display">\[\frac{dN}{dt} = rN \Rightarrow \frac{dN}{N} = r dt\]</span></p>
<p>Now we integrate <span class="math inline">\(N\)</span> and <span class="math inline">\(r\)</span> with respect to their start and end points: <span class="math inline">\(N\)</span> from <span class="math inline">\(N_0\)</span> to <span class="math inline">\(N_t\)</span>, and, correspondingly, <span class="math inline">\(r\)</span> from <span class="math inline">\(t=0\)</span> to <span class="math inline">\(t=t\)</span>,
<span class="math display">\[\int_{N_0}^{N_t} \frac{1}{N}dN = \int_{0}^{t}rdt\]</span>
<span class="math display">\[\ln(N_t) - \ln(N_0) = rt - r\,0\]</span>
<span class="math display">\[\ln(N_t) = \ln(N_0) + rt\]</span>
We now exponentiate (<span class="math inline">\(e^x\)</span>) both sides to arrive at our projection equation.
<span class="math display">\[N_t = e^{\ln(N_0) + rt} = N_0 e^{rt}\]</span></p>
<p>To summarize our model of continuous population growth, we have the following statements.</p>
<p><strong>Projection:</strong>
<span class="math display">\[N_t = N_0 e^{rt}\]</span></p>
<p><strong>Population growth rate:</strong>
<span class="math display">\[\frac{dN}{dt} = rN\]</span></p>
<p><strong>Per capita population growth rate:</strong>
<span class="math display">\[\frac{dN}{Ndt} = r\]</span>
Once again, we see why we refer to exponential growth as density-independent: the per capita growth rate does not depend on <span class="math inline">\(N\)</span>.</p>
</div>
<div id="properties-of-geometric-and-exponential-growth" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Properties of geometric and exponential growth<a class="anchor" aria-label="anchor" href="#properties-of-geometric-and-exponential-growth"><i class="fas fa-link"></i></a>
</h2>
<p>Compare the projection equations for geometric and exponential growth. We find that
<span class="math display">\[\lambda = e^{r} \quad ; \quad \ln \lambda = r\]</span>
This gives us a few useful rules of thumb.</p>
<ul>
<li>No change: <span class="math inline">\(r = 0\quad;\quad\lambda =1\)</span>
</li>
<li>Growing population: <span class="math inline">\(r &gt; 0 \quad;\quad \lambda &gt; 1\)</span>
</li>
<li>Shrinking population: <span class="math inline">\(r &lt; 0 \quad;\quad \lambda &lt; 1\)</span>
</li>
</ul>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Let r take on three values</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># Convert to lambda</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.3678794 1.0000000 2.7182818</code></pre>
<p><em>Time scaling</em> This is a useful property if we ever want to change time units in a discrete model. We must first <span class="math inline">\(\lambda\)</span> to <span class="math inline">\(r\)</span>, change units in <span class="math inline">\(r\)</span> and convert back to <span class="math inline">\(\lambda\)</span>. For instance, if we find that the annual finite rate of increase for a population of crickets is <span class="math inline">\(\lambda = 1.2\)</span>, we cannot convert that to a monthly rate of <span class="math inline">\(1.2/12 = 0.1\)</span>. Instead we convert to <span class="math inline">\(r\)</span> and back to <span class="math inline">\(\lambda\)</span>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fl">1.2</span></span>
<span></span>
<span><span class="co"># Convert lambda to r </span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span>; <span class="va">r</span></span></code></pre></div>
<pre><code>## [1] 0.1823216</code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Scale r from year to month</span></span>
<span><span class="va">r2</span> <span class="op">&lt;-</span> <span class="va">r</span><span class="op">/</span><span class="fl">12</span>; <span class="va">r2</span></span></code></pre></div>
<pre><code>## [1] 0.01519346</code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Convert back to lambda (per month)</span></span>
<span><span class="va">lambda2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">r2</span><span class="op">)</span>; <span class="va">lambda2</span></span></code></pre></div>
<pre><code>## [1] 1.015309</code></pre>
<p>This is very, very different than <span class="math inline">\(\lambda/12\)</span>.</p>
<p><em>Doubling time</em> Sometimes we gain a more intuitive grasp of an idea when we convert to a different form of the same relationship. Exponential growth is one of those ideas that can be hard to grasp. A more intuitive way to compare or express exponential growth rate is through <em>doubling time</em>, the time required for the population to double in size. For instance, a per capita growth rate of <span class="math inline">\(r = 0.14\,\mathrm{inds}\cdot \mathrm{ind}^{-1} \mathrm{y}^{-1}\)</span> means that the population will double in less than 5 years.</p>
<p>We determine this by letting <span class="math inline">\(N_t = 2N_0\)</span>.
<span class="math display">\[2N_0 = N_0 e^{rt}\]</span>
<span class="math display">\[\ln 2 = rt\]</span>
<span class="math display">\[t =\frac{\ln 2}{r}\]</span></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># let r be a sequence from </span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co">#doubling time will be</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="va">r</span></span></code></pre></div>
<pre><code>## [1] 69.314718 13.862944  6.931472  1.386294</code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># and a picture</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">.2</span>, <span class="fl">0</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, tcl<span class="op">=</span><span class="op">-</span><span class="fl">.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="va">x</span>, xlab<span class="op">=</span><span class="st">"r"</span>, ylab<span class="op">=</span><span class="st">"Doubling time"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:doubling"></span>
<img src="figs/doubling-1.png" alt="Doubling time is inversely related to the intrinsic rate of increase, r." width="60%"><p class="caption">
Figure 3.4: Doubling time is inversely related to the intrinsic rate of increase, r.
</p>
</div>
<div id="average-growth-rate" class="section level3" number="3.3.1">
<h3>
<span class="header-section-number">3.3.1</span> Average growth rate<a class="anchor" aria-label="anchor" href="#average-growth-rate"><i class="fas fa-link"></i></a>
</h3>
<p>In any real data set, such as from a real population of fruit flies or Song Sparrows, <span class="math inline">\(N_{t+1}/N_t\)</span> will vary from year to year. How do we calculate an average growth rate for a fluctuating population?</p>
<p>Let’s consider the case where a population increases and then decreases. For each year, we will calculate the annual rate of increase <span class="math inline">\(R = N_{t+1}/N_t\)</span>, and take the arithmetic average of those rates to see if it makes sense.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">15</span>, <span class="fl">15</span><span class="op">)</span></span>
<span><span class="va">R</span> <span class="op">&lt;-</span> <span class="va">N</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">/</span><span class="va">N</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>; <span class="va">R</span></span></code></pre></div>
<pre><code>## [1] 1.5 0.5 1.0</code></pre>
<p>The arithmetic average of those rates is <span class="math inline">\((1.5 + 0.5 + 1.0)/3=1.0\)</span>. If <span class="math inline">\(R=1.0\)</span>, then, on average, the population should stay the same, but it decreased. Why is that?</p>
<p>Let us do the annual time steps explicitly to see what is going on.
<span class="math display">\[N_3 = (N_0 R_0) R_1 R_2\]</span></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Remember that we call the first time t=0 and N0, but</span></span>
<span><span class="co"># when coding, these values are the first in a series, so </span></span>
<span><span class="co"># N0 is N[1]</span></span>
<span></span>
<span><span class="co"># Now we do the annual changes which should equal N3</span></span>
<span><span class="va">N</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">R</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">R</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">R</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span></code></pre></div>
<pre><code>## [1] 15</code></pre>
<p>From this calculation, we see that when we start with <span class="math inline">\(N_0=20\)</span> and do the annual steps, we wind up with a smaller population, even though the arithmetic average is <span class="math inline">\(R_{\mathrm{ave}} = 1\)</span>. How do we calculate an average of numbers that we multiply together?</p>
<p>We want a number <span class="math inline">\(\bar{R}\)</span> such that
<span class="math display">\[\bar{R}^t = R_1R_2\ldots R_t\]</span></p>
<p>To find that, we simply solve for <span class="math inline">\(\bar{R}\)</span>
<span class="math display">\[(\bar{R}^t)^{1/t} =\bar{R} = \left(R_1R_2\ldots R_t\right)^{1/t}\]</span>
We take the <span class="math inline">\(t\)</span>-th root of the product of all the <span class="math inline">\(R\)</span>. This is called the <em>geometric average.</em> Another way of writing this would be to use the product symbol, as in
<span class="math display">\[\bar{R} = \left(\prod_{i=1}^t R_i\right)^{1/t}\]</span></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">R</span></span></code></pre></div>
<pre><code>## [1] 1.5 0.5 1.0</code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#arithmetic average</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># geometric average</span></span>
<span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span>; <span class="va">t</span></span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/prod.html">prod</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">t</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.9085603</code></pre>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># shows the population should decline</span></span></code></pre></div>
<p>Another way to do the same thing is to take the arithmethic mean of the log-growth rates, and back-transform,</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span> <span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.9085603</code></pre>
<p>Now we see the effect of calculating the average growth rate correctly. This leads to a useful rule of thumb: <em>random variation in growth rate suppresses population growth.</em> Here we illustrate that. We start with a growing population.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fl">1.01</span> <span class="co"># positive growth rate</span></span>
<span><span class="va">N0</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="co"># starting N</span></span>
<span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fl">20</span> <span class="co"># 20 years</span></span>
<span><span class="va">Nt1</span> <span class="op">&lt;-</span> <span class="va">N0</span><span class="op">*</span><span class="va">lambda</span><span class="op">^</span><span class="va">t</span>; <span class="va">Nt1</span></span></code></pre></div>
<pre><code>## [1] 122.019</code></pre>
<p>Here <span class="math inline">\(\lambda &gt; 1\)</span>, so the population grows.</p>
<p>Now we do a simulation in which we let <span class="math inline">\(\lambda\)</span> have a mean of 1.01 but allow it to vary randomly.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a vector to hold all N</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">t</span><span class="op">)</span>; <span class="va">N</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">N0</span></span>
<span></span>
<span><span class="co"># create t-1 random lambdas with a mean of 1.01 </span></span>
<span><span class="co"># ranging from 0.41 to 1.61</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="co"># makes the radnom sequence repeatable</span></span>
<span><span class="va">random.lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span>n<span class="op">=</span><span class="op">(</span><span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, min<span class="op">=</span><span class="fl">0.41</span>, max<span class="op">=</span><span class="fl">1.61</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the geometric mean</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/prod.html">prod</a></span><span class="op">(</span><span class="va">random.lambda</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">random.lambda</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 1.00105</code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># actual simulated projection</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> </span>
<span>  <span class="va">N</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">N</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">*</span> <span class="va">random.lambda</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">qplot</span><span class="op">(</span>x<span class="op">=</span><span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="va">N</span>, geom<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"line"</span>, <span class="st">"point"</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"Time (y)"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:randomLambda"></span>
<img src="figs/randomLambda-1.png" alt="Random variation in growth rate alters the long term average growth rate." width="90%"><p class="caption">
Figure 3.5: Random variation in growth rate alters the long term average growth rate.
</p>
</div>
<p>Sometimes the arithmetic average is close to the correct average, but it is never the correct approach.</p>
</div>
</div>
<div id="modeling-with-data-simulated-dynamics" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> Modeling with Data: Simulated Dynamics<a class="anchor" aria-label="anchor" href="#modeling-with-data-simulated-dynamics"><i class="fas fa-link"></i></a>
</h2>
<p>Science strives to make predictions about the behavior of systems. Ecologists and conservation biologists frequently strive to predict the fate of populations, that is, determine the probability that a population will persist. This is referred to as <em>population viability analysis</em> (PVA) and is a large field of endeavor that is vital to managing threatened populations. Here we put into practice ideas about population biology to make informed predictions about the fate of the Song Sparrow population in Darrtown, OH. We also illustrate simple computational methods for doing so.</p>
<p>The preceding sections (the bulk of the chapter) emphasized understanding the deterministic underpinnings of simple forms of density independent growth: geometric and exponential growth. This section explores the stochastic simulation of density independent growth. Our simulation makes most of the same assumptions we made at the beginning of the chapter. In addition, we assume that the observed annual growth rates (<span class="math inline">\(N_{t+1}/N_t\)</span>) are representative of future growth rates, and that the growth rate in one year is entirely independent of any other year.</p>
<p>To make meaningful projections of future population size, we should quantify the uncertainty with our guess. Simulation is one way we can project populations and quantify the uncertainty. The way one often does that is to use the original data and sample it randomly to calculate model parameters. This way, the simulations are random, but based on our best available knowledge, i.e., the real data. The re-use of observed data occurs in many guises, and it is known often as bootstrapping or resampling.</p>
<p>In a highly influential paper on miminmum population sizes in conservation, <span class="citation">Shaffer (<a href="references.html#ref-shaffer1981" role="doc-biblioref">1981</a>)</span> identifies four different types of noise or stochasticity that are important in driving variability in populations. The first of these is <em>demographic stochasticity</em>. This is the random-like or stochastic nature of individual births and deaths. Due to this element of random chance, individuals may live or die, produce offspring or not. As a result, population size will fluctuation randomly. This is very important in small populations, and becomes increasingly unimportant in larger and larger populations. This is the same process that underlies genetic drift in small populations.</p>
<p>Another source of variation <span class="citation">Shaffer (<a href="references.html#ref-shaffer1981" role="doc-biblioref">1981</a>)</span> identifies is <em>environmental stochasticity</em>. This is temporal variation in birth or death rates that affects all individuals to a similar degree, due to variation in the population’s biotic or abiotic environment.</p>
<p>The last sources of variation are <em>genetic stochasticity</em> and <em>natural catastrophes</em>. Perhaps the latter of these is the most difficult to deal with, because catastrophes are, by definition, enormously consequential and unpredictable.</p>
<p>Given these sources of uncertainty, <span class="citation">Shaffer (<a href="references.html#ref-shaffer1981" role="doc-biblioref">1981</a>)</span> defines <em>minimum viable population</em> size (MVP) thus,</p>
<p>“<em>A minimum viable population for any given species in any given habitat is the smallest isolated population having a 99% chance of remaining extant for 1000 y despite foreseeable effects of demographic, environmental and genetic stochasticity, and natural catastrophes.</em>”</p>
<p>In our simulations, we take one approach to simulating a population of Song Sparrows. The computational approaches includes a variety of tricks that you could use in a more serious approach to population projection and determining probabilities of extinction. In their supplemental documentation, <span class="citation">Chaudhary and Oli (<a href="references.html#ref-chaudhary_2019" role="doc-biblioref">2019</a>)</span> provide an excellent list of criteria to evaluate your own or someone else’s approach to PVA.</p>
<div id="data-based-approaches" class="section level3" number="3.4.1">
<h3>
<span class="header-section-number">3.4.1</span> Data-based approaches<a class="anchor" aria-label="anchor" href="#data-based-approaches"><i class="fas fa-link"></i></a>
</h3>
<p>We will use the observed <em>changes</em> in population counts <span class="math inline">\(R_t=N_{t+1}/N_t\)</span> as our data. We draw an <span class="math inline">\(R_t\)</span> at random from among the many observed values, and project the population one year forward. We then repeat this into the future, say, for ten years. Each simulation of a ten year period will result in a different ten year trajectory because we draw <span class="math inline">\(R_t\)</span> at random from among the observed <span class="math inline">\(R_t\)</span>. However, if we do many such simulations, we will have a <em>distribution</em> of outcomes that we can describe with simple statistics (e.g., median, mean, quantiles).</p>
<p>A different approach would be to estimate the individual probabilities of births and deaths in the entire Darrtown population, and use those probabilities and birth rates to simulate the entire population into the future. In such an <em>individual-based simulation</em>, we would simulate the fates of individuals, keeping track of all individual births and deaths.</p>
<p>There are myriad other approaches, but these give you a taste of what might be possible. In this section we focus on the first of these alternatives, in which we use observed <span class="math inline">\(R_t\)</span> to simulate the dynamics of Song Sparrow counts. We do so, in part, because we have those data, while we do not have any estimates of birth rates or death rates.</p>
<p>Here we investigate Song Sparrow (<em>Melospize melodia</em>) dynamics using data from the annual U.S. Breeding Bird Survey (<a href="http://www.mbr-pwrc.usgs.gov/" class="uri">http://www.mbr-pwrc.usgs.gov/</a> bbs/). Below we will</p>
<ol style="list-style-type: decimal">
<li>create and examine visually the data (annual <span class="math inline">\(R\)</span>’s),</li>
<li>simulate one projection,</li>
<li>scale up to multiple simulations,</li>
<li>simplify simulations and perform them 1000s of times, and</li>
<li>analyze the output.</li>
</ol>
</div>
<div id="creating-and-visualizing-the-data" class="section level3" number="3.4.2">
<h3>
<span class="header-section-number">3.4.2</span> Creating and visualizing the data<a class="anchor" aria-label="anchor" href="#creating-and-visualizing-the-data"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s start by graphing the data<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;I’ve come to abhor my use of the expression “look at”; I use it when I don’t say what I mean. “Look at” can mean almost anything, but it rarely means only “looking at”…&lt;/p&gt;"><sup>18</sup></a>. <em>Graphing the data is always a good idea — it is a principle of working with data</em>. We first load the data from the <code>primer</code> R package, and look at the names of the data frame. We then choose to <code>attach</code> the data frame, because it makes the code easier to read.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Don’t use &lt;code&gt;attach&lt;/code&gt; for anything important&lt;/p&gt;"><sup>19</sup></a></p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">primer</span><span class="op">)</span> <span class="co"># load the primer package</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">sparrows</span><span class="op">)</span> <span class="co"># load a built-in data set</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">sparrows</span><span class="op">)</span> <span class="co"># extract the names of the columns in the data frame</span></span></code></pre></div>
<pre><code>## [1] "Year"           "Count"          "ObserverNumber"</code></pre>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/attach.html">attach</a></span><span class="op">(</span><span class="va">sparrows</span><span class="op">)</span> <span class="co"># put the columns in R's search path</span></span></code></pre></div>
<p>Now we plot these counts through time (Fig. <a href="expo.html#fig:cts">3.6</a>).</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">sparrows</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Year</span>, y<span class="op">=</span><span class="va">Count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>pch<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:cts"></span>
<img src="figs/cts-1.png" alt="Observations of Song Sparrows in Darrtown, OH (http://www.mbr-pwrc.usgs.gov/bbs/)." width="75%"><p class="caption">
Figure 3.6: Observations of Song Sparrows in Darrtown, OH (<a href="http://www.mbr-pwrc.usgs.gov/bbs/" class="uri">http://www.mbr-pwrc.usgs.gov/bbs/</a>).
</p>
</div>
<p>We see that Song Sparrow counts at this site (the DARRTOWN transect, OH, USA) fluctuated a fair bit between 1966 and 2003. They never were completely absent and never exceeded <span class="math inline">\(\sim 120\)</span> individuals.</p>
<p>Next we calculate annual <span class="math inline">\(R_t=N_{t+1}/N_t\)</span>, that is, the observed growth rate for each year <span class="math inline">\(t\)</span>.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the use of [-1] in the index tells R to exclude the first element.</span></span>
<span><span class="co"># length() is the length of a vector, so [-length(X)] means exclude the last</span></span>
<span><span class="va">obs.R</span> <span class="op">&lt;-</span> <span class="va">Count</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">Count</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Count</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>Thus our <em>data</em> are the observed <span class="math inline">\(R_t\)</span>, not the counts <em>per se</em>. These <span class="math inline">\(R\)</span> form the basis of everything else we do. Because they are so important, let’s plot these as well. Let’s also indicate <span class="math inline">\(R=1\)</span> with a horizontal dotted line as a visual cue for zero population growth. Note that we exclude the last year because each <span class="math inline">\(R_t\)</span> is associated with <span class="math inline">\(N_t\)</span> rather than <span class="math inline">\(N_{t+1}\)</span>.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Year</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Count</span><span class="op">)</span><span class="op">]</span>, y<span class="op">=</span><span class="va">obs.R</span>, geom<span class="op">=</span><span class="st">"point"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">1</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/bquote.html">bquote</a></span><span class="op">(</span><span class="va">N</span><span class="op">[</span><span class="va">t</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">N</span><span class="op">[</span><span class="va">t</span><span class="op">]</span><span class="op">)</span>, x<span class="op">=</span><span class="st">"Year (t)"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:Rrates"></span>
<img src="figs/Rrates-1.png" alt="Annual growth rates (R=N[t+1]/N[t]) for Song Sparrows" width="75%"><p class="caption">
Figure 3.7: Annual growth rates (R=N[t+1]/N[t]) for Song Sparrows
</p>
</div>
<p>One thing that emerges in our graphic data display (Fig. <a href="expo.html#fig:Rrates">3.7</a>) is we have an unusually high growth rate in the early 1990’s, with the rest of the data clustered around 0.5–1.5. We may want to remember that.</p>
</div>
<div id="one-simulation" class="section level3" number="3.4.3">
<h3>
<span class="header-section-number">3.4.3</span> One simulation<a class="anchor" aria-label="anchor" href="#one-simulation"><i class="fas fa-link"></i></a>
</h3>
<p>Our simulation will,</p>
<ol style="list-style-type: decimal">
<li>determine the number of years we wish to simulate,</li>
<li>create an empty vector, <code>N</code>, to hold our simulated <span class="math inline">\(N\)</span>, which is <code>years + 1</code> long,</li>
<li>draw a random sample of <span class="math inline">\(R_t\)</span>, one for each year (<code>R</code>),</li>
<li>select a starting abundance <span class="math inline">\(N_0\)</span> and put it in <code>N[1]</code>.</li>
<li>multiply our first random <span class="math inline">\(R\)</span>, <code>R[1]</code>, times <code>N[1]</code> to generate the next, <code>N[2]</code>.</li>
<li>repeat step 5 for each year to simulate each <code>N[t+1]</code> from <code>R[t]</code> and <code>N[t]</code>.</li>
</ol>
<p>First, we decide how many years we want to simulate growth, and create an empty vector that will hold our data.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">years</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="va">years</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span> <span class="co"># rep(0,years+1) would do the same thing.</span></span></code></pre></div>
<p>Our vector of <span class="math inline">\(N\)</span> has to be one longer than the number of <span class="math inline">\(R\)</span> we use. This is because each <span class="math inline">\(R\)</span> is the change <em>from one year to the next</em> and there will always be one more <em>next</em> than there is <span class="math inline">\(R\)</span>.</p>
<p>Next we draw 10 <span class="math inline">\(R\)</span> at random with replacement. This is just like having all 35 observed <span class="math inline">\(R\)</span> written down on slips of paper and dropped into a paper bag. We then draw one slip of paper out of the bag, write the number down, and put the slip of paper back in the bag, and then repeat this 9 more times. This is <em>resampling with replacement</em>. In that case, we would be assuming that all of these <span class="math inline">\(R_t\)</span> are important and will occur at some point, but we just don’t know when—they constitute the entire universe of possibilities. The R function <em>sample</em> will do this.</p>
<p>Terminology: A random process occurs only in our imagination, or perhaps at the quantum level. A stochastic process is one which we treat operationally as random while acknowledging that there are complex underlying deterministic drivers. A pseudorandom process is a completely deterministic and hidden process used by computers and their programmers to generate numbers that cannot be distinguished from random; we can repeat a pseudorandom process by stipulating a key hidden starting point.</p>
<p>We can use <code><a href="https://rdrr.io/r/base/Random.html">set.seed()</a></code> to make your pseudorandom process the same as mine, i.e., repeatable.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co"># Draw a sample of our observed R with replacement, "years" times.</span></span>
<span><span class="op">(</span><span class="va">rRs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">obs.R</span>, size<span class="op">=</span><span class="va">years</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  [1] 1.4489796 0.8125000 1.0714286 1.2857143 0.7727273 0.4805195 1.2857143
##  [8] 1.0500000 0.7204301 1.4489796</code></pre>
<p>Now that we have these 10 <span class="math inline">\(R\)</span>, all we have to do is use them to generate the population sizes through time. For this, we need to use what programmers call a <em>for-loop</em>. In brief, a for-loop repeats a series of steps for a predetermined number of times.</p>
<p>Let’s start our simulated N with the sparrow count we had in the last year.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">Count</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Count</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>Now we are ready to use the for-loop to project the population. For each year <span class="math inline">\(t\)</span>, we multiply <span class="math inline">\(N_t\)</span> by the randomly selected <span class="math inline">\(R_t\)</span> to get <span class="math inline">\(N_{t+1}\)</span> and put it into the <span class="math inline">\(t +1\)</span> element of <code>N</code>.</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span><span class="op">(</span> <span class="va">t</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">years</span><span class="op">)</span> <span class="op">{</span> </span>
<span><span class="co"># starting with year = 1, and for each subsequent year, do... </span></span>
<span><span class="va">N</span><span class="op">[</span><span class="va">t</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">N</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">*</span> <span class="va">rRs</span><span class="op">[</span><span class="va">t</span><span class="op">]</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Let’s graph the result.</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">years</span>, <span class="va">N</span>, geom<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"point"</span>,<span class="st">"line"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:simten"></span>
<img src="figs/simten-1.png" alt="A single simulated population projection." width="90%"><p class="caption">
Figure 3.8: A single simulated population projection.
</p>
</div>
<p>It appears to work (Fig. <a href="expo.html#fig:simten">3.8</a>).</p>
<p>Let’s review what we have done. We</p>
<ul>
<li>had a bird count each year for 36 years. From this we calculated 35 <span class="math inline">\(R\)</span> (for all years except the very last).</li>
<li>decided how many years we wanted to project the population (10,y).</li>
<li>drew at random and with replacement the observed <span class="math inline">\(R\)</span>—one <span class="math inline">\(R\)</span> for each year we want to project forward.</li>
<li>we created an empty vector and put in an initial value.</li>
<li>performed each year’s calculation, and put it into the vector we made.</li>
</ul>
<p>So what does Fig. <a href="expo.html#fig:simten">3.8</a> represent? It represents one possible outcome of a trajectory, if we assume that <span class="math inline">\(R\)</span> has an equal probability of being any of the observed <span class="math inline">\(R_t\)</span>. This <em>particular</em> trajectory is very unlikely, because it would require one particular sequence of randomly selected <span class="math inline">\(R\)</span>s. However, we assume that it is <em>no less likely</em> than any other particular trajectory.</p>
<p>As only one realization of a set of randomly selected <span class="math inline">\(R\)</span>, Fig. <a href="expo.html#fig:simten">3.8</a> tells us very little. What we need to do now is to replicate this process a very large number of times, and examine the <em>distribution</em> of outcomes, including moments of the distribution such as the mean, median, and the uncertainty of eventual outcomes.</p>
</div>
<div id="multiple-simulations" class="section level3" number="3.4.4">
<h3>
<span class="header-section-number">3.4.4</span> Multiple simulations<a class="anchor" aria-label="anchor" href="#multiple-simulations"><i class="fas fa-link"></i></a>
</h3>
<p>Next we create a way to perform the above simulation several times. There are a couple tricks we use to do this. We still want to start small so we can figure out the steps as we go. Here is what we would do next.</p>
<ol style="list-style-type: decimal">
<li>We start by creating a function that will do the steps we did above.</li>
<li>We then perform replicate, independent simulations, using <code><a href="https://rdrr.io/r/base/lapply.html">replicate()</a></code>.</li>
</ol>
<p>Here we write a function to combine several steps. Our function has three arguments: the observed <span class="math inline">\(R\)</span>, the number of years that we want to simulate, and the initial population size.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myForLoop</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">obs.R</span>, <span class="va">years</span>, <span class="va">initial.N</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co">## obs.R - observed annual growth rates, </span></span>
<span>  <span class="co">## years - the number of years that we want to simulate,</span></span>
<span>  <span class="co">## initial.N - the initial population size.</span></span>
<span>  </span>
<span>  <span class="co"># select all R at random</span></span>
<span>  <span class="va">rR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">obs.R</span>, size<span class="op">=</span><span class="va">years</span>, replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="co"># create a vector to hold N</span></span>
<span>  <span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="va">years</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="co"># give it an initial population size</span></span>
<span>  <span class="va">N</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">initial.N</span></span>
<span>  <span class="co"># Do the for-loop</span></span>
<span>  </span>
<span>  <span class="co"># For each year...</span></span>
<span>  <span class="kw">for</span><span class="op">(</span> <span class="va">t</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">years</span> <span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># project the population one time step</span></span>
<span>      <span class="va">N</span><span class="op">[</span><span class="va">t</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="va">N</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">*</span> <span class="va">rR</span><span class="op">[</span><span class="va">t</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="co"># return the vector of N</span></span>
<span>  <span class="va">N</span></span>
<span><span class="op">}</span> </span></code></pre></div>
<p>After running the above code, try it out with different hypothetical <span class="math inline">\(R\)</span>.</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">myForLoop</span><span class="op">(</span>obs.R<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">1.5</span><span class="op">)</span>, years<span class="op">=</span><span class="fl">5</span>, initial.N<span class="op">=</span><span class="fl">43</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 43.000 21.500 10.750  5.375  5.375  5.375</code></pre>
<p>Our function seems to work.</p>
<p>Next we do ten such projection simulations, each for 50 time steps, using the sparrow data.</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># specify the number of simulations and for how long</span></span>
<span><span class="va">sims</span><span class="op">=</span><span class="fl">10</span>; <span class="va">years</span><span class="op">=</span><span class="fl">50</span></span>
<span></span>
<span><span class="co"># make the randomizations repeatable</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">outmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="va">sims</span>,   </span>
<span>             expr<span class="op">=</span><span class="fu">myForLoop</span><span class="op">(</span>obs.R<span class="op">=</span><span class="va">obs.R</span>, years<span class="op">=</span><span class="va">years</span>, initial.N<span class="op">=</span><span class="fl">43</span><span class="op">)</span></span>
<span>                    <span class="op">)</span></span></code></pre></div>
<p>Now let’s peek at the results (Fig. <a href="expo.html#fig:tensimfig">3.9</a>). It is fun to graph our output, but also helps us make sure we are not making a heinous mistake in our code. Note we use log scale to help us see the small populations.</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html">matplot</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">years</span>, <span class="va">outmat</span>, type<span class="op">=</span><span class="st">"l"</span>, log<span class="op">=</span><span class="st">"y"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:tensimfig"></span>
<img src="figs/tensimfig-1.png" alt="Using matplot() to plot a matrix vs. a single variable. Our simulated populations sometimes increase and sometimes decrease." width="75%"><p class="caption">
Figure 3.9: Using matplot() to plot a matrix vs. a single variable. Our simulated populations sometimes increase and sometimes decrease.
</p>
</div>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># combine columns years, and our output</span></span>
<span><span class="va">junk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>years <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">years</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>, <span class="va">outmat</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">junk</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  [1] "years" "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X7"    "X8"   
## [10] "X9"    "X10"</code></pre>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># make sure to load 'tidyr' if you did not already load it or tidyverse</span></span>
<span><span class="co"># library(tidyr)</span></span>
<span><span class="co"># Take the wide data frame with many columns and turn it into </span></span>
<span><span class="co"># a long data frame with one column to ID each simulation, and one to hold values.</span></span>
<span><span class="va">out.long</span> <span class="op">&lt;-</span> <span class="fu">pivot_longer</span><span class="op">(</span><span class="va">junk</span>, cols<span class="op">=</span><span class="va">X1</span><span class="op">:</span><span class="va">X10</span>, names_to<span class="op">=</span><span class="st">"Run"</span>, values_to<span class="op">=</span><span class="st">"N"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">out.long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">years</span>, y<span class="op">=</span><span class="va">N</span>, group<span class="op">=</span><span class="va">Run</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:tensimfig2"></span>
<img src="figs/tensimfig2-1.png" alt="Using ggplot() to plot one variable against vs. a single variable, organized by a grouping variable. Our simulated populations sometimes increase and sometimes decrease." width="75%"><p class="caption">
Figure 3.10: Using ggplot() to plot one variable against vs. a single variable, organized by a grouping variable. Our simulated populations sometimes increase and sometimes decrease.
</p>
</div>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Or for colorful lines</span></span>
<span><span class="co"># ggplot(data=out.long, aes(x=years, y=N,  linetype=Run, colour=Run)) + </span></span>
<span><span class="co">#    geom_line(show.legend=FALSE) + scale_y_log10() </span></span></code></pre></div>
<p>What does it mean that the simulation has an approximately even distribution of final population sizes (Fig. <a href="expo.html#fig:tensimfig2">3.10</a>? If we plotted it on a linear scale, what would it look like?<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Plotting it on the log scale reveals that the relative change is independent of population size; this is true because the rate of change is geometric. If we plotted it on a linear scale, we would see that many trajectories result in small counts, and only a few get really big. That is, the median size is pretty small, but a few populations get huge.&lt;/p&gt;"><sup>20</sup></a></p>
<p>Rerunning this simulation, with new <span class="math inline">\(R\)</span> each time, will show different dynamics every time, and that is the point of simulations. Simulations are a way to make a few key assumptions, and then leave the rest to chance. In that sense it is a null model of population dynamics.</p>
</div>
<div id="a-distribution-of-possible-futures" class="section level3" number="3.4.5">
<h3>
<span class="header-section-number">3.4.5</span> A distribution of possible futures<a class="anchor" aria-label="anchor" href="#a-distribution-of-possible-futures"><i class="fas fa-link"></i></a>
</h3>
<p>Now we are in a position to make an informed prediction, given our assumptions. We will predict the range of possible outcomes and the most likely outcomes, given our set of assumptions.</p>
<p>We will simulate the population for 50 years 10,000 times and describe the distribution of final population sizes. We use <code>system.time</code> to tell me how long it takes on my computer.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sims</span><span class="op">=</span><span class="fl">1e4</span>; <span class="va">years</span><span class="op">=</span><span class="fl">50</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">## system.time keeps track of how long processes take.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span></span>
<span><span class="va">outmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="va">sims</span>,   </span>
<span>                    expr<span class="op">=</span><span class="fu">myForLoop</span><span class="op">(</span>obs.R<span class="op">=</span><span class="va">obs.R</span>, years<span class="op">=</span><span class="va">years</span>, initial.N<span class="op">=</span><span class="fl">43</span><span class="op">)</span></span>
<span>                    <span class="op">)</span></span>
<span>            <span class="op">)</span></span></code></pre></div>
<pre><code>##    user  system elapsed 
##   0.165   0.007   0.172</code></pre>
<p>This tells me how long it took to complete 10,000 simulations. We also check the dimensions of the output, and they make sense.</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">outmat</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1]    51 10000</code></pre>
<p>We see that we have an object that is the size we think it should be. We shall assume that everything worked way we think it should.</p>
</div>
<div id="analyzing-results" class="section level3" number="3.4.6">
<h3>
<span class="header-section-number">3.4.6</span> Analyzing results<a class="anchor" aria-label="anchor" href="#analyzing-results"><i class="fas fa-link"></i></a>
</h3>
<p>We extract the last year of the simulations (last row), and summarize it with quartiles (0%, 25%, 50%, 75%, 100%, and also the mean).</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N.2053</span> <span class="op">&lt;-</span> <span class="va">outmat</span><span class="op">[</span><span class="fl">51</span>,<span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">N.2053</span><span class="op">)</span></span></code></pre></div>
<pre><code>##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
##       0.0      12.1      60.7    1306.3     297.7 2299416.6</code></pre>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">N.2053</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-23"></span>
<img src="figs/unnamed-chunk-23-1.png" alt="Distribution of the 10000 final base-10 log population sizes. Note the approximately Normal distribution." width="75%"><p class="caption">
Figure 3.11: Distribution of the 10000 final base-10 log population sizes. Note the approximately Normal distribution.
</p>
</div>
<p>The <code><a href="https://rdrr.io/r/stats/quantile.html">quantile()</a></code> function allows us to find a form of empirical confidence interval, including, approximately, the central 90% of the observations.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Note that there are many ways to estimate quantiles (R has nine ways), but they are approximately similar to percentiles.&lt;/p&gt;"><sup>21</sup></a></p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">N.2053</span>, prob<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">.95</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<pre><code>##          5%         95% 
##    1.331579 2862.940808</code></pre>
<p>These quantiles provide an estimate of the most likely range of possible population sizes, given our assumptions.</p>
</div>
<div id="extinction-probability-expectation-and-uncertainty" class="section level3" number="3.4.7">
<h3>
<span class="header-section-number">3.4.7</span> Extinction probability: expectation and uncertainty<a class="anchor" aria-label="anchor" href="#extinction-probability-expectation-and-uncertainty"><i class="fas fa-link"></i></a>
</h3>
<p>What is the chance that the sparrow would become extinct in this region, due to these inherent processes? As one answer to this question, we can calculate the fraction of times that the population fell below 1.0 (or <span class="math inline">\(\log N = 0\)</span>). Based on the above summaries, it will be a fairly small number.</p>
<p>First, we convert persisting populations (<span class="math inline">\(N \ge 1\)</span>) to 1, and extinct populations (<span class="math inline">\(N&lt;1\)</span>) to zero. We then sum the ones and divide by the total number of all simulated populations. This gives us the fraction surviving, and that is the fraction we <em>expect</em>; it is our <em>expectation</em>…the <em>expected</em> survival probability.</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">persisting</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span> <span class="va">N.2053</span> <span class="op">&gt;=</span> <span class="fl">1</span> <span class="op">)</span></span>
<span><span class="op">(</span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">persisting</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">persisting</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.9607</code></pre>
<p>Next we ask, what is the <em>uncertainty</em> associated with that? We will find an intuitive Bayesian answer to the question: What is the probability that the sparrow would become extinct in this region, due to these inherent processes?</p>
<p>We will gain an intuition into Bayesian probability elsewhere<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Bayesian analysis allows us to estimate the probabiility that our hypothesis is true, as opposed to the probability of our data given our hypothesis (Pr(H|D) vs. Pr(D|H)).&lt;/p&gt;"><sup>22</sup></a>. For now, we will simply rely on well-established relationship between the binomial probability distribution and the beta distribution.</p>
<p>A Bayesian approach forces us to use what we already know. For us, we will start with expert opinion of whether Song Sparrows are likely to maintain a self-replacing population (a ‘source’ population - Ch. 6) and avoid extinction over our time interval. In other words, we ask Dr. Dave Russell. He says “Probably, but you can’t be sure.” Let’s represent “probably” with the beta distribution. The <strong>beta distribution</strong> generates probability densities for a random variable between [0,1], perfect for representing probabilities which always lie between zero and one. The beta distribution has two parameters, often called shape 1 (<span class="math inline">\(\alpha\)</span>) and shape 2 (<span class="math inline">\(\beta\)</span>). The mean of the beta distribution is,
<span class="math display">\[\mu = \frac{\alpha}{\alpha + \beta}\]</span></p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">base</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">base</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dbeta</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>shape1 <span class="op">=</span> <span class="fl">3</span>, shape <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y<span class="op">=</span><span class="st">"Probability density of surviving"</span>,</span>
<span>       x<span class="op">=</span><span class="st">"Probability of surviving (p)"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:survivalPrior"></span>
<img src="figs/survivalPrior-1.png" alt="Our prior belief on the probability that the Song Sparrow population in Darrtown will replace itself over our time interval. We call this the *prior probability distribution.*" width="67%"><p class="caption">
Figure 3.12: Our prior belief on the probability that the Song Sparrow population in Darrtown will replace itself over our time interval. We call this the <em>prior probability distribution.</em>
</p>
</div>
<p>Fig. <a href="expo.html#fig:survivalPrior">3.12</a> shows our <em>prior beliefs</em>. That is, before we look at our data, we think there is about a 3/5’s chance (60%) that Song Sparrows in Darrtown won’t become extinct over our time interval. How will we update our beliefs using our data?</p>
<p>First, our “data” are really just 36 years of counts and 35 estimates of annual growth (<span class="math inline">\(N_{t+1}/N_{t}\)</span>). We can do as many simulations as we like, but they are still based on only 35 annual growth estimates. Therefore, if we combine our survival estimate with the amount of data, we multiply the survival probability by the sample size and think of it as evidence in favor of surviving. Weight of evidence not in favor is the difference.</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># number of observations</span></span>
<span><span class="va">nR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">obs.R</span><span class="op">)</span>; <span class="va">nR</span> </span></code></pre></div>
<pre><code>## [1] 35</code></pre>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="co"># probability of persisting</span></span></code></pre></div>
<pre><code>## [1] 0.9607</code></pre>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># evidence in favor of survival</span></span>
<span><span class="va">nR.surv</span> <span class="op">&lt;-</span> <span class="va">nR</span> <span class="op">*</span> <span class="va">p</span>; <span class="va">nR.surv</span></span></code></pre></div>
<pre><code>## [1] 33.6245</code></pre>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># evidence in favor of extinction</span></span>
<span><span class="va">nR.ext</span> <span class="op">&lt;-</span> <span class="va">nR</span> <span class="op">-</span> <span class="va">nR.surv</span>; <span class="va">nR.ext</span></span></code></pre></div>
<pre><code>## [1] 1.3755</code></pre>
<p>Next, we update our belief about Song Sparrow persistence, using the beta distribution. It turns out that we just add the evidence in favor of and not in favor of survival to the alpha and beta parameters (shape1, shape2) to get updated values that will generate our updated beliefs.</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">updated.alpha</span> <span class="op">=</span> <span class="fl">3</span> <span class="op">+</span> <span class="va">nR.surv</span></span>
<span><span class="va">updated.beta</span> <span class="op">=</span> <span class="fl">2</span> <span class="op">+</span> <span class="va">nR.ext</span></span></code></pre></div>
<p>Now we plot our <em>updated</em> beliefs, with what we call the <em>posterior distribution.</em></p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">base</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dbeta</span>, </span>
<span>                args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>shape1 <span class="op">=</span> <span class="fl">3</span>, </span>
<span>                            shape2 <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dbeta</span>, </span>
<span>                args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>shape1 <span class="op">=</span> <span class="va">updated.alpha</span>, </span>
<span>                            shape2 <span class="op">=</span> <span class="va">updated.beta</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y<span class="op">=</span><span class="st">"Probability density of surviving"</span>,</span>
<span>       x<span class="op">=</span><span class="st">"Probability of surviving (p)"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:survivalpost"></span>
<img src="figs/survivalpost-1.png" alt="Our updated beliefs (solid line) about the probability that the Song Sparrows will replace themselves over our time interval. The solid line is the posterior distribution. The dashed line was our prior beliefs or prior distribution." width="67%"><p class="caption">
Figure 3.13: Our updated beliefs (solid line) about the probability that the Song Sparrows will replace themselves over our time interval. The solid line is the posterior distribution. The dashed line was our prior beliefs or prior distribution.
</p>
</div>
<p>A Bayesian approach to probability and learning</p>
<ol style="list-style-type: decimal">
<li>start with what we believe prior to collecting data,</li>
<li>collect some data, and then</li>
<li>update our beliefs according to the data.</li>
</ol>
</div>
<div id="inferring-processes-underlying-growth-rate" class="section level3" number="3.4.8">
<h3>
<span class="header-section-number">3.4.8</span> Inferring processes underlying growth rate<a class="anchor" aria-label="anchor" href="#inferring-processes-underlying-growth-rate"><i class="fas fa-link"></i></a>
</h3>
<p>The above approach relies only on the observed data. That means that the growth rates, while representative, can never be different than what was observed. A different approach would be to assume that the growth rates can be different than observed, <em>but drawn from the same underlying process</em> that caused the observed rates.</p>
<p>The observed rates are simply a visible manifestation of unseen processes. We might summarize these by asserting that the observed growth rates were samples from a continuous distribution distribution, whose properties we can infer from the sample. For instance, it may be that these processes cause annual rates to follow a normal<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Gaussian&lt;/p&gt;"><sup>23</sup></a>, or perhaps log-normal distribution.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;The R package fitdistplus has great capabilities for fitting distributions to data, and estimating distribution parameters.&lt;/p&gt;"><sup>24</sup></a></p>
<p>We can fit a normal distribution to the logarithms of our observed <span class="math inline">\(R\)</span>, and we see that it doesn’t do too bad a job (Fig. <a href="expo.html#fig:fitln">3.14</a>).</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">obs.R</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">obs.R</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="co"># a regular sequence for log-R</span></span>
<span><span class="va">lR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1.1</span>, by<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="co"># the probability densities for the log-R</span></span>
<span><span class="va">dR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">lR</span>, m<span class="op">=</span><span class="va">mu</span>, sd<span class="op">=</span><span class="va">sigma</span><span class="op">)</span></span>
<span><span class="co"># rescale the probability density to visible height to graph</span></span>
<span><span class="va">rdR</span> <span class="op">&lt;-</span> <span class="va">dR</span><span class="op">*</span><span class="fl">10</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">obs.R</span><span class="op">)</span>, breaks<span class="op">=</span><span class="fl">10</span>, ylab<span class="op">=</span><span class="st">"Frequency"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">lR</span>, <span class="va">rdR</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">obs.R</span><span class="op">)</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">obs.R</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:fitln"></span>
<img src="figs/fitln-1.png" alt="The logarithms of the observed R arrayed in a histogram (left) and a quantile-quantile plot comparing our log-growth rates to the normal distribution (right). Our data seem somewhat approximated by a Normal distribution whose mean and standard deviation are derived from the log-transformed data. The probability distribution has been rescaled to be visible on this graph. However, the q-q plot shows that the sample (y-axis) includes values that are smaller and larger than predicted by the normal distribution." width="50%"><img src="figs/fitln-2.png" alt="The logarithms of the observed R arrayed in a histogram (left) and a quantile-quantile plot comparing our log-growth rates to the normal distribution (right). Our data seem somewhat approximated by a Normal distribution whose mean and standard deviation are derived from the log-transformed data. The probability distribution has been rescaled to be visible on this graph. However, the q-q plot shows that the sample (y-axis) includes values that are smaller and larger than predicted by the normal distribution." width="50%"><p class="caption">
Figure 3.14: The logarithms of the observed R arrayed in a histogram (left) and a quantile-quantile plot comparing our log-growth rates to the normal distribution (right). Our data seem somewhat approximated by a Normal distribution whose mean and standard deviation are derived from the log-transformed data. The probability distribution has been rescaled to be visible on this graph. However, the q-q plot shows that the sample (y-axis) includes values that are smaller and larger than predicted by the normal distribution.
</p>
</div>
<p>Now we will simulate populations just like before, but instead of random draws from the observed data, we do random draws from the inferred distribution.</p>
<p>Our new function.</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myForLoop2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mu</span>, <span class="va">sigma</span>, <span class="va">years</span>, <span class="va">initial.N</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># select all R at random from a normal distribution</span></span>
<span>  <span class="co"># where the mean and variance are the same as our data</span></span>
<span>  <span class="va">lrR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">years</span>, m<span class="op">=</span><span class="va">mu</span>, sd<span class="op">=</span><span class="va">sigma</span><span class="op">)</span></span>
<span>  <span class="co"># exponentiate to backtransform to raw growth rate units</span></span>
<span>  <span class="va">rR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">lrR</span><span class="op">)</span></span>
<span>  <span class="co"># create a vector to hold N</span></span>
<span>  <span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="va">years</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="co"># give it an initial population size</span></span>
<span>  <span class="va">N</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">initial.N</span></span>
<span>  <span class="co"># Do the for-loop</span></span>
<span>  <span class="kw">for</span><span class="op">(</span> <span class="va">t</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">years</span> <span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># project the population one time step</span></span>
<span>      <span class="va">N</span><span class="op">[</span><span class="va">t</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="va">N</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">*</span> <span class="va">rR</span><span class="op">[</span><span class="va">t</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="co"># return the vector of N</span></span>
<span>  <span class="va">N</span></span>
<span><span class="op">}</span> </span></code></pre></div>
<p>Our new simulations.</p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 10,000 simulations, each over 50 years</span></span>
<span><span class="va">sims</span><span class="op">=</span><span class="fl">1e4</span>; <span class="va">years</span><span class="op">=</span><span class="fl">50</span></span>
<span><span class="co"># set the pseudorandom seed to 3 (for repeatability)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co"># do the replications</span></span>
<span><span class="va">outmat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="va">sims</span>,</span>
<span>                    expr<span class="op">=</span><span class="fu">myForLoop2</span><span class="op">(</span>mu<span class="op">=</span><span class="va">mu</span>, </span>
<span>                                    sigma<span class="op">=</span><span class="va">sigma</span>, </span>
<span>                                    years<span class="op">=</span><span class="va">years</span>,</span>
<span>                                    initial.N<span class="op">=</span><span class="fl">43</span></span>
<span>                                    <span class="op">)</span></span>
<span>                    <span class="op">)</span></span>
<span><span class="co">## save the last year for each of the 10,000 simulations</span></span>
<span><span class="va">N2.2053</span> <span class="op">&lt;-</span> <span class="va">outmat2</span><span class="op">[</span><span class="fl">51</span>,<span class="op">]</span></span>
<span><span class="co"># compare the 90th quantiles for our two approaches to simulations</span></span>
<span><span class="va">drawn.from.normal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">N2.2053</span>, prob<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">.95</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="va">bootstrapped</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">N.2053</span>, prob<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">.95</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>drawn.from.normal<span class="op">=</span><span class="va">drawn.from.normal</span>, bootstrapped<span class="op">=</span><span class="va">bootstrapped</span><span class="op">)</span></span></code></pre></div>
<pre><code>## $drawn.from.normal
##          5%         95% 
##    1.205509 3089.819907 
## 
## $bootstrapped
##          5%         95% 
##    1.331579 2862.940808</code></pre>
<p>The results are fairly similar to those based on only the observed <span class="math inline">\(R\)</span>. If they were markedly different, we might ask whether our choice of distribution was appropriate.</p>
<p>Our conclusions are based on a model of discrete density-independent population growth.</p>
<ul>
<li>what assumptions are we making and are they valid?</li>
<li>Are our unrealistic assumptions perhaps nonetheless a good approximation of reality?</li>
<li>what would you like to add next to make the model a better approximation?</li>
</ul>
</div>
</div>
<div id="f-environmental-noise" class="section level2" number="3.5">
<h2>
<span class="header-section-number">3.5</span> 1/<span class="math inline">\(f\)</span> environmental noise<a class="anchor" aria-label="anchor" href="#f-environmental-noise"><i class="fas fa-link"></i></a>
</h2>
<p>Perhaps we can explain some of the variation in annual growth rates of sparrows to weather patterns in the sampling area (Darrtown, Ohio). In doing so, we might be assuming the <em>environmental stochasticity</em> is worth modeling which might allow us to separate demographic effects from environmental effects. That would give us a better model we might use for explanation and prediction.</p>
<p>When we model or simulate a time series, we often find it essential to account for patterns that arise on different time scales and have different magnitudes. For instance, air temperature (and its consequences) varies diurnally, from day to day, week to week, and across seasons. We often refer to this as “one over f-noise” (<span class="math inline">\(1/f\)</span>-noise), that is, random variation of multiple overlapping asynchronous patterns of variation. This can be characterized with <em>spectral analysis</em> <span class="citation">(<a href="references.html#ref-shumway2019" role="doc-biblioref">Shumway and Stoffer 2019</a>; <a href="references.html#ref-halley1996" role="doc-biblioref">Halley 1996</a>)</span>. Spectral analysis allows us to detect cyclic repeating patterns in strongly cyclic data, such as El Niño Southern Oscillations, small mammal population cycles, tree masting dynamics, disease outbreaks. In fact, nearly all environmental variability typically shows some degree of structure that is nonrandom.</p>
<p>In addition to detecting the particular frequencies of some cycles, we can also describe multivariate emergent spectral patterns with reference to a color spectrum. When variation at all time scales is equally important, we refer to this as white noise, analogous to white light, which includes all visible frequencies. When lower frequencies are more important, we refer to this as red noise. This results from low-frequency long-wavelength patterns having greater amplitude than high-frequency, short-wavelength patterns. We refer to this as <em>reddened noise</em>.</p>
<p>Environmental variables typically have a reddened color that we often call pink noise <span class="citation">(<a href="references.html#ref-halley1996" role="doc-biblioref">Halley 1996</a>)</span>.This type of environmental variation as <em>environmental color</em>, whether white, pink, brown, or even, in the other direction, blue.</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">time.series.r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/primer/man/one_over_f.html">one_over_f</a></span><span class="op">(</span>gamma<span class="op">=</span><span class="fl">1</span>, N<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, <span class="va">time.series.r</span>, type<span class="op">=</span><span class="st">'l'</span>, main<span class="op">=</span><span class="st">"Pink noise"</span><span class="op">)</span></span>
<span><span class="va">time.series.w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/primer/man/one_over_f.html">one_over_f</a></span><span class="op">(</span>gamma<span class="op">=</span><span class="fl">0</span>, N<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, <span class="va">time.series.w</span>, type<span class="op">=</span><span class="st">'l'</span>, main<span class="op">=</span><span class="st">"White noise"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:colorex"></span>
<img src="figs/colorex-1.png" alt="Examples of reddened (left) and white (right) time series." width="67%"><img src="figs/colorex-2.png" alt="Examples of reddened (left) and white (right) time series." width="67%"><p class="caption">
Figure 3.15: Examples of reddened (left) and white (right) time series.
</p>
</div>
<p>Experimental studies of environmental variation require us to isolate different features of the variability while holding other features constant. For instance, we may want to hold the mean temperature constant but add different amounts of variation. We may want to hold the mean and the variance constant, but vary the spectral environment color. <em>Spectral mimicry</em> <span class="citation">(<a href="references.html#ref-cohen1999" role="doc-biblioref">J. E. Cohen et al. 1999</a>)</span> is a technique to helps us do that. It takes a string of numbers and arranges them into a sequence whose spectral signature mimics a designated spectral pattern. This imbues the original numbers with a different spectral pattern. Thus, the two sequences retain exactly the same data and therefore the same means and variances, but differ only in their sequences and spectral properties.</p>
<p>Below, we use spectral mimicry to simulate Song Sparrow population dynamics. We first investigate spectral mimicry by creating</p>
<ul>
<li>a string of uniform random numbers between [0,1],</li>
<li>a template that has pink (slightly reddened) sequence,</li>
<li>a rearrangement of the original string to match the spectral properties of the template.</li>
</ul>
<p>We then plot the three vectors, showing the original data, the reddened template, and then the data rearranged to approximate the template.</p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N</span> <span class="op">=</span> <span class="fl">50</span> <span class="co"># number of data points in one string</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="co"># set the pseudorandomization seed</span></span>
<span></span>
<span><span class="co">## create uniform random numbers</span></span>
<span><span class="va">N.random</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span></span>
<span><span class="co">## Pink noise template</span></span>
<span><span class="va">one.over.f.template</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/primer/man/one_over_f.html">one_over_f</a></span><span class="op">(</span>gamma<span class="op">=</span><span class="fl">1</span>, N<span class="op">=</span><span class="va">N</span><span class="op">)</span></span>
<span><span class="co">## Rearrangement (mimicry)</span></span>
<span><span class="va">N.f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/primer/man/spec_mimic.html">spec_mimic</a></span><span class="op">(</span><span class="va">N.random</span>, <span class="va">one.over.f.template</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## combine and plot</span></span>
<span><span class="va">series</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">N.random</span>, <span class="va">one.over.f.template</span>, <span class="va">N.f</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html">matplot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, <span class="va">series</span>, type<span class="op">=</span><span class="st">'l'</span>, </span>
<span>        col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, </span>
<span>       legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">series</span><span class="op">)</span>, bty<span class="op">=</span><span class="st">'n'</span>, </span>
<span>        col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:specex"></span>
<img src="figs/specex-1.png" alt="Example of spectral mimicry, showing the original random data points (solid black line), the template ('one.over.f.template', red dashed line), and the rearranged, reddened data points (solid red line)." width="90%"><p class="caption">
Figure 3.16: Example of spectral mimicry, showing the original random data points (solid black line), the template (‘one.over.f.template’, red dashed line), and the rearranged, reddened data points (solid red line).
</p>
</div>
<p>In Fig. <a href="expo.html#fig:specex">3.16</a>, the solid lines refer to the uniform data (black) and the reddened (red).</p>
<div id="reddened-song-sparrow-growth" class="section level3" number="3.5.1">
<h3>
<span class="header-section-number">3.5.1</span> Reddened Song Sparrow growth<a class="anchor" aria-label="anchor" href="#reddened-song-sparrow-growth"><i class="fas fa-link"></i></a>
</h3>
<p>Imagine that the Ohio (USA) environment of our Song Sparrows reveals <em>environmnetal stochasticity</em>, that is, random-like fluctuations that we do not understand. Next imagine that this environmental stochasticity affects Song Sparrow growth rate. If we want to simulate future sparrow population dynamics, we may want to mimic the type and magnitude of this underlying variation. We might do that by using our original annual growth data, but arranged in a reddened series.</p>
<p>Let us first examine whether the sparrow growth rates show evidence of reddened population dynamics. We can use the <code><a href="https://rdrr.io/pkg/primer/man/plot_f.html">plot_f()</a></code> in <code>primer</code> to evaluate that. It plots the time series, and then the power spectra. It fits a line to the log(power) vs. log(frequency) and calculates a frequentist confidence interval.</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/primer/man/plot_f.html">plot_f</a></span><span class="op">(</span><span class="va">Count</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:plotf-1"></span>
<img src="figs/plotf-1.png" alt="Sparrow population dynamics seems to show reddened flutuations. On the left, sparrow counts over time, and on the right, the log-log plot of the power spectrum (power vs. frequency). The frequentist confidence interval on the slope of the fitted line suggests that we shouldn't rule out the possibility of a reddened series." width="90%"><p class="caption">
Figure 3.17: Sparrow population dynamics seems to show reddened flutuations. On the left, sparrow counts over time, and on the right, the log-log plot of the power spectrum (power vs. frequency). The frequentist confidence interval on the slope of the fitted line suggests that we shouldn’t rule out the possibility of a reddened series.
</p>
</div>
<div class="figure">
<span style="display:block;" id="fig:plotf-2"></span>
<img src="figs/plotf-2.png" alt="Sparrow population dynamics seems to show reddened flutuations. On the left, sparrow counts over time, and on the right, the log-log plot of the power spectrum (power vs. frequency). The frequentist confidence interval on the slope of the fitted line suggests that we shouldn't rule out the possibility of a reddened series." width="90%"><p class="caption">
Figure 3.18: Sparrow population dynamics seems to show reddened flutuations. On the left, sparrow counts over time, and on the right, the log-log plot of the power spectrum (power vs. frequency). The frequentist confidence interval on the slope of the fitted line suggests that we shouldn’t rule out the possibility of a reddened series.
</p>
</div>
<pre><code>##      2.5 %     97.5 % 
## -2.3079822 -0.5672105</code></pre>
<p>Not surprisingly, we see the possibility of reddened population dynamics. You could also investigate the observed annual growth rates the same way.</p>
<p>To resample the sparrow growth rates and also create a reddened sequences of them, we could do two things, depending on our goals. We could create a large number of different reddened templates and mimic them using only the observed data. Alternatively, we can draw annual growth rates at random, and match each random draw to the same reddened sequence.</p>
<p>Below, we simply rearrange the observed annual growths into a single reddened sequence. For the reddened template, we will assume moderate reddening, or pink noise, for which <span class="math inline">\(\gamma = 1\)</span>.</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">R.n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">obs.R</span><span class="op">)</span> <span class="co"># number of observations</span></span>
<span></span>
<span><span class="co">## A random pink noise template</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">one.over.f.template</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/primer/man/one_over_f.html">one_over_f</a></span><span class="op">(</span>gamma<span class="op">=</span><span class="fl">1</span>, N<span class="op">=</span><span class="va">R.n</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Rearrange the observed R</span></span>
<span><span class="va">R.f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/primer/man/spec_mimic.html">spec_mimic</a></span><span class="op">(</span><span class="va">obs.R</span>, <span class="va">one.over.f.template</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## combine and plot</span></span>
<span><span class="va">series</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">obs.R</span>, <span class="va">one.over.f.template</span>, <span class="va">R.f</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html">matplot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">R.n</span>, <span class="va">series</span>, type<span class="op">=</span><span class="st">'l'</span>, </span>
<span>        col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, </span>
<span>       legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">series</span><span class="op">)</span>, bty<span class="op">=</span><span class="st">'n'</span>,</span>
<span>        col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:Rred"></span>
<img src="figs/Rred-1.png" alt="Original and rearranged" width="90%"><p class="caption">
Figure 3.19: Original and rearranged
</p>
</div>
<p>Now we can project a simulated sparrow population</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N.f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">R.f</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">)</span></span>
<span><span class="co"># give it an initial population size</span></span>
<span><span class="va">N.f</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">43</span></span>
<span></span>
<span><span class="co"># Do the for-loop</span></span>
<span>  <span class="co"># For each year...</span></span>
<span>  <span class="kw">for</span><span class="op">(</span> <span class="va">t</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">R.f</span><span class="op">)</span> <span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># project the population one time step</span></span>
<span>      <span class="va">N.f</span><span class="op">[</span><span class="va">t</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="va">N.f</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">*</span> <span class="va">R.f</span><span class="op">[</span><span class="va">t</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span><span class="co">## Graph N, and R</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">N.f</span><span class="op">)</span>, <span class="va">N.f</span>, type<span class="op">=</span><span class="st">'l'</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">27</span>,<span class="fl">90</span>, <span class="st">"Pop. size"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">R.f</span><span class="op">)</span>, <span class="va">R.f</span>, type<span class="op">=</span><span class="st">'l'</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">17</span>, <span class="fl">2</span>, <span class="st">"Randomized Pink Annual R"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">1</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:fdyn"></span>
<img src="figs/fdyn-1.png" alt="Example of a simulated sparrow projection using reddened annual growth rates." width="90%"><p class="caption">
Figure 3.20: Example of a simulated sparrow projection using reddened annual growth rates.
</p>
</div>
<p>Can you make predictions about how environmental noise might alter the risk of extinction?</p>
</div>
</div>
<div id="in-fine-1" class="section level2" number="3.6">
<h2>
<span class="header-section-number">3.6</span> <em>In fine</em><a class="anchor" aria-label="anchor" href="#in-fine-1"><i class="fas fa-link"></i></a>
</h2>
<p>In this chapter, we have explored the meaning of density-independent population growth. It is a statistically demonstrable phenomenon, wherein the per capita growth rate exhibits no relation with population density. It is a useful starting point for conceptualizing population growth. We derived discrete geometric and continuous exponential growth and have seen how they are related. We calculated doubling times. We have discussed the assumptions that different people might make regarding these growth models. We introduced a characteristic of environmental variability, <span class="math inline">\(1/f\)</span>-noise. We have used simulation to explore prediction and inference in a density-independent context. Our simulations included those with and without <span class="math inline">\(1/f\)</span>-noise.</p>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="oft.html"><span class="header-section-number">2</span> Optimal Foraging</a></div>
<div class="next"><a href="DID.html"><span class="header-section-number">4</span> Density-independent Demography</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#expo"><span class="header-section-number">3</span> Simple density-independent growth</a></li>
<li><a class="nav-link" href="#discrete-growth-rates-of-fruit-flies-in-my-kitchen"><span class="header-section-number">3.1</span> Discrete growth rates of fruit flies in my kitchen</a></li>
<li><a class="nav-link" href="#fruit-flies-with-continuous-overlapping-generations"><span class="header-section-number">3.2</span> Fruit flies with continuous overlapping generations</a></li>
<li>
<a class="nav-link" href="#properties-of-geometric-and-exponential-growth"><span class="header-section-number">3.3</span> Properties of geometric and exponential growth</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#average-growth-rate"><span class="header-section-number">3.3.1</span> Average growth rate</a></li></ul>
</li>
<li>
<a class="nav-link" href="#modeling-with-data-simulated-dynamics"><span class="header-section-number">3.4</span> Modeling with Data: Simulated Dynamics</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#data-based-approaches"><span class="header-section-number">3.4.1</span> Data-based approaches</a></li>
<li><a class="nav-link" href="#creating-and-visualizing-the-data"><span class="header-section-number">3.4.2</span> Creating and visualizing the data</a></li>
<li><a class="nav-link" href="#one-simulation"><span class="header-section-number">3.4.3</span> One simulation</a></li>
<li><a class="nav-link" href="#multiple-simulations"><span class="header-section-number">3.4.4</span> Multiple simulations</a></li>
<li><a class="nav-link" href="#a-distribution-of-possible-futures"><span class="header-section-number">3.4.5</span> A distribution of possible futures</a></li>
<li><a class="nav-link" href="#analyzing-results"><span class="header-section-number">3.4.6</span> Analyzing results</a></li>
<li><a class="nav-link" href="#extinction-probability-expectation-and-uncertainty"><span class="header-section-number">3.4.7</span> Extinction probability: expectation and uncertainty</a></li>
<li><a class="nav-link" href="#inferring-processes-underlying-growth-rate"><span class="header-section-number">3.4.8</span> Inferring processes underlying growth rate</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#f-environmental-noise"><span class="header-section-number">3.5</span> 1/\(f\) environmental noise</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#reddened-song-sparrow-growth"><span class="header-section-number">3.5.1</span> Reddened Song Sparrow growth</a></li></ul>
</li>
<li><a class="nav-link" href="#in-fine-1"><span class="header-section-number">3.6</span> In fine</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Primer of Ecology using R</strong>" was written by Hank Stevens. It was last built on 2022-10-10.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
