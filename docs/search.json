[{"path":"index.html","id":"preface","chapter":"Preface","heading":"Preface","text":"NEW EDITION E-BOOK (20 August 2021)Lotka-Volterra versions direct competition mutualism together one chapter, followed consumer-resource interactions, including predator-prey, resource-based competition mutualism.chapter consumer-resource competition mutualism follows chapters covering two-species consumer resource interactions (mostly predator-prey).> 1 y since looking primer package, might want peruse index - added functions including ones 1/f noise, spectral mimicry, Allee effect.based book published Springer, “Primer Ecology R,” part Use R! series.primer package CRAN (v. 1.2.0) suffice edition. may also install directly GitHub. , install devtools package. successfully Windows operating system, think need install Rtools:https://cran.r-project.org/bin/windows/Rtools/done , use code:spite presumptuous title, goals book modest. wrote asthe manual wish graduate school, anda primer graduate course Population Community Ecology Miami University.1AcknowledgementsI grateful generosity early reviewers readers, contributed much quality work: Jeremy Ash, Tom Crist, David Gorchov, Raphael Herrera-Herrera, Thomas Petzoldt, James Vonesh, well several anonymous reviewers, students Population Community Ecology class past 15 years. also grateful many conversations emails shared four wonderful mathematicians theoreticians: Jayanth Banavar, Ben Bolker, Stephen Ellner, Steve Wright — never conversation people without learning something. particularly fortunate team-taught Population Community Ecology Miami University two wonderful scientists educators, Davd Gorchov Thomas Crist. experience, working closely colleagues, able attempt book. go without saying, emphasis, mistakes book mine, many sharp eyes insightful minds many people.also deeply indebted R Core Development Team creating, maintaining pushing forward R programming language environment. Like air breathe, imagine (professional) life without . grateful developers packages allowed literate programming Rmarkdown LaTeX, using RStudio GitHub.indebted Rachel Collins size-structured coneflower data, Scott Meiners colleagues generous sharing data, metadata, statistical summaries Buell-Small Succession Study (http://www.ecostudies.org/bss/). like thank Stephen Ellner Ross’s Bombay death data R code insight past years. also indebted Tom Crist colleagues sharing moth data (work supported Nature Conservancy Ecosystem Research Program\nNSF DEB-0235369).Last, importantly, like thank life make living worthwhile.Martin Henry Hoffman StevensOxford, OH, USA, EarthToday, Current Era","code":"devtools::install_github(\"HankStevens/primer\")"},{"path":"theory.html","id":"theory","chapter":"1 Theory in Ecology","heading":"1 Theory in Ecology","text":"chapter, introduce perspective ecological theory, provide two examples efficient theory, metabolic scaling maximum entropy theory.Theory really, really important. Without theory sort guide us, merely counting pebbles quarry. Good theory may conceptual mathematical, helps us focus clearly less ambiguous manner systems study. book, explore mathematical models provide special cases theory.Scientific theory body knowledge provides organized mechanistic view world works (Samuel M. Scheiner 2010). Theories concerning gravity, general relativity, evolution natural selection provide structured ways connecting observations, patterns, processes provide insight world way . stands stark contrast colloquial use theory implies lack knowledge, someone says “oh, ’s just theory,” referring guess without much evidence. Scientific theory set explanations whose validity tested repeatedly experiments new data.","code":""},{"path":"theory.html","id":"examples-of-theories","chapter":"1 Theory in Ecology","heading":"1.1 Examples of theories","text":"Ecology lots theories, different types. discuss may prevalent, important, useful, combination.","code":""},{"path":"theory.html","id":"hierarchy-theory","chapter":"1 Theory in Ecology","heading":"1.1.1 Hierarchy theory","text":"early persistent organizing schema ecology based hierarchy theory (O’Neill et al. 1986; Rose et al. 2017, references therein). posits ecological systems structured hierachically, entity comprises subunits. instance, entity population big bluestem grass (Andropogon gerardii) part larger ecology community many species. population big bluestem comprises subpopulations separated space, subpopulation comprises separate individuals, individual comprises multiple ramets set organ systems tissues, comprise different cell types. theory posits entity gives rise emergent properties hierarchical level , influences processes within smaller sub-entity hierachical level . disciplinary organizing principle, approach structures nearly ecology curriculum.Hierarchy theory gets complicated levels hierarchy start include fundamentally different types entities. big bluestem hierarchy included biotic components–individual part population part community individuals multiple species, made organ systems tissues. Ecology, however, includes biotic abiotic parts environments. ecosystem includes community species, also nutrients, water, light, abiotic components, along spatial arrangement things.Different hierarchies useful different questions. individual organism can play different roles different hierarchies. Consider individual bunch grass. understand population evolves, need count individuals within population, evolutionary fitness tracked number independent reproductive units. contrast, understand competitive interactions, may much important weigh biomass groups individuals population, biomass closely related resource uptake.","code":""},{"path":"theory.html","id":"a-general-theory-of-ecology","chapter":"1 Theory in Ecology","heading":"1.1.2 A general theory of ecology","text":"Good scientific theories exist within hierarchy disciplinary knowledge (S. M. Scheiner Willig 2011). explain phenomena within domain knowledge organized around principles assumptions. Scheiner Willig posit theory biology explains phenomena relating “diversity complexity living systems.” One ten principles theory depends “cell fundamental unit life.” Subsumed within theory biology theory cells whose domain “cells causes structure, function, variation.” theory turn based principles theories organize understanding cells cells .Models specific explicit manifestations general theories. book, focus popular mathematical models specific manifestions theories ecology.S. M. Scheiner Willig (2011) propose theory ecology, cover book. part theory:General Theory EcologyDomain: spatial temporal pattern distribution abundance organisms, including causes consequences.Principles:Organisms distributed space time heterogeneous manner.Organisms interact abiotic biotic environments.Variation characteristics organisms results heterogeneity ecological patterns processes.distributions organisms interactions depend contingencies.Environmental conditions perceived organisms heterogeneous space time.Resources perceived organisms finite heterogeneous space time.Birth death rates consequence interactions abiotic biotic environment.ecological properties species result evolution.principles constitute know true ecological systems. principles provide focus single chapter principles apply broadly many chapters book.perspective general theory ecology:Domain: house life2: constituent entities, causes, consequences.Principles:Entities3 open systems inputs outputs.Entities internal complexity.Entities include self-replicating components (living elements).Entities interact via inputs, outputs, behavior.Rates change, including inputs outputs, influenced directly physical factors: space, temperature, concentration.see elements principles throughout book well.","code":""},{"path":"theory.html","id":"efficient-theory","chapter":"1 Theory in Ecology","heading":"1.1.3 Efficient theory","text":"Marquet et al. (2014) argue best theories efficient. theories tend based first principles, observations laws fundamental assumptions scientific domain. biology, principles can include laws thermodynamics, mathematical properties central limit theorem. Theories built upon first principles thus well-grounded reality understand lead logically refinements. Marquet colleagues also claim efficient theory expressed mathematics. Mathematics universal language unamibiguous. forces us clear possible mean state theory.4 Last, efficient theories make large number predictions using small number free parameters.5 Examples efficient theories cover book include metabolic scaling, exponential growth, density dependence, ecological neutral theory.Marquet et al. Scheiner Willig emphasize slightly different features definition “theory.” Scheiner Willig emphasize relatively broad ideas well-supported experiments repeated observation. Marquet colleagues tend mean something fairly specific narrow, typically something can expressed mathematically. Scheiner Willig might refer theory constitutive theory even simply model.Next, describe Metabolic Theory Ecology. theory based first principles, central tenets expressed mathematically. ’s core equation small number free parameters (fitted constants) makes large number testable predictions. Parts theory supported large number observations. fits everyone’s definition theory.","code":""},{"path":"theory.html","id":"metabolic_scaling","chapter":"1 Theory in Ecology","heading":"1.2 An example: Metabolic Theory of Ecology","text":"Metabolic rate central rapidly individuals forage , consume use resources, reproduce die. metabolic theory ecology (Brown et al. 2004) well-supported body knowledge underlying mechanisms, resulting profound wide-ranging consequences populations ecosystems.Body size temperature fundamental properties organisms environment. study body shape body processes scale body size allometry. body size affects metabolic rate, body size indirectly helps determine population growth rates species interact . Temperature affects molecules vigorously molecules vibrate move, increasing temperature tends speed chemical reactions. metabolism really just complex network biochemical reactions, temperature influences metabolic rate.core theory expressed simple mathematical equation describes body size temperature govern metabolic rate.","code":""},{"path":"theory.html","id":"body-size-dependence","chapter":"1 Theory in Ecology","heading":"1.2.1 Body-size dependence","text":"profoundly simple general rule describing effect interspecific variation body size metabolism.6 biological law referred Kleiber law (Kleiber 1932), quarter power scaling (Brown et al. 2004). compare basal (.e. resting) metabolic rates different species, across wide range body sizes spanning many orders magnitude, find thatwhole-organism resting metabolic rate increases organism mass raised three-quarter power, ,\\[\nB = ^{z} \\quad;\\quad z = 3/4\n\\]equation, \\(B\\) basal, resting, metabolic rate, \\(M\\) body mass, \\(\\) proportionality constant, \\(z\\) power law scaling coefficient. proportionality constant \\(\\) varies depending type organism arthropods, fish, mammals. Plants scale manner (Niklas Enquist 2001), although size mass little trickier measure. scaling coefficient, \\(z\\), seemingly magical constant many argued vary substantially among different types organisms.Ecologists typically describe metabolism-mass relations power law behavior using logarithmic scales. , power law relations become linear. Using rules exponents logarithms, metabolic scaling becomes\n\\[ \\log B = \\log + z\\log M\\]\n\\(\\log B\\) increases linearly \\(\\log M\\) slope \\(3/4\\). brains can process compare linear relations much easily curvilinear ones.plot curvilinear relation R using curve() graphics package R included base installation one core packages. function curve() can plot curve expressed function x. , draw curve dotted 1:1 line comparison, add power function \\(x^{3/4}\\).\nFigure 1.1: Metabolic rate increases predictably species body sizes.\nhelp us grasp implications , let’s consider mass-specific metabolic rates. “Mass-specific” means per-gram basis.7 Mass-specific metabolic rate basal metabolic rate individual divided mass, \\(B/M\\).mass-specific metabolic rate allows us compare directly, example, metabolic rate cell shrew vs. cell elephant. cell burning fuel faster?can estimate metabolic scaling principle using rules exponents\n\\[ \\frac{B}{M} = \\frac{M^z}{M^1} = M^{z-1} = ^{-1/4}\\]\n, now rule thatmass-specific metabolic rate declines organisms mass raised negative one quater power\nFigure 1.2: Mass-specific metabolic rate declines predictably species body sizes.\nyears, heated debate () precise value scaling coefficient \\(z\\), (ii) underlying mechanism. Early arguments suggested \\(z \\approx 2/3\\) rate heat dissipation scales amount surface area. \\(2/3\\)?Let’s envision volume organism three linear dimensions, volume scales cube linear dimensions, surface area scales square linear dimensions,8\n\\[V \\propto L^3\\]\n\\[\\propto L^2\\]\nearly explanation metabolic rate, \\(B\\), scales linearly area,\n\\[B \\propto ^1 \\propto L^2\\].\nsubstitution get,\n\\[L^2 \\propto V^z \\propto (L^3)^z\\]\nimplying exponents \\(2 = 3z\\) \\(z=2/3\\), get,\n\\[B=V^{2/3}\\],\n, part, mass scales linearly volume mammals group.early theory started first principles (heat dissipation geometry) resulted prediction single parameter. used make predictions metabolic rate scales body mass. Metabolic rate governs huge amount biology ecology, including resource consumption rates, lifespan, maximum population growth rates. Therefore, theory model powerful tools understanding world making testable predictions.model good tested. done, scientists found consistent mismatch observations theory. Investigators showed value exponent appeared closer 3/4 raher 2/3. 1990s, group including Jim Brown Geoffrey West (West, Brown, Enquist 1997) proposed underlying mechanism explained 3/4. assumed organisms mustdistribute resources single source branching, fractal-like, space-filling network parts body,size smallest branch ( capillary) organisms sizes.energy required distribute resources must minimized, less energy-efficient designs lost natural selection.prediction resulted assumptions exponent 3/4. theory model begin different first principles makes different prediction.Soon Jayanth Banavar colleagues offered alternative (J. R. Banavar, Maritan, Rinaldo 1999; Jayanth R. Banavar et al. 2002), arguing assumption fractal-like network correct, event, necessary apply organisms. proposed different theory less restrictive assumptions found nonetheless exponent also predicted 3/4.base arguments geometry resource distribution system. organisms take limiting resources distribute resources part cell body. key point larger organism, greater portion resources transit instant time. leads increasingly inefficient system, metabolism larger organisms run slowly per unit resource:Larger organisms can process resources per unit time (\\(B=^{3/4}\\)), less less efficiently (\\(\\frac{B}{M}=^{-1/4}\\)) due resources transport.Banavar, Brown others eventually collaborated address quarter power scaling animals particular led additional novel predictions (J. R. Banavar et al. 2010).theory remains fertile active area research (Glazier 2018). interested reader careful distinguish patterns observed across many species different sizes, versus patterns observed single species individuals different sizes versus types patterns. Subtly different patterns may driven different mechanisms.","code":"\n## using curve, let your variable be 'x'.\ncurve(1*x, from = .01, to=100, ylab = \"Metabolic rate (B)\",\n      xlab=\"Body mass (M)\", lty=3)\ncurve(x^(3/4), from = .01, to = 100, add=TRUE)\neq1 = function(M, a){a*M^-0.25} # create the function, F(M)\nggplot(data=data.frame(x=c(0.1, 100)), aes(x=x) ) + \n  stat_function(fun=eq1, geom=\"line\", args=list(a=1)) + \n  xlab(\"Mass (M)\") + ylab(\"Mass-specific metabolic rate (B/M)\")"},{"path":"theory.html","id":"temperature-dependence","chapter":"1 Theory in Ecology","heading":"1.2.2 Temperature dependence","text":"addition body size, temperature plays key role regulating metabolic rate. Arrhenius equation connects macroscopic property temperature kinetic energy molecules rates govern. Metabolic rate proportional rate determining processes,\n\\[B  = e^{\\frac{-E_a}{kT}}\\]\n\\(\\) just constant, \\(e\\) exponential, \\(E_a\\) average activation energy rate-limiting enzymes (units, eV), \\(k\\) Boltzmann’s constant (units eV\\(\\,\\)K\\(^{-1}\\)), \\(T\\) (units deg K). Bolztmann’s constant (\\(\\backsim 8.6 \\times 10^-5\\)\\(\\,\\)eV\\(\\,\\)K\\(^{-1}\\)) converts macroscopic property temperature kinetic energy molecules.Individual biochemical reactions combine determine basal metabolic rate, Gillooly (2000) taken foundation metabolic theory ecology (Brown et al. 2004). 2000, suggested average activation energy approximately \\(E_a = 0.23\\,\\)eV . Subsequent work described “temperature sensitivity,” larger numbers imply organisms respond strongly temperature variation.Arrhenius equation little complicated simple power law, much. range biologically relevant temperatures, dominated largely exponential increase metabolic rate increasing temperature (Fig 1.3).\nFigure 1.3: effect body temperature ectothermic metabolic rates can approximated Arrhenius function, \\(B = e^{-E_a/(kT)}\\). \\(= 10^4\\), \\(E_a = 0.23\\). similar shape power law z > 1, range biologically relevant temperatures.\nlinearize relation metabolic rate temperature, get\n\\[\n\\begin{aligned}\nB &= e^{\\frac{-E_a}{kT}}\\\\\n\\log(B) &= \\log{} - E_a\\frac{1}{kT}\\\\\n\\end{aligned}\n\\]\ndependent variable \\(1/(kT)\\), \\(-E_a\\) slope, \\(\\log \\) intercept. Thus, negative slope relation describes theoretical prediction effect temperature metabolic rate., . metabolic theory ecology algebraic product body size- temperature-dependence:\n\\[B = M^{3/4} e^{\\frac{-E_a}{kT}}\\]\ntheory makes quantitative predictions regarding kinds ecology phenomena (Brown et al. 2004), includinghome range sizepopulation growthpopulation sizeresource uptakepredation species interactions, andecosystem cycling.Note relations based first principles geometry thermodynamics, depend small number parameters (\\(\\), \\(-E_a\\), perhaps \\(z=3/4\\)), makes tremendous number predictions. Therefore, Marquet et al. (2014) propose “good” theory, efficient.","code":"\n# with base R\n# base R: curve(10^4*exp(-0.23/(8.5 * 10^-5 *x)), 276, 316), ylab=\"B\", xlab='T')\n# or ggplot2\n# the function, with default parameter values\neq.t <- function(t,a=10^4,E=0.23,k=8.6 * 10^-5){a*exp(-E/(k*t))}\n# the data used in our function\ntemps <- data.frame(t=276:316)\nggplot(data=temps, aes(x=t)) + \n# set the basic properties of the plot\n  stat_function(fun=eq.t, geom=\"line\") + \n# set the function to plot\n  xlab(\"Temperature (K)\") + ylab(\"Metabolic rate (B)\")  \n# add labels"},{"path":"theory.html","id":"power-law-scaling-implies-constant-relative-differences","chapter":"1 Theory in Ecology","heading":"1.3 Power law scaling implies constant relative differences","text":"power law scaling, relative change constant. , proportional change one variable results proportional change . instance, compare smaller species larger species \\(100 \\times\\) body mass, can expect see metabolic rate increase \\(31.6 \\times\\), regardless mass smaller species. now, verify numerically limited cases.Now divide mass \\(\\) next smallest mass \\(-1\\). using vector dividing mass except first one, mass except last one.\nTable 1.1: increase mass constant multiplier (10x), power law scaling results constant proportional change basal metabolc rate.\ncan verify generally using algebra, just particular case . show mass increases constant multiplier, metabolic rate also, regardless particular masses involved.Let mass \\(m_2\\) greater mass \\(m_1\\) factor \\(c\\), \\(m_2 = c m_1\\), \n\\[\\frac{m_2}{m_1} = c\\].like show ratio metabolic rates \\(b_2 / b_1\\) also constant. Since \\(m_2 = cm_1\\), can say \n\\[b_1 = m_1^{3/4}\\]\n\\[b_2 = (cm_1)^{3/4} = ac^{3/4}m_1^{3/4}\\]\n\\[\\frac{b_2}{b_1} = \\frac{ac^{3/4}m_1^{3/4}}{am_1^{3/4}}\\]\nreduce fraction, left \n\\[\\frac{b_2}{b_1} = c^{3/4}\\]shows power law scaling, increasing \\(x\\) constant multipier (proportion), \\(y\\) increases proportion raised power.Let’s represent graphically couple ways, reusing data made previously chapter. First, just change axes , units scales multiples 10 (often scientific notation).\nFigure 1.4: changing scales axes linearize power law relations. Note scales logarithmic, using original linear values.\n","code":"\n# define body mass and metabolic rate\nm <- c(.01, 1, 100, 10000)\nb <- m^.75\n# round(x, digits=0) rounds number to zero decimal places\nround( m[-1]/m[-length(m)], digits = 0)\nround( b[-1]/b[-length(b)], digits = 1)\n# using base R\npar(mar=c(5,4,0,0), mgp=c(1.5,.4,0) )# set figure margins in \"lines\"\ncurve(x^(3/4), from = .01, to = 100, log=\"xy\", ylab=\"Basal metabolic rate\", xlab=\"Mass\")\ntext(10, 80^.7, expression(M^0.75))"},{"path":"theory.html","id":"meet-mete-maximum-entropy-theory-of-ecology","chapter":"1 Theory in Ecology","heading":"1.4 Meet METE: Maximum Entropy Theory of Ecology","text":"Maximum Entropy Theory Ecology best known making predictions elucidating patterns species-area relations species abundance distributions emerge relatively stable ecological communities ecosystems (John Harte Newman 2014). However, active area research Harte others extending ideas non-equilibrium systems well (John Harte, Umemura, Brush 2021).Entropy , basically, disorder. Less entropy means order structure. Maximum entropy maximum disorder. universe tends toward maximum entropy, although places times, like parts world right now, entropy can decrease. Physicists folks responsible understanding entropy, Edwin Jaynes arguably one responsible understanding appreciation role information probability.MaxEnt, principle maximization information entropy, principle maximum entropy , given set constraints system, least-biased probability distribution describes data arising system one maximum entropy.principle maximum entropy show maximal uncertainty arising flattest distribution, given known constraints, provides least biased description system. can provide least biased probability distributions situations constraints:Consider jar contains jelly beans, contains least one 1000. least biased distribution possible counts jelly beans?Imagine hectare land contains trees different heights, mean height three meters. least biased distribution possible tree heights?Regarding forest - told variance height two meters? least biased distribution possible tree heights?principle maximum entropy help us prove , absence information, least biased distributions sets constraints uniform, exponential, Gaussian (normal) probability distributions.maximum entropy theory ecology (John Harte Newman 2014) can tell us expect know little, little going aside random noise.talk METE chapter diversity, mention emphasize patterns arise ecology via random noise.rank-abundance distribution famous ecological pattern. log-abundance relative abundance species, arranged abundant least abundant (Fig. 1.5).\nFigure 1.5: Rank abundance distribution tree species 50 ha plot Barro Colorado Island. Line best fit log-normal distribution.\ncurve formed data points (left, Fig. 1.5) steep first, among abundant species. curve flattens bit getting little bit steeper . group species logarithmic abundance categories, make histogram abundances, get *species abundance distribution.\" Preston (1962) noted distributions remarkabling similar normal (Gaussian) distribution, abundances log-transformed (resulting lognormal-like distribution). turns curve quite common decades ecologists argued might infer underlying ecological processes basis shape curve. discussion died ecologists admitted impossible determined processes basis pattern.discussion shape rank-abundance distribution revived late nineties Steve Hubbell showed pretend individuals equally likely live die, independent species identity, expect pattern (Hubbell 2001). Later, John Harte showed principle maximum entropy general approach question extended realms patters.example, consider community five individuals three species. constraints, \\(N=5\\), \\(S=3\\). many different possible distributions species abundances can get assume maximum uncertainty, .e., maximum entropy? way know? , can count .Consider five individuals distributed among three species (rows) list possible community states (columns).rank species abundance distributions care species abundant, just different species exist can different abundances. Maximum entropy us ask, “average abundance abundant species?” Let’s calculate . can see abundant species either 3 individuals two individuals occurs three times. Therefore average abundance abundant species calculated asor two half individuals five individuals whole community.least abundant species? least abundant species always one individual. Therefore, second abundant species , average, 1.5 individuals.\nFigure 1.6: Expected rank abundance distribution, given five individuals three species, maximum entropy theory ecology.\none prediction METE: given number individuals number species, can predict species abundance distribution.","code":"\nlibrary(vegan)\ndata(BCI)\nabun <- colSums(BCI)\nmod <- rad.lognormal(abun)\nplot(mod, main=\"Rank-abundance distribution\")\n\nmod.oct <- prestonfit(colSums(BCI))\nplot(mod.oct, main=\"Species abundance distribution\")  \n# by default, R fills matrices by columns.\nstates <- matrix(\n  c(3,1,1, # column 1,\n    1,3,1, # column 2, etc.\n    1,1,3,\n    2,2,1,\n    2,1,2,\n    1,2,2),\n  nrow = 3 )\n# label species\nrownames(states) <- LETTERS[1:3]\nstates # each column is a possible configuration.##   [,1] [,2] [,3] [,4] [,5] [,6]\n## A    3    1    1    2    2    1\n## B    1    3    1    2    1    2\n## C    1    1    3    1    2    2\n(3+3+3+2+2+2)/6## [1] 2.5\nqplot(x=1:3, y=c(2.5, 1.5, 1), geom=c(\"point\", \"line\")) + \n  labs(y=\"Expected abundance\")"},{"path":"theory.html","id":"in-fine","chapter":"1 Theory in Ecology","heading":"1.5 In fine","text":"Useful theory helps us think clearly sometimes imaginatively world works. Good theory usually efficient theory, making greatest number predictions fewest free parameters. helps clarify thinking disentangle myriad mechanisms play ecological systems.","code":""},{"path":"oft.html","id":"oft","chapter":"2 Optimal Foraging","heading":"2 Optimal Foraging","text":"\nFigure 2.1: Optimal foraging theory (OFT) generates testable quantitative predictions allow less ambiguous description explanation observed patterns processes. , simplistic model Great Tit (Parus major) foraging includes gross energy intake underestimates time spent patches (dashed). contrast, model includes energetic costs traveling searching matches predictions far better (solid). Cowie (1977).\ncan useful think natural selection optimizing process: phenotypes diversify, winners replicate losers don’t, phenotypes winners tend get passed replicants. Therefore, often assume, Dr. Pangloss, species exist now best possible species, , optimal design. like Dr. Pangloss, woefully mistaken stopped . Nonetheless, optimization, , tendency toward optimum, helps us generate testable hypotheses consider .Optimal Foraging Theory (OFT) helps us consider organisms foraged optimally. organisms–plants, fungi, archaea, even animals–forage, subject natural selection. Therefore, phenotypes work pretty well, probably optimally definitely optimally times places. Nonetheless, OFT efficient theory behavior organism, absence complications. Therefore, allows us study relative importance “complications.”Foraging key link individual, communities ecosystems (Beckerman, Petchey, Morin 2010). organisms interact environment via consumption, choices make influence population dynamics, species interactions, nutrient cycling, even physical structures terrestrial aquatic habitats. text logic chapter rely heavily Stephens Krebs (1986) S. P. Ellner (2009).Scheiner Willig’s edited volume Theory Ecology, Andy Sih (Sih 2011) proposes following propositions form basis foraging theory:Foraging patterns maximize fitness correlate fitness.Foraging patterns depend range options available forager available option affects fitness correlate fitness.Foraging behaviour balances conflicting demands–tradeoffs important shaping foraging behaviour.properties outcome natural selection operating foraging behavior. understanding foraging considers three features (Stephens Krebs 1986):currency (optimized),constraints (features behaviour limit optimality), andthe resulting decision rules.Currency quantity optimized forager. currency assumed quantity limits fitness, energy particular consumable resource. measure rate, instance, energy gained per unit time (E/T) uptake critically limiting resource per unit time (R/T).Constraints limitations assume organisms. might include distances resource patches, time costs associated extracting resource substrate subduing prey. also include constraints imposed species including competitors predators. Constraints can get complicated quickly; however, simple quantitative theory makes predictions can evaluate complicated assumptions.Decision rules ascribed forager’s choices. decision rule concern probability attacking prey encountered, leave one resource patch order search another.additional way think , , . great deal effort focused understanding patch use: foragers explore resources, give go search another patch (Charnov 1976). patch use models, based economic models marginal value theorem.Another avenue inquiry concerns animals eat. instance, go big prey may hard catch difficult subdue, just snack easy? prey models diet models, attempt explain organisms consume .note “prey.” organisms forage resources. Plants extend branches toward light, proliferate leaves roots resource rich patches, rhizomes grow longer faster resource-poor soils. Bumblebees search learn find nectar-rich flowers, wolves hunt packs take large ungulates. bacterivorous nanoflagellates intercept particles selectively depending perceived nutritional value particles (Boenigk et al. 2002). , depending forager, “prey” may \\(\\mathrm{}_{3}^-\\) ions, nectar, moose, bacteria. Therefore, refer resources variously prey, prey items, resources, resource items. ideas best handled patch-based models (Charnov 1976) “resource patch” intuitive useful unit.note “handle.” organisms pays costs consume resources. OFT, “handle” typically means expending energy time attack subdue prey (predators), proliferate resource rich areas (plants), exude extra cellular enzymes (fungi); ingest item(s), resume searching.","code":""},{"path":"oft.html","id":"a-prey-model","chapter":"2 Optimal Foraging","heading":"2.1 A prey model","text":"…forager asks, “eat ?”9Let’s start field started, prey-centered model (MacArthur Pianka 1966; Emlen 1966).goal optimize currency.","code":""},{"path":"oft.html","id":"our-intuition","chapter":"2 Optimal Foraging","heading":"2.1.1 Our intuition","text":"\nFigure 2.2: amount energy, E (y-axis), lost gained foraging ant–may decline slowly time (x-axis) searching, decline quickly handling food item. ant gains energy consumes item. : ant. expends energy searching food. Upon encountering food item, may choose ‘handle’ (encounters 1 3) gain energy, handle (encounter 2) save added cost handling .\nseems reasonable forager encounters food, eat . However, handling costs forager gets back energy, isn’t worth . might think ratio profitability,\n\\[\\frac{e_i}{h_i}\\]\n\\(e_i\\) energy item type \\(\\), \\(h_i\\) cost handling said item. \\(e_i/h_i<1\\), doesn’t make sense select item. , handling item means forager looking better food item. suggests even \\(e_i/h_i>1\\), forager may want handle likely soon encounter food items higher energy content. top , act searching may expose forager risk running competing foragers, even eaten bigger forager. Clearly, forager faces tradeoffs searches encounters resources.","code":""},{"path":"oft.html","id":"mathematical-support","chapter":"2 Optimal Foraging","heading":"2.1.2 Mathematical support","text":"One reasons represent ideas mathematically make concrete assumptions, math can tell us predictions . .Let’s assume natural selection tends maximize currency Gain per unit Time, \\(G/T\\). model use parameters variables:\\(=\\) index prey type\\(S =\\) total time spent searching (units = seconds, \\(s\\)).\\(\\lambda_i =\\) rate encounter prey type \\(\\) (units = # encountered/s = \\(\\#/s\\); note can also #/area × area/s, like)10\\(p_i =\\) probability forager attacks prey encountered (units number handled per number encountered, #/#; dimensionless parameter)\\(h_i =\\) handling time item type \\(\\), (units = s/#).\\(T =\\) total elapsed time (units = s)definitions can calculate important quantities.Total number items encountered type \\(\\) \n\\[S \\lambda_i\\]units \\(s\\, \\#\\,s^{-1} = \\#\\).Total number type \\(\\) items handled proportion, \\(p_i\\), encountered foragers chooses go , \n\\[S\\lambda_i p_i\\]\nunits \\(\\#\\).Total time spent handling items type \\(\\) \n\\[H=S\\lambda_i p_i h_i\\]\nunits \\(s\\).11Total elapsed time time spent searching plus time spent handling, \\[T=S + \\sum_i^n S\\lambda_i h_i p_i\\]\nuse summation add together total handling times prey resource type \\(= \\{1,\\,2, \\ldots ,\\,n\\}\\).Let\\(e_i =\\) net energetic gain catching consuming single type-prey item (units = Joules, J). includes gross energy item minus handling costs plus energy lost searching time.\\(c =\\) energy cost per unit time searching (units = J).Total energy gain eating items number items type \\(\\) handled times net amount energy per item type \\(\\), \\(e_i\\), \\[\\sum_{=1}^n S\\lambda_i p_i e_i\\]\nunits \\(\\# (\\mathrm{J}/ \\#) = \\mathrm{J}\\).Therefore, rate energy intake (J/\\(s\\)) handling eating \n\\[\\mathrm{intake} = \\frac{\\sum_{=1}^n S\\lambda_i p_i e_i}{S + \\sum_{=1}^n S\\lambda_i h_i p_i}\\]\nsubtract cost searching, arrive quantity want maximize,\n\\[G/T=\\frac{\\sum_{=1}^n \\lambda_i p_i e_i}{1 + \\sum_{=1}^n \\lambda_i p_i h_i}-c\\]\nmajor question OFT whether forager include particular prey type. Say rank prey types, \\(=\\{1,2,...,m,...,n\\}\\), terms energy content, type \\(=1\\) energy per item, \\(=m\\) intermediate, type \\(=n\\) least. items forager include diet? energy-dense, include second well, ? Part answer rests ratio energy gain versus handling costs, profitability, \\(e_i/h_i\\).maximized \\(G/T\\) respect \\(p_j\\), able determine whether include item \\(j\\). leads several predictions.Prediction 1 less energy-dense item added net energy content greater realized energy gain items,\\[\\begin{equation}\n\\frac{e_{m+1}}{h_{m+1}} > \\frac{\\sum_{=1}^m \\lambda_i e_i}{1 + \\sum_{=1}^{m} \\lambda_i h_i} \\tag{2.1}\n\\end{equation}\\]diet already includes items 1-\\(m\\), realized energy content diet takes account average encounter rates item type. means foraging always select particular type (\\(p_j =1\\)), never select (\\(p_j=0\\)); known “zero-one rule.”Prediction 2 Foragers rank prey types profitability, \\(e/h\\).Prediction 3 encounter rates increase (increasing abundances), selectivity increases. Note encounter rates right hand side, increase, fraction right. make harder inequality true, forager pickier. don’t believe , try simplified version (Fig. 2.3).\nFigure 2.3: Selectivity increases average encounter rates.\nPrediction 4 Inclusion type \\(m+1\\) diet depend encounter rate. Thus, particular type included instantaneous net gain type greater realized long term average net gain profitable types. Note encounter rate appears right hand side, left.model fair real world? Well, zero-one rule doesn’t work ; turns variety reasons, foragers completely ignore low-profit prey. However, great support predictions () (Stephens Krebs 1986). importantly, cases, theory provided clear framework generate testable predictions unambiguous assumptions, want efficient theory. model helped guide research, inclusion greater complexity led deeper understanding behavior consequences species interactions.","code":"\nG.T = function(lambda, h=1, e=1){lambda*e/(1+lambda*h)} # create the function you want\nmyData <- data.frame( lambda=c(0, 10) ) # data you need\nggplot(data=myData, aes(x=lambda)) + # set the basic properties of the plot\n  # in the stat_function, we indicate the parameters in our equation.\n  stat_function(fun=G.T, geom=\"line\") +\n  ylab(bquote(over(lambda*e, 1 + lambda*h))) + xlab(bquote(lambda))  # add labels"},{"path":"oft.html","id":"the-patch-model","chapter":"2 Optimal Foraging","heading":"2.2 The patch model","text":"…omniscient rationale agents roam free.forager asks, “long stay ?” simple prey model, forager searches encounters prey one time, makes decision consume , resumes searching. simple patch model, forager searches encounters patches one time, first consumes resources makes decision leave . Perhaps single important prediction simple patch model forager leave patch current rate energy gain drops average expected rate energy gain habitat large.follows, rely Charnov (1976), applies marginal-value theorem explain optimal behavior. , economics, “marginal value” refers rate - slope function. calculus, derivative. , derivative (.e. slope) relation energy gain time.Let’s assume simplest patch models: one patch type, patches , distributed randomly habitat. Assume also forager uses time travel patches (travel time, \\(t_t\\)) time searching within patch (residence time, \\(t_r\\)). forager encounters patches random, rate \\(\\lambda\\), , mean time next encounter \\(1/\\lambda\\).\nFigure 2.4: Net energy gain function patch residence time may take different forms. Net energy gain increases time slows (decelerates) greater fraction resources patch consumed. top line (solid) assumes diminishing returns patch depleted, forager continues find resources excess metabolic losses. lower line (dashed) represents net energy gain arise patch depleted fully costs continue unabated.\nTry :Draw gain function prey remain well hidden first, forager becomes increasingly able find prey.Draw gain function cost foraging, forager eventually depletes prey.one graph, draw two gain functions resource rich patch resource poor patch., currency long-term average energy intake, \\(R\\), want maximize . decision forager needs make long stay patch. forager’s constraints share similarity prey model (Stephens Krebs 1986).-patch travel time within-patch hunting time distinct, …… independent ,forager encounters patches sequentially randomly,given patch, net expected energy gain function time spent patch……zero \\(t=0\\), …increases time, deceleratesthe forager omniscient - knows everything available patches learn anything new forages (already knows everything).forager must decide long stay patch maximize \\(R\\). Let\n\\[R=\\frac{g(t_r)}{t_t + t_r}\\]\n\\(t_t + t_r\\) total time leaving one patch, traveling next patch, foraging second patch, leaving second patch. Think benefit (\\(g(t)\\)) per unit time. fraction slope straight line Fig. 2.5.Intuitively, can imagine long term average rate energy gain \\(R\\) unimodal (hump-shaped) following scenario (Fig. 2.4). Upon encountering patch forager resources thus \\(R\\) actually negative due costs traveling new patch. \\(t_r\\) passes forager gains energy (\\(g(t_r)\\) increases), \\(R\\) increase become positive. assumption theory (reality) gain function, \\(g(t_r)\\), decelerates–rate energy intake declines patch depleted. increasing time patch lower rate energy intake, \\(R\\) starts decline.\\(t_r\\) short, \\(R\\) yet maximizes. \\(t_r\\) long, \\(R\\) begins decline. \\(R\\) hump-shaped, can use calculus find maximum. occur slope zero, slope function, \\(F\\), derivative, \\(F^\\prime\\). asssume travel time constant, can take partial derivative \\(R\\) respect just residence time, \\(t_r\\), \\(\\delta R / \\delta t_r\\). First, recall product rule differentiation:\n\\[F(x) = g(x)f(x)\\quad ; \\quad F^\\prime(x) =f^\\prime(x)g(x) +  f(x)g^\\prime(x)\\]\ncan find necessary derivative.\n\\[\\frac{\\delta R}{\\delta t_r} = - \\frac{1}{(t_t+t_r)^2} g(t_r) + \\frac{1}{t_t+t_r}g^\\prime(t_r)= g^\\prime(t_r) - \\frac{g(t_r)}{t_t+t_r}=0\\]\nderivative equals zero slope gain function (\\(g^\\prime(t_r)\\)) equals \\(R\\), tells use \\(R\\) maximized point. Therefore, predicts order maximize long-term average rate, stay patch instantaneous rate, \\(g^\\prime(t_r)\\) drops long term average rate, \\(R\\) (Fig. 2.5).\nFigure 2.5: Energy gain vs. time: origin forager enters patch; left time spent traveling one patch next, right time spent patch. graph represents two different habitats, one patches easy get (habitat 1), another takes time get patch patch (habitat 2). cases, patches identical, gain function. curved line gain function, net energy gain function time spent patch. slope curve derivative gain function. slope single time point instantaneous rate gain. two straight lines expected gains averaged time habitat whole. Lambda rate forager randomly encounters patches - Poisson process, mean expected time 1/lambda. forager leave patch instantaneous rate gain patch equals long term average rate gain habitat whole.\nsimple patch model predicts average travel time greater, foragers stay longer patch. Similarly, model predicts patch quality lower, foragers stay longer patch. Use Fig. 2.5 construct explanations predictions.Just starting pointThe simple prey patch models extended great deal help understand broad range foraging situations (Sih 2011). Simultaneous, rather sequential, encounters can lead different predictions. cases, energy alone, \\(e_i\\), rather profitability, \\(e_i/h_i\\), may determine prey selection maximizes long term mean average rate. Travel time encounter rates interact explain contrasting situations.Central place foragers play slightly different rules (Stephens Krebs 1986). Central place foragers located single location, remain . instance, parent bird (dinosaur) finds patches returns repeatedly nest, bringing one multiple prey items. parent birds, fitness depends offspring viability, selection tends optimize manner similar organism foraging . cases built upon patch models, question exploit patches exist different distances nest.Another example central place forager spider acts ambush sit--wait predator remains stationary prey item gets close enough attack. One approach spider problem consider distance prey handling cost search costs negligible.simple foraging models provide starting points field inquiry spanning many decades. interplay models, natural history species, experiments led greater appreciation organisms behave , consequences evolution food webs ecosystems reside.","code":""},{"path":"oft.html","id":"a-simulation-of-a-prey-model","chapter":"2 Optimal Foraging","heading":"2.3 A simulation of a prey model","text":"Next, embark simulation simple prey model. start assumptions:two prey types, \\(= {1,2}\\)ranked effective energy contents, \\(e_1 > e_2\\)equal handling times, \\(h_1=h_2=1\\)equal relative abundances, \\(r_1=r_2=0.5\\)encounter rates determined overall prey encounter rate, \\(\\lambda\\), relative abundances \\(\\lambda_i = \\lambda r_i\\).equal probability attack prey encountered, \\(p_1=p_2=1\\).search cost constant, \\(c_s=0.01\\)addition properties, simulation needs several bookkeeping parameters variables order track forager energy content. need run finite amount time; ’ll control total search time, Total. Remember encounter rates means actual encounters random stochastic. result, forager may go lean periods net energy intake negative.need keep track total elapsed time, cycle, search time, search cost, handling time, energy gain.let forager forage 60 minutes examine structure output object.N number foraging cyclesG net energy gainTt total elapsed timeseries dataframe two variables: net.e energy gain minus search costs cycle, cycle.start elapsed time cycle startsparams list includes parameters used runNow let’s graph something, graphs fun.\nFigure 2.6: cumulative energy capital forager goes searching handling resource items, increases time prey assimilated.\nUse simulation help solidify mind predictions simple prey model. ?prediction interested ?Prediction: Include type 2 \n\\[\\begin{equation}\n\\frac{e_2}{h_2} > \\frac{\\lambda_1 e_1 }{1 + \\lambda_1 h_1} \\tag{2.2}\n\\end{equation}\\]\nFigure 2.7: right hand side prediction\nget sense prediction (2.2) means, graph righthand quantity function one relevant variable, energy content type 1, encounter rate (Fig. 2.7). parameters determined curves :","code":"\noptimal.forager <- function(\n  e = c(2, 1), # energy content of the prey types\n  h = c(.5, .5), # handling times\n  r = c(.5, .5), # relative abundance of prey types: sum(r) = 1\n  lambda = 0.4, # overal encounter rate, for all prey combined\n  p = c(1,1), # prob. of attack if encountered\n  cs = 0.4, # cost of searching per unit time\n  Total = 10 # limit to foraging time\n  ) {\n###############\n### begin foraging\nec <- NULL # an object to tally gains and costs.\ncycle <- 0 # the cycle count (= search, choose and maybe attack and eat)\nct <- 0 # start time of the cyclesan object to tally cycle times.\nelapsed.time <- 0 # total time spent foraging\nwhile( elapsed.time < Total ) {\n  # count which search cycle we're on\n  (cycle <- cycle + 1)\n  \n  # a random amount of search time, t.s, until it finds something.\n  (lambda.r <- lambda * r)\n  (ts <- rexp(2, rate=lambda.r))\n  if(ts[1] < ts[2]) i <- 1 else i <- 2\n  i\n  # cost of searching for that time\n  (cost.s <- ts[i] * cs)\n\n  # choose to attack the encountered item with probability p\n  (gain <- if(p[i] > runif(1)){e[i]} else {0})\n  \n  # observed handling time \n  if(gain > 0 ){\n    h.obs <- h[i]\n    h.obs\n  } else {\n    h.obs <- 0\n  }\n   h.obs\n (cycle.time <- ts[i] + h.obs )\n ct <- c(ct, cycle.time)\n (elapsed.time <- elapsed.time + cycle.time)\n (ec <- c(ec, gain - cost.s))\n}\ndf <- data.frame(net.e = ec, cycle.start = cumsum(ct[1:cycle]))\nparams <- list(e=e, h=h, r=r, lambda=lambda, p=p, cs=cs, Total=Total)\n  out <- list(N = cycle, G = sum(ec), Tt = sum(ct), \n              series = df,\n              params = params)\n  return(out)\n}\nmyOut <- optimal.forager(Total=60)\nstr(myOut)## List of 5\n##  $ N     : num 26\n##  $ G     : num 22.8\n##  $ Tt    : num 61.1\n##  $ series:'data.frame':  26 obs. of  2 variables:\n##   ..$ net.e      : num [1:26] 0.201 0.762 0.456 1.262 1.125 ...\n##   ..$ cycle.start: num [1:26] 0 2.5 3.59 7.95 10.3 ...\n##  $ params:List of 7\n##   ..$ e     : num [1:2] 2 1\n##   ..$ h     : num [1:2] 0.5 0.5\n##   ..$ r     : num [1:2] 0.5 0.5\n##   ..$ lambda: num 0.4\n##   ..$ p     : num [1:2] 1 1\n##   ..$ cs    : num 0.4\n##   ..$ Total : num 60\nggplot(myOut$series, aes(x=cycle.start, y=cumsum(net.e))) + geom_line() \nunlist( myOut$params )##     e1     e2     h1     h2     r1     r2 lambda     p1     p2     cs  Total \n##    2.0    1.0    0.5    0.5    0.5    0.5    0.4    1.0    1.0    0.4   60.0"},{"path":"oft.html","id":"lab-exercise","chapter":"2 Optimal Foraging","heading":"2.3.1 Lab exercise","text":"parameter values suggest forager include prey type 1 diet?Create parameter combinations forager () (ii) include prey type 2.Use simulation optimal.forager() confirm predictions.","code":""},{"path":"expo.html","id":"expo","chapter":"3 Simple density-independent growth","heading":"3 Simple density-independent growth","text":"\nFigure 3.1: Song Sparrow (Melospiza melodia) counts Darrtown, OH, USA. Sauer, J. R., J.E. Hines, J. Fallon. 2005. North American Breeding Bird Survey, Results Analysis 1966–2004. Version 2005.2. USGS Patuxent Wildlife Research Center, Laurel, MD.\n\nFigure 3.2: Song Sparrow (Melospiza melodia) annual changes population size function population size.\n1966 1971, Song Sparrow (Melospiza melodia) abundance Darrtown, OH, USA, seemed increase quickly, perhaps unimpeded particular factor (Fig. 3.1, 3.2). effort manage population, may want predict future population size. may also want describe growth rate population size terms mechanisms influence growth rate. may want compare growth relevant mechanisms Song Sparrow populations passerine populations. , start simplest population phenomena, geometric exponential growth.Geometric exponential growth examples density-independent growth. captures fundamental process reproduction (e.g., making seeds babies) results geometric series.13 instance, one cell divides make two, two cells divide make four, , reproduction cell results two cells, regardless many cells population—mean density-independent. myopically observed event reproduction, whether one cell two, one plant producing many seeds, genesis geometric series. Therefore, models populations include \nfundamental process geometric increase. Second, populations can grow density-independent fashion resources plentiful. behooves us start simple model , complex population models include process.. Hastings (2011) proposes can approach single species poulation growth either microscopic macroscopic point view. microscopic approach begins two propositions. first know location, timing, traits individuals, can predict perfectly population dynamics; second can never predict dynamics perfectly births deaths fundamentally random can described probabilities.14 microscopic approach, seek detailed description individuals build complex model understand consequences characteristics interacting individuals, including growth population.chapter, choose start Hastings’ macroscopic approach. propositions appear simpler.population grows exponentially absence forces.forces can prevent population growing exponentially.consequences following assumptions.individuals population identical.migration population.number offspring per individual (per capita birth death rates) constant time, (ii) independent number individuals population.\nnumber offspring per individual (per capita birth death rates) constant time, (ii) independent number individuals population.Deviations assumptions lead interesting parts single species population dynamics (. Hastings 2011). deviation play chapter concerns assumption c; model stochastic variation population growth rate investigate extinction risk. also worth mentioning , although propositions 1 2 follow assumptions -d, strictly necessary (. Hastings 2011). instance, individuals need identical, deal big exception next chapter introduce structured population growth. Also, migration admissable, provided immigration = emigration alter growth rates. Nonetheless, deviations . b. can important consequences single species population dynamics.define Density-independence real population lack statistical relation density population, per capita growth rate15. power detect significant relation two continuous variables depends factors govern statistical power, number observations, range predictor variable, strength underlying relation. Therefore, conclusion, particular population exhibits density-independent growth, may trivial sample size small, generations sampled, sampled population narrow range densities. Nonetheless, behooves us come back definition , , get caught biology particular organism.chapter, ’ll introduce density-independent population projection, growth, per capita growth, populations synchronous reproduction (discrete models), continuous reproduction (continuous models).","code":""},{"path":"expo.html","id":"discrete-growth-rates-of-fruit-flies-in-my-kitchen","chapter":"3 Simple density-independent growth","heading":"3.1 Discrete growth rates of fruit flies in my kitchen","text":"Summertime, living easy. Fruit flies kitchen, number’s quite high. Flies love ripe fruit, red wine. drown wine–sure good bad.now, ’ll treat fruit flies grow discrete generations. common populatilons live seasonal habitats - reproduction timed season, breed altogether one bout.16I count number flies every week, find numbers:several ways can describe fruit fly population growth. begin thinking proximate causes change population size per unit time: births, immigration, death emigration (Fig. 3.3). options, state thus:\n\\[\\frac{\\Delta N}{\\Delta t} = \\frac{B + - D - E}{\\Delta t}\\]\n, pop growthe rate17 determined numbers births, deaths, migrants per unit time.past month, suspect fruit flies increasing primarily reproduction kitchen. Clearly, point past, fly two (three) must immigrated kitchen, either adults eggs larvae fruit brought home (\\(>0\\)). now, assume fruit fly population dynamics kitchen governed births deaths (\\(=E=0\\)), , \n\\[ \\frac{N_{t+1} - N_t}{(t+1) - t}=\\frac{\\Delta N}{\\Delta t}=\\frac{B+D}{\\Delta t}\\]\nequation, \\(t\\) particular time unit, one week, \\(t+1\\) one additional week. refer population like closed, closed migration .\nFigure 3.3: number fruit flies kitchen depends immigration emigration, births deaths. text, assume immigration emigration zero. rates individuals per unit time.\nlike represent births deaths proportions existing adults. , \n\\[B = bN;\\quad D=dN\\]\nreflects biological realities adults produce offspring, everyone chance dying. parameter \\(b\\) positive real number, \\(b \\ge 0\\). model births reflects geometric property reproduction: specified time interval \\(\\Delta t\\), average parent makes \\(b\\) babies. Parameter \\(d\\) real number zero one, \\(0 \\le d \\le 1\\). \\(b\\) \\(d\\) units individuals per individual per unit time. depend unit time.offspring die next census?Fig. 3.3 helps us think things. Simplifying, ’ll assume births occur first, death comes offspring adults.Let’s define terms.\\(N_0\\), \\(N_1\\) - number flies start first time interval.\\(N^\\prime\\), \\(N^{\\prime\\prime}\\) - distinct values \\(N\\), just births.\\(\\Delta N\\) - change \\(N\\) one point time another.\\(t\\) time, \\(\\Delta t\\) time interval \\(N\\) may change.Let’s match numbers going kitchen. first census count, \\(t=0\\), counted adults label number \\(N_0\\). adults lay eggs hatch, larvae pupae develop, become adults, giving us population \\(N^\\prime = N_0 + bN\\)eggs fail hatch, larvae die\nmaturing. Many adults die well. assume eggs,\nlarvae, adults die rate, end one\ngeneration \\(N_1 = dN^\\prime = d(N_0 + bN)\\).Substituting multiplying get\n\\[ N_1 = N_0 + bN_0 - d\\left(N_0 + bN_0\\right)\\]see next time point, \\(t=1\\), number fruit flies\nequal number started , \\(N_0\\), plus number\nnew individuals, \\(bN_0\\), minus number original adults \ndie, \\(dN_0\\), minus number new individuals die, \\(dbN_0\\).can pull parameters together,\n\\[ N_1 = N_0 + bN_0 - dN_0 - dbN_0 \\]\n\\[ N_1 - N_0 =  N_0 \\left(b - d - db\\right)\n= N_0 + r_dN_0 \\tag{3.1}\\]\\(r_d = b - d - db\\).growth rate population \\(\\Delta N / \\Delta t\\), , \\(t=0\\), \n\\[\\frac{\\Delta N}{\\Delta t} = \\frac{N_1 - N_0}{t_1-t_0} = \\frac{(N_0 + r_dN_0) - N_0}{t_1-t_0} = r_d N_0 \\]\ngeneralize, drop zero, get \\(r_dN\\). per capita population growth rate \\(r_dN/N =r_d\\)). time step something 1, also divide \\(\\Delta t\\).simple census data , can\nestimate \\(r_d\\) first time step.\n\\[N_1 = N_0 + r_dN_0=  2 + r_d (2) \\implies r_d=1\\]\nknow \\(r_d\\) constant time, can infer general rule project population forward time arbitrary number time steps. let \\(\\lambda = 1+r_d\\).\n\\[N_1 = N_0 + r_dN_0 = N_0(1 + r_d) = N_0\\lambda\\]\n\\[N_2 = N_1\\lambda=  (N_0 \\lambda)\\lambda\\]\n\\[N_3 = N_2\\lambda=  (N_0 \\lambda)\\lambda\\lambda\\]\nsimply,\n\\[N_t = N_0\\lambda^t\\]summarize model discrete population growth, following statements:Projection:\n\\[N_t = N_0\\lambda^t\\]Population growth rate:\n\\[\\frac{\\Delta N}{\\Delta t} = r_dN; \\quad \\mathrm{~} \\lambda=1+r_d\\]Per capita opulation growth rate:\n\\[\\frac{\\Delta N}{N\\Delta t} = r_d\\]last, see model density-independent growth: per capita growth rate include \\(N\\).","code":"\nt <- c(0, 1, 2, 3)\nN <- c(2, 4, 8, 16)\nqplot(x=t, y=N, geom=c(\"line\", \"point\") )"},{"path":"expo.html","id":"fruit-flies-with-continuous-overlapping-generations","chapter":"3 Simple density-independent growth","heading":"3.2 Fruit flies with continuous overlapping generations","text":"reality kitchen, individual fruit flies sex reproducing schedules. population, breed continuously, cohorts re synchronous. populations like , need describe instantaneous growth rates, \\(\\Delta t\\) longer fixed period time, instant, infinity small.return example (Fig. 3.3), summarize (3.1). Please take look equation; make time explicit appears equation. begin remembering \\(b\\) \\(d\\) time units.Let \\(\\Delta t\\) small fraction \\(t\\), time step goes \\(t\\) \\(t + \\Delta t\\).\\(\\Delta t \\rightarrow 0\\), \\(b\\) \\(d\\) need shrink well, \\(\\Delta t b\\) \\(\\Delta t d\\).\\(dN/dt\\) identify differential equation instantaneous rate population growth, lower case \\(d\\) symbolizing infinitesimally small change.now solve limit \\(\\Delta N /\\Delta t\\) \\(\\Delta t\\) goes zero.\n\\[\\frac{dN}{dt}=\\lim_{\\Delta t \\rightarrow 0} \\frac{N_{t+\\Delta t} - N_t}{\\Delta t} = \\lim_{\\Delta t \\rightarrow 0} \\frac{\\Delta t\\,bN_t - \\Delta t \\,dN_t - \\Delta t\\, d (\\Delta t\\, b)N_t}{\\Delta t} \\]\ndivide \\(\\Delta t\\) let \\(\\Delta t \\rightarrow 0\\), get\n\\[\\frac{dN}{dt}=\\lim_{\\Delta t \\rightarrow 0} bN_t - dN_t - \\Delta t\\, d bN_t = bN_t - dN_t=rN\\]arrive projection equation continuously growing population, integrate \\(rN\\) respect time. Integration cumulative summing \\(y\\) across range \\(x\\). even uses exagerated “S” indicate summation, \\(\\int\\). integrate population growth across time. start rearranging\n\\[\\frac{dN}{dt} = rN \\Rightarrow \\frac{dN}{N} = r dt\\]Now integrate \\(N\\) \\(r\\) respect start end points: \\(N\\) \\(N_0\\) \\(N_t\\), , correspondingly, \\(r\\) \\(t=0\\) \\(t=t\\),\n\\[\\int_{N_0}^{N_t} \\frac{1}{N}dN = \\int_{0}^{t}rdt\\]\n\\[\\ln(N_t) - \\ln(N_0) = rt - r\\,0\\]\n\\[\\ln(N_t) = \\ln(N_0) + rt\\]\nnow exponentiate (\\(e^x\\)) sides arrive projection equation.\n\\[N_t = e^{\\ln(N_0) + rt} = N_0 e^{rt}\\]summarize model continuous population growth, following statements.Projection:\n\\[N_t = N_0 e^{rt}\\]Population growth rate:\n\\[\\frac{dN}{dt} = rN\\]Per capita population growth rate:\n\\[\\frac{dN}{Ndt} = r\\]\n, see refer exponential growth density-independent: per capita growth rate depend \\(N\\).","code":""},{"path":"expo.html","id":"properties-of-geometric-and-exponential-growth","chapter":"3 Simple density-independent growth","heading":"3.3 Properties of geometric and exponential growth","text":"Compare projection equations geometric exponential growth. find \n\\[\\lambda = e^{r} \\quad ; \\quad \\ln \\lambda = r\\]\ngives us useful rules thumb.change: \\(r = 0\\quad;\\quad\\lambda =1\\)Growing population: \\(r > 0 \\quad;\\quad \\lambda > 1\\)Shrinking population: \\(r < 0 \\quad;\\quad \\lambda < 1\\)Time scaling useful property ever want change time units discrete model. must first \\(\\lambda\\) \\(r\\), change units \\(r\\) convert back \\(\\lambda\\). instance, find annual finite rate increase population crickets \\(\\lambda = 1.2\\), convert monthly rate \\(1.2/12 = 0.1\\). Instead convert \\(r\\) back \\(\\lambda\\)., different \\(\\lambda/12\\).Doubling time Sometimes gain intuitive grasp idea convert different form relationship. Exponential growth one ideas can hard grasp. intuitive way compare express exponential grwoth rate doubling time, time required population double size. instance, per capita growth rate \\(r = 0.14\\,\\mathrm{inds}\\cdot \\mathrm{ind}^{-1} \\mathrm{y}^{-1}\\) means population double less 5 years.determine letting \\(N_t = 2N_0\\).\n\\[2N_0 = N_0 e^{rt}\\]\n\\[\\ln 2 = rt\\]\n\\[t =\\frac{\\ln 2}{r}\\]\nFigure 3.4: Doubling time inversely related intrinsic rate increase, r.\n","code":"\n# Let r take on three values\nr <- c( -1, 0, 1)\n# Convert to lambda\nexp(r)## [1] 0.3678794 1.0000000 2.7182818\nlambda <- 1.2\n\n# Convert lambda to r \nr <- log(lambda); r## [1] 0.1823216\n# Scale r from year to month\nr2 <- r/12; r2## [1] 0.01519346\n# Convert back to lambda (per month)\nlambda2 <- exp(r2); lambda2## [1] 1.015309\n# let r be a sequence from \nr <- c(0.01, 0.05, 0.1, 0.5)\n#doubling time will be\nlog(2)/r## [1] 69.314718 13.862944  6.931472  1.386294\n# and a picture\npar(mgp=c(1.2, .2, 0), mar=c(2, 2, 1, 1), tcl=-.2)\ncurve( log(2)/x, xlab=\"r\", ylab=\"Doubling time\")"},{"path":"expo.html","id":"average-growth-rate","chapter":"3 Simple density-independent growth","heading":"3.3.1 Average growth rate","text":"real data set, real population fruit flies Song Sparrows, \\(N_{t+1}/N_t\\) vary year year. calculate average growth rate fluctuating population?Let’s consider case population increases decreases. year, calculate annual rate increase \\(R = N_{t+1}/N_t\\), take arithmetic average rates see makes sense.arithmetic average rates \\((1.5 + 0.5 + 1.0)/3=1.0\\). \\(R=1.0\\), , average, population stay , decreased. ?Let us annual time steps explicitly see going .\n\\[N_3 = (N_0 R_0) R_1 R_2\\]calculation, see start \\(N_0=20\\) annaul steps, wind smaller population, even though arithmetic average \\(R_{\\mathrm{ave}} = 1\\). calculate average numbers multiply together?want number \\(\\bar{R}\\) \n\\[\\bar{R}^t = R_1R_2\\ldots R_t\\]find , simply solve \\(\\bar{R}\\)\n\\[(\\bar{R}^t)^{1/t} =\\bar{R} = \\left(R_1R_2\\ldots R_t\\right)^{1/t}\\]\ntake \\(t\\)-th root product \\(R\\). called geometric average. Another way writing use product symbol, \n\\[\\bar{R} = \\left(\\prod_{=1}^t R_i\\right)^{1/t}\\]Another way thing take arithmethic mean log-growth rates, back-transform,Now see effect calculating average growth rate correctly. leads useful rule thumb: random variation growth rate suppresses population growth. illustrate . start growing population.\\(\\lambda > 1\\), population grows.Now simulation let \\(\\lambda\\) mean 1.01 allow vary randomly.\nFigure 3.5: Random variation growth rate alters long term average growth rate.\nSometimes arithmetic average close correct average, never correct approach.","code":"\nN <- c(20, 30, 15, 15)\nR <- N[2:4]/N[1:3]; R## [1] 1.5 0.5 1.0\n# Remember that we call the first time t=0 and N0, but\n# when coding, these values are the first in a series, so \n# N0 is N[1]\n\n# Now we do the annual changes which should equal N3\nN[1]*R[1]*R[2]*R[3]## [1] 15\nR## [1] 1.5 0.5 1.0\n#arithmetic average\nmean(R)## [1] 1\n# geometric average\nt <- length(R); t## [1] 3\nprod(R)^(1/t)## [1] 0.9085603\n# shows the population should decline\nexp( mean( log(R) ) )## [1] 0.9085603\nlambda <- 1.01 # positive growth rate\nN0 <- 100 # starting N\nt <- 20 # 20 years\nNt1 <- N0*lambda^t; Nt1## [1] 122.019\n# create a vector to hold all N\nN <- rep(0, t); N[1] <- N0\n\n# create t-1 random lambdas with a mean of 1.01 \n# ranging from 0.41 to 1.61\nset.seed(3) # makes the radnom sequence repeatable\nrandom.lambda <- runif(n=(t-1), min=0.41, max=1.61)\n\n# the geometric mean\nprod(random.lambda)^(1/length(random.lambda))## [1] 1.00105\n# actual simulated projection\nfor(i in 1:(t-1)) { \n  N[i+1] <- N[i] * random.lambda[i]\n}\n\nqplot(x=0:(t-1), N, geom=c(\"line\", \"point\"), xlab=\"Time (y)\")"},{"path":"expo.html","id":"modeling-with-data-simulated-dynamics","chapter":"3 Simple density-independent growth","heading":"3.4 Modeling with Data: Simulated Dynamics","text":"Science strives make predictions behavior systems.\nEcologists conservation biologists frequently strive predict fate populations. referred population viability analysis (PVA) large field endeavor vital managing threatened populations. put practice ideas population biology make informed predictions fate Song Sparrow population Darrtown, OH. also illustrate simple computational methods .preceding sections (bulk chapter) emphasized understanding deterministic underpinnings simple forms density independent growth: geometric exponential growth. section explores stochastic simulation density independent growth. simulation makes assumptions made beginning chapter. addition, assume observed annual growth rates (\\(N_{t+1}/N_t\\)) representative future growth rates, growth rate one year entirely independent year.make meaning full projections future population size, quantify uncertainty guess. Simulation one way can project populations quantify uncertainty. way one often use original data sample randomly calculate model parameters. way, simulations random, based best available knowldge, .e., real data. re-use observed data occurs many guises, known often bootstrapping resampling.highly influential paper miminmum population sizes conservation, Shaffer (1981) identifies four different types noise stochasticity important driving variability populations. first demographic stochasticity. random correctly stochastic nature individual births deaths. Due element random chance, individuals may live die, produce offspring . result, population size fluctuation randomly. important small populations, becomes increasingly unimportant larger larger populations. process underlies genetic drift small populations.Another source variation Shaffer (1981) identifies environmental stochasticity. temporal variation birth death rates affects individuals similar degree, due variation population’s biotic abiotic environment.last sources variation genetic stochasticity natural catastrophes. Perhaps latter difficult deal , catastrophes , definition, enormously consequential unpredictable.Given sources uncertainty, Shaffer (1981) defines minimum population size (MVP) thus,“minimum viable population given species given habitat smallest isolated population 99% chance remaining extant 1000 y despite foreseeable effects demographic, environmental genetic stochasticity, natural catastrophes.”simulations, take one approach simulating population Song Sparrows. computational approaches includes variety tricks use serious approach population projection determining probabilities extinction. supplemental documentation, Chaudhary Oli (2019) provide excellent list criteria evaluate someone else’s approach PVA.","code":""},{"path":"expo.html","id":"data-based-approaches","chapter":"3 Simple density-independent growth","heading":"3.4.1 Data-based approaches","text":"use observed changes population counts \\(R_t=N_{t+1}/N_t\\) data. draw \\(R_t\\) random among many observed values, project population one year forward. repeat future, say, ten years. simulation ten year period result different ten year trajectory draw \\(R_t\\) random among observed \\(R_t\\). However, many simulations, distribution outcomes can describe simple statistics (e.g., median, mean, quantiles).different approach estimate individual probabilities births deaths entire Darrtown population, use probabilities birth rates simulate entire population future. individual-based simulation, simulate fates individuals, keeping track individual births deaths.myriad approaches, give taste might possible. section focus first alternatives, use observed \\(R_t\\) simulate dynamics Song Sparrow counts. , part, data, estimates birth rates death rates.investigate Song Sparrow (Melospize melodia) dynamics using data annual U.S. Breeding Bird Survey (http://www.mbr-pwrc.usgs.gov/ bbs/). willcreate examine visually data (annual \\(R\\)’s),simulate one projection,scale multiple simulations,simplify simulations perform 1000s times, andanalyze output.","code":""},{"path":"expo.html","id":"creating-and-visualizing-the-data","chapter":"3 Simple density-independent growth","heading":"3.4.2 Creating and visualizing the data","text":"Let’s start graphing data18. Graphing data always good idea — principle working data. first load data primer R package, look names data frame. choose attach data frame, makes code easier read.19Now plot counts time (Fig. 3.6).\nFigure 3.6: Observations Song Sparrows Darrtown, OH (http://www.mbr-pwrc.usgs.gov/bbs/).\nsee Song Sparrow counts site (DARRTOWN transect, OH, USA) fluctuated fair bit 1966 2003. never completely absent never exceeded \\(\\sim 120\\) individuals.Next calculate annual \\(R_t=N_{t+1}/N_t\\), , observed growth rate year \\(t\\).Thus data observed \\(R_t\\), counts per se. \\(R\\) form basis everything else . important, let’s plot well. Let’s also indicate \\(R=1\\) horizontal dotted line visual cue zero population growth. Note exclude last year \\(R_t\\) associated \\(N_t\\) rather \\(N_{t+1}\\).\nFigure 3.7: Annual growth rates (R=N[t+1]/N[t]) Song Sparrows\nOne thing emerges graphic data display (Fig. 3.7) unusually high growth rate early 1990’s, rest data clustered around 0.5–1.5. may want remember .","code":"\nlibrary(primer)\ndata(sparrows)\nnames(sparrows)## [1] \"Year\"           \"Count\"          \"ObserverNumber\"\nattach(sparrows)\nggplot(data=sparrows, aes(x=Year, y=Count)) + geom_line() + geom_point(pch=1)\n# the use of [-1[ in the index tells R to exclude the first element.\n# length() is the length of a vector, so [-length(X)] means exclude the last\nobs.R <- Count[-1]/Count[-length(Count)]\nqplot(x=Year[-length(Count)], y=obs.R, geom=\"point\") + geom_hline(yintercept=1, lty=3) + \n  labs(y=bquote(N[t+1]/N[t]), x=\"Year (t)\")"},{"path":"expo.html","id":"one-simulation","chapter":"3 Simple density-independent growth","heading":"3.4.3 One simulation","text":"simulation ,determine number years wish simulate,create empty vector, N, hold simulated \\(N\\), years + 1 long,draw random sample \\(R_t\\), one year (R),select starting abundance \\(N_0\\) put N[1].multiply first random \\(R\\), R[1], times N[1] generate next, N[2].repeat step 5 year simulate N[t+1] R[t] N[t].First, decide many years want simulate growth, create empty vector hold data.vector \\(N\\) one longer number \\(R\\) use. \\(R\\) sthe change one year next always one next \\(R\\).Next draw 10 \\(R\\) random replacement. just like 35 observed \\(R\\) written slips paper dropped paper bag. draw one slip paper bag, write number , put slip paper back bag, repeat 9 times. resampling replacement. case, assuming \\(R_t\\) important occur point, just don’t know —constitute entire universe possiblities. R function sample .\n[random process occurs imagination, perhaps quantum level.20 stochastic process one treat operationally random acknowledging complex underlying deterministic drivers. pseudorandom process completely deterministic hidden process used computers programmers generate numbers distinguished random; can repeat pseudorandom process stipulating key hidden starting point.]can use set.seed() make pseudorandom process mine, .e., repeatable.Now 10 \\(R\\), use generate population sizes time. , need use programmers call -loop. brief, -loop repeats series steps predetermined number times.Let’s start simulated N sparrow count last year.Now ready use -loop project population. year \\(t\\), multiply \\(N_t\\) randomly selected \\(R_t\\) get \\(N_{t+1}\\) put \\(t +1\\) element N.Let’s graph result.\nFigure 3.8: single simulated population projection.\nappears work (Fig. 3.8). Let’s review done. Wehad bird count year 36 years. calculated 35 \\(R\\) (years except last).\n decided many years wanted project population (10,y).\n* drew random replacement observed \\(R\\)—one \\(R\\) year want project forward.\n* created empty vector put initial value (last year’s real data).\n* performed year’s calculation, put vector made.Fig. 3.8 represent? represents one possible outcome trajectory, assume \\(R\\) equal probability observed \\(R_t\\). particular trajectory unlikely, require one particular sequence randomly selected \\(R\\)s. However, less likely particular trajectory.one realization set randomly selected \\(R\\), Fig. 3.8 tells us little. need now replicate process large number times, examine distribution outcomes, including moments distribution mean, median, confidence interval eventual outcomes.","code":"\nyears <- 10\nN <-numeric(years+1) # rep(0,years+1) would do the same thing.\nset.seed(3)\n# Draw a sample of our observed R with replacement, \"years\" times.\n(rRs <- sample(x=obs.R, size=years, replace = TRUE))##  [1] 1.4489796 0.8125000 1.0714286 1.2857143 0.7727273 0.4805195 1.2857143\n##  [8] 1.0500000 0.7204301 1.4489796\nN[1] <- Count[length(Count)]\nfor( t in 1:years) { \n# starting with year = 1, and for each subsequent year, do... \nN[t+1] <- N[t] * rRs[t]\n}\nqplot(0:years, N, geom=c(\"point\",\"line\"))"},{"path":"expo.html","id":"multiple-simulations","chapter":"3 Simple density-independent growth","heading":"3.4.4 Multiple simulations","text":"Now create way perform simulation several times. couple tricks use . still want start small can figure steps go. next.start creating function steps .replicate independent simulations, using replicate().write function combine several steps.function seems work. Next ten projection simulations, 50 time steps, using sparrow data.Now let’s peek results (Fig. 3.9). fun graph output, also helps us make sure making heinous mistake code. Note use log scale help us see small populations.\nFigure 3.9: Using matplot() plot matrix vs. single variable. simulated populations sometimes increase sometimes decrease.\n\nFigure 3.10: Using ggplot() plot one variable vs. single variable, organized grouping variable. simulated populations sometimes increase sometimes decrease.\nmean simulation approximately even distribution final population sizes  (Fig. )? plotted linear scale, look like?^[Plotting log scale reveals relative change independent population size; true rate change geometric. plotted linear scale, see many trajectories result small counts, get really big. , median size pretty small, populations get huge.}Rerunning simulation, new \\(R\\) time, show different dynamics every time, point simulations. Simulations way make key assumptions, leave rest chance. sense null model population dynamics.","code":"\nmyForLoop <- function(obs.R, years, initial.N) {\n  # select all R at random\n  rR <- sample(obs.R, size=years, replace=TRUE)\n  # create a vector to hold N\n  N <- numeric(years+1)\n  # give it an initial population size\n  N[1] <- initial.N\n  # Do the for-loop\n  for( t in 1:years ) {\n    # project the population one time step\n      N[t+1] <-  N[t] * rR[t]\n  }\n  # return the vector of N\n  N\n} \n# try it out with different hypothetical R\nmyForLoop(obs.R=0:3, years=5, initial.N=43)## [1]  43 129   0   0   0   0\n# specify the number of simulations and for how long\nsims=10; years=50\nset.seed(3)\noutmat <- replicate(sims,   \n                    expr=myForLoop(obs.R=obs.R, years=years, initial.N=43)\n                    )\nmatplot(0:years, outmat, type=\"l\", log=\"y\")\n# combine columns years, and our output\njunk <- data.frame(years = 1:(years+1), outmat)\nnames(junk)##  [1] \"years\" \"X1\"    \"X2\"    \"X3\"    \"X4\"    \"X5\"    \"X6\"    \"X7\"    \"X8\"   \n## [10] \"X9\"    \"X10\"\n# make sure to load 'tidyr' if you did not already load it or tidyverse\n# library(tidyr)\n# Take the wide data frame with many columns and turn it into \n# a long data frame with one column to ID each simulation, and one to hold values.\nout.long <- pivot_longer(junk, cols=X1:X10, names_to=\"Run\", values_to=\"N\")\nggplot(data=out.long, aes(x=years, y=N, group=Run)) + geom_line() +  \n  scale_y_log10() \n# Or for colorful lines\n# ggplot(data=out.long, aes(x=years, y=N,  linetype=Run, colour=Run)) + \n#    geom_line(show.legend=FALSE) + scale_y_log10() "},{"path":"expo.html","id":"a-distribution-of-possible-futures","chapter":"3 Simple density-independent growth","heading":"3.4.5 A distribution of possible futures","text":"Now position make informed prediction, given assumptions. predict range possible outcomes likely outcomes, given set assumptions.simulate population 50 years 10,000 times describe distribution final populatin sizes. use system.time tell long takes computer.tells long took complete 10,000 simulations. also check dimensions output, make sense.see object size think . shall assume everything worked way think .","code":"\nsims=1e4; years=50\nset.seed(3)\n## system.time keeps track of how long processes take.\nsystem.time(\noutmat <- replicate(sims,   \n                    expr=myForLoop(obs.R=obs.R, years=years, initial.N=43)\n                    )\n            )##    user  system elapsed \n##   0.134   0.005   0.142\ndim(outmat)## [1]    51 10000"},{"path":"expo.html","id":"analyzing-results","chapter":"3 Simple density-independent growth","heading":"3.4.6 Analyzing results","text":"extract last year simulations (last row), summarize quartiles (0%, 25%, 50%, 75%, 100%, also mean).\nFigure 3.11: Distribution 10000 final base-10 log population sizes. Note approximately Normal distribution.\nquantile() function allows us find form empirical confidence interval, including, approximately, central 90% observations.21These quantiles provide estimate likely range possible populatin sizes, given assumptions.","code":"\nN.2053 <- outmat[51,]\nsummary(N.2053, digits=6)##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. \n##       0.0      12.1      60.7    1306.3     297.7 2299420.0\nhist(log10(N.2053))\nquantile(N.2053, prob=c(0.05, .95) )##          5%         95% \n##    1.331579 2862.940808"},{"path":"expo.html","id":"inferring-processes-underlying-growth-rate","chapter":"3 Simple density-independent growth","heading":"3.4.7 Inferring processes underlying growth rate","text":"approach relies observed data. means growth rates, representative, can never different observed. different approaach assume growth rates can different observed, drawn underlying process caused observed rates.observed rates simply visible manifestation unseen processes. might summarize asserting observed growth rates samples continuous distribution distribution, whose prperties can infer sample. instance, may processes cause annual rates follow Normal, perhaps log-normal distribution.can fit Normal distribution logarithms observed \\(R\\), see doesn’t bad job (Fig. 3.12).\nFigure 3.12: logarithms observed R seem reasonably approximated Normal distribution whose mean standard deviation derived log-transformed data. probability distribution rescaled visible graph.\nNow simulate populations just like , instead random draws observed data, random draws inferred distribution.new function.new simulations.results similar based observed \\(R\\). markedly different, might ask whether choice distribution appropriate.conclusions based model discrete density-independent population growthwhat assumptions making valid?unrealistic assumptions perhaps nonetheless good approximation reality?like add next make model better approximation?","code":"\nmu <- mean( log(obs.R) )\nsigma <- sd( log(obs.R) )\n\n# a regular sequence for log-R\nlR <- seq(-1, 1.1, by=0.01)\n# the probability densities for the log-R\ndR <- dnorm(lR, m=mu, sd=sigma)\n# rescale the probability density to visible height to graph\nrdR <- dR*10\n\nhist(log(obs.R), breaks=10, ylab=\"Frequency\")\nlines(lR, rdR)\nmyForLoop2 <- function(mu, sigma, years, initial.N) {\n  # select all R at random from \n  lrR <- rnorm(years, m=mu, sd=sigma)\n  rR <- exp(lrR)\n  # create a vector to hold N\n  N <- numeric(years+1)\n  # give it an initial population size\n  N[1] <- initial.N\n  # Do the for-loop\n  for( t in 1:years ) {\n    # project the population one time step\n      N[t+1] <-  N[t] * rR[t]\n  }\n  # return the vector of N\n  N\n} \nsims=1e4; years=50\nset.seed(3)\noutmat2 <- replicate(sims,   \n                    expr=myForLoop2(mu=mu, sigma=sigma, years=years, initial.N=43)\n                    )\nN2.2053 <- outmat2[51,]\nquantile(N2.2053, prob=c(0.05, .95) )##          5%         95% \n##    1.205509 3089.819907\nquantile(N.2053, prob=c(0.05, .95) )##          5%         95% \n##    1.331579 2862.940808"},{"path":"expo.html","id":"f-environmental-noise","chapter":"3 Simple density-independent growth","heading":"3.4.8 1/\\(f\\) environmental noise","text":"Perhaps might explain variation annual growth rates weather patterns breeding range (Darrtown, Ohio). , might separate demographic effects vs. environmental effects. give us even better model use explanation prediction.model simulate realistic time series, often find essential account temporal autocorrelation often appears environmental data. Patterns autocorrelation often best characterized “one f-noise” (\\(1/f\\)), , random variation temporal autocorrelation follows color spectrum. Uncorrelated noise referred white noise correlations actually occur wavelengths. Red noise emphasized strong positive correlation short wavelengths low correlation long wavelengths. result, red noise random longer wavelengths less random short wavelengths . Environmental variables typically reddened color typically refer pink noise (Halley 1996).good example reddened noise average daily air temperature. Daily temperature tends positively correlated one day next, tends weakly correlated two days separated time. Daily water temperature even strongly correlated adjacent days high specific heat water.chapter, explored meaning density-independent population growth. statistically demonstrable phenomenon, wherein per captia growth rate exhibits relation population density. useful starting point conceptualizing population growth. derived discrete geometric continuous exponential growth seen related. caculated doubling times. discussed assumptions different people might make regarding growth models. Last, used simulation explore prediction inference density-independent context.","code":"\nset.seed(1)\ntime.series <- one_over_f(gamma=2, N=50)\nplot(1:50, time.series, type='l', main=\"Reddened noise\")\ntime.series <- one_over_f(gamma=0, N=50)\nplot(1:50, time.series, type='l', main=\"White noise\")\none_over_f()##   [1]  0.298824010  0.237226439  0.022089966 -0.058677477 -0.143104439\n##   [6] -0.096115585 -0.217674233 -0.318510492 -0.411251888  0.013766040\n##  [11]  0.058893149 -0.250099478 -0.475972239 -0.583968374 -0.185727547\n##  [16] -0.471796572 -0.777508331 -0.911505916 -0.999884280 -1.145470033\n##  [21] -1.144976191 -1.076483805 -1.072279877 -0.968071771 -0.842569319\n##  [26] -1.223831808 -1.260713073 -1.200984196 -1.092624456 -0.912505127\n##  [31] -0.801324833 -0.849137971 -0.666099799 -0.242696588 -0.336315476\n##  [36] -0.413040724 -0.302926138 -0.189909334 -0.111440017 -0.105175915\n##  [41]  0.386642286  0.173388729  0.201344125 -0.078417077 -0.067053947\n##  [46]  0.253079784  0.087084305 -0.175424320  0.175378412 -0.018511340\n##  [51] -0.326746570 -0.307820229 -0.238600098 -0.017850970 -0.242894565\n##  [56] -0.114187912 -0.123189588 -0.250224129 -0.315375425 -0.482370556\n##  [61] -0.679859449 -0.654850531 -0.788414474 -0.862824689 -1.119964520\n##  [66] -1.284946496 -1.501806547 -1.429023014 -1.686673886 -1.717936023\n##  [71] -1.339415250 -1.438129614 -1.376591163 -1.487297230 -1.296710293\n##  [76] -1.141483988 -1.168313720 -1.277595263 -1.267864047 -1.775251874\n##  [81] -1.788995566 -1.438183268 -1.117802176 -1.257935981 -1.105544404\n##  [86] -1.148643680 -1.326412085 -1.452105066 -1.363881397 -1.557466098\n##  [91] -1.447593696 -1.156491906 -0.965223705 -0.940559500 -0.454249722\n##  [96] -0.525117326 -0.552481219 -0.762876531 -0.435203543 -0.181171967\n## [101] -0.043885710  0.003821143 -0.146239428 -0.195746588 -0.168055878\n## [106] -0.130514156 -0.406878361 -0.462138459 -0.394679685 -0.195522343\n## [111]  0.281265599  0.458744369  0.746887742  0.809777963  1.190705346\n## [116]  1.264690242  0.874309071  0.742373164  0.765139339  0.666812962\n## [121]  0.808437966  0.826119619  0.799500046  0.740888658  0.577590139\n## [126]  0.755627670  1.267427177  1.244177427  1.077970660  1.025106186\n## [131]  0.848674967  1.080393233  1.513672665  1.537706076  1.530141514\n## [136]  1.598658591  1.505414796  1.554742635  1.821012230  1.948974147\n## [141]  1.786873405  1.807088422  1.264629628  1.255344152  0.947658329\n## [146]  0.915749082  1.310765326  1.354415207  1.524322656  1.420308620\n## [151]  1.226589960  0.984675278  0.808371597  0.626751709  0.547783422\n## [156]  0.468083434  0.513039379  0.530440634  0.496461435  0.433902955\n## [161]  0.659671581  0.933006176  0.755059314  1.040193197  1.274216904\n## [166]  1.265997977  1.184445211  1.168937063  1.241008459  1.298614092\n## [171]  1.222971943  1.077538730  0.854257118  0.896230927  0.679514064\n## [176]  0.205251182 -0.172535497 -0.275142660 -0.062514131 -0.009668855\n## [181]  0.106339508  0.102343929  0.001463750 -0.053420265 -0.037794333\n## [186] -0.132799374 -0.273124821 -0.276711413 -0.107940539  0.011454678\n## [191]  0.095326934  0.126416026  0.185546476  0.420958833  0.552621056\n## [196]  0.567177990  0.737451506  0.602832006  0.690105908  0.482555676"},{"path":"DID.html","id":"DID","chapter":"4 Density-independent Demography","heading":"4 Density-independent Demography","text":"preceding chapter, listed Hastings’ (. Hastings 2011) key principles assumptions single species population growth. One key assumptions “individuals population identical.” chapter, elucidate important violation assumption, population structure.\nFigure 4.1: Demography human populations Mexico Sweden. Based 1990 data US Census Bureau, Population Division, International Programs Center.\nPopulations structure. Consider human populations Mexico Sweden 1990. Mexico much larger fraction population child bearing age classes younger (Fig. 4.1). addition, age-specific fertility rate higher Mexico, especially younger women\n(Fig. 4.1). happen, Mexico \nmany young people? consequences \nculture, use resources, domestic foreign policies,\nfuture population growth? Sweden?Demography study populations special attention structure (Lincoln, Boxshall, Clark 1998). Originally, age-based human demography provenance actuaries helped governments keep track number citizens different ages thus, instance, know many available conscription military.22The reason model structure populations various demographic rates vary markedly stages. Juveniles produce offspring. seeds survive entire year, whereas large adults survive well. use structure structure associated important differences demographic rates: survival, fecundity, growth.structure refer simply organization populations character life history stage, age, size. Sizes ages often reduced categories saw human populations (e.g., 0–4.9,y, 5–9.9,y,…). Sizes may based reliable repeatable measure relates demographic rates similarly binned. Life history stages may include eggs, larvae, metamorphs, juveniles, adults amphibians, seeds, rosettes, reproductive stems herbaceous plants. variable size, don’t even need use categories, rather can use size continuous variable; address briefly later chapter.Structured population models allow us intertwine species-specific natural history quantitative methods. makes approach especially appealing conservation biology threatened endangered species. use structured population models improve better understanding population improve predictions future dynamics, guide management population. might learn lot controls abundance\nspecies can test ideas related different stages, ages,\nsizes. limits population growth Western toad –\negg survival, overwintering survival juveniles? \ninvest efforts \ncontrol garlic mustard (Alliaria petiolata) – killing \nfirst year\nrosettes, second year adults? cacti generally endangered (Goettsch et al. 2015)—smallest size, largest size\nessential insure long-term survival? can use\nstructured population models address questions.","code":""},{"path":"DID.html","id":"a-two-stage-matrix-model","chapter":"4 Density-independent Demography","heading":"4.1 A two stage matrix model","text":"\nFigure 4.2: Like amphibians, Western toad (Anaxyrus boreas) complex life cycle, several life history stages. Adults breed early spring, laying eggs water. larvae (tadpoles) hatch develop spring summer, metamorphose (become metamorphs), juveniles. Juveniles require year mature. Adults can live decade. American toads (. americanus) thing.\nmatrix model structured population consists stages transitions. Vonesh Cruz (2002) used matrix projection assess importance egg mortality declines amphibian populations. model Western toad (Anaxyrus boreas, Fig. 4.2) comprises two stages (juveniles adults) four transitions.structured popuation models23, transition annual contribution individual stage \\(\\) time \\(t\\) stage \\(j\\) \\(t+1\\). Fig. 4.2, transition juvenile adult probability juvenile survives entire year also matures, becoming sexually viable.24 transition juvenile juvenile probability juvenile survives year mature. transition adult adult probability adult survives year. three transitions probabilities.transition adult juvenile (Fig. 4.2) typically referred fecundity, product several events. Vonesh De la Cruz assume transition depends population sex ratio, average clutch size female, egg survival, larval survival metamorphosis, overwintering survival metamorphs. even assume larval survival depnds denisty. Thus refer “fecundity”25 far just average clutch size must include processes occur year associated producing clutch survival clutch.Structured population models allow us take advantage natural history study species. study population, minimum, need () identify stages differ demographic rates, (ii) individuals tend breed.Consider example Western toad (Anaxyrus boreas). amphibians, survival fecundity rates depend heavily entirely life history stages egg, larvae (tadpole), juvenile, adult. know breeding occurs early spring, depending latitude elevation. wanted model juveniles adults, typically sample population prior breeding juveniles adults just starting become active.design structured population model depends sampling census schedule. models typically assume annual census occurs just , just seed set, egg laying, births. refer pre-breeding post-breeding census models. Vonesh Cruz (2002) (Fig. 4.2) use pre-breeding census model. juveniles adults present population time sampling. design assumed post-breeding census (later year), probably include three stages, larva (tadpoles) addition juveniles adults.reasons using pre- vs. post-breeding census include ability actually identify sample stages, parameter estimation. example, may easy accurately estimate abundance juvenile adult toads, difficult estimate larval density larval survival. case, represent adult juvenile transition black box, estimated total number new juveniles year \\(t+1\\) divided number adults year \\(t\\).can draw two different types life cycle graphs two-stage model just population (Fig. 4.3). people find one illuminating . useful able use .\nFigure 4.3: Two types life cycle graphs. represent amphibian pre-breeding model.\nstages must present annual census, arrow \ntransition must represent everything happens \nentire year. Notice transition adult toad juvenile toad\n(Fig. 4.3) includes egg production, egg survival, tadpole \nlarva survival growth, metamorphosis aquatic\nstage. obviously important events. make explicit stages count census; events implicit within transitions.life cycle diagram (Fig. 4.3), create transition projection matrix represents mathematically stages transitions stages (4.1). matrix one row one column stage, columns represent stages year \\(t\\) rows represent stages year \\(t+1\\). refer single column j single row . column represents stage j year \\(t\\), row represents stage year \\(t+1\\). amphibian example, transition matrix two rows two columns. “two two,” \\(2 \\times 2\\) matrix.\n\\[\\begin{equation}\n\\tag{4.1}\n \\mathbf{} =\n\\left(\n\\begin{array}{cc}\n p_{11}&F_{12} \\\\\np_{21}&p_{22} \n\\end{array}\n\\right)\n\\end{equation}\\]\n(4.1) represents Western toad (Fig. 4.3), transition\\(p_{11}\\) probability juveniles survive fail mature,\\(p_{21}\\) probability juveniles survive also mature,\\(p_{22}\\) probability adults survive, \\(F_{12}\\) contribution average adult juvenile stage.addition fecundity, survival, maturation growth one stage next, organisms undergo regression (Fig. 4.4). Regressing means transition later stage earlier stage. instance, plant can shrink size physical damage, disease herbivory. plant can also return temporarily non-reproductive stage large bout reproduction. examples regression (Fig. 4.4).One assumption making individuals set seed, give birth, . Therefore, refer model birth-pulse model. hand, assume continuous reproduction throughout year, things differently, refer birth-flow model. Whether population breeding continuously year, whether reproduction seasonal, influence estimate fecundities. Even synchronously breeding populations, many models pool years single age class stage. interested reader consult authoritative text Caswell (2001).\nFigure 4.4: transition matrix, element matrix describes probability individual given size \\(j\\) time \\(t\\) appears size \\(\\) time \\(t+1\\). Reproduction typically results minimum size, stage, age. matrix may composed small number rows columns (2-10), , case integral projection, infinite number rows columns. number rows equal number columns.\nlife cycle graph (Figs. 4.2, 4.3) corresponding transition matrix (4.1) constitute model. matrix structured population directly analogous \\(\\lambda\\) unstructured model discrete population growth previous chapter.26Later, project population analogous way, using\n\\[\\mathbf{ N_{t+1} = N_t}\\]\n, need refresher matrix multiplication.","code":""},{"path":"DID.html","id":"a-brief-primer-on-matrices","chapter":"4 Density-independent Demography","heading":"4.2 A brief primer on matrices","text":"refer matrices rows columns. matrix three rows one column \\(3 \\times 1\\) matrix (``three one’’ matrix); always state number rows first. Matrices comprise elements; element matrix signified row column. element second row first column \\(a_{21}\\). dimension matrix number rows columns.add two matrices, must dimensions. Consider two matrices, B . add two matrices simply add elements row column matrices, .\\[\\begin{align*}\n\\mathbf{} &=\n\\left(\n\\begin{array}{cc}\n& b \\\\\nc & d\n\\end{array} \\right); \\;\n\\mathbf{B} =\n\\left(\\begin{array}{cc}\nm & o\\\\\nn & p\n\\end{array}\\right)\\\\\n\\mathbf{+B} &=\n\\left( \\begin{array}{cc}\n\\left( +m \\right) & \\left(b+o \\right)\\\\\n\\left(c+n \\right) & \\left(d+p \\right)\n\\end{array} \\right) \n\\end{align*}\\]Multiplying matrices little complicated. , mutliply elements sum :multiply row element first matrix () times column element second matrix (B),sum element-wise products, andplace sum respective element final matrix.process refer dot product sometimes inner product. two vectors equal length \\(x\\) \\(y\\) dot product \n\\[x \\cdot y = x_1y_1 + x_2y_2 + \\ldots + x_n y_n\\]\ndot product begins two equal length vectors returns single number (.e. scalar).Consider matrix multiplication (4.2). first multiply element row 1 (\\(\\; b\\)), times corresponding elements column 1 B (\\(m\\; n\\)), sum products, place sum first row, first column resulting matrix. repeat row column B.\\[\\begin{align}\n\\tag{4.2}\n\\mathbf{AB} &=\n\\left( \\begin{array}{cc}\n\\left( + bn \\right) & \\left(ao+bp \\right)\\\\\n\\left(cm + dn \\right) & \\left(co + dp \\right)\n\\end{array}\\right) \n\\end{align}\\], number columns first matrix must equal number rows second matrix. also means resulting matrix number rows first matrix, number columns second matrix. Multiplying \\(2 \\times 2\\) matrix \\(2 \\times 1\\) results \\(2 \\times 1\\). Multiplying \\(3 \\times 3\\) matrix \\(3 \\times 1\\) results \\(3 \\times 1\\). multiply \\(2 \\times 1\\) matrix \\(2 \\times 2\\) number columns first matrix (1) match number rows second matrix (2).Let’s define two \\(2 \\times 2\\) matrices, M N, filling one rows, columns.Adding matrices simple. first element hand, sum matrices .mulitply M N, multiply sum first row \\(M\\) first column \\(N\\), make element \\(a_{11}\\) resulting matrix product.dot product.R, must use %*% signify mean matrix multiplication.multiply M times \\(2 \\times 1\\) matrix D, get?Make sure write multiplication summation element resulting matrix.transpose M \\(\\mathbf{M^T}\\)use transpose calculate reproductive value, later chapter.","code":"\n(M <- matrix( 1:4 , nrow=2, byrow=TRUE))##      [,1] [,2]\n## [1,]    1    2\n## [2,]    3    4\n(N <- matrix( c(10, 20, 30, 40), nrow=2)) # byrow=FALSE is the default.##      [,1] [,2]\n## [1,]   10   30\n## [2,]   20   40\n# 1 + 10\nM[1,1] + N[1,1]## [1] 11\nM + N##      [,1] [,2]\n## [1,]   11   32\n## [2,]   23   44\n# 1*10 + 2*20\nM[1,1] * N[1,1] + M[1,2] * N[2,1] ## [1] 50\nM %*% N##      [,1] [,2]\n## [1,]   50  110\n## [2,]  110  250\nD <- matrix(c(100, 200), nrow=2)\nM %*% D##      [,1]\n## [1,]  500\n## [2,] 1100\n# note that we cannot perform D %*% M\nM; t(M)##      [,1] [,2]\n## [1,]    1    2\n## [2,]    3    4##      [,1] [,2]\n## [1,]    1    3\n## [2,]    2    4"},{"path":"DID.html","id":"decomposing-a","chapter":"4 Density-independent Demography","heading":"4.3 Decomposing A","text":"slightly different way conceptualize transition matrix consider three separate matrices, one growth, survival, fecundity,\n\\[\\mathbf{ = GS + F }\\].Survival, S, growth, G, elements:stage \\(j\\) probability survival \\(s_j\\), describes survival stage \\(t\\) \\(t+1\\).survivor stage \\(j\\) grow regress different stage, remain stage, probability \\(g_{ij}\\).demographic context, fecundity, F, surviving number offspring produced average individual stage \\(\\). Sometimes complete black box, can count adults year \\(t\\) offspring year \\(t+1\\). times, can use estimates probability individual stage \\(\\) reproduces , average number offspring individual actually reproduce, survival growth adults resulting offspring. depends detail study system. , course, depends heavily whether census population shortly reproduction (pre-breeding census), shortly reproduction (post-breeding census).Western Toad (Fig. 4.2), results \n\\[\\begin{equation*}\n\\tag{4.3}\n \\mathbf{= GS + F} = \n\\left(\n\\begin{array}{cc}\n1-\\mathrm{P} & 0 \\\\\n\\mathrm{P} & 1\n\\end{array} \\right)\n\\left(\n \\begin{array}{cc}\n \\sigma_j&0\\\\\n0 & \\sigma_a\n \\end{array} \\right)\n+\n\\left(\n\\begin{array}{cc}\n0 & \\rho \\phi \\sigma_e \\sigma_t \\sigma_m \\\\\n0 & 0\n\\end{array} \\right) = \n\\left(\n\\begin{array}{cc}\n\\sigma_j (1-\\mathrm{P}) & \\rho \\phi \\sigma_e \\sigma_t \\sigma_m \\\\\n\\sigma_j \\mathrm{P} & \\sigma_a\n\\end{array} \\right)\n\\end{equation*}\\]\\(\\sigma_j,\\,\\sigma_a\\) survival juveniles adults, P probability juvenile growth, given survival. adult survives always remains adult (\\(g_{22}=1\\)) never regresses (\\(g_{12}=0\\)). Fecundity occurs adults, product sex ratio (\\(\\rho\\)), average clutch size per female (\\(\\phi\\)), egg survival (\\(\\sigma_e\\)), survival tadpoles (\\(\\sigma_t\\)), overwintering survival metamorphs (\\(\\sigma_m\\)).27Vonesh de la Cruz went added density-dependence using term negative effects high tadpole density tadpole survival growth. show , regardless complex natural history gets, can build natural history models.","code":""},{"path":"DID.html","id":"a-three-stage-model","chapter":"4 Density-independent Demography","heading":"4.4 A three stage model","text":"\nFigure 4.5: life cycle garlic mustard using post-breeding census (Pardini et al. 2009). census takes place May year. arrow represents transition May May. Seeds germinate early spring become rosettes (basal leaves near soil surface). rosettes experience mortality summer, fall, winter. Surviving rosettes become reproductive adults following spring summer. Adults flower pollinated June, fruits ripen seeds mature. Seeds overwinter least six months germinating spring. seeds germinate, may remain viable seed bank several years. Thus, complete life cycle least two years. seeds germinate, plant requires year reach maturity, produce flowers, fruits seeds.\nLet’s work probability transitions.\\(s_1\\), germinated seed survives rosette.\\(s_2\\), surviving May August rosette.\\(s_3\\), surviving August early May becoming reproductive plant.\\(v\\), seed viable (survives can germinate).\\(g_1\\), viable seed germinates first season, \\(1-g_1\\) remains ungerminated.\\(g_2\\), viable seed germinates second season \\(1-g_2\\) .Fecundity, \\(f\\), average number seeds per reproductive plant.transition matrix thus \\[\\begin{equation*}\n\\tag{4.4}\n \\mathbf{} = \n\\left(\n\\begin{array}{ccc}\n 1-g_2  & 0       & v(1-g_1)f \\\\\ng_2 s_1 & 0       & v g_1 s_1 f \\\\\n0       & s_2 s_3 & 0\n\\end{array} \\right)\n\\end{equation*}\\]Put words transition elements.transition adult rosette? plant shrink? perennial plants can get smaller, regress, happens . transition, adult May gets pollinated, develops fruits, seeds mature deposited soil late summer fall. seeds survive overwinter, germinate early spring, grow rosettes summer, survive next census May. way, stage 3 (adult) contributes stage 2 (rosette) reproduction plus survival growth. transition adult seed, \\(p_{13}\\), occurs seeds germinate first winter, spend another year seed bank soil.transition matrix, can use characterize many features population, including finite rate increase (\\(\\lambda\\)), predicted relative abundances various stages, relative importance separate transition \\(p_{ij}\\) long term population growth rate. later section, first explore projection. frequently useful acutally project population, one year time, future.","code":""},{"path":"DID.html","id":"projection","chapter":"4 Density-independent Demography","heading":"4.5 Projection","text":"Projection modeling population time, prediction one another set assumptions. practice, use matrix multiplication project stage- structured populations. Matrix multiplication calculations us. let square demographic transition matrix, one row one column stage. Let \\(\\mathbf{N}_t\\) one-column matrix stage sizes, one row stage. Matrix multiplication allows us project population,\n\\(\\mathbf{}\\mathbf{N}_t = \\mathbf{N}_{t+1}\\).project population multiple years, use -loop. used previous chapter unstructured population. multiply transition matrix current year’s abundances projecting next year’s abundances. need specify transition matrix, starting stage abundances \\(t=0\\), number years want project. define transition matrix, \\(\\mathbf{N}_0\\), numbers time steps project.-loop, need zeroes matrix hold \\(n\\) years stages, including first year. start filling matrix zeroes “binding” rows \\(\\mathbf{N}_0\\) onto top zeroes matrix first row.Now perform iteration -loop plot result. Note multiplication current year \\(t\\) put result next year \\(t+1\\).\nFigure 4.6: Projection population showing transient dynamics.\nfirst seven years, see abundances two stages bounce around. transient dynamics , density-independent models, fade away time.","code":"\nA <- matrix( c(.1, 2.0, \n        .3,.4), nrow=2, byrow=T)\nN0 <- matrix(c(100, 1), nrow=1) \nyears <- 6\nN.proj1 <- matrix( 0, nrow=years, ncol=nrow(A)) \ncolnames(N.proj1) <- c(\"Juv\", \"Adult\")\nN.proj2 <- rbind(N0, N.proj1)\n# Project, then...\nfor(t in 1:years) {N.proj2[t+1,] <- A%*%N.proj2[t,]}\n# ...rearrange and plot\nN.proj.data <- data.frame(Year=0:years, N.proj2)\nnpd <- gather(N.proj.data, Stage, Abundance, -Year)\nggplot(npd, aes(Year, Abundance, linetype=Stage)) + geom_line()"},{"path":"DID.html","id":"analyzing-the-transition-matrix","chapter":"4 Density-independent Demography","heading":"4.6 Analyzing the transition matrix","text":"Projection important many reasons, especially stochastic models complicated models. However, also get best insights direct analysis transition matrix using eigenanalysis (Caswell 2001).features learn structured population using eigenanalysis best thought predictions, attractors, long term averages, assuming transition elements don’t change. big assumption, understanding helps us interpret analysis appropriately.obtained transition matrix, \\(\\mathbf{}\\), can analysis using eigenanalysis estimate\\(\\lambda\\), finite rate increase,stable stage structure,reproductive value, andsensitivities elasticities., explain quantities.","code":""},{"path":"DID.html","id":"eigenanalysis","chapter":"4 Density-independent Demography","heading":"4.6.1 Eigenanalysis","text":"Eigenanalysis mathematical technique summarizes multivariate data. Ecologists use eigenanalysis frequently, () multivariate statistics ordination, (ii) local stability analyses two species, (iii) analyzing population transition matrices. Eigenanalysis simply method transform square matrix independent, orthogonal, pieces. pieces eigenvectors corresponding eigenvalues. number eigenvalues (eigenvectors) columns matrix. demography, two useful pieces dominant right eigenvalue corresponding right eigenvector.Eigenanalysis technique finds solutions \\(\\lambda\\) \\(\\mathbf{w}\\) \n\\[\n\\tag{4.5}\n\\mathbf{Aw}=\\lambda \\mathbf{w}\n\\]\\(\\mathbf{w}\\) column vector number rows \\(\\mathbf{}\\). write eq. (4.5) \\(2 \\times 2\\) matrix, \\[\n \\tag{4.6}\n \\left(\n \\begin{array}{ccc}\n  a_{11} & a_{12} \\\\\n  a_{21} & a_{22}\\\\\n \\end{array} \n \\right) \n \\left(\n  \\begin{array}[c]{c}\n   w_{11}\\\\\n   w_{21}\n  \\end{array}\n  \\right)\n  =\\lambda \\left(\n  \\begin{array}[c]{c}\n   w_{11}\\\\\n   w_{21}\n  \\end{array}\n  \\right)\n\\]\ninstance, can perform eigenanalysis transition matrix.gives us one eigenvalue per column transition matrix (values). eigenvalue corresponding eigenvector corresponding column vectors matrix.Let’s use R prove eq. (4.5) say . see whether \\(\\mathbf{}\\mathbf{w} = \\lambda \\mathbf{w}\\) \n\\(= 1\\). , use results previous eigenanalysis.first column \\(\\mathbf{Aw}\\) second column \\(\\lambda \\mathbf{w}\\). Sure enough, look . Try exercise second eigenvalue second eigenvector, \\(=2\\).Typically, first eigenvalue corresponding eigenvector capture important features transition matrix. call dominant eigenvalue, \\(\\lambda_1\\), corresponding eigenvector, \\(w_1\\). first solution capture information transition matrix, useful.infinite number solutions equation solutions can just simple multiples set found eigenanalysis. Eigenanalysis finds set solutions independent , capture information \\(\\mathbf{}\\) particularly useful way.book, delve details eigenanalysis beyond . eigenanalysis takeaways:can perform eigenanalysis square matrices (number rows = number columns).number eigenvalues columns .eigenvalues usually complex numbers, real part imaginary part.largest eigenvalue one largest geometric mean real imaginary parts sign (+,-) respected.“dominant” eigenvalue largest one; R return first one.eigenvalue corresponding eigenvector.number elements eigenvector number rows .important us use results. , describe use eigenanalysis find () long term asymptotic finite rate increase \\(\\lambda\\), (ii) stable stage distribution, reproductive values stage.","code":"\n(A <- matrix(c(0, .3, 2, .7), nrow=2))##      [,1] [,2]\n## [1,]  0.0  2.0\n## [2,]  0.3  0.7\n(eA <- eigen(A))## eigen() decomposition\n## $values\n## [1]  1.2 -0.5\n## \n## $vectors\n##            [,1]       [,2]\n## [1,] -0.8574929 -0.9701425\n## [2,] -0.5144958  0.2425356\n(lambda1 <- eA$values[1])## [1] 1.2\n(w1 <- eA$vectors[,1])## [1] -0.8574929 -0.5144958\ncbind(A %*% w1, lambda.w=lambda1 * w1)##                   lambda.w\n## [1,] -1.0289915 -1.0289915\n## [2,] -0.6173949 -0.6173949"},{"path":"DID.html","id":"finite-rate-of-increase","chapter":"4 Density-independent Demography","heading":"4.6.2 Finite rate of increase","text":"\nasymptotic annual growth rate finite rate increase dominant eigenvalue transition matrix. meaning geometric growth unstructured population.Eigenvalues always referred Greek symbol \\(\\lambda\\), provide solution (4.5). dominant eigenvalue matrix, \\(\\lambda_{1}\\), eigenvalue largest magnitude, frequently complex number. perform eigenanalysis, common get complex numbers, real imaginary parts. magnitude sum squared parts. population transition matrices, \\(\\lambda_{1}\\) always positive real. case types matrices examine later chapters.dominant eigenvalue biggest one. can find one asking R tell us index position \\(\\) largest absolute value (modulus) eigenvalues. cases, first eigenvalue, .use index extract largest eigenvalue. keep real part, using Re(), dropping imaginary part. (Note although dominant eigenvalue real transition matrix always real, R include imaginary part equal zero (\\(0i\\)) place holder eigenvalues non-zero imaginary part).L1 \\(\\lambda_1\\), asymptotic finite rate increase. finite rate increase biological meaning \\(\\lambda\\) previous chapter.","code":"\n( dom.pos <- which.max( Mod(eA[[\"values\"]]) )  )## [1] 1\n# extract the dominant eigenvalue and retain only its Real part\n( L1 <- Re(eA[[\"values\"]][dom.pos]) )## [1] 1.2"},{"path":"DID.html","id":"stable-stage-distribution","chapter":"4 Density-independent Demography","heading":"4.6.3 Stable stage distribution","text":"predicted long term average relative abundance different life history stages ages called stage distribution, , distribution individuals among stages. property stage structured population , demographic rates (elements transition matrix) remain constant, stage structure approach stable stage distribution, stage distribution relative number individuals stage constant. Note population can grow, absolute number individuals increases, relative abundances stages constant; stable stage distribution. population actually growing (.e. \\(\\lambda=1\\)) demographic parameters remain constant, population stationary achieve stationary stage distribution, neither absolute relative abundances change.find stable stage distribution? also turns \\(w_1\\) provides necessary information. scale eigenvector \\(w_1\\) sum elements interested distribution, defined stages summing one. Therefore stable stage distribution \n\\[\n \\tag{4.7}\n \\frac{w_1}{\\sum_{=1}^s{w_1}}\n\\]\n\\(s\\) number stages.population reaches stable stage distribution stages grows shrinks exponentially. might believe consider can represent \\(\\mathbf{}\\) \\(\\lambda\\).","code":""},{"path":"DID.html","id":"calculating-the-stable-stage-distribution","chapter":"4 Density-independent Demography","heading":"4.6.4 Calculating the stable stage distribution","text":"dominant eigenvector, \\(w_1\\), position dominant eigenvalue. extract \\(w_1\\), keeping just real part, divide sum get stable stage distribution.shows us transition matrix change time, population eventually composed relative abundances.claimed, without evidence, constant transition matrix, projected population eventually reach stable stage distribution grow exponentially finite rate increase \\(\\lambda_1\\). show example.sum abundances different stages, calculate total population sizes. , can calculate annual rate increase \\(N_{t+1}/N_t\\).\nFigure 4.7: Calculating annual finite rate increase projected population shows population approach asymptotically constant geometric rate increase. Solid points annual growth rate; circular point lambda(1) eigenanalysis.\nIterating transition matrix approximate \\(\\lambda_1\\) \\(w_1\\) actually called power iteration method eigenanalysis.","code":"\n# continuing from previous code...\nw1 <- Re(eA[[\"vectors\"]][,dom.pos])\nssd <- w1/sum(w1)\nround(ssd, 3)## [1] 0.625 0.375\nA <- matrix(c(0, .3, 2, .7), nrow=2) # our tran. matrix\nN0 <- c(Juveniles=1,Adults=10) # initial population\nsteps <- 8 # number of time steps\n# combine the stages of our initial population, and a zero matrix \n# with a column for each stage and a row for each time step\nN <- rbind(N0, matrix(0, ncol=2, nrow=steps) )\n# use a for-loop to project the population each year and store it.\nfor(t in 1:steps) {N[t+1,] <- A%*%N[t,]}\n# Sum the stages to get the total N\nN.total <- rowSums(N)\n# For each year, divide each stage by the total to get \n# relative abundances and thus the distribution.\nproportions <- N/N.total\nSD <- data.frame(Year=0:steps, proportions)\nsdg <- gather(SD, Stage, Proportion, -Year)\n\n# plot the distributions for succeeding years.\nggplot(sdg, aes(Stage, Proportion)) + geom_col()  + \n  facet_wrap(~Year, nrow=3, ncol=3)\n# using \"-\" in an index removes that element\nlambda.t <- N.total[-1]/N.total[-(steps+1)] \nqplot(x=1:steps, y=lambda.t, geom=c(\"line\", \"point\")) + \n  annotate(\"point\", x = steps  , y=L1, pch=1, size=3) "},{"path":"DID.html","id":"reproductive-value","chapter":"4 Density-independent Demography","heading":"4.6.5 Reproductive value","text":"\nstage structure gives us one measure importance stage (relative abundance), reproductive value gives us one measure importance individual stage. Reproductive value expected contribution individual future reproduction. characterize individuals stage using expected reproductive value.find reproductive value associated stage solving dominant left eigenvector \\(\\mathbf{v}\\), \n\\[\n \\tag{4.8}\n \\mathbf{vA}=\\lambda\\mathbf{v}.\n\\]\nLike relation dominant right eigenvector stable stage distribution, vector actually proportional reproductive values. Unlike stable stage distribution, scale reproductive values relative first stage (e.g. juveniles seeds).\n\\[\n \\tag{4.9}\n  \\frac{v_1}{v_{1[1]}}\n\\]\nfind left eigenvalues -vectors performing eigenanalysis transpose transition matrix. Transposition flips rows columns, row 1 becomes column 1 vice versa. perform eigenanalysis, extracting just dominant left eigenvector; scale , stage 1 reproductive value 1.0.see reproductive value, rv, increases age stage. means expected reproductive value individual second stage 4 times great individual first stage. general, reproductive value individuals stage increases increasing probability reaching fecund stages.","code":"\ntA <- t(A) # transpose\netA <- eigen(tA)\ndom.pos <- which.max(Mod(etA$values))\nv1 <- Re(etA$vectors[,dom.pos])\n( rv <- v1/v1[1] )## [1] 1 4"},{"path":"DID.html","id":"sensitivity-and-elasticity","chapter":"4 Density-independent Demography","heading":"4.6.6 Sensitivity and elasticity","text":"Sensitivity elasticity tell us relative importance transition (.e. arrow life cycle graph element matrix) determining \\(\\lambda\\). combining information stable stage structure reproductive values.stage structure reproductive values way contribute importance stage determining \\(\\lambda\\). stable stage distribution provides relative abundance individuals stage. Reproductive value provides expected contribution future population growth individuals stage. Sensitivity elasticity combine tell us relative importance transition determining \\(\\lambda_1\\).Sensitivities direct contributions transition determining \\(\\lambda_1\\). sensitivity element \\(a_{ij}\\) transition matrix change \\(\\lambda_1\\) occurs change \\(a_{ij}\\) small amount, \n\\[\\delta \\lambda / \\delta a_{ij}\\].\nisn’t surprising, , derived stable stage distribution reproductive values. Specifically, sensitivities calculated \\[\n\\frac{\\delta \\lambda}{\\delta a_{ij}}=\\frac{v_{1[]}w_{1[j]}}{v_1\\cdot w_1} \n\\tag{4.10}\n\\]\n\\(v_{}w_{j}\\) product pairwise combination elements dominant left right eigenvectors, \\(v\\) \\(w\\). Specifically, numerator generated reproductive value target stage stable stage distribution source stage,\n\\[\n\\begin{pmatrix} v_1\\\\v_2 \\end{pmatrix} \\begin{pmatrix} w_1 & w_2 \\end{pmatrix}=\n\\begin{pmatrix} \nv_1 w_1 & v_1 w_2 \\\\\nv_2 w_1 & v_2 w_2\n\\end{pmatrix}\n\\]\ndenominator, dot product, \\(\\mathbf{v} \\cdot \\mathbf{w}\\), sum pairwise products vector element,\n\\[v_{11}w_{11} + v_{12}w_{12} + \\ldots + v_{1n}w_{1n}\\].\nDividing numerator sum causes sensitivities relative magnitudes \\(v\\) \\(w\\).Let’s calculate sensitivities now. stable stage distribution reproductive values merely scaled versions dominant right left eigenvectors, doesn’t matter whether use unscaled eigenvectors, scaled stable stage distribution reproductive values.sensitivities, \\(\\delta \\lambda / \\delta a_{ij}\\), corresponding transition element. always get sensitivity every position matrix, even transition zero, \\(a_{ij}=0\\). just ignore , convention, usually include .\nsensitivities relative change \\(\\lambda_1\\) absolute change element. instance, relative effect lambda increasing \\(a_{21}\\) 0.3 0.31, \\(a_{22}\\) 0.7 0.71.largest sensitivities just calculated \\(p_{21}\\), surviving first stage second stage. means small changes \\(p_{21}\\) larger effects \\(\\lambda_1\\) small changes \\(F_2\\) \\(p_{22}\\).\nFigure 4.8: Sensitivities lambda transition elements slopes. dotted line calculated sensitivity lambda [2,1], slope evaluated [2,1].\nElasticities sensitivities weighted transition probabilities. Recall sensitivities effects lambda small absolute change transition matrix elements. contrast, elasticities effects lambda proportional change transition element influences \\(\\lambda_1\\)—1% increase seed production, 1% decline juvenile survival influence \\(\\lambda_1\\)? answers, need adjust sensitivities account relative magnitudes transition elements, provides elasticities, \\(e_{ij}\\). Elasticities relative sensitivities, defined \\[\ne_{ij}=\\frac{\\delta \\lambda/\\lambda}{\\delta a_{ij}/a_{ij}} = \\frac{a_{ij}}{\\lambda}\\frac{\\delta \\lambda}{\\delta a_{ij}}.\n\\]\nalso equal \n\\[e_{ij}= \\frac{\\delta \\log \\lambda}{\\delta \\log a_{ij}}.\\]\nLike sensitivities, can think elasticities slopes.Calculating R easy.Now see survival adults (\\(p_{22}\\)) biggest effect \\(\\lambda_1\\). difference sensitivities elasticities? elasticities reflect effect proportional change (e.g., 1%) elements, whereas sensitivities reflect effect change constant amount (e.g., 0.01) element.Note elasticities relative , sum 1.0. especially nice feature elasticities makes easier compare elasticities among different matrices different organisms.sensitivities elasticities, can really begin see controlling growth rate stage (age) structured population. provide us predicted effects \\(\\lambda_1\\) proportional change demographic rate. particularly important management invasive (endangered) species seek maximum impact minimum amount effort resources (Caswell 2001; S. P. Ellner Guckenheimer 2006). can use help predict population might respond natural phenomena management practices affect one stage another.details can get confusing, smart people don’t always get right. Therefore, get expert advice (Caswell 2001; S. P. Ellner Guckenheimer 2006), remember stages life cycle graph matrix stages collect one point time, arrow transition element include everything happens one census period next.","code":"\nvw <- matrix(rv, nr=2, nc=1) %*% matrix(ssd, nr=1, nc=2) # or vw <- v1 %*% t(w1); the numerator\ndot.prod <- sum(rv*ssd) # or dot.prod <- sum(v1 * w1) denominator\n(s <- vw/dot.prod)##           [,1]      [,2]\n## [1,] 0.2941176 0.1764706\n## [2,] 1.1764706 0.7058824\ne <- (A/L1) * s\n(round(e, 3))##       [,1]  [,2]\n## [1,] 0.000 0.294\n## [2,] 0.294 0.412"},{"path":"DID.html","id":"integral-projection","chapter":"4 Density-independent Demography","heading":"4.7 Integral projection","text":"stages seem like arbitrary categories along continuous scale? size easy measure accurately really good predictor demographic rates, rates vary continuously size? decide size classes? draw seemingly arbitrary divisions different sizes?integral projection, opposed matrix projection, longer worry particular number stages age classes. select individual-level state variable, body mass, length, stem diameter, even location, useful predictor demographic rates.use continuously varying state variable place stages age classes. rely statistical methods, linear regression, describe relations individual-level state variable survival, growth, fecundity. combine relations model individuals population likely change one generation next.many organisms, size often relatively good predictor survival fecundity. Within population, size often associated age, learning, resource acquisition. Size also related onset reproductive maturity initiation development reproductive structures. Among reproductive individuals, size often strongly correlated per capita reproductive output. Integral projection can use size model size-dependent demography.Integral projection models (IPMs) based calculus integration across continuous variables combine information size-dependent demographic rates size distributions project population abundances sizes future.practice, rarely use tools integral calculus IPMs solidly grounded. Instead, approximate integration using large matrices. simple example approximation, consider plant height measure using meter stick. assume plant height , principle, continuous variable take real value 0 infinity. However, imagine measure height nearest centimeter, thereby create 100 height categories. measurement process chops continuous variation discrete categories. implementing integral projection models, typically combine different techniques associated continuous variation (e.g., linear regression) discrete variation (e.g., matrix algebra).","code":""},{"path":"DID.html","id":"a-size-based-ipm-of-smooth-coneflower","chapter":"4 Density-independent Demography","heading":"4.7.1 A size-based IPM of smooth coneflower","text":"Rachel Collins colleagues studying populations endangered coneflower, Echinecea laevigata, southwest Virginia, USA. Smooth coneflower perennial rhizomatous herbaceous plant sparsely distributed across mid-Atlantic southeastern states (plantsusda.gov). requires open spaces little canopy cover, meadows early successional habitat.Collins marked individual selected populations, measured size individual coneflower plants using total leaf area, ranged 3-950 cm\\(^2\\). tagged individuals tracked changes time, able estimate survival fecundity different sized individuals. also measured seed set (number seeds per inflorescence) recruitment. Recruitment emergence seed, , germination, growth, survival first year.follows, see empirical data growth, survival, fecundity. continuous data allow us produce matrices , narrow size classes. details require understanding probability densities, rather probabilities, per se, conceptually analogous. continuous probability density analog matrix referred “kernel.” Regardless, goal – want use understanding growth, survival, fecundity estimate matrix kernel K ,\n\\[\\mathbf{K = GS + F}\\].Next show size-dependence processes, resulting kernels. IPMs, common use logarithm size rather original linear scale. many processes scale log-size. - sizes natural log leaf area.Survival, S, one year next depends size.\nFigure 4.9: Survival represented surviving (1) surviving (0). probability surviving next year, given size first year esitmated using logistic regression.\nGrowth, G really size plant one year depends size previous year.\nFigure 4.10: Growth relation size one time vs. size another. fitted estimate includes 95% confidence interval. dashed line 1:1 line; line growth, regression smaller size.\nNext tackle fecundity, F, us estimated usingthe size-dependent probability flowering,size-dependent number seeds produced flowering individual,probability seed germinating surviving new recruit, andthe size-distribution new recruits.Typically, bigger individuals greater chance flowering, smooth coneflower exception. estimate chance using logistic regression.\nFigure 4.11: Plants larger first year greater chance flowering next year.\nalso true bigger plants might produce seeds, although lot evidence data.\nFigure 4.12: compelling evidence size influences seed set. Nonetheless, use approach estiamting fecundity, F.\nalso need estimate establishment probability, chance seed germinates survives following summer. Collins estimated using seed baskets. mesh baskets soil placed known number seeds. placed ground seedlings recruits counted following year.\nFigure 4.13: Probability seeds one year establish new recruits following summer.\ncan use data (shown) characterize size distribution new recruits, approximately log-normally distributed.\nFigure 4.14: size distribution new recruits; assume independent plant size year t.\nFirst estimate something data, use build functions. use code handed stone tablets Ellner, Merow, others.start data frame hold summaries.Next, perform analyses extract means, linear relationships, variation, put values data frame.make functions able use relationships data frame make kernel.\nFigure 4.15: component kernels G, S, F, make full demographic projection kernel, K, smooth cone flower. Unlike proection matrices, kernels scale axes start size = 0 lower left corner. color scaling full kernel differs slightly can see contributions G, S, F.\n","code":"\n# vegetative coneflower data.\ndata(coneflower)\ncf <- coneflower\n# seed set\ndata(coneflowerseeds)\nsf <- coneflowerseeds\n# recruit sizes - not shown\ndata(coneflowerrecruits)\nrs <- coneflowerrecruits\n# recruit sizes - not shown\neda_s <- ggplot(cf, aes(logA, surv)) + lims(x=c(0.5, 2.75)) +\n  geom_jitter(height=.02, alpha=0.5) + \n  geom_smooth(method=\"glm\", method.args = list(family = \"binomial\")) + labs(title=\"Survival\")\neda_s\n# use only the plants alive in both years\ncfs <- filter(cf, surv==1 & !is.na(logAp))\neda_g <- ggplot(cfs, aes(logA, logAp)) + geom_point() +\n  geom_abline(intercept=0, slope=1, lty=2, col=\"blue\") +\n  labs(title=\"Growth, Stasis, Regr.\") + \n  geom_smooth(method=\"lm\",col=\"red\", se=)\neda_g\ncff <- filter(cf, surv==1 )\neda_f <- ggplot(cfs, aes(logA, flower_p)) + \n  geom_jitter(height=.02, alpha=0.5) + \n  geom_smooth(method=\"glm\", method.args = list(family = \"binomial\")) + labs(title=\"Flowering\")\neda_f\neda_sd <- ggplot(sf, aes(logAs, seeds)) + geom_point() +\n  geom_smooth(method=\"lm\") + labs(title=\"Seed set\")\neda_sd\n# 50 seeds into each of baskets\nN <- rep(50, 9)\n# no. of seeds planted in the fall that popped up and\n# survived into June\nsuccess <- c(5,8,11,10,1,0,4,5,5)\nY <- cbind(success, failure=N-success)\ngerm.est <- glm(Y ~ 1, family=\"binomial\")\n# the point estimate of establishment success\n# backtransform from logistic regression.\npr <- 1/(1 + exp(-coef(germ.est)[1]))\n\n# plot the probability distribution of establishment \nx <- sum(Y[,\"success\"])\nnx <- sum(Y[,\"failure\"])\n# Use the Jeffreys interval, which is based on the Beta distribution \n# with priors of (1/2, 1/2) being the conjugate prior for the binomial.\neda_pr <- ggplot(data = data.frame(x = c(0, 0.5)), aes(x)) +\n  stat_function(fun = dbeta, n = 501, \n                args = list(shape1 = x+1/2, shape2=nx+1/2)) + labs(y=\"Prob(recruiting)\", title=\"Seed basket recruitment\") + \n  scale_y_continuous(breaks = NULL)\neda_pr\nm.log <- mean(log10(rs$area17)) # mean of log-area of new recruits\nstd.log <- sd(log10(rs$area17)) # st. dev. of log-area of new recruits\neda_C <- ggplot(data = data.frame(x = c(0.4, 1.4)), aes(x)) +\n  stat_function(fun = dnorm, n = 101, \n                args = list(mean = m.log, sd = std.log)) +\n  labs(y=\"Prob(recruit log-size x)\", \n       title=\"Distr. of recruit sizes\") + \n  scale_y_continuous(breaks = NULL)\neda_C\n## this sets up a list of the model parameters. These parameters will be estimated and recorded below.\nparams=data.frame(\n    surv.int=NA,\n    surv.slope=NA,\n    growth.int=NA,\n    growth.slope=NA,\n    growth.sd=NA,\n    flowering.int=NA,\n    flowering.slope=NA,\n    seed.int=NA,\n    seed.slope=NA,\n    seed.sd=NA,\n    recruit.size.mean=NA,\n    recruit.size.sd=NA,\n    establishment.prob=NA\n)\n#survival regression\nsurv.reg=glm(surv~logA,data=cf,family=binomial())\nparams$surv.int <- coef(surv.reg)[1]\nparams$surv.slope <- coef(surv.reg)[2]\n\n# Growth\ngr.reg <- lm(logAp ~ logA, data=cf)\nparams$growth.int <- coef(gr.reg)[1]\nparams$growth.slope <- coef(gr.reg)[2]\nparams$growth.sd <- sd(resid(gr.reg))\n\n# flowering\nfl.reg=glm(flower_p~logA, data=cf,family=binomial())\nparams$flowering.int <- coef(fl.reg)[1]\nparams$flowering.slope <- coef(fl.reg)[2]\n\n# seed set\nseed.reg <- lm(seeds ~ logAs, data=sf)\nparams$seed.int <- coef(seed.reg)[1]\nparams$seed.slope <- coef(seed.reg)[2]\nparams$seed.sd <- sd(resid(seed.reg))\n\n# recruitment\nparams$establishment.prob <- pr\n\n# recruit size distr.\nparams$recruit.size.mean <- m.log\nparams$recruit.size.sd <- std.log\n## Make the kernel (cf. projection matrix)\n\n# Relies on the Riemann sum, using midpoints. Increase $n$ to decrease $h$ and improve accuracy (but reduce speed).\n\n# The variable 'y' in the figures below is log10(Area).\n\n# 1. boundary points b, mesh points y and step size h\n# integration limits - these limits span the range of sizes observed in the data set, and then some.\nmin.size=.9*min(c(log10(rs$area17), cf$logA,cf$logAp),na.rm=T)\nmax.size=1.1*max(c(log10(rs$area17), cf$logA,cf$logAp),na.rm=T)\n# number of cells in the discretized kernel\nn=100 \n# boundary points (the edges of the cells defining the kernel)\nb = min.size + c(0:n)*(max.size-min.size)/n \n# mesh points (midpoints of the cells)\ny = ( b[1:n] + b[2:(n+1)] ) / 2\n# width of the cells\nh = y[2]-y[1]\n\n#############\n# 2. make component kernels\npar(mfrow=c(2,2)) \n# outer  yields an outer product where each element is can be an arbitrary function.\nG=h*outer(y, y, FUN=g.zpz, params=params)   # growth kernel\nimage(y,y,t(G),main='G')        # plot it\n\nP = G # placeholder;redefine P on the next line\nS=s.z(y,params=params)   \nfor(i in 1:n) P[,i]=G[,i]*S[i]          # growth*survival kernel\n{image(y,y,t(P),main='GS')   # plot it\nabline(0,1,lwd=3) }# plot 1:1, which represents stasis\n\nFec=h*outer(y, y, f.zpz, params=params)   # reproduction kernel\nimage(y,y,t(Fec),main='F') # plot it\n\nK=P+Fec # full kernel\n#image(y,y,t(K),main='full kernel')          # plot it\n\n# sometimes it's hard to see both because\n# the fecundity part of the kernel swamps the growth/survival part, \n# so here's a plotting trick to level out the kernel\nimage(y,y,t(K)^.33,main='K', \n      col=grey.colors(12, start=0, end=1, rev = TRUE))    # plot it"},{"path":"DID.html","id":"population-summaries","chapter":"4 Density-independent Demography","heading":"4.7.2 Population summaries","text":"question answer using matrices, can answer using kernels.estimate finite rate increase, \\(\\lambda\\), way .[1] 1.061195The true stable size distribution, reproductive value, elasticity.\nFigure 4.16: Descriptions smooth coneflower demographics.\n","code":"\n(lambda=Re(eigen(K)$values[1]))\nw.eigen=Re(eigen(K)$vectors[,1])\nstable.dist=w.eigen/sum(w.eigen) \nv.eigen=Re(eigen(t(K))$vectors[,1])\nrepro.val=v.eigen/v.eigen[1] \n\n\n# The eigen-things can be combined to obtain the sensitivity and elasticity matrices.\n# 2. compute elasticity and sensitivity matrices\nv.dot.w=sum(stable.dist*repro.val)*h\nsens=outer(repro.val,stable.dist)/v.dot.w\nelas=matrix(as.vector(sens)*as.vector(K)/lambda,nrow=n)\n\n# 3. plot results \n\npar(mfrow=c(1,3)) \nplot(y,stable.dist,xlab=\"Size\",type=\"l\",main=\"Stable size distribution\")\nplot(y,repro.val,xlab=\"Size\",type=\"l\",main=\"Reproductive values\") \nimage(y,y,t(elas),xlab=\"Size (t)\",ylab=\"Size (t+1)\",main=\"Elasticity\")"},{"path":"DID.html","id":"r-packges-for-demography","chapter":"4 Density-independent Demography","heading":"4.8 R packges for demography","text":"Caswell (2001) definitive reference text matrix models. S. P. Ellner Guckenheimer (2006) provides excellent introduction, sure many excellent texts well.Stubben Milligan (2007) Stott, Hodgson, Townley (2018), de la Cruz (2019) provide R packages stage-based matrix models methods go well beyond text. addition, several packages analyzing life tables human demography.Stephen P. Ellner, Childs, Rees (2016) probably best source understanding IPMs. R package IPMpack (Metcalf et al. 2014) excellent package implement analyze IPMs.","code":""},{"path":"DID.html","id":"exploring-a-real-population","chapter":"4 Density-independent Demography","heading":"4.9 Exploring a real population","text":"Crouse, Crowder, Caswell (1987) performed demographic analysis endangered sea turtle species, loggerhead (Caretta caretta). Management loggerhead populations seemed essential long term survival, popular management strategy still protect nesting females, eggs, hatchlings. ground breaking work Crouse28 colleagues compiled data create stage-based projection matrix analyze quantitatively stages important least important influencing long-term growth rate. work led US Federal laws requiring US shrimp fishermen use nets include Turtle Excluder Devices (TEDs, https://www.fisheries.noaa.gov/southeast/bycatch/turtle-excluder-device-regulations ). Crouse et al. determined transition matrix, , loggerhead population:\\[\\begin{array}{c}\nH\\\\J_s\\\\J_l \\\\sub \\\\ B_1 \\\\B_2 \\\\ M\n\\end{array}\n \\left(\n\\begin{array}{cccccccc}\n     0&      0&      0&      0&    127&      4& 80\\\\\n0.6747& 0.7370&      0&      0&      0&      0& 0\\\\\n     0& 0.0486& 0.6610&      0&      0&      0& 0\\\\\n     0&      0& 0.0147& 0.6907&      0&      0& 0\\\\\n     0&      0&      0& 0.0518&      0&      0& 0\\\\\n      0&      0&      0&      0& 0.8091&      0& 0\\\\\n      0&      0&      0&      0&      0& 0.8091& 0.8089\n\\end{array} \n\\right)\\]Draw hand two different types life cycle graphs loggerhead population. Include matrix elements associated transition.Use eigenanalysis determine \\(\\lambda_1\\). Explain tells us population, including assumptions regarding stable stage distribution.Use eigenanalysis determine stable stage distribution.Use eigenanalysis determine elasticities. transition(s) influential determining growth rate?predicted long-term relative abundance stages? call ?interest maximize long-term growth rate, stage(s) invest protection measures? stages least likely enhance long-term growth rate, regardless protective measures?Start \\(\\mathbf{N} = \\left(1000\\,10\\,10\\,10\\,10\\,10\\,10\\right)\\) graph dynamics stages 20 years.","code":"\nA <- matrix(\n  c(0,      0,      0,      0,    127,      4,    80,\n    0.6747, 0.7370, 0,      0,      0,      0,     0,\n    0,      0.0486, 0.6610, 0,      0,      0,     0,\n    0,      0,      0.0147, 0.6907, 0,      0,     0,\n    0,      0,      0,      0.0518, 0,      0,      0,\n    0,      0,      0,      0,      0.8091, 0,      0,\n    0,      0,      0,      0,      0,      0.8091, 0.8089), \nnrow=7, ncol=7, byrow=TRUE)\neigen(A)$values## [1]  0.9450310+0.0000000i  0.7461702+0.2130565i  0.7461702-0.2130565i\n## [4]  0.3716668+0.0000000i  0.2654528+0.0000000i -0.0884455+0.1195997i\n## [7] -0.0884455-0.1195997i"},{"path":"DDgrowth.html","id":"DDgrowth","chapter":"5 Density-dependent growth","heading":"5 Density-dependent growth","text":"Let’s go back Song Sparrow (Melospiza melodia) data used illustrate density-independent growth — now graph data.\nFigure 5.1: Song Sparrow Melospiza melodia* counts, \\(N\\), 1966–2003 relation observed counts annual growth rate determined counts, fit ordinary least squares regression. See Chapter 3 data source.*\nplot annual per capita growth rate, \\(r_t = \\log (N_{t+1}/N_t)\\), function \\(N\\), see pattern emerge. low \\(N\\), \\(r>0\\), whereas high \\(N\\), \\(r < 0\\). annual growth rate depends size density population. sort thing mean use term density-dependent growth.might limit population growth sparrows? Space available male territories successional-scrub type habitat? Availability seeds, fruits invertebrates? don’t necessarily know precisely limits , something related abundance, can treat density proxy amount limitation.Density-dependent population growth case per capita population growth rate depends statistically density population. slope relation negative Fig. 5.1, call negative density-dependence. Negative density dependence characteristic population undergoing intraspecific competition, individuals species compete shared resources negative effects demographic rates. , represent algebraically?29","code":""},{"path":"DDgrowth.html","id":"continuous-logistic-growth","chapter":"5 Density-dependent growth","heading":"5.1 Continuous logistic growth","text":"originally introduced ecology Verlhurst late 1800s, described limits population growth terms upper limit \\(K\\),\n\\[\\begin{equation}\n\\frac{dN}{dt}= rN\\left(1-\\frac{N}{K}\\right) \\tag{5.1}\n\\end{equation}\\]\n\\(K\\) referred carrying capacity. population size negative effects crowding prevent additional population growth. happens equation \\(N=K\\), population growth rate falls zero, \\(\\left(1-K/K\\right)=1-1=0\\).Notice first part equation exponential growth \\(rN\\), modified negative effect growing population. \\(N\\) grows, \\((1-N/K)\\) causes \\(dN/dt\\) shrink. \\(N\\) approaches \\(K\\), \\(dN/dt\\) approaches zero, population stops changing stays \\(N=K\\).refer \\(K\\) attractor \\(N\\) moves deterministic fashion toward \\(K\\) – \\(K\\) attracts \\(N\\). explore meanings attractor related terms throughout book.Theory alert! Recall Alan . Hastings (2011) identified principles macroscopic theory population growth, () populations exponentially, unless (ii) something prevents exponential growth. see one somethings – negative density dependence.Another common representation model, one use \n\\[\\begin{equation}\n\\frac{dN}{dt}= rN\\left(1-\\alpha N\\right) \\tag{5.2}\n\\end{equation}\\]\n\\(\\alpha=1/K\\). manner, \\(\\alpha\\) represents per capita effect individual population growth rate. next.","code":""},{"path":"DDgrowth.html","id":"dynamics-around-the-equilibria-stability","chapter":"5 Density-dependent growth","heading":"5.2 Dynamics around the equilibria — stability","text":"stability system30 measure much tends stay , spite external disturbances changes state system.term stability given many specific meanings, including resilience, resistant, reactivity, permanence. won’t go , one consider different facets stability (Chen Cohen 2001).31 focus resilience, tendency population return equilibrium, attracted toward equilibrium, perturbed .Consider stability marble inside wok. wok doesn’t move, marble just sits lowest spot bottom. wok bumped, marble jiggles rolls around bit, settles back bottom. stable system point bottom bowl (attractor) toward marble rolls — points inside wok allow marble find lowest point (attractor). reason, call collection points inside surface wok basin attraction. steeper sides, quickly marble moves toward bottom. rate referred resilience.translate notion basin population, let position marble inside wok value \\(N\\) particular point. Bumping wok disturbance causes change \\(N\\). slope sides wok reflects biology mathematics cause \\(N\\) move quickly slowly back toward bottom. logistic model, rate determined \\(r\\) \\(\\alpha\\), also \\(N\\) . attractor bottom bowl population’s carrying capacity, \\(K=1/\\alpha\\).32When imagine marble wok, becomes easy envision \\(K\\) attractor bottom bowl. consider carrying capacity stable equilibrium point, attractor, even factors, disturbance, may cause \\(N\\) deviate .equilibrium focused \\(K\\), recall \\(N=0\\) also equilibrium. equilibrium actually edge wok — slightest jiggle, marble falls moves toward center wok, \\(K\\). biological analog “jiggle” additional one small numbers individuals otherwise extinct population. example, consider sterile Petri dish nutrient agar E. coli population size zero. E. coli \\(N=0\\) gets “perturbed” single added cell, population move quickly toward carrying capacity \\(K\\). sense, \\(N=0\\) equilibrium, unstable equilibrium. also call unstable equilibrium repeller.","code":""},{"path":"DDgrowth.html","id":"analytical-linear-stability-analysis","chapter":"5 Density-dependent growth","heading":"5.2.1 Analytical linear stability analysis","text":"interested dynamics stability \\(N\\) equilibria, \\(N^*\\). use analytical linear stability analysis show mathematically described marble wok. somewhat limited scope, linear stability nonetheless powerful technique dynamic model analysis.nutshell, determine whether growth rate, zero equilibrium, becomes positive negative response small change \\(N\\). , \\(N\\) takes tiny step away equilbrium, tiny step shrink, grow? tiny step results shrinking step, back toward equilibrium, demonstrates stability. tiny step results growth bigger step, demonstrates instability. analytical stability analysis tells us.Consider plot growth rate, \\(dN/dt\\) vs. \\(N\\) (Fig. 5.2). equilibria, \\(N^*\\), \\(N\\) (\\(x\\)-axis) \\(dN/dt=0\\) (points , d). Note population growth rate positive negative. happen population finds \\(N=50\\)? grow, moving along \\(x\\)-axis, population growth rate slows much comes rest \\(N=1/\\alpha=K=100\\). Thus, \\(N\\) changes converges equilibrium, \\(N^*\\), \\(dN/dt=0\\). Alternatively \\(N=110\\), \\(dN/dt\\) negative, \\(N\\) shrinks back \\(K\\) (point d). return toward \\(K\\) means \\(K\\) attractor stable equilibrium.Next, consider \\(N=0\\), point ; change . However, “perturbed” , addition one individuals, “perturbation” grow, sending \\(N\\) across \\(x\\)-axis, away \\(N=0\\), toward \\(N=K\\). stasis \\(N=0\\), movement away \\(N=0\\) slightest perturbation means \\(N=0\\) repeller unstable equilibrium.Linear stability analysis calculate degree attraction repulsion local point.\nFigure 5.2: Population growth rate, \\(dN/dt\\), function \\(N\\). kind graph called phase portrait phase plane. Points –e labelled convenience. values \\(N\\) associated points \\(\\) \\(d\\), population growth rate equals zero. values \\(N\\) associated \\(b\\) \\(c\\) growth rate positive, \\(e\\) growth rate negative. Note growth rate function \\(N\\) (time explicitly part graph)\nfast \\(N\\) return \\(N^*=K\\), perturbed? Let’s start imagining two populations different intrinsic rates increase (\\(r=1,\\,0.5\\)), focus growth rate \\(N^*=K\\) (Fig. 5.3). one populations \\(dN/dt\\) go zero quickly? population loses individuals declines \\(x\\) \\(N^*-x\\), population return \\(N^*\\) quickly? surprisingly, population higher \\(r\\) — \\(r=1\\), population growth rate (\\(y\\)-axis) greater \\(r=0.5\\), therefore return faster rate.Note also population (\\(r=1\\)) negative growth rate greater magnitude \\(N^*+x\\). Regardless whether gains loses individuals, return \\(N^*\\) quickly population lower \\(r\\).\nFigure 5.3: close equilibrium, population recovers perturbation, moving toward equilibrium attractor, rate \\(e^{-r}\\). Left, slopes population growth \\(vs.\\) \\(N\\) near equilibrium; around equilibrium attractor, small decreases \\(N\\) lead positive growth rate, whereas small increases lead negative growth rate; population steeper slope changes faster. Right, regardless particular \\(r\\) population, population recovers perturbation, moving toward equilibrium attractor, rate \\(e^{-r}\\)\nquantify rate return \\(N^*\\) can compare two populations? slope curve \\(N^*\\) quantifies rate return, slope exponential return rate. calculate slope curve use calculus, slope curve derivative. case, need derivative growth rate (\\(dN/dt\\)) respect variable \\(x\\)-axis, \\(N\\). derivative called partial derivative. Therefore need partial derivative growth rate, respect \\(N\\). slope growth rate respect \\(N\\).find partial derivative, let us denote population growth rate \\(\\dot{N}=dN/dt\\) (“N-dot”),\n\\[\\begin{equation}\n  \\tag{5.3}\n  \\dot{N} = rN\\left(1-\\alpha N\\right).\n\\end{equation}\\]\n\\(\\dot{N}\\) common symbol time derivative growth rate, use merely simplify notation.Given \\(\\dot{N}\\), partial derivative respect \\(N\\) \n\\[\\begin{equation}\n  \\tag{5.4}\n  \\frac{\\partial \\dot{N}}{\\partial N} = r - 2r\\alpha N.\n\\end{equation}\\]\n, interested equilibrium, \\(N = 1/\\alpha\\). substitute eq.  simplify, reduces \n\\[\\begin{equation}\n  \\tag{5.5}\n  \\frac{\\partial \\dot{N}}{\\partial N} = -r \\, .\n\\end{equation}\\]\n\\(N^*=1/\\alpha\\), slope \\(-r\\). *negative slope equilibrium demonstrates stability equilibrium.Near \\(N^*\\), population growth rate \\(-rx\\).33 , rate change \\(x\\) (Figs. 5.3) \n\\[\\begin{equation}\n  \\tag{5.6}\n  \\frac{dx}{dt} = -rx\n\\end{equation}\\]\nallows us pretend perturbation diminish exponentially, growth rate constant. say “pretend,” realize rate applies small region can assume slope straight line. can describe size \\(x\\) time \\(t\\) integrating well-known differential equation respect time \n\\[\\begin{equation}\n  \\tag{5.7}\n  x_t = x_0e^{-r t}\n\\end{equation}\\]\n\\(x_0\\) size initial displacement relative equilibrium, \\(x_t\\) size displacement time \\(t\\) relative equilibrium.choose \\(x_t\\) carefully, analyses, can determine time required reach \\(x_t\\) call time characteristic return time. determine characteristic return time, let \\(x_t=x_0/e\\), thus defining characteristic return time amount time required reduce perturbation 63% (.e. \\(1/e\\)). can solve \\(t\\) dividing \\(x_0\\) taking \\(\\log\\) sides,\n\\[\\begin{align}\n  \\tag{5.8}\n  \\frac{x_0}{e} &= x_0e^{-r t}\\\\\n  \\log\\left(e^{-1}\\right) &= -r t\\\\\n  t &= -\\frac{1}{\\left(-r\\right)}.\n\\end{align}\\]\nThus see return time, \\(t\\), positive number, units \\(r\\), depends slope growth rate respect \\(N\\). also depends assumption linearity close equilibrium.review, took partial derivative \\(dN/dt\\) respect \\(N\\), evaluated partial derivative \\(N^*\\) get rate change perturbation, \\(x\\). negative value indicates perturbation decline time, indicating stable equilibrium attractor. positive value indicate perturbation grow time, thus indicating unstable equilibrium, repellor.can use R’s minimal symbolic capabilities get derivatives. get partial derivative evaluate two equilibria (Fig. 5.2).first value, 1, corresponds first value \\(N\\), \\(N=0\\). positive, indicates perturbation increase time, meaning \\(N=0\\) repellor. second value, \\(-1\\), negative, indicates perturbation decrease time, meaning \\(N=1/\\alpha\\) attractor.","code":"\n# Plot the phase portrait - use the phaseR package\nlogisticPP <- phasePortrait(logistic, ylim = c(-5, 105), parameters = c(1, 100),\n              ylab=\"Population Growth Rate (dN/dt)\", xlab=\"N\")\nN <- c(0, 10, 50, 100, 115)\npop.growth.rate <- expression( N * (1 -  N/100) )\npoints(N, eval(pop.growth.rate), cex=1.5)\ntext(N, eval(pop.growth.rate), letters[1:5],adj=c(.5,2))\nalpha <- 0.01; r <- 1\npop.growth.rate <- expression( r * N * (1 -  alpha*N) )\n# find the partial derivative of dNdt\ndF.dN <- D(pop.growth.rate,\"N\")\ndF.dN # here it is## r * (1 - alpha * N) - r * N * alpha\n# set N equal to zero and the carrying capacity\nN <- c(0, 1/alpha) \n# calculate the slopes of dN/dt vs. N at those two points\neval(dF.dN)## [1]  1 -1"},{"path":"DDgrowth.html","id":"projection-with-numerical-integration","chapter":"5 Density-dependent growth","heading":"5.2.2 Projection with numerical integration","text":"simple density-independent growth, able project population using integral exponential growth equation, \\(N_t=N_0 e^{rt}\\). models become complex, longer able . Instead, use numerical integration project models continuous growth time. use numerical techniques turn infinitely small intervals calculus (\\(dx\\), \\(dy\\)) , small, finite steps. Mathematicians computer scientists devised clever ways accurately precisely. R, best package deSolve, contains several solvers differential equations perform numerical integration. access solvers (.e. numerical integraters) using ode function deSolve package. function, ode, wrapper underlying suite functions work.ordinary differential equation (ODE) logistic growth,\\(dN/dt = rN(1-\\alpha N)\\) say “solve” equation,particular time intervalgiven set parameters andparticular initial conditions initial population size.instance, say solve logistic growth model time \\(t=0,\\, 1 \\ldots \\, 20\\), parameters \\(r=1\\), \\(\\alpha=0.001\\), \\(N_0=10\\).Let’s example ode, using logistic growth. first define function particular way. arguments function must , order: time, vector populations, vector list model parameters. Note function already primer package clogistic(), don’t run code use function.isn’t necessary, use () allow us use names variables parameters (Petzoldt 2003). works y p vectors named variables parameters. Finally, use return cause function produce derivative list.following equivalent, slightly less readable transparent.solve ODE, need specify parameters–wil tell R values want use \\(r\\) \\(\\alpha\\).also need tell R size population start , \\(t=0\\), \\(N_0\\). refer initial condition, start population size \\(N_0=1\\). also need supply time steps want output. R project population size times including last time step specify.Now put ode(), correct arguments. output matrix, first column time steps, remaining state variables. loaded primer, deSolve package loaded already.34We can plot output well. deSolve package directs R use special methods plot output ode.\nFigure 5.4: Output numerical integration logistic growth, N0==10, r=1, alpha=0.001.\nsee classic S-shaped curve logistic growth. Regardless start, population always settle \\(K=1/\\alpha\\).\nreading , predict shape curve :\\(r\\) smaller, larger.\\(\\alpha\\) smaller, larger.initial population size \\(K\\)\nFigure 5.5: variation logistic growth parameters influence dynamics.\nsee refer \\(K\\) attractor \\(N\\) moves deterministic fashion toward \\(K\\). explore meanings attractor related terms throughout book.phaseR package sweet plotting functions systems 1 two ODEs. used phase portrait, use trajectories.\nFigure 5.6: velocity field kind like magnetic field, showing rate direction trajectories throughout space. nullcline isocline rate change zero (straight horizontal lines figure). r = 1, K=2.\n","code":"\nclogistic <- function(time, y, parameters){\n  # y is a single value of N; if we have more than one population, \n  # e.g. competition, then y would have two values, one for \n  # each population.\n  \n  # parameters is a vector of...parameters....\n  \n  # Both y and parameters have names for each element,\n  # e.g., y <- c(N=10) - see the text.\n  \n  with(as.list(c(y, parameters)), {\n    # \"with\" creates an \"environment\" within which R looks for values\n    # c() combines the two vectors into one\n    # as.list() turns the resulting vector into a list\n    \n    # our differential equation for growth\n    dN.dt <- r * N * (1 - alpha * N)\n    \n    # making the function create output, which must be a list with\n    # one element\n    return( list( dN.dt ) )\n  } )\n}  logistic2 <- function(t, y, p){\n    dN.dt <- p[1] * y[1] * (1 - p[2] * y[1])\n    return( list( dN.dt ) )\np <- c(r=1, alpha = 0.001)\n# We name the state variable and the parameters\ny0 <- c(N=1)\nt <- 0:20\nout <- ode(y=y0, times=t, func=clogistic, parms=p)\nout[1:5,]##      time         N\n## [1,]    0  1.000000\n## [2,]    1  2.713627\n## [3,]    2  7.342179\n## [4,]    3 19.709440\n## [5,]    4 51.820737\nplot(out)\nt=seq(0, 20, by=0.01); r <- c(.5, 1.5)\nalpha <- c(0.002, 0.001); N0 <- c(10, 1500)\ninput <- expand.grid(r=r, alpha=alpha, N=N0)\noutdf <- NULL\n#outdf <- data.frame(time=NULL, N=NULL, N0=NULL, r=NULL, alpha=NULL)\nfor(i in 1:nrow(input)) { \n  y <- c(N=input[i,\"N\"])\n  p <- c(r=input[i,\"r\"], alpha=input[i,\"alpha\"] )\n  out <- ode(y, times=t, fun=clogistic, p)\n  out2 <- cbind(out, N0=y, r=p[\"r\"], alpha=p[\"alpha\"])\n  outdf <- rbind.data.frame(outdf, out2)\n}\noutdf$N0 <- as.factor( outdf$N0 )\noutdf$alpha <- as.factor(outdf$alpha )\nggplot(outdf, aes(time, N, colour=N0, linetype=alpha) ) + geom_line() + \n  facet_grid(r~., labeller=label_both) + theme_bw()\n# Plot the velocity field, nullclines and several trajectories\n\n## These create arrows (vectors) whose length and direction\n## reveal the velocity at different points\nlogistic_flowField     <- flowField(logistic,\n                                    xlim       = c(0, 5),\n                                    ylim       = c(-1, 3),\n                                    parameters = c(1, 2),\n                                    points     = 21,\n                                    system     = \"one.dim\",\n                                    add        = FALSE)\n## A \nlogistic_nullclines    <- nullclines(logistic,\n                                     xlim       = c(0, 5),\n                                     ylim       = c(-1, 3),\n                                     parameters = c(1, 2),\n                                     system     = \"one.dim\")\nlogistic_trajectory    <- trajectory(logistic,\n                                     y0         = c(-0.5, 0.5, 1.5, 2.5),\n                                     tlim       = c(0, 5),\n                                     parameters = c(1, 2),\n                                     system     = \"one.dim\")"},{"path":"DDgrowth.html","id":"other-forms-of-density-dependent-growth","chapter":"5 Density-dependent growth","heading":"5.3 Other forms of density-dependent growth","text":"many forms density-dependent growth, describe . Let’s start decoupling density-dependence birth death rates (N. J. Gotelli 2001).","code":""},{"path":"DDgrowth.html","id":"effects-of-n-on-birth-and-death-rates","chapter":"5 Density-dependent growth","heading":"5.3.1 Effects of N on birth and death rates","text":"Recall chapter 3 \\(r=b-d\\). Now let \\(b\\) \\(d\\) functions population size \\(N\\) (\\(b=F(N)\\), \\(d=G(N)\\)). let \\(F(N)\\) \\(G(N)\\) take wide variety different forms. now, however, let’s say \\(N\\) linear effects rates \n\\[\\begin{align}\nb &=b_0 - \\\\\nd &= d_0 + cN\n\\end{align}\\]\nappear Fig. 5.7.\nFigure 5.7: Per capita birth death rates can functions density (dashed lines). carrying capacity (K) occurs point per capita birth death rates equal. solid line represents per capita population growth rate, zero N=K.\nNow population growth rate \n\\[\\begin{align}\n\\frac{dN}{dt} &= [(b_0-)-(d_0 + cN)] N\\\\\n& =[(b_0-d_0) - (+c)N] N\\\\\n& = (b_0-d_0)(1-\\frac{+c}{b_0-d_0}N)N\n\\end{align}\\]\nnet negative effect \\(N\\) per capita population growth rate \\[\\alpha = \\frac{+c}{b_0-d_0}\\]\nnumerator total direct negative effect \\(N\\) birth death rates, denominator \\(r\\), net maximum per capita growth rate occurs \\(N\\) approaches zero.","code":""},{"path":"DDgrowth.html","id":"theta-logistic-growth","chapter":"5 Density-dependent growth","heading":"5.3.2 Theta-logistic growth","text":"explore simple extension logistic model, theta-logistic model, adds parameter increase flexibility generality.\n\\[\\begin{equation}\n  \\tag{5.9}\n  \\frac{dN}{dt} = rN\\left(1 - \\left(\\alpha N\\right)^\\theta \\right) \n\\end{equation}\\]\n\\(\\theta\\) strictly positive (\\(\\theta>0\\)); \\(\\theta=0\\) means zero growth, \\(\\theta < 0\\) mean negative growth \\(K\\), unbounded positive growth \\(K\\). Approximations eq. (5.9) allow \\(\\theta \\leq 0\\) possible (Sibly et al. 2005), interpretation becomes strained.make function can use ode(), numerical integration function. ’ll need run code use later.varying \\(\\theta\\), can change linear density dependence simple logistic model curvilinear density dependence (Fig. ). curvilinearity arises \\(\\alpha N < 1.0\\) (.e. \\(0 < N < K\\)),\n\\[\\begin{align*}\n  \\tag{5.10}\n   \\left(\\alpha N\\right)^\\theta &< \\alpha N,\\quad \\theta > 1\\\\\n   \\left(\\alpha N\\right)^\\theta &> \\alpha N,\\quad \\theta < 1.\n\\end{align*}\\]\ncontrast, \\(\\alpha N=1.0\\), \\(\\left(\\alpha N\\right)^\\theta < \\alpha N\\). means \\(\\theta\\) affect \\(K\\).\\(\\theta > 1\\), weakens density dependence low \\(N\\), population grows faster logistic, else equal. \\(\\theta < 1\\), strengthens density dependence low \\(N\\), causing population grow slowly logistic, else equal.effects \\(\\theta\\) density dependence controls shape relation growth rate \\(vs\\). \\(N\\) (.k.. production function, Fig. ). First, note given \\(r\\), growth rate \\(N<K\\) increases \\(\\theta\\). Second, note position peak production function shifts right \\(\\theta\\) increases. , \\(\\theta\\) increases, \\(N\\) maximum growth rate occurs also increases. wanted shift peak growth rate higher \\(N\\) without also increasing height peak, decrease \\(r\\) simultaneously.speculate biological meaning \\(\\theta\\) shape denisty dependence. instance, high \\(\\theta\\) suggests threshold, wherein population exhibits little density dependence close \\(K\\). Perhaps related territoriality, spatial refuge predators. Alternatively, low \\(\\theta\\) might suggest resource preemption, wherein small number individuals can sequester large amounts resources, increasing \\(N\\) results reduced preemption. organisms plastic body sizes (plants, fish), mean low \\(N\\), average body size large, \\(N\\rightarrow K\\), average body size decreases. \\(\\theta\\), per se, devoid mechanism, discovering magnitude \\(\\theta\\) different types species (Sibly et al. 2005) lead generation new testable hypotheses controls populations.\nFigure 5.8: Theta-logistic per capita rates, population growth rates, dynamics $ heta<1$, $ heta=1$, $ heta>1$. review population dynamics, Sibly et al. (2005) use theta-logistic density dependence show populations frequently concave-, $ heta < 1$, pattern.\n","code":"\nthetalogistic  <- function(times, y, parms) {\n  ## with() and as.list() create an environment in which R will see \n  ## the named elements in `parms`. \n  n <- y[1]\n  with(as.list(parms), {\n    dN.dt <- r * n * (1-(alpha*n)^theta)\n    return( list( c(dN.dt) ) ) }  )\n}\nr <- .75; alpha <- 0.01; theta <- c(.5, 1, 2); N <- 0:110\n## Per capita PGR\ntheta.out <- sapply(theta, function(th) {1-(alpha*N)^th})\nmatplot(N, theta.out, type='l', col=1)\nabline(h=0)\nlegend('topright', legend=paste(\"theta =\", c(2, 1, 0.5) ), lty=3:1, bty='n')\n\n## PGR\nthetaGR.out <- sapply(theta, function(th) {r*N*(1-(alpha*N)^th)})\nmatplot(N, thetaGR.out, type='l', col=1)\nabline(h=0)\n##\nr <- 3.4\nlines(N, r*N*(1-(alpha*N)^theta[1]))\ntext(12, 24, \"r=3.4\")\n\nprms <- c(r = 0.75, alpha = 0.01, theta=1)\nt <- seq(0,20, by=.1)\nthetaN <- sapply(theta, function(th) {prms[\"theta\"] <- th\n                                      ode(y=1, times=t, thetalogistic, prms)[,2] } )\nmatplot(t, thetaN, type='l')"},{"path":"DDgrowth.html","id":"allee-effect","chapter":"5 Density-dependent growth","heading":"5.3.3 Allee effect","text":"Allee effect positive relation average individual fitness population size (Drake Kramer 2011). us, translates positive relation per capita population growth rate population size.Allee effect likely arise sexually reproducing populations. occurs low population sizes, male female individuals less likely encounter mating frequency low. population size increases, females males likely encounter , mating increases.One way represent additional term model, incorporates threshold population size, population growth rate negative. \\(\\) threshold population size,\n\\[\\begin{equation}\n\\frac{dN}{dt}= rN\\left(1-\\alpha N\\right)\\left(1 - \\frac{+\\tau}{N+\\tau}\\right) \\tag{5.11}\n\\end{equation}\\]population size falls threshold, recover (\\(N<\\), \\(dN/dt < 0\\)). Parameter \\(\\tau\\) greater 0, controls severe consequence \\(N<\\). smaller \\(\\tau\\) , negative population growth becomes. function project dynamic available primer alogistic().\nFigure 5.9: Allee effect positive relation bewteen population growth rate population size, often best envisioned negative consequence small population size. , threshold population size 20, meaning \\(dN/dt < 0\\), \\(N < 20\\).\n","code":"\n## for simplicity, we let r=1 so we can ignore it here.\npgrA <- function(N, alpha, a, tau){ N*(1-alpha*N)*(1-(a+tau)/(N+tau)) }\nmyData <- data.frame( N=c(0, 110) ) # ggplot requires a data frame\np <- ggplot(data=myData, aes(x=N)) + # set the basic properties of the plot\n  # in the stat_function, we indicate the parameters in our equation.\n    stat_function(fun=pgrA, geom=\"line\", n=1001,\n                  args=list(alpha = 0.01, a=20, tau=.1)) + \n  labs(y=\"Population growth rate (dN/dt)\", x=\"Population size (N)\") + \n  #theme_classic() + \n  geom_hline(yintercept=0, lty=3)+\n  scale_x_continuous(expand = c(0, 0)) \np"},{"path":"DDgrowth.html","id":"the-integral-of-logistic-growth","chapter":"5 Density-dependent growth","heading":"5.3.4 The integral of logistic growth","text":"might well add expression \\(N_{t}\\), analogous \\(N_{t}=N_{0}\\exp(rt)\\) exponential growth. integrate eq. (5.2) respect time, \n\\[\\begin{equation}\nN_{t}=\\frac{N_{0}e^{rt}}{1+\\alpha N_{0}\\left(e^{rt}-1\\right)}.\n\\label{fig:clogisticNt}\n\\end{equation}\\]\nNote resemblance exponential equation. exponential equation numerator, divided correction factor starts 1 \\(t=0\\). correction factor grows time, rate virtually exponential growth adjusted \\(\\alpha\\) scaled \\(N_{0}\\). Thus \\(t=0\\), \\(N_0\\) small, near-exponential growth, decreased merely factor \\(\\alpha N_0\\).","code":""},{"path":"DDgrowth.html","id":"discrete-density-dependent-growth","chapter":"5 Density-dependent growth","heading":"5.4 Discrete Density-dependent Growth","text":"continuous logistic equation probably simplest example population growth, aside pure exponential growth. describe discrete-time version. Recall discrete time version population growth rate \n\\[\\frac{\\Delta N}{\\Delta t}=\\frac{N_{t+1}-N_t}{(t+1) - t}=N_{t+1}-N_t\\]\ntime step one (1) entire time unit (typically year). discrete time logistic function therefore\n\\[\\begin{equation}\n  N_{t+1} - N_t = r_d N_t\\left(1-\\alpha N_t\\right)\n  \\tag{5.12}\n\\end{equation}\\]\\(r_d\\) meaning chapter 3, \\(r_d = b-d-bd\\). \\(r_d\\) quite small slow growing population, similar continuous form. However, \\(r_d\\) becomes larger faster growing population, dynamics can get quite exciting.Let’s explore dynamics numerically writing function project discrete logistic growth. pre-written function available primer name.project discrete time model, project entire one year time. structured demographic models, unstructured geometric growth sparrow simulation. using function deSolve package imposes one year time step, specifically discrete time models, including difference equations.35We set model continuous time model.specific parameters, initial state population size, time steps. Note discrete time model time steps must annual increments. project population.\nFigure 5.10: Discrete growth can look lot like continuous growth long per capita growth rate low.\n","code":"\ndlogistic <- function (t, y, p) {\n  N <- y[1]\n  with( as.list(p),{\n      N.diff <-  rd * N * (1 - alpha * N) \n      return(list(N.diff))  }) }\np <- c(rd=1, alpha=.01)\ny <- c(N=10)\nyears <- 0:10\noutd <- ode(func = dlogistic, y = y, times = years,\n parms = p, method = \"euler\")\noutd <- as.data.frame(outd)\nggplot(outd, aes(x=time, N)) + geom_line() + geom_point() +\n  annotate(\"text\", x=1, y =1/p[\"alpha\"]+2, label=\"K = 1/alpha\")"},{"path":"DDgrowth.html","id":"effects-of-r_d","chapter":"5 Density-dependent growth","heading":"5.4.1 Effects of \\(r_d\\)","text":"Changing \\(\\alpha\\) \\(K\\) change radically dynamics model. However, increasing \\(r_d\\) changes dynamics lot. contrast happens continuous logsitic growth. increase \\(r_d\\) sufficiently, get stable limit cycles raise \\(r_d\\) high enough, get chaos.36.\nFigure 5.11: variation \\(r_d\\) influences dynamics discrete logistic growth.\nlow \\(r_d\\), simple asymptotic approach \\(K\\). \\(r_d\\) increases, see population overshoot carrying capacity exhibit damped oscillations. \\(2 < r_d < 2.449\\), population attracted two-point limit cycles. case, two points stable attractors. Regardless population starts , attracted two points, given \\(r_d\\). \\(r_d\\) increases , number points increases four-point limit cycle (e.g., \\(r_d=2.5\\)), eight-point cycle, 16-point limit cycle, . points stable attractors. \\(r_d\\) increases , however, stable limit cycles shift chaos (\\(r_d>2.57\\)). Chaos non-repeating, deterministic fluctuating trajectory, bounded, sensitive initial conditions.R. M. May (1974) shocked ecological community first demonstrated stable limit cycles chaos using model. groundbreaking work, done hand calculator, showed complicated, seemingly random dynamics emerge result simple deterministic rules. Among things, made population biologists wonder whether prediction possible . general, however, chaos seems require special circumstances, including high population growth.biological interpretation fluctuations? Consider simple environment, small vegetation-eating animals high reproductive rates eat almost vegetation one year. following year, vegetation recovered, animal population still high. Thus high growth rate causes disconnect actual population size, negative effects individuals comprising population. negative effects actions individuals (e.g., resource consumption) felt offspring individuals, rather individuals . won’t belabor point , certainly possible extend delayed density dependence wide variety populations. discrete logistic model built delay, time lag, one time step, growth increment makes single leap one time step. delay missing analogous continuous time model growth increment covers infinity small time step, thanks miracles calculus.37","code":"\nrd.v <- seq(1.3, 2.8, by=.3)\nN0 <- c(N=10); t = 0:20\nNs <- sapply(rd.v, function(r) {\n  p <- c(rd=r, alpha=0.01)\n  outd <- ode(func = dlogistic, y = N0, times = t,\n parms = p, method = \"euler\")[,2]\n  }\n ) \nout <- data.frame(t=t, Ns)\nnames(out) <- c(\"t\", paste(\"rd=\",rd.v, sep=\"\"))\nout.l <- pivot_longer(out, cols=-1, names_to=\"r.d\", values_to=\"N\")\n\nggplot(out.l, aes(t, N) ) + geom_line() + \n  facet_wrap(~r.d)"},{"path":"DDgrowth.html","id":"bifurcations","chapter":"5 Density-dependent growth","heading":"5.4.2 Bifurcations","text":"now, examined \\(N\\) function time. \ngraphed different \\(\\alpha\\) \\(N_0\\), time always \n\\(x\\)-axis. Now going examine \\(N\\) function \\(r_d\\), \\(r_d\\) \\(x\\)-axis. Specifically, plot stable limits attractors \\(vs\\). \\(r_d\\) (Fig. ??). mean? \\(r_{d} < 2\\), single \\(N\\). mean stable point equilibrium, point attractor.long \\(r_d\\) small, \\(N\\) always converges particular point.38 \\(2<r_{d}<2.45\\), sudden two different \\(N\\); , two-point stable limit cycle. Note \\(r_d\\approx 2\\) oscillations two point attractors around \\(K\\) small, increase \\(r_d\\), two points farther apart. point limit cycle emerges, \\(r_d=2\\), called bifurcation; splitting single attractor two attractors. \\(r_{d}\\approx 2.45\\), another bifurcation, two stable attractors split two, resulting total four unique \\(N\\). \\(r_{d}\\approx 2.53\\), eight \\(N\\).points periodic attractors \\(N\\) drawn particular points regular intervals. \\(r_d\\) increases number attractors continue double, growing geometrically. Eventually, reach point becomes infinite number unique points, determined \\(r_{d}\\).39 completely deterministic, non-repeating pattern \\(N\\) property chaos. Chaos random phenomenon; rather result deterministic mechanisms generating non-repeating patterns.perform comprehensive simulations, plot point periodic attractors vs. \\(r_d\\). First pick constraints simulation: number different \\(r_d\\), sequence \\(r_d\\) values, number time steps.\nFigure 5.12: Illustration long term dynamics discrete logistic population growth. small change continuous parameter results change number attractors (e.g. single point equilibrium stable 2-point limit cycle), call bifurcation.\n\nFigure 5.13: Illustration long term dynamics discrete logistic population growth. small change continuous parameter results change number attractors (e.g. single point equilibrium stable 2-point limit cycle), call bifurcation.\ngreat deal effort expended trying determine whether particular model real population exhibits true chaos. practical sense, may somewhat unimportant whether population exhibits true chaos, merely higher order periodic attractor (S. P. Ellner Turchin 2005). key point simple models, therefore potentially simple mechanisms, can generate complex dynamics.Another important characteristic feature chaotic populations sensitive initial conditions. Thus emerges idea whether butterfly Sierra Leone flaps wings twice thrice may determine whether hurricane hits southeastern United States New Orleans, Louisiana, Galveston, Texas.40If generate simulations vary initial population size single individual, find can enormous impact similarity two populations’ dynamics, ability predict future population sizes (Fig. @(fig:DDGChaosInitN)). Note populations start similar trajectories, soon diverge experience different sequences minima maxima (Fig. @(fig:DDGChaosInitN)). part upsetting ecologists May’s 1974 paper — perhaps even simplest deterministic model create dynamics complex distinguish random (R. M. May 1974). time, however, came learn () distinguish random dynamics chaos-like dynamics, (ii) hunt chaos exciting, frequently disappointing (Becks et al. 2005; Constantino et al. 1995; Kendall, Prendergast, Bjornstad 1998).start three populations, close initial abundance, \\(N_0 \\\\{97,98,99\\}\\). project population \\(r_d\\) generate chaos 30 time steps.\nFigure 5.14: Effects differences initial population size short term long term dynamics, correspondence, three populations.\nOne last issue note extent populations bounded. population may complex dynamics, may able characterize given population upper lower bounds. spite differences created initial conditions, upper lower bounds chaotic populations similar (Fig. 5.14). Note also \\(r_d\\) increases (Fig. ??) oscillations increase systematically.One way see deterministic nature chaos trace population size time point next time point. put \\(N_t\\) \\(x\\)-axis \\(N_{t+1}\\) \\(y\\)-axis, connect successive points.\nFigure 5.15: chaotic discrete logistic population shows certain highly predictable patterns including population sizes limited quadratic form revealed .\ngeneral, can describe many characteristics populations, even predict exactly population size five years hence. instance, can describe shape density dependence (linear, nonlinear), characteristics \\(N\\), average, variance, periodicity, upper lower bounds, color (.e. degree temporal auto-correlation). Indeed, characteristics may vary among types organisms, body sizes, environments.","code":"\n## Iff you are interested....\nnum.rd <- 1001 # the number of rd's you want\nrd.s <- seq(1.5,3, length=num.rd) # the actual rd values\nt <- 0:1000 # how long to run each population\nN0 <- c(N=99) # N-zero\n## do all the dynamical simulations putting each run\n## into a column of a matrix.\nNs <- sapply(rd.s, function(r) {\n  p <- c(rd=r, alpha=0.01)\n  outd <- ode(y = N0, times = t, func = dlogistic, \n parms = p, method = \"euler\")[,2]\n  }\n ) \nout <- data.frame(t=t, Ns) # put times to the front of the matrix\nnames(out) <- c(\"t\", paste(\"rd=\",rd.s, sep=\"\")) # relabel columns\nout.last <- subset(out, t > 0.8*max(t)) # keep only the last 20%\n## put the data in the \"long format\"\nout.l <- pivot_longer(out.last, cols=-1, names_to=\"r.d\", values_to=\"N\")\nout.l <- arrange(out.l, r.d, t) # re-order the data\n## extract text out of the 'r.d' label that is the numeric value\ntext.values <- substr(out.l$r.d, regexpr(\"=\", out.l$r.d)+1, 100) \n## convert the characters of \"1.5\" to the number 1.5\nout.l$rd <- as.numeric( text.values )\n\n## plot the stable limits to show the bifurcations\nggplot(out.l, aes(rd, N)) + geom_point(pch=\".\") + theme_bw()\nout.l.chaotic <- subset( out.l, rd > 2.6 )\n\nggplot(out.l.chaotic, aes(rd, N)) + geom_point(pch=\".\") + theme_bw()\nN.init <- c(97,98,99)\nt <- 0:30\np <- c(rd=2.7, alpha=0.01)\nout <- NULL\nfor(i in  1:3){\n  # project the population\n  N0 <- c(N=N.init[i])\n  a <- ode(y=N0, times=t, dlogistic, \n           parms=p, method=\"euler\")\n  # fill a column with the initial value\n  b <- data.frame(a, N0=as.factor(N0)) # b now has cols: t, N, rd\n  # store data in rows of out \"bind rows\" with rbind\n  out <- rbind.data.frame(out, b)\n}\nggplot(data=out, aes(time, N, colour=N0, linetype=N0)) + geom_line()\nN0 <- c(N=2); t <- 0:1000\np <- c(rd = 2.8, alpha = 0.01)\nout <- ode(N0, t, dlogistic, p, method=\"euler\")\nn <- out[901:1000, 2]\nntp1 <- n[-1]\nnt <- n[-length(n)]\nqplot(nt, ntp1, geom=c(\"point\", \"path\") ) + labs(y=\"N[t+1]\", x=\"N[t]\")"},{"path":"DDgrowth.html","id":"ricker-and-more","chapter":"5 Density-dependent growth","heading":"5.4.2.1 Ricker and more","text":"many models density dependent growth. , like theta-logistic Richards models, flexible parameters. Others, like Gompertz model, used widely fields, cancer research tumor growth, von Bertalanffy body size growth, Ricker model fisheries.Ricker model looks lot like friend, exponential growth, \\(r\\) modified density. see side side.\\[\\begin{equation}\nN_{t+1} = N_t e^{r} \\quad ; \\quad N_{t+1}=N_t e^{r_d \\left(1-N_t/K\\right)}\n\\end{equation}\\]Like discrete logistic growth, Ricker model41 also exhibit chaos high per capita growth rates (\\(r_d>>1\\)).","code":""},{"path":"DDgrowth.html","id":"maximum-sustained-yield","chapter":"5 Density-dependent growth","heading":"5.5 Maximum Sustained Yield","text":"classical model harvesting fisheries wildlife populations based particular conceptualization maximum sustained yield (MSY). Maximum sustained yield historically defined population size population growth rate harvest rate maximum. logistic growth model, half carrying capacity. can solve finding maximum production function. use calculus (differentiation) find slope production function equals zero. Starting partial derivative respect \\(N\\) (eq. (5.4)), solve zero.\n\\[\\begin{align}\n  \\tag{5.13}\n    0 &= r - 2r\\alpha N\\\\\n    N &= \\frac{r}{2r\\alpha} = \\frac{K}{2}\n\\end{align}\\]\nSimilarly, determine peak \\(\\theta\\)-logistic model well.\n\\[\\begin{align}\n  \\tag{5.14}\n  \\frac{\\partial \\dot{N}}{\\partial N} &=r - \\left(\\theta+1\\right)r\\left(\\alpha N\\right)^\\theta\\\\\n0 &= \\frac{K}{\\left(\\theta+1\\right)^{1/\\theta}}\n\\end{align}\\]\n\\(\\theta=1\\), reduces \\(K/2\\), logistic model. saw , \\(\\theta < 1\\) causes value less \\(K/2\\).Even assume logistic model appropriate given population, harvests practice seldom reduce populations \\(K/2\\), often \\(N\\) \\(K\\) vary time difficult estimate. Moreover, economic forces often lead -harvesting. contemporary models harvesting incorporate concepts (Roughgarden Smith 1996) still may prevent fisheries collapse driven social political pressures. note detailed information available age- stage-specific survivorship reproduction, age- stage-structured models harvesting preferred method (e.g., Chapter 2). many populations, marine fisheries, however, data often available stock size (\\(N\\)) total catch (\\(H\\)). fisheries models, total catch fixed vary \\(N\\). leads highly unstable population dynamics fortunately longer practiced fisheries. Usually total catch \\(H\\) modeled function \\(N\\).Let us assume total catch harvest, \\(H\\), simple linear function \\(N\\); total harvest rate \\(FN\\) usually described way.42 case, maximum sustained yield can determined logistic growth-harvest model. basic model \n\\[\\begin{align}\n  \\tag{5.15}\n\\frac{dN}{dt}&=rN(1-\\frac{N}{K})-FN\n\\end{align}\\]\n\\(FN=H\\) harvest rate, \\(F\\) per capita fishing mortality rate. assume fixed per capita catch mortality \\(F\\) total harvest \\(H=F\\times N\\). Maximum sustained yield occur \\(K/2\\) (Fig. 5.16). Therefore like know value \\(F\\) new \\(N^* = K/2\\) rather \\(K\\). can determine value \\(F\\) true finding \\(dN/dt=0\\) \\(N=K/2\\).\n\\[\\begin{align}\n  0 &= r\\frac{K}{2}\\left(1-\\frac{\\frac{K}{2}}{K}\\right)-F\\frac{K}{2}\\\\\n  F &= \\frac{r}{2} \\tag{5.16}\n\\end{align}\\]\nFigure 5.16: find predicted population growth rate harvesting, start Logistic growth rate (solid line) substract harvest rate (dashed line).\nharvesting occurs rate \\(F<r/2\\), slope harvest line shallower Fig. 5.16, refer -harvesting. rate \\(F>r/2\\), slope steeper Fig. 5.16, refer -harvesting. Roughgarden Smith (1996) show -harvesting ecologically stable, whereas -harvesting frequently thought economically optimal approach don’t care long-term wellbeing fishing industry.Typically economically optimal approach leads -harvesting marginal income fishery related interest rate invested income, \\(F= (r + \\rho)/2\\), \\(\\rho\\) interest rate (usually \\(\\rho\\) set 0.05). can substitute eq. (5.15) solve \\(N\\) (ignoring \\(N=0\\)).\n\\[\\begin{align*}\n  \\tag{5.17}\n  0&=rN(1-\\frac{N}{K})-\\frac{r + \\rho}{2}N\\\\\n   N\\frac{r}{K}&=r -\\frac{r}{2} -\\frac{\\rho}{2}\\\\\n  N &=\\frac{K}{2}\\left(1-\\frac{\\rho}{r}\\right)\n\\end{align*}\\]\nThus, unless \\(\\rho=0\\), typical economic optimum \\(N_{e}^*\\) smaller \\(N*=K/2\\). makes intuitive economic sense consider income invested profits. margin error, however, much smaller, putting fisheries population, investment fishing fleets associated econmoies greater risk. Roughgarden Smith (1996) showed ecological stability fishery likely beget economic cultural stability. show supposed “economic optimal” harvesting rate low increased extinction risk harvested population unacceptably high levels. collapse fishery , course, economically culturally devastating.","code":"\npgrlog <- function(N, r, alpha){ r*N*(1-alpha*N) }\nr <- 0.5; alpha <- 0.01\nmyData <- data.frame( N=c(0, 110) ) # ggplot requires a data frame\np <- ggplot(data=myData, aes(x=N)) + # set the basic properties of the plot\n  # in the stat_function, we indicate the parameters in our equation.\n    stat_function(fun=pgrlog, geom=\"line\", n=1001,\n                  args=list(r=r, alpha = alpha)) + \n  labs(y=\"Population growth rate (dN/dt)\", x=\"Population size (N)\") + \n  geom_abline(intercept=0, slope=r/2, lty=2) + ylim(c(-5, 15))\np\n\npgrH <- function(N, r, alpha, f){ r*N*(1-alpha*N) - f*N }\nf <- r/2\nmyData2 <- data.frame( N=c(0, 60) ) # ggplot requires a data frame\nh <- ggplot(data=myData2, aes(x=N)) + # set the basic properties of the plot\n  # in the stat_function, we indicate the parameters in our equation.\n    stat_function(fun=pgrH, geom=\"line\", n=1001,\n                  args=list(r=r, alpha = alpha, f = f)) + \n  labs(y=\"PGR w/ harvesting (dN/dt)\", x=\"Population size (N)\") +\n   ylim(c(-5, 15))\nh"},{"path":"meta.html","id":"meta","chapter":"6 Populations in Space","heading":"6 Populations in Space","text":"\nFigure 6.1: frequency distribution number plant species (y-axis) occupy different numbers grassland remnants (x-axis). Note U-shaped (bimodal) distribution number sites occupied. years similar (Collins Glenn 1991).\nrelatively large spatial scales, unusual species seem occur everywhere, many species found one locations. example, Scott Collins Susan Glenn (Collins Glenn 1991) showed grasslands, separated 4\\(\\,\\)km, species occupying one site (Fig. 6.1, left-bar) two sites, also species occupying sites intermediate numbers sites (Fig. 6.1, right-bar), resulting U-shaped frequency distribution. Illke Hanski (. Hanski 1982) coined rare common species “satellite” “core” species, respectively, proposed explanation. Part answer seems come effects immigration emigration spatial context. chapter explore mathematical representations individuals populations space, investigate consequences populations collections populations.","code":""},{"path":"meta.html","id":"source-sink-dynamics","chapter":"6 Populations in Space","heading":"6.1 Source-sink Dynamics","text":"\nFigure 6.2: simplest source-sink model, m21 > m12 net movement individuals source sink.\nconcept source-sink populations begins assumption spatially separated subpopulations occupy distinct patches, exhibit intrinisic dynamics due births deaths (Fig. 6.2). can characterize subpopulation population growth rate, \\(\\lambda_i\\). addition, individuals migrate patches. Therefore, number individuals observe particular patch due internal dynamics births deaths, also migration.Source populations births deaths (\\(\\lambda > 1\\)) emigration immigration. Sink populations fewer births deaths (\\(\\lambda < 1\\)) immigration emigration.consider causes variation \\(\\lambda\\), often refer quality patches habitats. High quality patches high growth rates (\\(\\lambda>1\\)), whereas low quality patches low growth rates (\\(\\lambda < 1\\)). might also study factors associated growth rate, frequency nesting sites, predator densities, soil fertility, factors predict regulate growth rates.Pulliam envisioned two linked bird populations track adult reproduction, adult juvenile survival, estimate \\(\\lambda_i\\) separately population. size source population, time \\(t+1\\) \\(n_{1,t+1}\\) result survival fecundity. Adult survival \\(P_A\\) fecundity results reproduction, \\(\\beta_1 n_{1,t}\\), times survival juveniles \\(P_J\\). sink population modeled way.\n\\[\\begin{align}\n  \\tag{6.1}\n  n_{1, t+1} &= P_A n_{1,t} + P_J (\\beta_1 n_{1,t}) = \\lambda_1 n_1\\\\\n  n_{2, t+1} &= P_A n_{2,t} + \\beta_2 P_J n_{1,t} = \\lambda_2 n_2\n\\end{align}\\]Pulliam assumed thatthe two populations vary fecundity (\\(\\beta\\)), created differences growth rates, \\(\\lambda_1 > 1 > \\lambda_2\\).birds excess number territories source population emigrated source habitat sink habitat, \\(m_{21} = \\lambda_1 - 1\\).assumptions result source population maintaining constant density, excess fecundity migrates sink population.can use matrix model investigate source-sink populations (e.g., Berry et al. 2008). place rate respective element two-stage matrix model. assume pre-breeding census, count adults. population dynamics thus governed .\\[\\begin{equation}\n\\tag{6.2}\n\\mathbf{} = \\left(\n\\begin{array}{cccc}\nP_{A1} + P_{J1}\\beta_1 &  M_{12} \\\\\nM_{21}  &  P_{A2} +P_{J2}\\beta_2 \n\\end{array} \\right)\n\\end{equation}\\]\nupper left element (row 1, column 1) reflects within-patch growth characteristics patch 1. lower right quadrant (row 2, column 2) reflects within-patch growth characteristics patch 2.Source-sink models assume net migration flows source sink (\\(M_{21}>M_{12}\\)). assume, simplicity, migration exclusively source sink (\\(M_{21}>0\\), \\(M_{12}=0\\)). assume \\(\\lambda_1 > 1\\) excess individuals migrate patch 2, \\(M_{21} = \\lambda_1 - 1>0\\).  simplifies \\[\\begin{equation}\n\\tag{6.3}\n\\mathbf{} = \\left(\n\\begin{array}{cccc}\n1 &  0 \\\\\n\\lambda_1-1 &  \\lambda_2 \\\\\n\\end{array} \\right)\n\\end{equation}\\]first assign \\(\\lambda\\) source sink populations, create matrix.can use eigenanalysis, Chapter 4 stage structured populations. dominant eigenvalue provide long term asymptotic total population growth. can calculate stable stage distribution, case distribution individuals two habitats.dominant eigenvalue, see Pulliam’s working assumption total population growth (two popuations combined) \\(\\lambda=1\\). Upon calculating stable distribution, also see source population contains individuals sink population.Pulliam explored consequences assumptions relative abundances two populations. varied \\(\\lambda_1\\) range values calculated relative abundance source population. let p1 proportion total population source.\nFigure 6.3: declining relative abundance high quality habitat source-sink model. proportion total population (\\(n_1/(n_1+n_2)\\)) source population may decline increasing habitat quality growth rate.\nOne main theoretical findings relative abundance population density can misleading indicators habitat quality (Fig. 6.3). assume excess individuals source migrate sink, habitat quality reproduction increase source population, source population comprises ever decreasing proportion total population! , \\(\\lambda_1\\) gets larger, \\(n_1/(n_1+n_2)\\) gets smaller. Thus, density can misleading predictor long-term population viability, source population productive exhibits high degree emigration.","code":"\nlambda1 <- 1.2; lambda2 <- .4\nA <- matrix(c(1,    0, \n              lambda1-1, lambda2), nrow=2, byrow=TRUE)\nA##      [,1] [,2]\n## [1,]  1.0  0.0\n## [2,]  0.2  0.4\neA <- eigen(A)\neA$values## [1] 1.0 0.4\n# calculate the stable stage distr.\n(ssd <- eA$vectors[,1]/sum(eA$vectors[,1]) )## [1] 0.75 0.25\n# a range of lambdas\nlambda1 <- seq(1, 3, by=0.01)\n\n# proportion of total N in the source habitat\np1 <- sapply(lambda1, function(l1) {\n  # replace lambda1\n  A[2,1] <- l1-1\n  # extract the dominant eigenvalue\n  dom.ev <- eigen(A)$vectors[,1]\n  # calculate the relative abundance of the first pop.\n  dom.ev[1]/sum(dom.ev)\n  })\n\n# plot the result\nqplot(x=lambda1, y=p1, geom=\"line\", \n      ylab=\"Fraction of total population\\n in the source population\",\n      xlab=expression(lambda[1]) ) "},{"path":"meta.html","id":"complications-and-cases","chapter":"6 Populations in Space","heading":"6.1.1 Complications and cases","text":"Pseudosinks ecological traps special cases counterintuitive dynamics. Pseudosinks patches immigration high pushes subpopulation carrying capacity depresses growth rates (e.g., Breininger Oddy 2004). absence immigration, population growth rates sustain population (\\(\\lambda > 1\\)). Ecological traps habitats preferred animals, actually low quality (\\(\\lambda < 1\\)). can occur, espcially face human-induced rapid environmental change. many cases, mismatch sensory traits organisms novel environments (Robertson, Rehage, Sih 2013). Like moth flame, .Ideal free despotic two types distributions individuals among patches. types, assume quality unoccupied habitats varies among patches. also assume individuals negative effects quality, example, territory occupation resource use. means current habitat quality depends original quality unoccupied habitat also number occupants. ideal free distribution individuals among patches results individuals distribute perfect proportion habitat quality. net result current patches equal quality high quality patches suffer proportionally individuals.contrast, ideal despotic distribution arises individuals always prefer habitat higher original quality, habitat full, point use low quality habitat. thought occur animals territorial, prefer better habitat long single territory available.Balanced dispersal arises migration occurs similar rates among patches similar quality (\\(\\lambda \\approx 1\\)) patches vary size population size. results unexpected obervation migration small patches individuals large patches occurs nearly often reverse. means per capita emigration rates higher small patches large patches. clear occurs, occur higher edge:area ratio smaller patches boosts migration rate (Hambäack et al. 2007) evolution dispersal characteristics populations different sizes (Legrand et al. 2017; McPeek Holt 1992).","code":""},{"path":"meta.html","id":"metapopulations","chapter":"6 Populations in Space","heading":"6.2 Metapopulations","text":"logistic model (Chapter 5) well good, concept space built . many, perhaps circumstances ecology, space potential influence dynamics populations ecosystem fluxes (Lehman Tilman 1997; Leibold et al. 2004; Loreau, Mouquet, Holt 2003). logistic equation represents closed population, clear accounting emigration immigration. particular cases, however, consideration space may essential. learn start considering space, sites open receive immigrants lose emigrants?\nFigure 6.4: Collections sites, site (-F) may spot ground potentially occupied single plant, may oceanic island potentially occupied butterfly population. Sites may also colonized via internal external sources.\nmetapopulation population populations (Fig. 6.4). Modeling metapopulations emerged work pest management Levins (1969) wanted represent dynamics proportion fields infested pest. assumed field either occupied pest, . framework, keep track proportion populations remain occupied. assumed metapopulation closed, sense migration occurs exists finite number sites may exchange migrants.Whether consider single spatial population, single metapopulation, can envision collection sites connected dispersal. site may small spot ground occupied plant, may oceanic island occupied population. know single site occupied unoccupied. site occupied individual, know nothing big individual ; site occupied population, know nothing many indiviuals present. models derive keep track proportion sites occupied. known loosely metapopulation models. Although details can differ, whether modeling collection spatially discrete individuals single population collection spatially discrete populations, two cases share idea collection sites connected migration, subject extinction.relevant underlying biology concerns colonization extinction collection sites (Fig. 6.4). chapter, assume sites experience equal rates. one model, assume collection sites receives propagules outside, external source influenced collection sites (Fig. 6.4). cases, consider total rates colonization, \\(C\\), extinction, \\(E\\), influence rate change \\(p\\), proportion sites occupied,\n\\[\\frac{dp}{dt}=C-E.\\]\nconsider , somewhat orderly fashion, several permutations represent colonization extinction sites (N. G. Gotelli Kelley 1993; N. J. Gotelli 1991).","code":""},{"path":"meta.html","id":"the-classic-levins-model","chapter":"6 Populations in Space","heading":"6.2.1 The classic Levins model","text":"Levins (1969) proposed become classic metapopulation model,\n\\[\\begin{equation}\n  \\tag{6.4}\n  \\frac{dp}{dt} = c_{}p\\left(1-p\\right) - ep\n\\end{equation}\\]\nequation describes dynamics proportion, \\(p\\), set fields invaded pest. pest colonizes different fields total rate governed rate propagule production, \\(c_i\\), also proportion patches contain pest, \\(p\\). Thus, propagules scattered around landscape rate \\(c_i p\\). use subscript \\(\\) remind us colonization coming within sites studying (.e. internal colonization).rate \\(p\\) changes also related proportion fields unoccupied, \\((1-p)\\), therefore available become occupied increase \\(p\\). total rate colonization \\(c_ip(1-p)\\). pest constant local extinction rate \\(e\\), total extinction rate landscape \\(ep\\).parameters \\(c_i\\) \\(e\\) similar \\(r\\) continuous logistic growth, insofar dimensionless instantaneous rates. However, sometimes thought probabilities. parameter \\(c_i\\) approximately proportion open sites colonized per unit time. instance, created found 100 open sites, come back year see many became occupied time interval one year, proportion function \\(c_i\\). parameter \\(e\\) often thought probability site becomes unoccupied per unit time. found 100 occupied sites one year, revisit year later see many became *un}occupied time interval one year.internal colonization, modeling closed spatial population sites, whether “site” refers entire field (), small patch ground occupied individual plant (Tilman et al. 1994).Levins metapopulation model: R function differential equation requires arguments time, vector state variables (one state variable, \\(p\\)), vector parameters.using , can specify parameters names, long parms includes names. function levins() returns list contains value derivative, evaluated time point, state variable (merely \\(dp /dt\\)). use levins numerical integration function ode deSolve package.plot result (Fig. 6.5).\nFigure 6.5: Levins metapopulation model\nCan use model predict eventual equilibrium? Sure — just set (6.4) zero solve \\(p\\). model achieves equilibrium ,\n\\[\\begin{align*}\n  \\tag{6.5}\n  0 &=c_{}p-c_{}p^2 - ep\\\\\n  p^* &= \\frac{c_{}-e}{c_{}}=1-\\frac{e}{c_{}}.\n\\end{align*}\\]\n, see \\(p^* > 0\\) long \\(c_i > e\\) (e.g., Fig. 6.5). \\(p^* = 1\\), sites filled? principle, sites occupied simultaneously unless \\(e=0\\).","code":"\nlevins <- function(t, y, parms) {\n       p <- y[1]\n       with(as.list(parms), {\n       dp <- ci * p * (1-p) - e * p\n       return(list(dp))\n       }) }\nprms <- c(ci=0.15, e=0.05)\nInitial.p <- 0.01\nout.L <- data.frame(ode(y=Initial.p, times=1:100, func=levins, parms=prms ))\nqplot(x=out.L[,1], y=out.L[,2], geom=\"line\", ylim=c(0,1), ylab=\"p\", xlab=\"time\")  +\n  annotate(\"text\", 25, .75, label=bquote(over(dp,dt)==cp(1-p)-ep))"},{"path":"meta.html","id":"propagule-rain","chapter":"6 Populations in Space","heading":"6.2.2 Propagule rain","text":"else might propagules come? site closed rest world, propagules come outside collection sites actually monitoring.now, let us assume collection sites continually showered propagules external source. propagules important, represent dynamics ,\n\\[\\begin{equation}\n  \\tag{6.6}\n  \\frac{dp}{dt} = c_{e}\\left(1-p\\right) - ep \n\\end{equation}\\]\n\\(c_{e}\\) specifies rate colonization coming external source. N. J. Gotelli (1991) refers model metapopulation model propagule rain, island–mainland model. calls describes constant influx propagules depend proportion, \\(p\\), sites occupied propagule production. Extinction mediated proportion sites occupied, constant per site rate.propagule rain metapopulation model: R function differential equation requires arguments time, vector state variables (one state variable, \\(p\\)), vector parameters.plot result (Fig. 6.6).\nFigure 6.6: Propagule rain metapopulation model\ncan solve model’s equilibrium setting eq.  equal zero.\n\\[\\begin{align*}\n0  &= c_{e}-c_{e}p - ep\\\\\np^*&=\\frac{c_{e}}{c_{e}+e}.\n\\end{align*}\\]course, might also think internal external sources important, case might want include sources model,\n\\[\\begin{align}\n  \\tag{6.7}\n  \\frac{dp}{dt} &= (c_{}p+c_{e})\\left(1-p\\right) - ep\n\\end{align}\\]\nseen , however, adding parameters something take lightly. Increasing number parameters 50% require lot effort estimate.","code":"\ngotelli <- function( t, y, parms) {\n       p <- y[1]\n       with(as.list(parms), {\n       dp <- ce *  (1-p) - e * p\n       return(list(dp))\n       })\n       }\nprms <- c(ce=0.15, e=0.05)\nInitial.p <- 0.01\nout.G <- data.frame(ode(y=Initial.p, times=1:100, func=gotelli, parms=prms ))\nqplot(x=out.G[,1], y=out.G[,2], geom=\"line\", ylim=c(0,1), ylab=\"p\", xlab=\"time\")  +\n  annotate(\"text\", 50, .25, label=bquote(over(dp,dt)==c[e](1-p)-ep))"},{"path":"meta.html","id":"the-rescue-effect-and-the-core-satellite-model","chapter":"6 Populations in Space","heading":"6.2.3 The rescue effect and the core-satellite model","text":"Thus far, ignored happens census periods. Imagine sample site “” year 1 January. possible 2 January 31 December population site becomes extinct subsequently recolonized, “rescued” extinction. sample 1 January next year, way knowing happened intervening time period. realize population become extinct recolonization occurred.can, however, model total extinction rate \\(E\\) rescue effect,\n\\[\\begin{equation}\n  \\tag{6.8}\n  E = - ep\\left( 1-p \\right).\n\\end{equation}\\]\nNote \\(p \\rightarrow 1\\), total extinction rate approaches zero. Total extinction rate declines proportion sites occupied increases, becomes increasingly likely dispersing propagules land sites. propagules happen land sites verge extinction, can “rescue” site extinction.Brown Kodric-Brown (1977) found enhanced opportunity immigration seemed reduce extinction rates arthropod communities thistles. coined effect immigration extinction rescue effect. MacArthur Wilson (1963) also discussed idea context island biogeography. can even vary strength effect adding yet another parameter \\(q\\), total extinction rate \\(-ep\\left( 1-qp \\right)\\) (N. G. Gotelli Kelley 1993).Assuming internal propagule supply simple rescue effect results referred core-satellite model,\n\\[\\begin{align}\n  \\tag{6.9}\n  \\frac{dp}{dt} &= c_ip\\left(1-p\\right) - ep\\left( 1-p \\right)\n\\end{align}\\]\nmodel made famous Illka Hanski (. Hanski 1982). referred core-satellite model Hanski showed predicts precisely pattern saw Fig. 6.1 beginning chapter.core-satellite metapopulation model: function differential equation requires arguments time, vector state variables (one state variable, \\(p\\)), vector parameters.plot result (Fig. 6.7).\nFigure 6.7: core-satellite metapopulation model\nequilibrium Hanski mode (eq. (6.9))? can rearrange simplify solving \\(p^*\\).\n\\[\\begin{align}\n \\tag{6.10}\n  \\frac{dp}{dt} &= \\left(c_i-e \\right) p \\left(1-p\\right)\n\\end{align}\\]\nshows us value \\(p\\) zero one, sign growth rate (positive negative) determined \\(c_i\\) \\(e\\).\\(c_i>e\\), rate increase always positive, occupancy exceed 1.0, metapopulation go full occupancy (\\(p^*=1\\)), stay . equilibrium stable attractor stable equilibrium. happens reason metapopulation becomes globally extinct, \\(p=0\\), even though \\(c_i>e\\)? \\(p=0\\), like logistic growth, metapopulation stops changing increase. However, slightest perturbation away \\(p=0\\) lead positive growth rate, increase toward stable attractor, \\(p^*=1\\). case, refer \\(p^*=0\\) unstable equilibrium repellor.Let’s explore stability equilibria plotting metapopulation growth rate function \\(p\\) (Fig. 6.8). set \\(c_i>e\\), examine slope line \\(p^*=1\\), see slope negative, indicating stable equilibrium. \\(p^*=0\\) slope positive, indicating unstable equilibrium.\nFigure 6.8: Metapopulation growth rate function \\(p\\), core-satellite model \\(c_i > e\\). see growth rate falls zero full occupancy (.e., \\(p^*=1\\)). point, slope negative, indicating equilibrium stable.\n\\(c_i<e\\), rate increase always negative, occupancy less 0, metapopulation become extinct (\\(p^*=0\\)), stay . Thus \\(p^*=0\\) stable equilibrium attractor. predicted happen , odd reason population achieved full occupancy, \\(p=1\\), even though \\(c_i<e\\)? case, \\((1-p)=0\\), rate change goes zero, population predicted stay , even though extinction greater colonization. weird ? fatal flaw model, interesting prediction resulting thorough examination model? relevant ? evaluate relevant ? discuss little , discuss effects habitat destruction.happens \\(c_i=e\\)? case, \\(c_i - e = 0\\), population stops changing. value \\(p\\) stops changing? seems though value \\(p\\), \\(c_i-e=0\\), rate change goes zero. happen population gets perturbed — return previous value? Let’s return question bit.analyze stability logistic growth, examined slope partial derivative equilibrium, can . find partial derivative (6.9) respect \\(p\\) \n\\[\\begin{equation}\n  \\tag{6.11}\n  \\frac{\\partial \\dot{p}}{\\partial p} = c - 2cp - e + 2ep\n\\end{equation}\\]\n\\(\\dot{p}\\) time derivative (6.9). little puzzling rearranging make things little simpler.\n\\[\\begin{equation}\n  \\tag{6.12}\n  \\frac{\\partial \\dot{p}}{\\partial p} = \\left(c_i - e\\right)\\left(1-2p\\right)\n\\end{equation}\\]\nRecall rules regard stability (Chapter 5). partial derivative (slope time derivative) negative equilibrium, means growth rate approaches zero following perturbation, meaning stable. partial derivative positive, means change accelerates away zero following perturbation, meaning equilibrium unstable. , find following guidelines:\\(c_i>e\\)\n\\(p=1\\), \\(\\partial \\dot{p}/ \\partial p < 0\\), stable equilibrium.\n\\(p=0\\), \\(\\partial \\dot{p}/ \\partial p>0\\), unstable equilibrium.\n\\(p=1\\), \\(\\partial \\dot{p}/ \\partial p < 0\\), stable equilibrium.\\(p=0\\), \\(\\partial \\dot{p}/ \\partial p>0\\), unstable equilibrium.\\(c_i < e\\)\n\\(p=1\\), \\(\\partial \\dot{p}/ \\partial p > 0\\), unstable equilibrium.\n\\(p=0\\), \\(\\partial \\dot{p}/ \\partial p < 0\\), stable equilibrium.\n\\(p=1\\), \\(\\partial \\dot{p}/ \\partial p > 0\\), unstable equilibrium.\\(p=0\\), \\(\\partial \\dot{p}/ \\partial p < 0\\), stable equilibrium.\\(c_i=e\\)? case, time derivative (\\(d p / dt\\)) partial derivative (\\(\\partial \\dot{p}/ \\partial p\\)) zero values p. Therefore, population gets displaced arbitrary point, remain unchanged, recover, stay displaced. call odd state affairs neutral equilibrium. revisit neutral equilibrium discuss interspecific competition predation.","code":"\nhanski <- function( t, y, parms) {\n  p<- y[1]\n       with(as.list(parms), {\n       dp <- ci * p *  (1-p) - e * p *(1-p)\n       return(list(dp))\n       })\n}\nprms <- c(ci=0.15, e=0.05)\nInitial.p <- 0.01\nout.H <- data.frame(ode(y=Initial.p, times=1:100, func=hanski, parms=prms ))\nqplot(x=out.H[,1], y=out.H[,2], geom=\"line\", ylim=c(0,1), ylab=\"p\", xlab=\"time\")  + \n  annotate(\"text\", 50, .25, label=bquote(over(dp,dt)==c[i]*p(1-p)-ep(1-p)))\ndpdtCS <- expression((ci-e)*p*(1-p))\nci <- 0.15; e <- 0.05\np <- seq(0,1, length=50)\ndp.dt <- eval(dpdtCS)\nqplot(p, dp.dt, geom=\"line\", ylab=\"dp/dt\")"},{"path":"meta.html","id":"parallels-with-logistic-growth","chapter":"6 Populations in Space","heading":"6.2.4 Parallels with Logistic Growth","text":"\nmay already occurred closed spatial population described sounds lot like simple logistic growth. closed population, spatial , reproduces proportion density, limited density. make connection little clear. turns simple rearrangement (6.4) provide explicit connection logistic growth spatial population model internal colonization (Roughgarden 1998).Imagine moment avid birder following population Song Sparrows Darrtown, OH, USA (Ch. 5). Song Sparrows limited number territories, males competing territories, think male Song Sparrows “filling ” proportion, \\(p\\), available habitat. territory thus like local population, pair sparrows either occupies site, , proportion territories occupied \\(p\\). therefore decide like use Levins’ spatially-implicit metapopulation model instead (6.4). ? rescaling logistic growth, \\(dN/dt = rN(1-\\alpha N)\\).Let us start defining logistic model variables terms. First define \\(N\\) \n\\[\\begin{equation*}\n  N=Hp\n\\end{equation*}\\]\n\\(N\\) number males defending territories, \\(H\\) total number possible territories, \\(p\\) proportion possible territories occupied one time. equilibrium, \\(N^*=K=Hp^*\\), \\(\\alpha=1/(Hp^*)\\). Recall Levins model, \\(p^*=(c_i-e)/c_i\\), therefore,\n\\[\\alpha = \\frac{c_i}{H\\left(c_i - e\\right)}\\]\nnow \\(N\\), \\(\\alpha\\), \\(K\\) terms \\(p\\), \\(H\\), \\(c_i\\) \\(e\\), \\(r\\)? Recall logistic growth, per capita growth rate goes \\(r\\) \\(N \\0\\) (Chapter 3). Levins metapopulation model, per patch growth rate \n\\[\\begin{align}\n  \\frac{1}{p}\\frac{dp}{dt}&=c_{}\\left(1-p\\right) - e.\n\\end{align}\\]\n\\(p \\0\\) expression simplifies \\(c_i-e\\), equivalent \\(r\\). Summarizing, , ,\n\\[\\begin{gather}\n  \\tag{6.13}\n  r=c_i-e\\\\\n  N=Hp\\\\\n  \\alpha = \\frac{1}{K} = \\frac{1}{Hp^*} = \\frac{c_i}{H\\left(c_i-e\\right)}\n\\end{gather}\\]Substituting logistic growth (\\(\\dot{N} = rN(1-\\alpha N)\\)), now \n\\[\\begin{align}\n \\tag{6.14}\n  \\frac{d(pH)}{dt} &= \\left(c_i-e\\right)pH\\left(1-\\frac{c_i}{H\\left(c_i-e\\right)}Hp\\right)\\\\\n  &= \\left(c_i-e\\right)pH - \\frac{ c_i-e }{c_i-e}c_ip^2H\\\\\n  &= H\\left(c_ip\\left(1-p\\right) - ep \\right)\n\\end{align}\\]\nalmost Levins model. note \\(H\\) constant, realize can divide sides \\(H\\), ending Levins model (6.4).","code":""},{"path":"meta.html","id":"levins-vs.-hanski","chapter":"6 Populations in Space","heading":"6.2.5 Levins \\(vs\\). Hanski","text":"use Levins’ model instead Hanski’s core-satellite model? explore possibility, let’s see Hanski model might change gradually Levins model. First define Hanski model extra parameter, \\(\\),\n\\[\\begin{equation}\n  \\tag{6.15}\n  \\frac{dp}{dt} = c_ip\\left(1-p\\right) - ep\\left(1-ap\\right).\n\\end{equation}\\]\nHanski’s model, \\(=1\\) Levins’ model \\(=0\\). solve equilibrium, see \n\\[\\begin{equation}\n  \\tag{6.16}\n  p^*=\\frac{c-e}{c-ae}\n\\end{equation}\\]\ncan derive either result two models. context logistic growth, \\(K=Hp^*\\), result (6.16) implies Hanski model, \\(K\\) fills available habitat, whereas Levins model implies \\(K\\) fills fraction total available habitat. fraction results dynamic balance \\(c_i\\) \\(e\\).","code":""},{"path":"meta.html","id":"habitat-destruction","chapter":"6 Populations in Space","heading":"6.2.6 Habitat Destruction","text":"researchers investigated effects habitat loss metapopulation dynamics (Kareiva Wennergren 1995; Nee May 1992; Tilman et al. 1994). Taking inspiration work Lande (R. Lande 1987, 1988), Kareiva Wennergren (1995) modeled effect habitat destruction, \\(D\\), overall immigration probability. incorporated Levins’ model \n\\[\\begin{equation}\n  \\tag{6.17}\n\\frac{dp}{dt}=c_ip(1-D-p) - ep\n\\end{equation}\\]\n\\(D\\) amount habitat destroyed, expressed fraction original total available habitat.turn eq. (6.17) function can use ode, ,\nFigure 6.9: Habitat destruction metapopulation model\nHabitat destruction, \\(D\\), may vary 0 (\\(=\\) Levins model) complete habitat loss 1.0; obviously interesting results come intermediate values \\(D\\), illustrate next.","code":"\nlande <- function(t, y, parms) {\n       with(as.list(c(y,parms)), {\n       dp <- ci * p * (1-D-p) - e * p\n       return(list(dp))\n       }) }\nprmsD <- c(ci=0.15, e=0.05, D=.2)\nInitial.p <- c(p=0.1)\n\nout.D <- data.frame(ode(y=Initial.p, times=1:100, func=lande, parms=prmsD ))\nqplot(x=out.D[,1], y=out.D[,2], geom=\"line\", ylim=c(0,1), ylab=\"p\", xlab=\"time\")  +\n  annotate(\"text\", 25, .75, \n           label=bquote( over(dp,dt)==c[i]*p(1-D-p)-ep) )"},{"path":"meta.html","id":"illustrating-the-effects-of-habitat-destruction","chapter":"6 Populations in Space","heading":"6.2.7 Illustrating the effects of habitat destruction","text":"can plot dynamics three levels destruction, starting none (\\(D=0\\)). first set parameters, time.Last, plot add useful labels.\nFigure 6.10: Three different levels habitat destruction\nequilibrium model? Setting eq.  zero, can solve \\(p\\).\n\\[\\begin{gather}\n  \\tag{6.18}\n  0=c_i-c_iD-c_ip - e\\\\\n  p^* = \\frac{c_i-c_iD - e}{c_i} = 1 -  \\frac{e}{c_i} - D\n\\end{gather}\\]\nThus see habitat destruction simple direct effect metapopulation.","code":"\nt <- 1:200\nprmsD <- c(ci=0.15, e=0.05, D=0)\nInitial.p <- c(p=0.01)\nt <- 1:200\nD0 <- ode(y=Initial.p, times=t, func=lande, parms=prmsD )\nprmsD[\"D\"] <- 0.2\nD.2 <- ode(y=Initial.p, times=t, func=lande, parms=prmsD )\nprmsD[\"D\"] <- 0.5\nD.5 <- ode(y=Initial.p, times=t, func=lande, parms=prmsD )\nps <- rbind.data.frame(D0, D.2, D.5)\nps$D <- as.character( rep(c(0, .2, .5), each=length(t)) )\nggplot(ps, aes(time, p, linetype=D)) + geom_line() "},{"path":"meta.html","id":"different-assumptions-lead-to-different-predictions-about-rates-of-extinction","chapter":"6 Populations in Space","heading":"6.2.8 Different assumptions lead to different predictions about rates of extinction","text":"Let us return now case core-satellite model \\(c_i < e\\) \\(p=1\\). Recall case, \\(p=1\\) unstable equilibrium (\\(p=0\\) stable equilibrium \\(c_i<e\\)).Imagine one time, metapopulation regulated mechanisms core-satellite model, including rescue effect, \\(c_i>e\\). therefore pretend , metapopulation occupies virtually every habitable site (let \\(p=0.999\\)). Now imagine environment changes, causing \\(c_i<e\\). Perhaps climate change enhances extinction rates. sudden, metapopulation poised near unstable equilibrium, \n\\[p=0.999\\quad ; \\quad c_i < e\\].\nhappen might differ without assumption rescue effect?\\(c_i > e\\), see \\(p^*=1\\) stable attractor (Fig. 6.11). extinction rates rise \\(c_i < e\\), see inevitable march toward extinction predicted core-satellite model (Fig. 6.11). decline starts slowly remains slow, begins gradually accelerate. metapopulation models make predictions?try experiment Levins model, see something different. Levins model predicts rapid decline \\(c_i < e\\). models predict extinction, rescue effect delays appearance extinction. appears rescue effect (difference two models) may act bit like ``extinction debt’’ (Tilman et al. 1994) wherein deterministic extinction dominant species multi-species community merely delayed, postponed indefinitely. Perhaps populations influenced rescue effect might prone unexpected collapse, stable equilibria 1 0. Thus simple theory can provide interesting insight, resulting different predictions superficially similar processes.show unexpected collapse core populations, starting near equilbrium. first two use Hanski model, third uses Levins. second third use \\(c_i < e\\).\nFigure 6.11: Metapopulation dynamics, starting near equilibrium \\(c_i=0.20\\) \\(e=0.01\\). environment changes, causing extinction rate increase greater colonization rate, may observe greatly delayed, inevitable, extinction (e.g., \\(c_i=0.20, e=0.25\\))\n","code":"\nC1 <- ode(y=c(p=0.999), times=t, func=hanski, parms=c(ci=0.2, e=0.01))\nC2 <- ode(y=c(p=0.999), times=t, func=hanski, parms=c(ci=0.2, e=0.25))\nL2 <- ode(y=c(p=0.999), times=t, func=levins, parms=c(ci=0.2, e=0.25))\ncoll <- rbind.data.frame(C1, C2, L2)\ncoll$model <- factor(rep(c(\"c>e\", \"c<e\", \"c<e (Levins)\"), each=nrow(L2)),\n                     levels=c(\"c>e\", \"c<e\", \"c<e (Levins)\"))\n\nggplot(coll, aes(time, p, linetype=model)) + geom_line()"},{"path":"meta.html","id":"hanskis-incidence-function","chapter":"6 Populations in Space","heading":"6.3 Hanski’s incidence function","text":"models metapopulation dynamics provide outline understanding metapopulation dynamics. However, necessarily provide direct means interrogate data use data illuminate understanding. One main reasons address two important ecological realities: patches differ area thus differ population sizes, different distances . MacArthur Wilson (1963) argued persuasively extinction risk related area, distance source influence probability colonization. Ii. Hanski (1994) provided approach using incidence functions, predict probability occurrence. allow us incorporate area distance model, uses easily acquired patch occupancy data (presence/absence data) evaluate metapopulation characteristics.incidence occupancy determined colonization extinction probabilities. assume patch \\(\\) empty year \\(t\\), recolonized year \\(t+1\\) probability \\(C_i\\). also means remain empty probability \\(1-C_i\\). patch \\(j\\) occupied year \\(t\\), become extinct year \\(t+1\\) probability \\(E_i\\). also means persist probability \\(1-E_i\\).two states one patch illustrated code figure . column matrix probabilities one state. Te first column comprises probabilities remaining empty changing empty occupied. second column comprises probabilities occupied patch becomes empty remains occupied.probability, \\(J_i\\), patch occupied given time ,\n\\[J_i = \\frac{C_i}{C_i + E_i}.\\]can show calculating stable distribution states using eigenanalysis way demographic matrices.see \\(J_i\\) stable state colonized.Extinction probability, \\(E\\), determined patch area \\(A_i\\) simple model. assume patches similar quality support equal densities (individuals per unit area). Larger areas individuals thus lower risk extinction. Ii. Hanski (1994) described mathematically \n\\[\\begin{align*}\nE_i = \\frac{e}{A_i^x} \\quad &\\mathrm{} A_i > e^{1/x}\\\\\nE_i = 1 \\quad &\\mathrm{} A_i \\le e^{1/x}\n\\end{align*}\\]\n\\(e\\) \\(x\\) constants letting \\(E_i\\) vary different systems. Parameter \\(x\\) controls effect area, larger values \\(x>1\\) mean large patches low extinction risk. Smaller values \\(x\\) (\\(x<1\\)) mean patches become exceedingly larger appreciably reduce extinction risk. parameter \\(e\\) area-independent measure extinction risk, related intrinsic population dynamics environmental stochasticity.can illustrate extinction probability toy code.\nFigure 6.12: Extinction probabliity butterfly population (silver spotted skipper, Hanski 1994).\nNote \\(A_0 = e^{1/x}\\) critical patch size population expected persist year.Colonization probability, \\(C_i\\), complicated. function number arriving migrants, function distances patches area (thus population sizes) patches. \n\\[C_i = \\frac{1}{1+\\left(\\frac{y^\\prime}{S_i}\\right)^2}\\]\n\\(y^\\prime\\) colonizing ability species, \\(S_i\\) can thought measure isolation patch \\(\\) rest patches. Formally, \n\\[S_i = \\sum_{j=1}^n\\left(p_j \\mathrm{exp}(-\\alpha d_{ij}) A_j\\right)\\]\ntotal \\(n\\) patches \\(j\\) habitats, \\(p_j\\) indicator whether patch currently occupied (0,1), \\(d_{ij}\\) distance patch \\(j\\) patch \\(\\), \\(\\alpha\\) effect distance, \\(A_j\\) area patch \\(j\\) thus index population size.can illustrate extinction probability toy code.\nFigure 6.13: Colonization probabliity butterfly population (silver spotted skipper, Hanski 1994).\nadditional details colonization function buried, interested reader consult sources ideas (. Hanski 1994; Ii. Hanski 1994).Combining \\(C_i\\) \\(E_i\\), can define incidence function,\n\\[J_i = \\frac{1}{1+ \\left(1+\\left[\\frac{y^\\prime}{S_i}\\right]^2\\right)\\frac{e}{A_i^x}}.\\]use model, need following data patchareas, \\(A_i\\), patch,locations patch, calculate distances pair patches \\(,j\\),presence absence species patch,distance parameter \\(\\alpha\\).distances, \\(\\alpha\\), presence/absences, calculate \\(S_i\\) patch. couple ways estimate \\(\\alpha\\) perhaps best way using mark-recapture methods, explain . parameters, \\(e,\\,x,\\,y^\\prime\\), estimated using nonlinear regression methods; use .","code":"\nC <- .3; E <- .5\nM <- matrix(c(1-C, E,\n              C, 1-E), ncol=2, byrow=TRUE)\ncolnames(M) <- rownames(M) <- c(\"empty\", \"occupied\")\nM##          empty occupied\n## empty      0.7      0.5\n## occupied   0.3      0.5\n{\n  plotmat(M, pos=2) #requires the diagram package\n  title(\"The two states of one patch\")\n}\n# J\n(J <- C/(C+E))## [1] 0.375\n# The stationary distributions for the two states, empty and occupied\neM <- eigen(M)\neM$vectors[,1]/sum(eM$vectors[,1])## [1] 0.625 0.375\n# Extinction probability\nE.p <- function(A, e=0.01, X=1.009){\n  Ei <- ifelse(A > e^(1/X), e/(A^X), 1)\n  Ei }\n\ncurve(E.p(x), 0, 0.2, ylim=c(0,1))\n## The ggplot way\n# myData <- data.frame( A=c(0, .2) ) # ggplot requires a data frame\n# ggplot(data=myData, aes(x=A)) + # set the basic properties of the plot\n#   # in the stat_function, we indicate the parameters in our equation.\n#   stat_function(fun=E.p, geom=\"line\", \n#                 args=list(e = 0.01, X = 1.009)) \n# Colonization probability from one patch to another, as a function of distance\nC.p <- function(d, yprime, alpha, area){\n  Sij <- exp(-alpha*d ) * area\n  Ci <- 1/(1 + (yprime/Sij)^2 )\n  Ci\n}\n\n# parameters\nyprime <- 2.663; ha <- 0.94; alpha <- 2\nkm <- seq(0, 1.5, by=0.01)\nC <- sapply(km, function(d) {C.p(d=d, yprime=yprime, alpha=alpha, area=ha)})\nqplot(km, C, geom=\"line\")"},{"path":"direct-competition-and-mutualism.html","id":"direct-competition-and-mutualism","chapter":"7 Direct competition and mutualism","heading":"7 Direct competition and mutualism","text":"Different species frequently compete limiting resources, result negative impacts . example, change species composition secondary succession (Fig. 7.1) appears mediated , among things, species’ ability intercept light, grow, cast shade species. chapter addresses simple ways represent interactions species. Unless specify otherwise, “competition” chapter refer competition species, interspecific competition.\nFigure 7.1: Changes abundances six species asters early secondary succession. turnover perennial weeds appears mediated competition light, among factors (data long-term Buell-Small Succession study [http://www.ecostudies.org/bss/]).\nchapter introduce direct interspecific competition mutualism (Fig. 7.2). Direct competition interaction individuals experience direct negative effect another individual aggressive interaction via contact signaling. Indirect competition negative interactions mediated another factor, limiting resource. grass species compete nitrate ammonium, shortage nutrients causes negative effects, shortage results consumption competing species. However, regardless biological complexity indirect competition, can learn lot modeling simplified direct interaction.Direct mutualisms described mathematically manner identical direct competition, signs reversed. Many pairwise mutualisms direct insofar involve third species element. Think bumblebees partridge peas, mycorrhizae, Rhizobium legumes.\nFigure 7.2: can model competition direct negative effects, indirect interactions mediated resource.\nchapter model direct interactions using Lotka-Volterra framework.","code":""},{"path":"direct-competition-and-mutualism.html","id":"interspecific-competition","chapter":"7 Direct competition and mutualism","heading":"7.1 Interspecific competition","text":"models density-dependent growth built upon assumption individuals within single population negative effects , refered intraspecific competition. assume individuals different species also negative effects .classic model competitive interactions continuous Lotka-Volterra model interspecific competition (Kingsland 1985). build directly logistic growth model adding additional term negative density dependence, time, competing species. Now label populations parameters using subscripts. subscripts identify species parameter relates. instance, \\(r_1\\) intrinsic rate increase species 1, \\(\\alpha_{12}\\) per capita effect species 2 1.\n\\[\\begin{align}\n  \\frac{d N_1}{d t}&=r_1N_1\\left(1-\\alpha_{11}N_1-\\alpha_{12}N_2\\right)\\tag{7.1}\\\\\n  \\frac{d N_2}{d t}&=r_2N_2\\left(1-\\alpha_{21}N_1-\\alpha_{22}N_2\\right) \\tag{7.2}\n\\end{align}\\]\nnotice (7.1) denisty-dependence term includes total effect species 1 (\\(\\alpha_{11}\\)) total effect species 2 species 1 (\\(\\alpha_{12}\\)) (Table 7.1).useful understand subscripts come . read right left — left right? saw models structured population growth, comes underlying linear algebra used work equations. define \\(\\alpha\\)’s together matrix,\n\\[\\begin{equation}\n  \\tag{7.3}\n  \\mathbf{\\alpha} =  \\begin{pmatrix}\n    \\alpha_{11} & \\alpha_{12} \\\\\n    \\alpha_{21} & \\alpha_{22} \n    \\end{pmatrix} = \n\\begin{pmatrix}\n    0.010 & 0.005\\\\\n    0.008 & 0.010 \n    \\end{pmatrix}\n\\end{equation}\\]\nsubscripts \\(\\alpha\\)s represent row column \ncoefficient; \\(\\alpha_{12}\\) first row, second column. merely reflects mathematicians describe matrix elements dimensions — row \\(\\times\\) column. use matrix multiplication, \\(\\alpha_{12}\\) becomes effect species 2 (column) species 1 (row). case, \\(\\alpha_{11}=\\alpha_{22}=0.01\\), \\(\\alpha_{21}=0.008\\), \\(\\alpha_{12}=0.005\\). Thus, species greater effects . Remember, larger \\(\\alpha\\), larger effect.\nTable 7.1: Parameters continuous 2 species Lotka-Volterra competition model. rest chapter explains meaning motivation.\nequations also commonly represented using carrying capacity, \\(K_i\\), summarize intraspecific effects abundance, coefficients modify intraspecific effects quantified \\(K_i=1/\\alpha_{ii}\\). representation looks like\n\\[\\begin{align}\n  \\frac{d N_1}{d t}&=r_1N_1\\left(\\frac{K_1-N_1-\\alpha'_{12}N_2}{K_1}\\right) \\tag{7.4}\\\\\n  \\frac{d N_2}{d t}&=r_2N_2\\left(\\frac{K_2-N_2-\\alpha'_{21}N_1}{K_2}\\right). \\tag{7.5}\n\\end{align}\\]\nversion, \\(K_1=1/\\alpha_{11}\\), note \\(\\alpha'_{12}\\) differs \\(\\alpha_{12}\\). \\(\\alpha'_{12}\\) eq. (7.4) merely modifies effect \\(1/K_1\\). turns \\(\\alpha'_{1,2}\\) equal ratio interspecific intraspecific per capita effects, \n\\[\\begin{align}\n  \\alpha_{12}&=\\frac{\\alpha'_{12}}{K_1}\\notag\\\\\n\\alpha'_{12}&=\\frac{\\alpha_{12}}{\\alpha_{11}}.\n\\end{align}\\]\nAnother useful measure relative importance interspecific competition \\(\\beta_{ij}=\\alpha_{ij}/\\alpha_{jj}\\) (see Invasion criteria, ).","code":""},{"path":"direct-competition-and-mutualism.html","id":"equilbria","chapter":"7 Direct competition and mutualism","heading":"7.1.1 Equilbria","text":"section, describe find equilibria simple multispecies model, solving growth equations zero, much way Chapters 3 4. begin isoclines, move boundary internal equilibria invasion criteria.","code":""},{"path":"direct-competition-and-mutualism.html","id":"isoclines","chapter":"7 Direct competition and mutualism","heading":"7.1.1.1 Isoclines","text":"isocline , general, line connecting points graph map equal value. instance, topographic map elevation isoclines, connecting points equal elevation. , isoclines connect points state space growth rate species \\(\\) equals zero — every point line represent \\(\\dot{N}_i=0\\). call zero net growth isoclines (ZNGI), sometimes called “zingees” people prefer economy words.zero net growth isocline set points growth population zero, population size competing species held constant. two-species equilibrium point growth rates populations zero. saw previously carrying capacity single species logistic population equilibrium. two species, gets tad trickier.find isocline species setting growth rate equal zero solving equation species terms species. example, find zero net growth isocline \\(N_2\\). find straight line describes points \\(d N_2/dt=0\\), \\(N_1\\) held constant.start setting (7.2) zero, solving \\(N_2\\).\n\\[\\begin{align*}\n  \\frac{d N_2}{d t}&=r_2N_2\\left(1-\\alpha_{21}N_1-\\alpha_{22}N_2\\right) \\\\\n  0 &=r_2N_2\\left(1-\\alpha_{21}N_1-\\alpha_{22}N_2\\right)\\\\\n  0 &= 1-\\alpha_{21}N_1-\\alpha_{22}N_2\\\\\n  N_2 &=\\frac{1}{\\alpha_{22}} - \\frac{\\alpha_{21}}{\\alpha_{22}}N_1 .\\tag{7.6}\n\\end{align*}\\]\nRecall formula straight line \\(y=mx + b\\) \\(m\\) \nslope \\(b\\) intercept \\(y\\) axis. can see \nexpression \\(N_2\\) (7.6) straight line, \n\\(y=N_2\\), \\(m= \\alpha_{21}/\\alpha_{22}\\), \\(b=1/\\alpha_{22}\\) (Fig. 7.3). \\(N_1\\) zero, \\(N_2=1/\\alpha_{22}\\). precisely saw Chapter 3 (logistic growth), single species logistic population equilibrium carrying capacity, \\(K=1/\\alpha\\).isocline (Fig. 7.3) shows competitor’s population size, \\(N_1\\), becomes larger, \\(N_2\\) declines \\(\\alpha_{21}/\\alpha_{22}\\) additional individual competing species 1, finally \\(N_2=0\\) \\(N_1=1/\\alpha_{21}\\).Graphing isocline isn’t hard, let’s graph something similar Fig. 7.3. First, define new matrix competition coefficients, \n\\(\\alpha_{11}=\\alpha_{22} > \\alpha_{12}=\\alpha_{21}\\).create expression plot \\(N_2\\) isocline, function \npossible values \\(N_1\\).specify \\(N_1\\), evaluate plot \\(N_2\\). add arrows remind us happens \\(N_2\\) value isocline.isocline \\(N_2\\) (Fig. 7.3) line \n\\(d N_2/d t =0\\) fixed value \\(N_1\\). Just \nsingle species logistic growth model, \\(N_2\\) exceeds \nequilibrium, declines, \\(N_2\\) less equilibrium,\ngrows. isocline (Fig. 7.3 set balance points positive negative growth. reflected arrows Fig. 7.3 — \\(N_2\\) ever isocline, declines ever isocline, rises. isocline shows whether \\(N_2\\) increases decreases depends \\(N_1\\).\nFigure 7.3: Phase plane plots two competing species, Lotka-Volterra zero growth isoclines. Arrows indicate population trajectories. Recall \\(K = 1/alpha\\).\nanalogy, isocline species 1 turns \n\\[\\begin{align}\n  N_1 &=\\frac{1}{\\alpha_{11}} - \\frac{\\alpha_{12}}{\\alpha_{11}}N_2. \\tag{7.7}\n\\end{align}\\]Note isoclines merely equations straight lines, easy nonsensical things, specify coefficients result negative population sizes. Therefore, let us proceed thoughtfulness care.","code":"\na <- matrix(c(  0.01, 0.005,\n                  0.005, 0.01), ncol=2, byrow=TRUE)\nN2iso <- expression(1/a[2,2] - (a[2,1]/a[2,2])*N1)\nN1 <- 0:200\nplot(N1, eval(N2iso), type='l',\n      ylim=c(0, 200), xlim=c(0, 200),\n      ylab=expression(\"N\"[2]))\narrows(x0=90, y0=150, x1=90, y1=80, length=0.1)\narrows(x0=75, y0=0, x1=75, y1=50, length=0.1)"},{"path":"direct-competition-and-mutualism.html","id":"finding-equilibria","chapter":"7 Direct competition and mutualism","heading":"7.1.1.2 Finding equilibria","text":", isoclines tell us species 2 becomes extinct (\\(N_2=0\\)), species 1 reaches carrying capacity (\\(N_1=1/\\alpha_{11}\\)) (Fig. 7.3). Similarly, \\(N_1=0\\), \\(N_2=1/\\alpha_{22}\\). important equilibria, verify internal consistency logical, provide end-points isoclines.species coexist (\\(N_1,\\,N_2 >0\\)) means must share one points isoclines — equilibrium point\nlines cross. find equilibria solving isoclines simultaneously. simple way substitute right hand side \\(N_2\\) isocline (7.6) \\(N_2\\) \\(N_1\\) isocline (7.7). , substitute isocline one species species’ abundance another species’ isocline. Combining eqs. (7.6) (7.7), get\n\\[\\begin{align}\n  N_1 &=\\frac{1}{\\alpha_{11}} - \\frac{\\alpha_{12}}{\\alpha_{11}}\\left(\\frac{1}{\\alpha_{22}} - \\frac{\\alpha_{21}}{\\alpha_{22}}N_1 \\right)\\notag\\\\\n  N_1 &=\\frac{1}{\\alpha_{11}} - \n  \\frac{\\alpha_{12}}{\\alpha_{11}\\alpha_{22}}+\n  \\frac{\\alpha_{12}\\alpha_{21}}{\\alpha_{11}\\alpha_{22}}N_1 \\notag\\\\\n  N_1\\left(1-\\frac{\\alpha_{12}\\alpha_{21}}{\\alpha_{11}\\alpha_{22}}\\right)&=\n  \\frac{\\alpha_{22}-\\alpha_{12}}{\\alpha_{11}\\alpha_{22}} \\notag\\\\\n  N_1^*&=\\frac{\\alpha_{22}-\\alpha_{12}}{\\alpha_{11}\\alpha_{22}-\\alpha_{12}\\alpha_{21}} \\tag{7.8}\n\\end{align}\\]\n\\(N_2\\), get\n\\[\\begin{align}\n  N_2^*&=\\frac{\\alpha_{11}-\\alpha_{21}}{\\alpha_{22}\\alpha_{11}-\\alpha_{12}\\alpha_{21}}\\tag{7.9}\n\\end{align}\\]now values \\(N_1^*\\) \\(N_2^*\\) point isoclines cross (Fig. 7.4, upper left). equilibria apply isoclines cross within feasible state space.expressions \\(N_1^*\\) \\(N_2^*\\) look pretty complicated, can use discern intuitive understanding species 1? First, see \\(r_i\\) expressions equilibria — depend \\(r_i\\) two-species model. Second, can confirm interspecific competition intensity falls zero (\\(\\alpha_{12}=\\alpha_{21}=0\\)), species reaches carrying capacity. , putative competitors occupy sufficiently different niches longer compete, reach carrying capacities.can also say something little less obvious species 1. happens negative effect competitor, \\(N_2\\), starts increase, , \\(\\alpha_{12}\\) gets bigger? , put obtusely precisely, let’s find\n\\[\\begin{equation}\n  \\label{eq:1}\n  N_1^* = \\lim_{\\alpha_{12} \\\\infty}\\frac{\\alpha_{22}-\\alpha_{12}}{\\alpha_{22}\\alpha_{11}-\\alpha_{12}\\alpha_{21}}\n\\end{equation}\\]\n, find limit equilibrium (7.8) \n\\(\\alpha_{12}\\) gets large. Well, \\(\\alpha_{ii}\\) become\neffectively zero \\(\\alpha_{12}\\) gets big. leaves\n\\(-\\alpha_{12}/(-\\alpha_{12}\\alpha_{21})=1/\\alpha_{21}\\). Huh? \nmeans simply negative effect competitor increases,\nabundance species 1 becomes increasingly dependent upon\n\\(\\alpha_{21}\\), negative effect competitor. Thus \narms race: negative effect competitor increases, \nabundance species depends increasingly ability suppress\ncompetitor.Summarizing, see absence interspecific competition, species attracted toward carrying capacities. Second, interspecific competition intense, species’ carrying capacity becomes less important, abundance increasingly determined ability suppress competitor.","code":""},{"path":"direct-competition-and-mutualism.html","id":"coexistence-the-invasion-criterion","chapter":"7 Direct competition and mutualism","heading":"7.1.1.3 Coexistence — the invasion criterion","text":"Based numerators eqs. (7.8) (7.9), seems \\(N_1^*\\) \\(N_2^*\\) may greater zero whenever \\(\\alpha_{ii}-\\alpha_{ji} >0\\). , indeed, case. step analysis refer “invasion criterion,” specifies conditions \\(N_i^* > 0\\).general, details model dynamics may quite complicated, long know whether species always increase rare, invade,43 know whether can persist face complex interactions. Thus don’t need find equilibrium, merely behavior near zero.determine whether species can increase rare? Let’s explore Lotka-Volterra competition model. can start letting species 1’s growth equation (7.1) greater zero.\n\\[\\begin{equation*}\n  \\tag{7.10}\n  0 < r_1N_1\\left(1-\\alpha_{11}N_1-\\alpha_{12}N_2\\right).\n\\end{equation*}\\]\ncan see absence density dependence (\\(\\alpha=0\\)) assuming \\(r_1>0\\), \\(N_1>0\\), population grows exponentially. , can see \\(d N/d t >0\\) long \\(\\left(1-\\alpha_{11}N_1-\\alpha_{12}N_2\\right)>0\\).determine whether \\(N_1\\) can increase rare want figure happens \\(N_1\\) gets close zero. start expressing \\(d N_1 / d t\\) completely terms \\(N_1\\) \\(\\alpha\\). substituting \\(N_2\\)’s isocline (7.6) place \\(N_2\\) (7.1). solve growth greater zero.\n\\[\\begin{align}\n 0&< \\left(1-\\alpha_{11}N_1-\\alpha_{12}N_2\\right)\\notag\\\\\n 0&<\\left(1-\\alpha_{11}N_1-\\alpha_{12}\\left(\\frac{1}{\\alpha_{22}}-\\frac{\\alpha_{21}}{\\alpha_{22}}N_1\\right)\\right)\n\\tag{7.11}\n\\end{align}\\]Now — value (7.11) \\(N_1 \\0\\)? can substitute 0 \\(N_1\\), (7.11) becomes\n\\[\\begin{align}\n 0&<\\left(1-\\alpha_{12}\\left(\\frac{1}{\\alpha_{22}}\\right)\\right) \\notag\\\\\n 0&<1-\\frac{\\alpha_{12}}{\\alpha_{22}}\\notag\\\\\n\\alpha_{12}&<{\\alpha_{22}}.\n\\end{align}\\]\nsaying? saying long \\(\\alpha_{12}<\\alpha_{22}\\), focal species can persist, increasing abundance near zero — \\(N_1\\) increase rare, , successfully invade.two species persist, coexist, must case \n\\[\\begin{equation*}\n\\alpha_{12}<\\alpha_{22} \\quad , \\quad \\alpha_{21}<\\alpha_{11} .\n\\tag{7.12}\n\\end{equation*}\\]Simply put, species coexist stably, effects must greater effects (Fig. 7.4, upper left).","code":""},{"path":"direct-competition-and-mutualism.html","id":"other-equilibria","chapter":"7 Direct competition and mutualism","heading":"7.1.1.4 Other equilibria","text":"Given isoclines equilibria , logical combinations might see, coexistence? list others, provide graphical interpretations (Fig. 7.4).Species 1 can invade rare, species 2 (Fig. 7.4, lower left)\n\\[\\begin{equation*}\n\\alpha_{12} < \\alpha_{22} \\quad,\\quad \\alpha_{21}>\\alpha_{11} \n\\end{equation*}\\]\nleads competitive exclusion species 1 — species 1 wins. referred boundary equilibrium, boundary state space one species. Equilibria \\(N_i>0\\) referred internal equilibria.Species 2 can invade rare, species 1 (Fig. 7.4, upper right)\n\\[\\begin{equation*}\n\\alpha_{12}>\\alpha_{22} \\quad,\\quad \\alpha_{21}<\\alpha_{11} \n\\end{equation*}\\]\nleads competitive exclusion species 2 — species 2 wins. boundary equilibrium. Note previous boundary equilibrium, equilibrium equations, (7.8) & (7.9), can return \\(N^*\\) negative large (\\(>K\\)). Recall equations derive simple equations straight lines, guarantee used sensibly — equations aren’t dangerous, theoreticians misuse equations dangerous.Neither species can invade rare (Fig. 7.4, lower right).\\[\\begin{equation*}\n\\alpha_{12} > \\alpha_{22} \\quad,\\quad \\alpha_{21} > \\alpha_{11}\n\\end{equation*}\\]creates unstable internal equilibrium—exclusion occur, either species win. condition sometimes referred founder control (Bolker, Pacala, Neuhauser 2003) identity winner depends part starting abundances. creates saddle state space. heck saddle? . suffices say directions, saddle attracts trajectories populations, directions, repels trajectories.44\nFigure 7.4: Phase plane diagrams Lotka-Volterra competitors different invasion conditions. Horizontal vertical arrows indicate directions attraction repulsion population (solid dased arrows); diagonal arrows indicate combined trajectory. Circles indicate equilibria; additional boundary equilibria can occur whenever one species zero. Left right: stable eq., \\(a_{ji} < a_{ii}\\); \\(N_2\\) wins, \\(a_{12} > a_{22}\\); \\(N_1\\) wins, $a_{21} > a_{11}; saddle attractor-repellor, \\(a_{ji} > a_{ii}\\).\n","code":""},{"path":"direct-competition-and-mutualism.html","id":"dynamics-at-the-equilibria","chapter":"7 Direct competition and mutualism","heading":"7.1.2 Dynamics at the Equilibria","text":"use eigenanalysis analyze properties equilibrium, whether attractors, repellers, , whether system oscillates around equilibria.logistic growth, assessed stability partial derivative growth rate, respect population size. negative population stable, negative value, shorter return time. build , present general recipe stability analysis (Morin 1999):Determine equilibrium abundances species setting growth equation zero, solving \\(N\\).Create Jacobian matrix. matrix represents response species changes population changes ’s populations. matrix elements partial derivatives species’ growth rate respect population.Solve Jacobian. Substitute equilibrium abundances partial derivatives Jacobian matrix put real number element Jacobian matrix.Use Jacobian matrix find behavior system near equilibria. trace, determinant, eigenvalues Jacobian can tell us stable unstable system , whether cycles.","code":""},{"path":"direct-competition-and-mutualism.html","id":"determine-the-equilibria","chapter":"7 Direct competition and mutualism","heading":"7.1.2.1 Determine the equilibria","text":"just . Given (7.8) (7.9), see \\(\\alpha\\) determine completely \\(N_1^*\\) \\(N_2^*\\). true Lotka-Volterra systems two species; systems also depend \\(r_i\\).Finding equilibria R can done using expressions equilibria, \\(N_1^*\\) \\(N_2^*\\). R expression symbolic representation equation. symbolic representations later evaluate using eval().Next create \\(\\mathbf{\\alpha}\\) evaluate expressions.","code":"\nN1Star <- expression( (a22-a12)/(a22*a11 - a12*a21) )\nN2Star <- expression( (a11-a21)/(a22*a11 - a12*a21) )\na11 <- a22 <- 0.01;  a12 <- 0.001; a21 <- 0.001\nN1 <- eval(N1Star); N2 <- eval(N2Star)\nN1## [1] 90.90909"},{"path":"direct-competition-and-mutualism.html","id":"create-the-jacobian-matrix","chapter":"7 Direct competition and mutualism","heading":"7.1.2.2 Create the Jacobian matrix","text":"next step find partial derivative. partial derivatives describe growth rate species changes respect abundance species respect abundance. Thus positive value indicates growth rate increases another population increases. might case predator growth rate prey population. negative value indicates growth rate decreases another population increases. likely true competitors prey growth rate predator population., work example, deriving partial derivative species 1’s growth rate respect .First let’s expand growth rate species 1 (7.1)45\n\\[\\begin{align}\n  \\frac{d N_1}{d t}&=\\dot{N_1} =r_1N_1 - r_1\\alpha_{11}N_1^2 - r_1\\alpha_{12}N_2N_1.\n\\end{align}\\]Now derive partial differential equation (PDE)46 respect \\(N_1\\), treating \\(N_2\\) constant.\n\\[\\begin{equation}\n  \\frac{\\partial \\dot{N_1} }{\\partial N_1}=r_1 - 2r_1\\alpha_{11}N_1 - r_1\\alpha_{12}N_2\n\\end{equation}\\]\nthink per capita effect species 1 growth rate.derive PDE respect \\(N_2\\), treat \\(N_1\\) constant, find\n\\[\\begin{equation}\n  \\frac{\\partial \\dot{N_1} }{\\partial N_2}= - r_1\\alpha_{12}N_1.\n  \\end{equation}\\]\nper capita effect species 2 species 1’s growth rate.\\(\\dot{N_2}\\), derive full matrix PDE’s,\n\\[\\begin{align}\n  \\tag{7.13}\n\\left(\n\\begin {array}{cc}\n\\frac{\\partial \\dot{N_1}}{\\partial N_1}&\\frac{\\partial \\dot{N_1}}{\\partial N_2}\\\\\n\\frac{\\partial \\dot{N_2} }{\\partial N_1}&\\frac{\\partial \\dot{N_2}}{\\partial N_2}\n\\end {array}\n\\right)  =\n\\left(\n\\begin {array}{cc}\nr_1 - 2r_1\\alpha_{11}N_1 - r_1\\alpha_{12}N_2& - r_1\\alpha_{12}N_1\\\\\n- r_2\\alpha_{21}N_2&r_2 - 2r_2\\alpha_{22}N_2 - r_2\\alpha_{21}N_1\\\\\n\\end {array}\n\\right).\n\\end{align}\\]matrix PDEs Jacobian matrix, simply “Jacobian.” differential equations, describe slopes curves (.e. slopes tangents curves) particular point. , describe straight line interpretations point. partial differential equations, describe growth rates change population sizes change.Finding partial differential equations Jacobian matrix R can done using expressions. create equations expressions growth rates, \\(\\dot{N_1}\\) \\(\\dot{N_2}\\), use find partial derivatives. First, expressions growth rates:Next, use expression \\(\\dot{N}\\) get partial derivatives respect population size. use R function D() (see also ?deriv). reveal result first one , partial derivative \\(\\dot{N_1}\\) respect , get others.find remaining PDEs.Last put together create Jacobian matrix, expression can evaluate .","code":"\ndN1dt <- expression( r1 * N1 - r1 * a11 * N1^2 - r1 * a12 * N1 * N2 )\ndN2dt <- expression(r2*N2 - r2*a22*N2^2 - r2*a21*N1*N2)\nddN1dN1 <-D(dN1dt, \"N1\")\nddN1dN1## r1 - r1 * a11 * (2 * N1) - r1 * a12 * N2\nddN1dN2 <- D(dN1dt, \"N2\")\nddN2dN1 <- D(dN2dt, \"N1\")\nddN2dN2 <- D(dN2dt, \"N2\")\nJ <- expression( matrix(c(eval(ddN1dN1), eval(ddN1dN2),\n                     eval(ddN2dN1), eval(ddN2dN2)),\n                   nrow=2, byrow=TRUE) )"},{"path":"direct-competition-and-mutualism.html","id":"solve-the-jacobian-at-an-equilibrium","chapter":"7 Direct competition and mutualism","heading":"7.1.2.3 Solve the Jacobian at an equilibrium","text":"solve Jacobian equilibrium, substitute \\(N_1^*\\) (7.8) \\(N_2^*\\) (7.9) Jacobian matrix (7.13). Refer equations now. value \\(N_1\\) terms \\(\\alpha_{ii}\\) \\(\\alpha_{ij}\\)? Take value stick element Jacobian (7.14). Repeat \\(N_2\\). , rearrange, get,\n\\[\\begin{align}\n  \\mathbf{J}=\n\\left(\n\\begin {array}{cc}\n-r_1\\alpha_{11}\\left(\\frac{\\alpha_{22}-\\alpha_{12}}{\\alpha_{11}\\alpha_{22}-\\alpha_{12}\\alpha_{21}}\\right)& - r_1\\alpha_{12}\\left(\\frac{\\alpha_{22}-\\alpha_{12}}{\\alpha_{11}\\alpha_{22}-\\alpha_{12}\\alpha_{21}}\\right)\\\\\n- r_2\\alpha_{21} \\left(\\frac{\\alpha_{11}-\\alpha_{21}}{\\alpha_{11}\\alpha_{22}-\\alpha_{12}\\alpha_{21}}\\right)&\n-r_2\\alpha_{22}\\left(\\frac{\\alpha_{11}-\\alpha_{21}}{\\alpha_{11}\\alpha_{22}-\\alpha_{12}\\alpha_{21}}\\right)\\\\\n\\end {array}\n\\right). \\tag{7.14}\n\\end{align}\\]Yikes \\(\\ldots\\) seems little intimidating small number species. However, remarkable element can expressed product \\(-r_i\\alpha_{ij}N_i^*\\), \\(\\) refers row, \\(j\\) refers column.Evaluating Jacobian matrix R easy part, defined .\nAssuming selected particular \\(\\mathbf{\\alpha}\\), used determine \\(N_1^*\\) \\(N_2^*\\), found PDEs created expression Jacobian matrix, labeled everything appropriately, can evaluate Jacobian equilibrium. \\(\\alpha_{ii}=0.01\\) \\(\\alpha_{ij}=0.001\\) (see ) findNote PDEs negative equilibrium. indicates stable equilibrium, means population’s growth rate slows response increase .","code":"\nr1 <- r2 <- 1\nJ1 <- eval(J)\nJ1##             [,1]        [,2]\n## [1,] -0.90909091 -0.09090909\n## [2,] -0.09090909 -0.90909091"},{"path":"direct-competition-and-mutualism.html","id":"use-the-jacobian-matrix","chapter":"7 Direct competition and mutualism","heading":"7.1.2.4 Use the Jacobian matrix","text":"Just way used eigenanalysis understand long term asymptotic behavior demographic matrices, can use eigenanalysis Jacobian assess long-term asymptotic behavior competing Lotka-Volterra populations. can focus dominant, leading, eigenvalue (\\(\\lambda_1\\)). dominant eigenvalue eigenvalue greatest real part, necessarily eigenvalue greatest magnitude.47 particular, dominant eigenvalue, \\(\\lambda_1\\), may real part magnitude48 smaller, less negative positive (e.g., \\(\\lambda_1=-.01\\), \\(\\lambda_2=-1.0\\)). continuous models, dominant eigenvalue, \\(\\lambda_1\\), approximately rate change perturbation, \\(x\\), equilibrium,\n\\[\\begin{equation}\n  \\tag{7.15}\n  x_t=x_0e^{\\lambda_{1}t}.\n\\end{equation}\\]\nThus, negative value, faster exponential decline back toward equilibrium (.e., toward \\(x=0\\)). logistic growth, think dominant eigenvalue “perturbation growth rate”: negative values mean decline perturbation, positive values indicate increase perturbation, causing system diverge repelled away equilibrium.addition dominant eigenvalue, need consider eigenvalues. Table 7.2 provides summary interpreting eigenvalues respect dynamics system. eigenvalues depend upon elements Jacobian, values calculated elements, notably determinant, trace, discriminant; similar set rules system behavior can based upon values (Roughgarden 1998). instance, Routh-Hurwitz criterion stability tells us two-species equilibrium locally stable, \\(\\mathbf{J_{11}} + \\mathbf{J_{22}} < 0\\) \\(\\mathbf{J_{11}}\\mathbf{J_{22}-\\mathbf{J_{12}}\\mathbf{J_{21}}} > 0\\). biological interpretation criterion posed problem end chapter. now, Table 7.2 suffice.\nTable 7.2: Interpreting eigenvalues Jacobian matrix.\nEigenanalysis Jacobian matrix R easy evaluated Jacobian matrix equilibrium (). simply perform eigenanalysis matrix (previous boxes: \\(\\alpha_{11}=\\alpha_{22}=0.01,\\,\\alpha_{12}=\\alpha_{21}=0.001,\\, r=1\\)).dominant eigenvalue negative (larger two: \\(\\lambda_1\\) = -0.818) indicating globally stable equilibrium (Table 7.2. eigenvalues real, complex, indicating oscillations (Table 7.2).","code":"\neigStable <- eigen(J1); eigStable[[\"values\"]]## [1] -0.8181818 -1.0000000"},{"path":"direct-competition-and-mutualism.html","id":"three-interesting-equilbria","chapter":"7 Direct competition and mutualism","heading":"7.1.2.5 Three interesting equilbria","text":"examine dynamical properties three particularly interesting internal equilibria , respectively, stable, unstable, neutral. case, examples use \\(\\alpha_{11}=\\alpha_{22}=0.01\\) \\(r_1=r_2=1\\). important, however, particular eigenvalues, rather sign, vary \\(\\alpha_{12}\\) \\(\\alpha_{21}\\), resulting stability properties trajectories.Given stability criteria , let us next examine dominant eigenvalue Jacobian equilibrium values \\(\\alpha_{ij},\\,\\alpha_{ji}\\) choose? can describe invasion criterion species \\(\\) \n\\[\\begin{equation}\n\\tag{5.7}\n  \\beta_{ij}=\\alpha_{ij}/\\alpha_{jj}\n\\end{equation}\\]\n, \\(\\beta_{ij}<1\\), species \\(\\) can invade. ratio relative strength inter- vs. intraspecific competitive effect. turns useful calculate \\(\\lambda_1\\) (``perturbation growth rate’’) combinations \\(\\beta_{ij},\\,\\beta_{ji}\\).Stable equilibrium – \\(\\beta_{ij},\\, \\beta_{ji} <1\\): criteria correspond \\(\\alpha_{12}<\\alpha_{22}\\, , \\, \\alpha_{21}<\\alpha_{11}\\). relative strength interspecific effects increases toward 1.0, \\(\\lambda_1\\) approaches zero, point system longer single global point attractor.\\(\\beta_{ij},\\, \\beta_{ji} <1\\), species can invade . find eigenvalues Jacobian negative real (Fig. 7.5, demonstrating populations reach stable equilibrium (Table 7.2. plot eigenvalues combinations \\(\\beta\\), see dominant eigenvalue increases negative values toward zero either \\(\\beta_{12}\\) \\(\\beta_{21}\\) approaches 1 (Fig. 7.5).\nFigure 7.5: Stable equilibria: relative strength interspecific competition increases (B(ij) increases toward 1), instability increases (lambda(1) increases toward 0). Solid dots represent initial abundances.\nUnstable equilibria – \\(\\beta_{ij}, \\, \\beta_{ji} > 1\\)criteria correspond \\(\\alpha_{12}>\\alpha_{22} ,\\, \\alpha_{21}>\\alpha_{11}\\) (Fig. 7.6).\nsaw , Lotka-Volterra competition model stable equilibria, also unstable equilibria, populations greater zero. Although unstable equilibrium persist, \\(\\beta_{ij}, \\, \\beta_{ji} > 1\\) creates interesting probably important dynamics(. Hastings 2004). One results referred founder control, either species can colonize patch, whichever species gets first (.e. founder) can resist invader (Bolker, Pacala, Neuhauser 2003).Another interesting phenomenon saddle ; unstable equilibrium attractor-repeller, , attracts directions repels others (Fig. 7.6). implies final outcome dynamics may difficult predict initial trajectories.\nFigure 7.6: Unstable equilibria: relative strength interspecific competition increases (B(ij) > 1), instability increases (lambda(1) > 0). unstable equilibrium may attract trajectories initial states, repel others (solid dots represent initial abundances).\nRecall geometric interpretation unstable equilibrium — saddle. trajectory ball rolling across saddle can depend large degree ball starts. Place crown saddle, tend roll deterministic fashion directly toward unstable equilibrium, even eventually rolls side.Eigenanalysis R Jacobian \\(\\beta_{ij}, \\, \\beta_{ji} > 1\\): create values \\(\\mathbf{\\alpha}\\) create unstable equilbrium.dominant eigenvalue now positive, negative, indicating saddle (Table 7.2.Neutral equilibria — \\(\\beta_{ij} = \\beta_{ji} = 1\\): happens inter- intraspecific effects species equal? puts populations knife’s edge, unstable saddle stable attractor. Let’s think first geometric interpretation, shift bowl, representing stable attractor, saddle, representing call neutral saddle.Imagine begin stable attractor, represented bowl, \\(\\alpha_{ij} < \\alpha_{ii}\\). drop ball bowl, bowl rolls bottom — global attractor. increase interspecific competition coefficients, \\(\\alpha_{ij} \\\\alpha_{ii}\\), pressing just two points opposite sides bowl. hands push two opposite sides, bowl flat one direction, two remaining sides slope downward. Perhaps think looks like taco shell? shape easily replicated just picking piece paper opposite edges, letting sag middle. neutral saddle. eigenanalysis tell us? Let’s find .just charge ahead R, encourage , repeating steps . find doesn’t work \\(\\beta_{ij} = \\beta_{ji} = 1\\), equilibria undefined (numerator denominator zero (7.8), (7.9). Hmmm. Perhaps can simplify things taking limit equilibrium, \\(\\alpha_{ij} \\\\alpha_{jj}\\). Let \\(\\alpha_{12}=\\) \\(\\alpha_{22}=+h\\), let \\(\\alpha_{21}=b\\) \\(\\alpha_{11}=b+h\\). want limit equilibrium \\(h\\) goes zero.\n\\[\\begin{align}\n  \\tag{7.16}\n  \\lim_{h \\0}\\frac{\\left(+h\\right)-}{\\left(+h\\right)\\left(b+h\\right) - ab} &=\\frac{1}{+b}\n\\end{align}\\]\nThus, \\(N_1^* = 1/(\\alpha_{11}+\\alpha_{22})\\), assuming \\(\\alpha_{12} = \\alpha_{22}\\) \\(\\alpha_{21}=\\alpha_{11}\\). Therefore, equilibrium population size simply inverse sum coefficients.Eigenanalysis R Jacobian \\(\\beta_{ij} = \\beta_{ji} = 1\\): create values \\(\\mathbf{\\alpha}\\) create neutral equilbrium.determine \\(N^*\\) using (7.16) usual expression, (7.9), fails denominator equals 0.dominant eigenvalue now zero, indicating neutral equilibrium (Table 7.2. neutral nature equilibrium results one equilibrium. Let’s try different one, also isocline.\\(\\lambda_1=0\\) equilibrium also neutral.perform eigenanalysis, find largest two eigenvalues zero, negative. reveals neither bowl unstable saddle, rather, taco shell, level bottom — neutral saddle.\nFigure 7.7: Trajectories N(1),N(2) \\(eta_{12} = eta_{21} = 1\\). entire isocline attractor, neutral saddle, final abundances depend initial abundances ratio \\(lpha_{11}/lpha_{22}\\). circle represents one derived equilibrium.\nexample, populations start low abundances, populations tend increase constant rates run isocline. Thus, populations can increase rare, relative abundances never change, regardless initial abundances.Recall Lotka-Volterra isoclines, originally stated . stated equilibrium point isoclines cross. \\(\\beta_{ij} = \\beta_{ji} = 1\\), isoclines completely overlap, infinite number equilibria—points along line\n\\[\\begin{equation}\n  N_2= \\frac{1}{\\alpha_{22}} - \\frac{\\alpha_{11}}{\\alpha_{22}}N_1\n\\end{equation}\\]\ninitial abundances determine trajectory equilibrium (Fig. 7.7).","code":"\na11 <- a22 <- 0.01\na12 <- a21 <- 0.011\nN1 <- eval(N1Star); N2 <- eval(N2Star)\neigen( eval(J) )[[\"values\"]]## [1]  0.04761905 -1.00000000\na11 <- a21 <- 0.01; a22 <- a12 <- 0.015\nN1 <- N2 <- 1/(a11+a22)\neigen( eval(J) )[[\"values\"]]## [1] -1  0\nN1 <- 1/(a11); N2<-0\neigen( eval(J) )[[\"values\"]]## [1] -1  0"},{"path":"direct-competition-and-mutualism.html","id":"return-time-and-the-effect-of-r","chapter":"7 Direct competition and mutualism","heading":"7.1.3 Return Time and the Effect of \\(r\\)","text":", referred \\(\\lambda_1\\) perturbation growth rate. commonly, people refer another quantity known characteristic return time. Return time commonly calculated negative inverse largest real part eigenvalues,\n\\[\\begin{equation}\n  \\tag{7.17}\n  RT = -\\frac{1}{\\lambda_1}.\n\\end{equation}\\]\ntime required return fraction distance49 back toward equilibrium. Negative return times (\\(\\lambda_1>0\\)) refer “backward time,” time past population far away (Fig. 7.8.\nFigure 7.8: \\(eta_{ij} < 1\\), return time positive time lapse system returns toward equilibrium. \\(eta_{ij}>1\\), return time negative, system closer (unstable) equilibrium past.\nEffect \\(r\\) stability return timeConsider Jacobian matrix (7.14), note \\(-r_i\\) appears Jacobian element. Therefore, larger \\(r\\), greater magnitude Jacobian elements. causes \\(\\lambda_1\\) increase magnitude, reflecting greater responsiveness perturbation equilibrium (Fig. 7.9.consider return time continuous models \\(\\beta_{12},\\,\\beta_{21} < 1\\), greater \\(r\\) shortens return time, increasing stability (Fig. 7.9. continuous models \\(\\beta_{12},\\,\\beta_{21} > 1\\), greater \\(r\\) increases perturbation growth rate, decreasing stability (Fig. 7.9. discrete models, discussed context, recall increasing \\(r_d\\) discrete logistic growth can destabilize population built-lag. true discrete competition models — increasing \\(r_d\\) much destabilizes interaction.\nFigure 7.9: dominant eigenvalue Jacobian matrix varies r well \\(eta\\) — higher r causes greater responsiveness perturbations around internal equilibrium r = 1 r = 0.5.\n","code":""},{"path":"direct-competition-and-mutualism.html","id":"interspecific-mutualism","chapter":"7 Direct competition and mutualism","heading":"7.2 Interspecific mutualism","text":"Mutualisms occur wide variety different species. Mutualisms form foundations ecosystems including coral reefs (coral zooxanthellae), grasslands, forests (plants mycorrhizal fungi, pollinators, dispersers). natural history mutualisms wildly diverse complex, Boucher, James, Keeler (1982) list types mutualisms:EnergeticNutritionalDefenseTransportObligate vs. facultativeDirect vs. indirectSymbiotic vs. independentOne common \nindirect mutualism (Fig. 11.3). case, series negative direct interactions can yield net positive indirect interactions, classic\ncase “enemy enemy friend.” instance,\nconsider three plant species compete limiting\nresource. species suppresses species B, indirectly\nhelping species C (Miller 1994).focus direct mutualisms, chapter, ’ll explore using Lotka-Volterra modelsLotka-Volterra mutualism straightforward, following template competition. change sign associated species. usual, \\(\\alpha_{ij}\\) per capita effect species \\(j\\) species \\(\\).\\[\\begin{align*}\n\\frac{dN_1}{dt} &= r_1N_1\\left( 1 - \\alpha_{11}N_1 + \\alpha_{12}N_2\\right)\\\\\n\\frac{dN_2}{dt} &= r_2N_2 \\left(1 + \\alpha_{21}N_1 - \\alpha_{22}N_2\\right)\n\\end{align*}\\]equations see sign intraspecific terms \\(\\alpha_{ii}N_i\\) negative, sign interspecific terms \\(\\alpha_{ij}N_j\\).zero net growth isoclines found way found interspecific competition, solving \\(dN_1/dt\\) (zero). graph , solve terms species 1.\n\\[\\begin{align*}\n0 &= 1 + \\alpha_{21}N_1 - \\alpha_{22}N_2\\\\\nN_2 &= 1/\\alpha_{22} + \\frac{\\alpha_{21}}{\\alpha_{22}}N_1\n\\end{align*}\\]\n\\[\\begin{align*}\n0 &= 1 - \\alpha_{11}N_1 + \\alpha_{12}N_2\\\\\nN_2 &=\\frac{\\alpha_{11}}{\\alpha_{12}}N_1 - 1/\\alpha_{12}\n\\end{align*}\\]equilibria \n\\[N_i^* = \\frac{\\alpha_{jj} + \\alpha_{ij}}{\\alpha_{ii}\\alpha_{jj} - \\alpha_{ij}\\alpha_{ji}}\\]\nNote assumes \\(\\alpha_{jj}\\) \\(\\alpha_{ji}\\), per se, greater zero, equation assumed .Let’s use describe facultative mutualism, , one neither species needs persist, better. mean let \\(r>0\\). now, also assume mutualism provides modest benefit, species benefits smaller negative effects (\\(\\alpha_{ii} > \\alpha_{ij}\\)). dynamics stable (Fig. 7.10)illustrate dynamics population, parameterize ODE model. parameters meet assumptions stated .write ODE model help anaylze dynamics.Lotka-Volterra approach predicts exclusion one species two realistic scenarios, obligate mutualisms mutualisms large effects. obligate mutualism one growth rate negative absence mutualism. way describe Lotka-Volterra models set \\(r < 0\\). results unstable equilibrium global repellor results loss one species. Second, benefit greater negative intraspecific effect, get uncontrolled positive feedback loop leading infinite population sizes. sense, like exponential growth: potentially useful idea, must moderated somehow order reflect long term trajectories.\nFigure 7.10: weak facultative mutualisms stable.\n","code":"\nparameters <- c(alpha11 = .2, alpha22 = .2, alpha12 = .1, alpha21=.1,\n                r1=.01, r2=.01)\nmutualism.LV <- function(t, y, params){\n  n1 <- y[1]; n2 <- y[2]\n  with(as.list(params), {\n    dn1.dt = r1*n1*(1 - alpha11*n1 + alpha12*n2)\n    dn2.dt = r2*n2*(1 + alpha21*n1 - alpha22*n2)\n    return(list( c(dn1.dt, dn2.dt) ) )\n  })\n}"},{"path":"direct-competition-and-mutualism.html","id":"generalized-lotka-volterra-models","chapter":"7 Direct competition and mutualism","heading":"7.3 Generalized Lotka-Volterra models","text":"point, used sign (\\(\\pm\\)) term equations illustrate clearly possible types interactions exploring. instead, let sign coefficient determine type interaction, let \\(\\alpha\\) less greater zero, can describe growth rate species \\(\\) function species \\(j\\), \n\\[\\frac{dN_i}{dt} = r_i N_i\\left(1+ \\sum_{j=1}^S \\alpha_{ij}N_j\\right)\\]\n\\(\\alpha_{ij}, \\alpha_{ji} < 0\\) describes competitive interactions, \\(\\alpha_{ij}, \\alpha_{ji} > 0\\) describes mutualisms, \\(\\alpha_{ij} < 0,\\, \\alpha_{ji}>0\\) can predation \\(j\\) \\(\\), \\(j=\\) represents effect species \\(\\) . later chapter, use description investigate , contrast two-species interactions, \\(r_i\\) helps shape multiple basins attraction alternative stable states.","code":""},{"path":"direct-competition-and-mutualism.html","id":"summary","chapter":"7 Direct competition and mutualism","heading":"7.4 Summary","text":"chapter provided several useful results.can represent species effects precisely way represented effects .Considering two species, species \\(\\) can invade species \\(j\\) effect species \\(j\\) species \\(\\) less effect species \\(j\\) .Two species coexist stably effects smaller effects .dominant eigenvalue Jacobian matrix (perturbation growth rate), negative inverse, return time, useful mathematical definitions stability.Perturbation growth rate decreases \\(\\beta_{ij},\\, \\beta_{ji}\\) decrease, either less one greater 1 (\\(\\beta_{ij} = \\alpha_{ij}/\\alpha_{jj}\\)).magnitude perturbation growth rate increases \\(r\\).","code":""},{"path":"cr.html","id":"cr","chapter":"8 Consumer-resource Interactions","heading":"8 Consumer-resource Interactions","text":"Consumption fundamental life. Organisms disequilibrium surroundings, requiring inputs resources maintain , grow, reproduce. first considered organisms biophysical energetic context discussed foraging. Optimal foraging theory seeks understand individual behavior diet choice solution problem maximizing net resource gain per unit time.organisms require carbon inorganic materials nitrogen phosphorus basic building blocks cells. one limit growth, refer limiting resources, differential growth limitation among species occurs result short supply, refer resource limitation consequently resource competition. resources organisms often refer prey, hosts, simply victims. consumers may predators, pathogens, parasites, herbivores, just enemies.use simple examples resource competition based loosely examples MacArthur (1972) Tilman (1982). nearly models book, represent growth resources consumers growth rate = gains - losses.considered population growth demographic context beginning chapter 3 continued, described \n\\[\\Delta N = B+-D-E\\].\nconsumer-resource theory, can combine biophysical demographic approaches.\nFigure 8.1: Lynx-snowshoe hare cycles.\nOne famous examples species interactions ecology lynx–snowshoe hare cycle, based data Hudson Bay Trading Co. trapping records (Fig. 8.1).50 decades, lynx–hare cycle used possible example predator-prey interaction, lot hard work lot people (Stenseth et al. 1997; Krebs et al. 1995) showed asymmetric dynamic — lynx depends quite heavily hare, seems track hare abundance, hare cycles seem caused just lynx.chapter, things. First, cover flavors consumer-resource models different levels complexity, style. Consumers always organisms: plants, microbes, animals. Resources context may biotic (prey) abiotic resources nitrate phosphate taken fungi, plants, algae. Also known exploitative interactions, represent cases one species negative effect one positive effect . , illustrate fundamental concepts consumer–resource dynamics, predators respond prey abundances numerical functional manner. try develop understanding range dynamics continuous discrete time systems.general, can conceptualize consumer-resource interactions coupled equations,\n\\[\\begin{align*}\n\\frac{1}{R}\\frac{dR}{dt}&= f_R\\left(R,C\\right)\\\\\n\\frac{1}{C}\\frac{dC}{dt} &= f_C\\left(C,R\\right)\n\\end{align*}\\]\nper-unit change resource function, \\(f_R\\), resource consumer. Likewise, per-unit change consumer function, \\(f_C\\), consumer , resource. Holt (2011) identified five universal propositions regarding predator-prey interactions, including consumption resource necessarily reduces amount resource, depends environmental context, ’ll ignore now.start famous consumer-resource pairing, predator prey, also known enemy-victim interactions.Let’s go way back toward beginning book introduced exponential growth. Let’s imagine exponentially growing population grows rate\n\\[\\dot{N} = bN-dN\\]\nknew , like models, wrong, argued useful. Indeed, ways null model biological systems exponential growth fundamental life.Let us stick simplicity, link predator \\(P\\) prey. simple way include predators another source death prey (\\(\\)), prey source life predators (\\(eaN\\)),\n\\[\\begin{align*}\n\\dot{N} &= bN-dN -\\\\\n\\dot{P} &= eaN - mP\n\\end{align*}\\]\n\\(e<1\\) relative efficiency predators turn captured prey new predators.units differential equations individuals per unit time. Therefore, units term must also individuals per unit time. units \\(b\\) \\(d\\) units prey per unit prey per unit time,\n\\[\\mathrm{units}(b) = \\frac{\\mathrm{prey}}{\\mathrm{prey}}\\frac{1}{t} = t^{-1}\\]\nsimply per unit time, unit individual gram. Units attack rate consumption rate, \\(\\), also \\(t^{-1}\\). Units efficiency simply new predators per unit prey,\n\\[\\mathrm{units}(e) = \\frac{\\mathrm{predators}}{\\mathrm{prey}}\\]\nunits \\(m\\) predators per predator per unit time, \\(t^{-1}\\).combine units terms \\(\\dot{P}\\) , get\n\\[ \\frac{\\mathrm{predators}}{t} = \\left(\\frac{\\mathrm{predators}}{\\mathrm{prey}} \\cdot \\frac{1}{t} \\cdot \\mathrm{prey}|\\right) - \\left( \\frac{1}{t}\\cdot \\mathrm{predators}\\right)\\]\nprove units consistent across term equation. Write sort equation prey.mere fact efficiency, \\(e<1\\), shows us another general proposition enemy-victim interactions; consider enemy victim units (e.g., grams), cost victim always greater benefit enemy. simply result second law thermodynamics, fundamental part predator-prey interactions (Holt 2011).two equations, can make simple prediction regarding equilibrium, \\(P^*\\), setting \\(\\dot{P} = 0\\),\n\\[P^* = \\frac{ea}{m}N\\quad ; \\quad \\frac{P}{N} = \\frac{ea}{m}\\]Thus, simple theory predicts steady state, relative abundances predator prey constant. prey grow (die) exponentially, theory can make prediction \\(N^*\\), save \\(b=d\\). However, predict predator prey persist constant ratio, assuming parameters fixed.","code":""},{"path":"cr.html","id":"ratio-dependence","chapter":"8 Consumer-resource Interactions","heading":"8.1 Ratio dependence","text":"ideas posit prey grows exponentially, predators. true, makes sense prey get captured constant per capita rate: predators always lurking relative abundance. leads us another way think relations equations.Let’s make individual predators explicit part loss rate, per capita capture rate prey \\(\\) total rate also depends \\(P\\). average, number prey available predator just \\(N/P\\). Therefore, predators capture share prey rate\n\\[aP\\frac{N}{P}\\].\nexpression, see capture rate prey growth rate predators depends ratio prey predators.\nPutting explicit treatment back model, \n\\[\\begin{align*}\n\\dot{N} &= bN-dN -aP\\frac{N}{P}\\\\\n\\dot{P} &= eaP\\frac{N}{P} - mP\n\\end{align*}\\]refer simple predator prey model ratio-dependent predation (R. Arditi Ginzburg 1989). added biological mathematical complexity, end result? simplify expressions, let \\(P\\)’s cancel , wind just . reassuring. pairs equations : describe ratio-dependent predation.units \\(\\) remain , predator terms cancel (\\((N/P)P = \\)).first model predator-prey interactions, analogous exponential growth single population, thus satisfying properties:Prey predator grow die exponentially; predator merely along ride.populations coupled simplest possible connection.","code":""},{"path":"cr.html","id":"dynamics-of-ratio-dependent-predation","chapter":"8 Consumer-resource Interactions","heading":"8.1.1 Dynamics of ratio dependent predation","text":"dynamics ratio-dependent predation simple. cycles fluctuations, just like exponential growth single species. assumes predation rate function predator abundance number prey per predator. predicts predator abundance constant fraction prey. qualitative prediction often roughly consistent data.Let’s code quick function model, continue make assumption ratio-dependence transparent can (\\((N/P)P\\)), clarity.Now run plot output.\nFigure 8.2: assumption simple ratio-dependence, predator population constant fraction prey population.\n\nFigure 8.3: predator isocline ratio dependence. prey isocline abundance completely independent predator population. Arrows indicate trajectories. Note prey simply increaing.\nExercise Calculate hand equilibrium abundance predators model.","code":"\ncr_ratio_dep_pred <- function(time, y, parameters){\n  # the populations\n  N <- y[1]; P <- y[2]\n  with(as.list(parameters),{ \n  \n    # the equations\n    dndt <- r*N - a*N/P*P\n    dpdt <- e*a*N/P*P - m*P\n    \n    # returning a list with one component that is \n    # a two element vector, c(rate1, rate2)\n    return(list(c(dndt, dpdt)))\n  })\n}\nt <- 0:100\np <- list(r=0.05, a=0.01, e=0.1, m=.1)\n\ny0 <-c(N=100, P=3)\noutdf <- as.data.frame(ode(y0, t, cr_ratio_dep_pred,  p))\noutL <- pivot_longer(outdf, -time, names_to=\"State_vars\", values_to=\"abun.\")\nggplot(outL, aes(time, abun., colour=State_vars)) + geom_line() + scale_y_log10()"},{"path":"cr.html","id":"prey-dependence","chapter":"8 Consumer-resource Interactions","heading":"8.2 Prey dependence","text":"widely used model predator-prey dynamics championed independently Alfred Lotka Vito Volterra. formulation, per predator capture rate depends prey abundance, ratio prey predators. refer “mass effects,” , often case chemical reactions, rate reaction depends merelyt concentration reactants. Molecules reactant interfere . Organisms always chill. Nonetheless, widely used, often reasonable, approximation enemy victim interactions, especially low densities enemies.capture rate independent number predators population, describe thus.\n\\[\\begin{align}\n\\dot{N} &= bN-dN - aNP = rN - aNP\\\\\n\\dot{P} &= eaNP - mP\n\\end{align}\\]\nper predator capture rate simply \\(\\). Therefore, units \\(\\) differ ratio-dependent model.Given \\(aNP\\) must units prey per unit time, must units \\(\\) ? Can express biologically meaningful way?find equilibria, correctly, zero net growth isoclines, setting \\(\\frac{P}{dt} = 0\\) \\(\\frac{dN}{dt}=0\\). get curious results.Predator isocline \\(\\frac{dP}{dt} = 0 \\implies N=\\frac{m}{ea}\\)Prey isocline \\(\\frac{dN}{dt} = 0 \\implies P=\\frac{r}{}\\)population’s growth rate zero population fixed value. deal dynamics next.","code":""},{"path":"cr.html","id":"dyanmics-of-prey-dependent-predation","chapter":"8 Consumer-resource Interactions","heading":"8.2.1 Dyanmics of prey-dependent predation","text":"Now let’s code numerical model prey-dependent, Lotka-Volterra, predation.Now run model, using parameters ratio-dependent predation, plot output.\nFigure 8.4: Prey-dependent Lotka-Volterra predation results oscillations. Prey increase predators sufficiently abundant control , point decline, leading decline preadtors. predator peaks lag behind prey peaks.\n\nFigure 8.5: prey predator isoclines prey dependence. Arrows indicate direction changing population sizes. black lines tow different tractories based two different initial abundances. ‘nullclines’ zero net growth isoclines prey (x) predator (y). Based arrow heads, can see trajectories oscillate counterclockwise direction.\nThink isoclines bit. conditions prey increase (arrows pointing right)? conditions prey decrease (arrows pointing left)? shows us prey increase whenever predator abundance certain value. found value , \\(P = r/\\). predator increase decrease? prey particular value, \\(N=m/(ea)\\).time populations rest true.","code":"\ncr_prey_dep_pred <- function(time, y, parameters){\n  # the populations\n  N <- y[1]; P <- y[2]\n  with(as.list(parameters),{ \n  \n    # the equations\n    dndt <- r*N - a*N*P\n    dpdt <- e*a*N*P - m*P\n    \n    # returning a list with one component that is \n    # a two element vector, c(rate1, rate2)\n    return(list(c(dndt, dpdt)))\n  })\n}\nt <- 0:200; y0 <-c(N=100, P=3)\np <- list(r=0.05, a=0.01, e=0.1, m=.1)\n\noutdf <- as.data.frame( ode(y0, t, cr_prey_dep_pred,  p) )\noutL <- pivot_longer(outdf, -time, names_to=\"State_vars\", values_to=\"abun.\")\nggplot(outL, aes(time, abun., colour=State_vars)) + geom_line()"},{"path":"cr.html","id":"interlude-functional-response---what-an-individual-predator-does-fr","chapter":"8 Consumer-resource Interactions","heading":"8.3 Interlude: Functional response - what an individual predator does (#fr)","text":"refer per predator kill rate functional response. response predator different levels \\(N\\) \\(P\\). functional response ratio-dependent model \\(/P\\), prey-dependent model \\(\\) (Fig. 8.6). referred type functional responses.type functional responses realistic? imply predator captures constant fraction prey, matter many prey . predicts regardless whether two prey individuals one gazillion prey, single predator can nonetheless capture fraction. , prey reach high densities, type functional responses realistic. However, prey never reach high densities, type reasonable bounds realized prey densities.typically thought realistic predator satiates, capture rate approaches plateau density prey increases. , predator catch, subdue, kill prey item, swallow , move . Optimal foraging models (Chapter 2) typically account . Ecologists refer activity “handling” time required handling time. Buzz Holling (1959) developed mathematical form functional response prey-dependent predation includes handling time:\n\\[\\frac{}{1+ahN}\\]\n\\(\\) attack rate, \\(h\\) ia handling time. refer functional response type II functional response (Fig. 8.6). \\(N\\) gets really big, fraction approaches \\(1/h\\),\n\\[\\lim_{N \\rightarrow \\infty} \\frac{}{1+ahN} = \\frac{1}{h}\\]it51 yet clear , pause reflect .can exercise using ratio, \\(N/P\\),\n\\[\\lim_{N/P \\rightarrow \\infty} \\frac{/P}{1+ahN/P} = \\frac{1}{h}\\]Another common weigh represent type II response formulation Michaelis-Menten enzyme kinetics,\n\\[m \\frac{N}{k+N}\\]\n\\(k\\) half-saturation constant, \\(m\\) maximum rate. half saturation constant value \\(N\\) results reaction rate killing rate half maximum, \\(m\\). Algebraic rearrangement Holling type II Michaelis-Menten type II formulations show \\(m=1/h\\) \\(k=1/(ah)\\). might try convince true.Sometimes predators don’t feed lot enough prey available. Sometimes due predators switching one prey type another becomes sufficiently common. predator may develop search image prey type, ignore others. ’ve known people like . represent via exponent (\\(z>1\\)) functional response,\n\\[\\frac{^z}{1+ahN^z}\\]\n\\(z>1\\) refer type III functional response.\nFigure 8.6: Left: Functional responses either prey-dependent ratio-dependent predation; \\(z=3\\). Right: functional responses per-prey basis.\never want use data ask behavior predator, can difficult distinguish foraging behaviors fitting data functional response curves. typically success fitting data kill rate per unit prey vs. prey density (Fig. 8.6) qualitative differences slope (negative vs. positive) low prey density (Juliano 2001).Prey- vs. ratio-dependent functional responsesSome empirical evidence suggests partial ratio-dependence may often represent happening nature (Roger Arditi Ginzburg 2012). can get introducing additional constant, \\(m\\), type II functional response:\n\\[\\frac{/P^m}{1+ahN/P^m}\\]\n\\(0\\le m \\le 1\\). \\(m=0\\), prey-dependent response, \\(m=1\\) purely ratio-dependent response.numerical response predator simply population growth rate varies \\(N\\), \\(dP/dt\\) vs. \\(N\\).","code":"\n{\n  par(mgp=c(0,1,1))\n  curve(.5*x, 0, 2.5, ylab=bquote(\"no. prey (or prey/predator) killed\\nper predator per time\"),\n       xlab=\"N or N/P\", axes=FALSE, main=\"Functional Responses\")\n  box()\n  curve(x/(1+x), add=TRUE, lty=2 )\n  curve(x^3/(1+x^3), add=TRUE, lty=3 )\n  text(2, 1.2, \"Type I\")\n  text(2.5, 1, \"Type III\", adj=1)\n  text(2.5, .6, \"Type II\", adj=1)\n}\n{\n  par(mgp=c(0,1,1))\n  curve(.5*x/x, 0, 2.5, ylab=bquote(\"no. prey (or prey/predator) killed\\nper predator per time\"), ylim=c(0, 1),\n       xlab=\"N or N/P\", axes=FALSE, main=\"Functional Responses\")\n  box()\n  curve(x/(1+x)/x, add=TRUE, lty=2 )\n  curve(x^3/(1+x^3)/x, add=TRUE, lty=3 )\n  text(0, .55, \"Type I\", adj=0)\n  text(0, .1, \"Type III\", adj=0)\n  text(0, 1, \"Type II\", adj=0)\n}"},{"path":"cr.html","id":"stability-analysis-for-the-prey-dependent-lotkavolterra-model","chapter":"8 Consumer-resource Interactions","heading":"8.4 Stability analysis for the prey-dependent Lotka–Volterra model","text":"section, perform necessary analytical work understand dynamics Lotka–Volterra predator–prey dynamics, follow peek time series dynamics confirm understanding based analytical work.competition, follow four steps: determine equilibria, create Jacobian matrix, solve use Jacobian.Lotka–Volterra equilibriumAll solve isoclines cross. Thus set equations equal . turns , however, isoclines just straight lines, see equilibrium \\((r/,\\,m/(ea))\\).haven’t already, set growth rates equal zero solve isoclines.Creating, solving using Jacobian matrixTake look growth equations . take partial derivatives want know population growth rate changes response changes abundance population. partial derivatives prey growth equation, respect predator, go first row matrix, whereas partial derivatives predator growth rate, respect herbivore go second row.52Just kicks, might try deriving partial derivatives, e.g., \\(\\frac{\\delta dN/dt}{\\delta N}\\), example, treat \\(N\\) variable \\(P\\) constant.\n\\[\\begin{align}\n  \\tag{8.1}\n\\left(\n\\begin {array}{cc}\n\\frac{\\partial \\dot{N}}{\\partial N}&\\frac{\\partial \\dot{N}}{\\partial P}\\\\\n\\frac{\\partial \\dot{P}}{\\partial N}&\\frac{\\partial \\dot{P}}{\\partial P}\n\\end {array}\n\\right) =\n\\left(\n\\begin {array}{cc}\nr-aP & -\\\\\neaP & eaN-m\\\\\n\\end {array}\n\\right)\n\\end{align}\\]can replace \\(P\\) \\(N\\) Jacobian equibria found . , get\\[\\begin{align}\n  \\tag{8.2}\n\\left(\n\\begin {array}{cc}\nr-(r/)&-(m/(ae))\\\\\nea(r/)&ea(m/(ae))-s\\\\\n\\end {array}\n\\right) \n=\n\\left(\n\\begin {array}{cc}\n0  & - m/e \\\\\ner &   0  \\\\\n\\end {array}\n\\right).\n\\end{align}\\]Typically system stable diagonal elements negative -diagonals postive — mean population self regulating, corresponds Routh-Hurwitz criterion (see competition chapter earlier use Routh-Hurwitz criteria).\n\\[\\begin{equation}\n  \\tag{8.3}\n  \\mathbf{J_{11}} + \\mathbf{J_{22}} < 0.\n\\end{equation}\\]\nnotice (8.2) diagonal elements zero. zeroes reveal negative density dependence within population, , self-regulation.part Routh-Hurwitz criteria condition,\n\\[\\begin{equation}\n  \\tag{8.4}\n\\mathbf{J_{11}}\\mathbf{J_{22}-\\mathbf{J_{12}}\\mathbf{J_{21}}} > 0.\n\\end{equation}\\]\npredator–prey context, suggests herbivore declines due predator (\\(\\mathbf{J_{12}}<0\\)) predator increases due herbivore (\\(\\mathbf{J_{21}}>0\\)). signs elements make product negative, help make condition true. Note \\(\\mathbf{J_{11}} \\mathbf{J_{22}} =0\\), condition reduces \\(-rm>0\\). Thus seems true along \\(r\\) \\(m\\) positive (defined case). Therefore, dynamic stable equilibrium.can perform eigenanalysis given parameters .find eigenvalues complex, real real parts less zero. complex, means populations oscillate cycle, period \\(2\\pi/\\omega\\) (see Competition chapter). real parts zero, means Lotka–Volterra predator–prey exhibits neutral stability. Recall neutral stability “-” case perturbations equilibrium neither grow decline time. merely change abundances cause response.come important distinction: simple ratio dependent predation model predicts oscillations, whereas simple prey-dependent predation model predictions oscillations inherent predator-prey interactions. ideas provides useful base understand predator-prey dynamics depends system, talk .","code":"\n# our parameters are inside the list called 'p', so we use 'with()'\nJac <- with( p, matrix( c(0, -m/e, e*r, 0), byrow=TRUE, nr=2) )\neigen(Jac)[[\"values\"]]## [1] 0+0.07071068i 0-0.07071068i"},{"path":"cr.html","id":"resource-growth-functions","chapter":"8 Consumer-resource Interactions","heading":"8.5 Resource growth functions","text":"now, assumed resource grows exponentially absence consumer. essential starting point, now add two simple extensions, logistic growth, saturating resource supply.resource biotic population, typical represent growth function logistic growth, \n\\[\\frac{dN}{dt}=rN\\left( 1-\\alpha N \\right)\\]\nuse \\(N/K\\) place \\(\\alpha N\\).resource inorganic molecule, nitrate phosphate soil solution aquatic habitat, often assume constant background supply rate \\(S\\) (Tilman 1982) absence consumption. can imagine background supply rate results microbial activities little affected growth single species describing. imagine inhibited availability resource \\(R\\), , absence consumption, actual resource supply rate \n\\[\\frac{dR}{dt} = r(S-R)\\]\n\\(r\\) resource renewal rate (intrinsic rate increase). units \\(r\\) \\(1/t\\) perhaps can think \n\\[\\frac{\\mathrm{resource~produced}}{\\mathrm{resource~present}} \\cdot \\frac{1}{t}=t^{-1}\\]\namount \\(R\\) increases, \\(dR/dt\\) decreases. sense, bears resemblance logistic growth, \\(S=K\\) \\(R=N\\). Next explore model detail.","code":""},{"path":"cr.html","id":"consumption-of-a-renewable-resource","chapter":"8 Consumer-resource Interactions","heading":"8.5.1 Consumption of a renewable resource","text":"Consider one simplest models consumer-resource interactions,\n\\[\\frac{dR}{dt}= r\\left(S-R\\right) - R\\]\n\\[\\frac{dN}{dt}= N\\left(eaR - d\\right)\\]\\(\\) per capita feeding rate consumer resource, \\(e\\) efficiency consumer converts unit resource new biomass, \\(d\\) per capita death rate consumers. fixed parameter \\(S\\) background supply rate resource, \\(r(S-R)\\) turnover rate resources part available \\(R\\) pool. resource nitrate, perhaps determined nitrifying soil microbes steady state. rate declines amount resource grows, \\(r(S-R)\\). likely happen resource washed soil, high amount resource suppresses production.Consumers can measured mass, grams, per capita. perhaps organisms weigh one gram.Let’s start exploring happens resource consumer \\(N=0\\). solve \\(dR/dt=0=r(S-R)\\), get,\n\\[R^* = S\\]\nsee , equilibrium (\\(N=0\\)), environment contain \\(S\\) amount resource.described , unit consumer reduces unit resource \\(\\) units per unit time. say per capita effect consumer resource \\(\\). effect resource consumer moderated assimilation efficiency \\(e\\), , much consumer can grow, given consumption \\(R\\). Therefore, effect resource consumer \\(ef\\).consumer consumes resource grows, also dies. equilibrium, growth = death, true, can solve per capita growth rate equal zero.\n\\[\\frac{dN}{Ndt} = 0 = efR - d \\implies R^* = \\frac{d}{ef}\\]refer equilibrium “R-star,” plays central role competition theory. moment.set \\(dR/dt=0\\) substitute \\(R^*\\) \\(R\\), find consumer population \n\\[N^* = \\frac{r\\left(S - d/(ea)\\right)}{(d/(ea)}=r\\left(S\\frac{e}{d}-\\frac{1}{} \\right)\\]can say environment must supply resource rate least \\(S>d/(ea)\\) allow species \\(N\\) persist. addition, per capita effect consumer entire resource pool equilibrium \\(aR^* =d/e\\).make R function populations.select parameter values, can find \\(R^*\\) \\(N^*\\).can also plot dynamics.","code":"\ncr_plant <- function(t,y,p){\n  N <- y[1]; R <- y[2]\n  with(as.list(p),{\n    dN <- N*(e*a*R - d)\n    dR <- r*(S-R) - a*R*N\n    return(list(c(dN,dR)))\n  } )\n}\np <- c(e=.1, a=1, d=.1, r=2, S=2)\n with(as.list(p),{\n   R.star = d/(e*a)\n   N.star = r*(S*e/d - 1/a)\n   return(c(R.star, N.star))\n })## [1] 1 2\nt <- seq(0, 100, by=1)\nout <- ode(y=c(N=1.5, R=2), times=t, func=cr_plant, parms=p)\n\noutdf <- out %>% as.data.frame() %>% pivot_longer(cols=!time, names_to=\"population\", values_to=\"value\")\nqplot(time, value, col=population, data=outdf, geom=\"line\")"},{"path":"cr.html","id":"prey-carrying-capacity-and-type-ii-functional-response","chapter":"8 Consumer-resource Interactions","heading":"8.5.2 Prey carrying capacity and type II functional response","text":"commonly used predator-prey models include carrying capacity prey, prey population grows logistically. predator nonlinear type II functional response. well-established realistic biological complications commonly attributed Rosenzweig MacArthur (1963), others soon began using similar approaches (R. M. May 1973). common version, ’ll refer Rosenzweig-MacArthur model, predator, \\(P\\), prey, \\(N\\):\n\\[\\begin{align*}\n\\frac{dN}{dt} &= r(1-\\alpha N) - \\frac{}{1+ahN}P\\\\\n\\frac{dP}{dt} &= e\\frac{}{1+ahN}P - mP\n\\end{align*}\\]investigate dynamics, can create ODE function consumer-resource model.\nFigure 8.7: Predator-prey dynamics prey carrying capacity type II predator functional response. parameter values, see damped oscillations.\nplot isoclines, can see dynamical phase plane clearly.\nFigure 8.8: Damped oscillations can arise prey negative density dependence, type II predator funcional response. Arrows indicate direction changing population sizes. black lines tractories based two different initial abundances. nullclines zero net growth isoclines prey (x) predator (y). Based arrow heads, can see trajectories oscillate counterclockwise direction.\nstable equilibrium occurs approximately 300, 45.","code":"\ncr_RM_pred <- function(time, y, p){\n  # prey is first, predator is second.\n  N <- y[1]; P <- y[2]\n  with(as.list(p), {\n    Ndot <- r*N*(1-alpha*N) - a*N*P/(1+a*h*N) # prey\n    Pdot <- e*a*N*P/(1+a*h*N) - m*P # predator\n    return(list(c(Ndot, Pdot)))\n  })\n}\nt <- 0:100; y0 <-c(N=100, P=3)\np <- list(r=0.8, alpha=0.001, a=.02, e=0.04, m=.15, h=.1)\noutdf <- as.data.frame( ode(y0, t, cr_RM_pred,  p) )\noutL <- pivot_longer(outdf, -time, names_to=\"State_vars\", values_to=\"abun.\")\nggplot(outL, aes(time, abun., colour=State_vars)) + geom_line()\n## This use the phaseR package to plot phase planes \n## for 1-D and 2-D systems\nppp.flowfield <-  flowField(cr_RM_pred, xlim = c(0.1, 1000), \n                            ylim = c(0.1,80),\n                            parameters = p, points = 11,\n                            add=FALSE, ylab=\"P\", xlab=\"N\",\n                            main=\"Rosenzweig-MacArthur\")\n## ZNGIs\nppp.nullclines <- nullclines(cr_RM_pred, xlim = c(.1,1000), \n                             ylim = c(.1,80),\n                            parameters = p, add.legend = FALSE)\ny0  <- matrix(c(100, 25, 100, 10), nc=2, byrow = TRUE)\n\n## Dynamics\nprey_trajectory <- trajectory(cr_RM_pred,  y0 = y0,\n                              parameters=p,\n                              tlim = c(0, 200))\neq <- findEquilibrium(cr_RM_pred, y0=c(300,40), parameters=p)$ystar"},{"path":"cr.html","id":"paradox-of-enrichment","chapter":"8 Consumer-resource Interactions","heading":"8.6 Paradox of enrichment","text":"Using variety models assume prey carrying capacity type II functional response, Rosenzweig (1971) showed unexpected phenomenon — increasing prey’s carry capacity drive extinction. can happen prey grow quickly high abundance temporarily support high abundance predators drive prey extinct. can demonstrate lowering \\(\\alpha\\) enough increase oscillations abundances get infinitesimally close zero.\nFigure 8.9: Predator-prey dynamics prey carrying capacity type II predator functional response. parameter values, see damped oscillations.\nTry replicating phase plane plot used new parameters.","code":"\nt <- 0:100; y0 <-c(N=100, P=3)\np <- list(r=0.8, alpha=0.0005, a=.02, e=0.04, m=.15, h=.1)\noutdf <- as.data.frame( ode(y0, t, cr_RM_pred,  p) )\noutL <- pivot_longer(outdf, -time, names_to=\"State_vars\", values_to=\"abun.\")\nggplot(outL, aes(time, abun., colour=State_vars)) + geom_line()"},{"path":"cr.html","id":"consumption-of-two-resources","chapter":"8 Consumer-resource Interactions","heading":"8.7 Consumption of two resources","text":"section, work example species depends two resources. simplicity, assume resources substitutable, , shortage one can made excess another.Consider plant, \\(N\\), can consume two substitutable resources ammonium (\\(R_1=\\)NH\\(_4^+\\)) nitrate (\\(R2=\\)\\(_3^-\\)). One just easily imagine tadpoles feed zooplankton periphyton, fish feed macroinvertebrates periphyton, wolves feed lemmings caribou. parameters meanings (\\(e\\)-efficiency, \\(\\)-consumption, \\(d\\)-mortality, \\(r\\)-resource renewal, \\(S\\)-supply).\\[\\frac{dN}{dt}= N\\left(e_{1} a_{1} R_1 + e_{2} a_{2} R_2 - d\\right)\\]\n\\[\\frac{dR_1}{dt}= r_1\\left(S-R_1\\right) - a_{1}N R_1\\]\n\\[\\frac{dR_2}{dt}= r_2\\left(S-R_2\\right) - a_{2}NR_2\\]\ngrowth rate plant depends concentrations resources.ODE function can write looks like :can solve \\(dN/dt=0\\), get combinations resource concentrations result equilibrium plant rate increase matchs loss rate:\n\\[R_2 = \\frac{d}{e_2 a_2} -\\frac{e_1 a_1}{e_2 a_2}R_1\\]\ntakes form straight line\n\\[y = \\mathrm{intercept} + \\mathrm{slope}\\cdot x\\]\n\\(R_2=y\\) \\(R_1=x\\). graph , include effect consumer resources (solid arrows, Fig. @ref(fig:cr_vecs)). total per capita consumption rate vector derived separate feeding rates \\(a_1\\) \\(a2\\), times consumer abundance, \\(N\\). also show effect resource renewal (dashed arrows, Fig. @ref(fig:cr_vecs)). happen resources consumer eliminated. often interested vector equilibria, \\(N^*\\), depend resource supply rates \\(S_1\\), \\(S_2\\).\n(#fig:cr_vecs)consumer’s zero net growth isocline (ZNGI, dN/dt=0, solid line) two substitutable resources determined traits species. Solid arrows consumption effects, dashed arrows resource renewal vectors; magnitudes equal \\(a_i\\) \\(r_i\\), respectively. Dotted lines resource dynamics, starting supply rates low consumer abundance (open points) ending equilibrium (solidd dots). Parameters: \\(e_i=d_i=0.1\\), \\(a_1=1\\), \\(a_2=0.5\\); \\(r_i=0.5\\); \\(S_i\\) shown open points.\n","code":"\ncr_1substitutable <- function(t, y, parameters){\n  # consumption by 1 consumer of two substitutable resources\n  N <- y[1] ; R1 <- y[2]; R2 <- y[3]; \n  with(as.list(parameters), {\n    N.dot <- N * ( e1*a1*R1 + e2*a2*R2  - d )\n    R1.dot <- r1 * (S1 - R1) - a1*N*R1 \n    R2.dot <- r2 * (S2 - R2) - a2*N*R2\n    return( list(c(N.dot,R1.dot, R2.dot)) )\n  } )\n}\nparameters <- list(\n                # the environment supplies resources at these rates\n                r1 = .5, r2=.5, S1=3, S2=3,\n                # consumption rates\n                a1=1, a2=0.5,\n                # assimilation efficiencies\n                e1=.1, e2=.1, \n                # death rate\n                d=.1\n                )\nt <- seq(0, 50, by=.1)\ny.init <- c(N=.5, R1=.1, R2=2)\nout <- ode(y = y.init,  times=t, func=cr_1substitutable,\n             parms=parameters)\noutL <- out %>% as.data.frame() %>% \n  pivot_longer(cols=-time, names_to=\"State.vars\", values_to=\"Abun\")\nggplot(outL, aes(x=time, y=Abun, colour=State.vars)) + geom_line()"},{"path":"cr.html","id":"interpreting-consumption-and-assimilation","chapter":"8 Consumer-resource Interactions","heading":"8.7.1 Interpreting consumption and assimilation","text":"one hand, higher consumption rate, \\(\\), means organism consumes resource. hand however, means reduction resource larger negative effect consumer. true assimilation efficiencies, \\(e\\). efficient converting resource biomass also means reduction resource represents greater reduction growth rate.Evolution often resulted adaptations allow organisms consume relatively resources need . One reason organism needs one resource another stoichiometric composition (Sterner, Elser, Vitousek 2002). instance, plant species root, stem, leaf tissue higher C:N ratio might relatively higher carbon light requirement relatively lower nitrogen requirement species lower C:N ratio, herbivore. plant likely adaptions allow acquire relatively carbon survive less nitrogen species.result species’ stoichiometric composition, can hypothesize species relatively higher tissue concentration \\(R_1\\) higher consumption rate, \\(a_1\\), species relatively lower \\(R_1\\) tissue concentration.population, \\(N\\), consuming resources ratio \\(a_2 R_2 / a_1 R_1\\), developing new biomass individuals ratio \\(e_2 a_2 R_2 / e_1 a_1 R_1\\). can useful approximation reality. logical, far guaranteed, organism’s requirements growth metabolism similar ratio. Otherwise, must store excrete use. Thus can consider\n\\[\\frac{e_2 a_2 R_2^*}{e_1 a_1 R_1^*}\\]\nresource ratio requirement.","code":""},{"path":"cr.html","id":"in-fine-1","chapter":"8 Consumer-resource Interactions","heading":"8.8 In fine","text":"involved simple consumer-resource interactions. Resources renew, consumers consume grow inefficiently, environment influences processes. variety ways represent resource renewal, consumption. Consumption, attack rate feeding rate, effect consumer resource, illustrated functional response.later chapters, describe different types enemy-victim relations including host-parasitoid disease dynamics, consequences competition mutualism emerge consumers interact via shared resources.","code":""},{"path":"host-parasitoid-relations.html","id":"host-parasitoid-relations","chapter":"9 Host-parasitoid relations","heading":"9 Host-parasitoid relations","text":"parasitoid ghastly thing. animals, frequently small wasps, characteristically lay egg hosts, often caterpillar, young hatch , slowly consume juicy bits host. Neither adult wasp larvae immediately kill host. Many eggs can laid host, many larvae can live (least briefly) host. Ultimately, however, host gradually consumed one larvae per host metamorphosizes adult. Thus parasitoid larvae always consume kill hapless host. sense, natural history intermediate predator parasite—parasite-like, parasitoid. Thank gods parasitoids, often help suppress animals like even less, herbivores eat crops. even parasitoids parasitoids, hyperparasitoids. among diverse taxonomic groups animals.variety characteristics host–parasitoid relations might make different kind predator–prey relations thinking now. particular, life cycles host prey intimately connected one--one correspondence dead hosts number parasitoids next generation. know many hosts killed, know approximately many parasitoids born.","code":""},{"path":"host-parasitoid-relations.html","id":"independent-and-random-attacks","chapter":"9 Host-parasitoid relations","heading":"9.1 Independent and random attacks","text":"keeping convention parasitoid models, let us describe dynamics hosts parasitoid enemies discrete time model (Nicholson Bailey 1935; R. M. May 1978). makes sense, organisms, typically insects, frequently complete life cycles together within year. Let us pretend hosts, \\(H\\), grow geometrically absence parasitoids, \\(H_{t+1} = RH_t\\). assume individuals attacked killed parasitoids, \\(H_a\\), rate becomes\n\\[\\begin{equation}\n \\tag{5.10}\n  H_{t+1} = R\\left( H_t - H_a \\right)\n\\end{equation}\\]\n, assume couple things parasitoid natural history. First, pretend parasitoids search randomly independently prey, able search area, \\(\\) (“area discovery”), life time. total number attack events \\(E_t=aH_tP_t\\): adults may lay egg host encounters, event kill host. Therefore, hosts can receive one egg, thereby making number attacked hosts lower number attack events, \\(E_t\\). attack occurs random event, now assume attack independent others.many species parasitoids, one adult can emerge single host, regardless many eggs laid host. Therefore, number emerging adult parasitoids, \\(P_{t+1}\\), simply number hosts attacked , whether host received one egg many. Therefore, number parasitoids time \\(t+1\\) merely number hosts attacked, can represent \n\\[\\begin{equation}\n  \\tag{9.1}\n  P_{t+1} = H_a.\n\\end{equation}\\]\nassumption one dead host = one new parasitoid can easily relaxed introduce constant \\(q\\), \\(P_{t+1} = qH_a\\).Nicholson Bailey (1935) took advantage well known discrete probability distribution, Poisson distribution53 describes probability observing particular number events specified time interval area, thos events occur randomly independently. defined \n\\[P\\left(x\\right) = \\frac{\\mu^x e^{-\\mu}}{x!} \\]\nprobability observing \\(x\\) events (given time interval) depends overall average rate \\(\\mu\\) number observed events.\ngenerates series\n\\[\\begin{equation*}\n  \\frac{1}{e^\\mu},  \\frac{\\mu}{1!e^\\mu}, \\frac{\\mu^2}{2!e^\\mu}, \\cdots \\frac{\\mu^r}{r!e^\\mu}\n\\end{equation*}\\]\nrepresenting probabilities occurrence 0, 1, 2, \\(r\\). exclamation point indicates factorial\n\\[x! = x(x-1)(x-2)...(1)\\]\n\\(0!=1\\) definition. distribution allows us predict number potential hosts escape attack \\(e^{-\\mu}\\) \\(\\mu=aP\\), per parasitoid attack area, \\(\\), times number parasitoids, \\(P\\). can use create simple discrete analytical model host–parasitoid dynamics.\n\\[\\begin{align}\n  H_{t+1} &= R H_te^{-aP_t}  \\tag{9.2}\\\\\n  P_{t+1} &= H_t \\left(1-e^{-aP_t}\\right)\\tag{9.3}\n\\end{align}\\]\nParameter \\(\\) known “area discovery,” area searched parasitoid’s lifetime. greater area searched (.e., larger \\(\\)) means hosts killed, fewer survive contribute next generation. Poisson distribution tells us attacks random independent, \\(e^{-aP_t}\\) probability host attacked. Therefore, \\(H_te^{-aP_t}\\) expected number hosts attacked survive reproduce.can find equilibrium discrete model. Recall , models continuous differential equations, meant letting \\(dN/dt = 0\\). discrete case, means letting \\(N_{t+1}-N_t=0\\). equilibrium, \\(N^*\\), value \\(N\\) true, \\(N^*=N_{t+1}=N_t\\). use find equilibrium parasitoids, starting (9.2),\n\\[\\begin{align}\n  H^*&=RH^*e^{-aP_t}\\notag\\\\\n  1 &=Re^{-aP_t} \\notag\\\\\n  P^*&=P_t=\\frac{\\log R}{}\n\\end{align}\\]\nrecognize (9.3), \\(P_{t+1}=H_t-H_{t+1}/R\\), \\(H^*=H_t=H_{t+1}\\), find host equilibrium\n\\[\\begin{align}\n  H^*&=P^*\\frac{R}{R-1}.\n\\end{align}\\]","code":""},{"path":"host-parasitoid-relations.html","id":"simulating-simple-host-parasitoid-dynamics","chapter":"9 Host-parasitoid relations","heading":"9.1.1 Simulating simple host-parasitoid dynamics","text":"motivate Nicholson-Bailey model simulation dynamics. may provide intuitive understanding simply throwing probability distribution problem. end, wind place, reassuring.Nicholson-Bailey model assumes parasitoids search fixed area, attacks hosts randomly independently. set duration time series, model parameters, create empty data frame hold results.Next calculate equilibrium, use nearby point initial abundances.project dynamics, one generation time, time step.Last plot trajectory, placing point (unstable) equilibrium, using arrows highlight direction magnitude increment change per time step.\nFigure 9.1: Dynamics around unstable equilibrium Nicholson-Bailey host–parasitoid model (\\(R=3\\), \\(=0.005\\)). Arrows indicate single time step; point equilibrium center.\n","code":"\ntime <- 20; R <- 3; a <- .005\nHPs <- data.frame(Hs <- numeric(time), Ps <- numeric(time))\nPst <- log(R)/a; Hst <- Pst*R/(R-1) \nHPs[1, ] <- c(Hst+1, Pst)\nfor(t in 1:(time-1))  HPs[t+1,]  <- {H <- R * HPs[t,1] * exp( -a * HPs[t,2] )\n                                 P <- HPs[t,1]*(1-exp(-a*HPs[t,2]))\n                               c(H,P) }\nplot(HPs[,1], HPs[,2], type=\"n\", xlab=\"H\", ylab=\"P\"); points(Hst, Pst);\narrows(HPs[-time,1], HPs[-time,2], HPs[-1,1], HPs[-1,2], length=.05)"},{"path":"host-parasitoid-relations.html","id":"simulating-random-attacks","chapter":"9 Host-parasitoid relations","heading":"9.1.1.1 Simulating Random Attacks","text":"model makes strong assumptions proportion hosts escape attacks, depends parasitoid attacks random independent. Therefore let us simulate parasitoid attacks random independent compare data field data. Let’s start field data collected Mark Hassell (R. M. May 1978), number parasitoid larvae per host, either 0, 1, 2, 3, 4 larvae., 1066 hosts larvae. can recreate data set, one observation per host: number larvae host.simulate random attacks, let’s use number hosts, number attacks, let computer attack hosts random. calculate total number hosts, \\(H\\), total mean number attacks experienced hosts.Next, predators attack (‘sample’) hosts random \nequal probability. code , identify hosts numbering\n1–\\(H\\). attack hosts independently, , replace attacked host back pool possible prey.count number times different hosts attacked.find count number hosts attacked , twice, .see, instance,  hosts attacked twice. also allows us know many hosts  attacked,Let’s compare observed data simulated data.seem fewer unattacked hosts attacked hosts random-attack simulation observed data. simply consequence observed values one many random possibilities? systematic difference? check ?One way check whether observed data differ model random independent attacks simulate many observations, compare observed data (rtotals[1] unattacked hosts) distribution simulated results. performing \\(n\\) simulations steps used .Next just make histogram (Fig. 9.2) number unattacked hosts, adding dotted line show true data lie, dashed line prediction, assumption random independent attacks, based Poisson distribution.\nFigure 9.2: Histogram simulated host populations, attacked rate r round(mean.attacks,2) mean attacks per host, assuming attacks hosts random independent .\nsimulation results (Fig. 9.2) indicate observed data include far unattacked hosts expected chance.Another, quicker way evaluate assumption independent random attacks compare ratio variance observed larvae per host mean. data follow Poisson distribution, ratio expected equal one.ratio greater one, know due chance. can test , null hypothesis, expect product ratio number hosts, \\(H\\), follows \\(\\chi^2\\) distribution, \\(H-1\\) degrees freedom. can ask likely ratio, extreme ratio, , attacks random independent. compare cumulative probability density function \\(\\chi^2\\) distribution.find , given large number observations, exceedingly unlikely observe ratio large larger. nice agrees simulation! feel confident parametric test agrees simulation ideas; perhaps necessary, working helps us understand .","code":"\ntotals <- c(1066, 176, 48, 8, 5)\nobs <- rep(0:4, totals)\nH <- sum( totals )\nNo.attacks <- sum(obs)\nmean.attacks <- mean(obs)\nattack.events <- sample(x=1:H, size=No.attacks, replace=TRUE)\nN.attacks.per.host <- table(attack.events)\n(tmp <- table( N.attacks.per.host ) )## N.attacks.per.host\n##   1   2   3 \n## 243  35   1\nnot.att <- H - sum(tmp)\nobs.sim <- rep(0:max(N.attacks.per.host), c(not.att, tmp))\ntable(obs)## obs\n##    0    1    2    3    4 \n## 1066  176   48    8    5\ntable(obs.sim)## obs.sim\n##    0    1    2    3 \n## 1024  243   35    1\nn <- 1000\nunatt.sim<- sapply(1:n, function(j) { ## Repeat n times...\n  ## simulate the same number of attacks.\n  host.sim.att <- sample(x=1:H, size=No.attacks, replace=TRUE)\n  ## subtract the number of attacked hosts from the total in the host population\n  ## The number of attacks on each attacked host\n  attacks.per <- table(host.sim.att)\n  ## the number of attacked hosts \n  n.attd <- length( attacks.per)\n  ## the number not attacked\n  H - n.attd\n                         } )\nhist(unatt.sim, xlab=\"Simulated # of Unattacked Hosts\", \n     prob=TRUE, xlim=c(1000, 1070) )\nabline(v=1066, lty=3)\nabline(v=exp(-mean.attacks), lty=2)\n(I <- var(obs)/mean(obs))## [1] 1.40413\n1-pchisq(I*H, df=H-1)## [1] 0"},{"path":"host-parasitoid-relations.html","id":"aggregation-leads-to-coexistence","chapter":"9 Host-parasitoid relations","heading":"9.2 Aggregation leads to coexistence","text":"Nicholson-Bailey model within independent radnom attacks, (9.2), (9.3), predicts parasitoid host become extinct. potentially useful - sometimes exactly observe local subpopulations. may also suggest missing something populations become extinct. feature models like: allow us rigorously evaluate assumptions falsify . scientific ideas ultimately described manner allow us , principle, falsify . confidence model , falsification might lead us ask, “model missing?”Perhaps missing important parasitoid natural history. Parasitoids tend aggregate particular hosts local populations hosts. hosts likely get attacked others, resulting unattacked hosts hosts receiving multiple attacks predicted random independent attacks. may related searching behavior, spatial distributions hosts landscape. parasitoids aggregate, tend leave low density host populations unparasitized. result, low density populations act refuges.Perhaps can kill two birds one stone, fix problems one step. R. M. May (1978) others done, assuming parasitoids aggregate.May proposed following logic one reason might observe unattacked hosts expected. Imagine distribution parasitoids among patches landscape can described one probability distribution, particular mean variance number parasitoids per patch. Imagine next attacks hosts within patch random independent thus described Poisson distribution. result compound distribution attacks — combination among-patch, within-patch distributions.54 examine distribution larvae per host, hosts landscape, find higher proportion unattacked hosts, higher proportion hosts attacked many times.negative binomial distribution can describe aggregated data, number larvae per host. data counts greater equal zero, variance greater mean. Thus, negative binomial distribution can describe greater aggregation Poisson distribution (\\(\\mu=\\sigma^2\\)), thereby describe nature somewhat accurately. May suggested true distribution larvae hosts, particular case, unlikely truly negative binomial, nonetheless useful approximation.Ecologists frequently use negative binomial distribution count data variance greater mean. different derivations distribution, therefore different parameterizations (Bolker 2008). ecology, typically use mean, \\(\\mu\\), overdispersion parameter \\(k\\). variance, \\(\\sigma^2\\), function , \\(\\sigma^2 = \\mu + \\mu^2/k\\); overdispersion mean \\(\\sigma^2 > \\mu\\). Large values \\(k\\) (\\(k>10\\)) indicate random independent events rather aggregation, distribution becomes indistinguishable Poisson. Small values (\\(k<2\\)) indicate aggregation.55 Fig. 9.3 shows examples. R negative binomial distribution built (nbinom), use \\(k\\) one arguments; rather, size \\(=k\\). generate graph showing distribution different values \\(k\\).\nFigure 9.3: negative binomial distribution, dispersion parameter \\(k\\) controls variance breadth distribution. given mean, smaller \\(k\\) causes greater variance, results higher proportion zeroes. \\(k\\) representative values Pacala, Hassell, May (1990).\nproportion unattacked hosts expected negative binomial \\((1 + aP_t/k)^{-k}\\). Therefore, can write analytical expressions population dynamics similar Nicholson-Bailey model, using negative binomial distribution.\n\\[\\begin{align}\n  H_{t+1} &= RH_t\\left(1+\\frac{aP_t}{k} \\right)^{-k}  \\tag{9.4}\\\\\n  P_{t+1} &=  H_t - H_t\\left(1+\\frac{aP_t}{k} \\right)^{-k}  \\tag{9.5}\n\\end{align}\\]\nR. M. May (1978) referred phenomenlogical model (opposed mechanistic) negative binomial merely approximates true, perhaps compound, distribution.","code":"\nnb.dat <- cbind(\n       Random = dnbinom(0:5, mu=.5, size=10^10),\n      \"k=10\"=dnbinom(0:5, mu=.5, size=10),\n      \"k=1\"=dnbinom(0:5, mu=.5, size=1),\n      \"k=0.01\"=dnbinom(0:5, mu=.5, size=.01)\n               )\nmatplot(0:5, nb.dat , type=\"b\", pch=1:4, col=1, ylim=c(0,1),\n        xlab=\"Attacks per Hosts\", ylab=\"Probability\") \nlegend(\"topright\", rev(colnames(nb.dat)), pch=4:1, lty=4:1, bty='n')\nmtext(quote(mu== 0.5), padj=2)"},{"path":"host-parasitoid-relations.html","id":"equilibria-for-a-discrete-time-model","chapter":"9 Host-parasitoid relations","heading":"9.2.1 Equilibria for a discrete-time model","text":"equilibria host parasitoid populations May’s model (9.4), (9.5), derived simply, decide upon describe condition equilibrium (.k.. steady state). models differential equations, meant letting \\(d N/d t =0\\). discrete case means letting \\(N_{t+1}-N_t=0\\). equilibrium value \\(N\\) true, \\(N^*=N_{t+1}=N_t\\). Following train thought, $H^*=H_{t+1} = H_t $ \\(P^*=P_{t+1} = P_t\\).solve equilbria, begin expression hosts (9.4), solve equilibrium parasitoid density. case, can divide (9.4) sides \\(H^*\\).\n\\[\\begin{align}\n  1 &= R\\left(1+\\frac{aP_t}{k}\\right)^{-k}\\notag\\\\\n  R^{-1} &=  \\left(1+\\frac{aP_t}{k}\\right)^{-k}\\notag\\\\\n  R^{1/k} &= 1 + \\frac{aP_t}{k}\\notag\\\\\n  P^* &= \\frac{k}{} \\left(R^{1/k} - 1 \\right)\\label{eq:16}\n\\end{align}\\]\nGiven , causes increases \\(P^*\\)? Certainly decreasing \\(\\) leads increases \\(P^*\\). parasitoid population smaller \\(\\) (.e. smaller area discovery), means require less space, can thereby achieve higher density. Increasing \\(k\\) means less aggregated attack events, increases probability parasitoid larvae alone host, increases parasitoid density, limit.want \\(H^*\\) well, can solve . see (9.5) can rearranged show\n\\[\\begin{align*}\n  P_{t+1} &= H_t - \\frac{H_{t+1}}{R}\n\\end{align*}\\]\ngiven contant \\(H\\) \\(P\\),\n\\[\\begin{align}\n  \\tag{9.6}\n  H^* &= P^* \\left(\\frac{R}{R-1} \\right)\n\\end{align}\\]\n\\(P^*\\) (9.4).","code":""},{"path":"host-parasitoid-relations.html","id":"stability-of-hostparasitoid-dynamics","chapter":"9 Host-parasitoid relations","heading":"9.3 Stability of host–parasitoid dynamics","text":"differential equation models, can analyze stability immediate vicinity equilibria discrete time models using eigenanalysis Jacobian matrix. Although analogous, important differences continuous discrete models.Jacobian matrix comprised partial derivatives growth increments (e.g., \\(\\Delta N = N_{t+1}-N_t\\)), rather time derivatives (e.g., \\(\\dot{N}\\)).Interpretation eigenvalues Jacobian reflects difference finite rate increase (\\(\\lambda\\)) intrinsic rate increase (\\(r\\)); e.g., discrete models, \\(\\lambda = 1\\) indicates zero growth.Populations discrete generations can grow quickly stable (e.g., chaos discrete logistic growth).discrete time case, Jacobian matrix set partial derivatives discrete growth increment rather time derivatives used continuous growth56. growth increments increments change entire time step, \\(\\Delta H=H_{t+1} - H_t\\) \\(\\Delta P=P_{t+1} - P_t\\). Taking increments (9.4), (9.5), Jacobian matrix partial differential equations \n\\[\\begin{align}\n  \\tag{9.7}\n\\left(\n\\begin {array}{cc}\n\\frac{\\partial \\Delta H}{\\partial H}&\\frac{\\partial \\Delta H}{\\partial P}\\\\\n\\frac{\\partial \\Delta P}{\\partial H}&\\frac{\\partial \\Delta P}{\\partial P}\n\\end {array}\n\\right) =\n\\left(\n\\begin {array}{cc}\nR\\left(1+aP\\right)^{-k}-1\\quad &-akHR\\left(1+aP\\right)^{-\\left(k+1\\right)} \\\\\n1-\\left(1+aP\\right)^{-k}& akH\\left(1+aP\\right)^{-\\left(k+1\\right)}\n\\end {array}\n\\right) \n\\end{align}\\]\n@\nanalyze equilibrium, substitute \\(H^*,\\,P^*\\) \\(H,\\,P\\), perform eigenanalysis. resulting eigenvalues, \\(\\lambda_1,\\,\\lambda_2\\), reflect perturbation growth increments, discrete time analogy instantaneous perturbation growth rates continuous models.Recall continuous time, \\(\\lambda_1\\) instantaneous rate change perturbation equilibrium,\n\\[\\begin{equation}\n \\tag{9.8}\n  \\dot{x}= \\lambda_1 x,\\quad x_t = x_0e^{\\lambda_1 t}\n\\end{equation}\\]\n\\(x\\) perturbation equilibrium; \\(\\lambda_1<0\\), perturbation decline. discrete growth, can think \\(\\lambda_1\\) discrete growth factor perturbation equilibrium,\n\\[\\begin{equation}\n  \\tag{9.9}\n  x_{t+1}=\\lambda_1x_t\n\\end{equation}\\]\n\\(x\\) perturbation. , see \\(x\\) decline long \\(0 <\\lambda_1 < 1\\). Second, \\(\\lambda_1 < 0\\), \\(x_{t+1}\\) changes sign time step, perturbation oscillates around 0. alright, magnitude also decreases time step, perturbation still declines toward zero. However, \\(\\lambda < -1\\), oscillations grow perturbation oscillates permanently. directly analogous oscillations, stable limit cycles, saw discrete logistic growth model. Thus, criterion stability discrete growth models eigenvalues, \\(-1 < \\lambda < 1\\).discrete models, also need little concerned imaginary part eigenvalues, contribute magnitude oscillations eigenvalues. therefore add magnitude \\(\\lambda = + bi\\) \\(|\\lambda|=\\sqrt{^2 +b^2}\\). Thus, system stable \\(|\\lambda|\\leq 1\\). magnitude complex number known modulus. moduli (plural modulus) host–parasite model therefore includes complex plane, real part eigenvalue \\(x\\)-axis, imaginary part \\(y\\)-axis (Fig. ??). magnitude modulus eigenvalue length vector plane.can illustrate stability criterion discrete models ways. phase plane portrait time series illustrate dynamics directly. However, also useful show relation measure stability parameters influencing stability. Since aggregation seems important host–parasitoid model, can show stability (\\(\\lambda\\)) varies \\(k\\). can thus investigate much aggregation required stability (Pacala, Hassell, May 1990). anticipate stability declines (\\(|\\lambda| \\1\\)) \\(k\\) increases.proceed largely continuous models, first expressions , partial derivatives , relevant functions — discrete models use \\(F(N_t)\\), \\(N_{t+1}=F(N_t)\\).next specify sequence \\(k\\)’s, \\(k\\), find equilibria, evaluate Jacobian, return eigenvalues Jacobian.Last, plot eigenvalue greatest absolute magnitude, retain sign real part, \\(\\lambda\\)  \\(k\\).\nFigure 9.4: Dynamical stability discrete host-parasitoid model aggregation. Region stability rate change following small perturbation away equilibrium. plus sign ‘+’ \\((0,0)\\) two small circles complex eigenvalues. length vector modulus.\neigenvalues complex numbers. typically important evaluate modulus, magnitude, eigenvalues Jacobian matrix discrete model. graph complex number plane (Fig. ??).First set unit circle define stability region complex number plane.plot circle add eigenvalues smallest \\(k\\);\nFigure 9.5: complex number plane; length arrows moduli, lambda.\nlength arrows moduli, \\(|\\lambda|\\).","code":"\nF.H <- expression(R*H*(1+a*P/k)^-k - H )\nF.P <- expression(H - H*(1+a*P/k)^-k - P)\nF.H.H <- D(F.H, \"H\"); F.H.P <- D(F.H, \"P\")\nF.P.H <- D(F.P, \"H\"); F.P.P <- D(F.P, \"P\")\nk <- 10^seq(-1, 1, by=.01)\nR <- 3\na <- .005\nHPeigs <- sapply(k, function(ki) {\n  k <- ki\n  P <- k*(R^(1/k) - 1)/a\n  H <- P * R/(R-1)\n  jac <- matrix( c(eval(F.H.H), eval(F.H.P), eval(F.P.H), eval(F.P.P)), \n                nrow=2, byrow=TRUE )\neigen(jac)[[\"values\"]] \n} )\nmodmaxs <- apply( HPeigs, 2, function(lambdas) {\n  i <- which.max(Mod(lambdas))\n  sign(Re(lambdas[i])) * Mod(lambdas[i]) })\n\nplot(k, modmaxs, type='l', \n     ylab=quote(\"Stability \"*(lambda[1])) )\nabline(h=-1, lty=3)\nth <- seq(-pi, pi, len=100)\nz <- exp(1i*th)\npar(pty=\"s\")\nplot(z, type=\"l\")\npoints(0,0, pch=3); points(HPeigs[,100])\narrows(x0=c(0,0), y0=c(0,0), x1=Re(HPeigs[,100]), y1=Im(HPeigs[,100]))"},{"path":"host-parasitoid-relations.html","id":"dynamics-of-the-may-hostparasitoid-model","chapter":"9 Host-parasitoid relations","heading":"9.3.0.1 Dynamics of the May host–parasitoid model","text":"simply play May’s model. following generates phase plane diagram dynamics, although shown. set duration time series, model parameters, create empty data frame hold results.Next calculate equilibrium, use nearby point initial abundances.project dynamics, one generation time, time step.Last plot trajectory, placing point equilibrium, using arrows highlight direction magnitude increment change per time step.","code":"\ntime <- 20; R <- 3; a <- .005; k <- .6\nHP2s <- data.frame(Hs = numeric(time), Ps = numeric(time))\nP2st <- k*(R^(1/k) - 1)/a; H2st <- P2st * R/(R-1)\nP2st;H2st## [1] 628.8302## [1] 943.2453\nHP2s[1, ] <- c(1000,500)\nfor(t in 1:(time-1))  HP2s[t+1,]  <- {\n  H <- R * HP2s[t,1] * (1+a*HP2s[t,2]/k)^(-k)\n  P <- HP2s[t,1] - HP2s[t,1] * (1+a*HP2s[t,2]/k)^(-k)\n                               c(H,P) }\n{\n  plot(HP2s[,1], HP2s[,2], type=\"l\", xlab=\"H\", ylab=\"P\")\n  points(H2st, P2st)\n  arrows(HP2s[-time,1], HP2s[-time,2], HP2s[-1,1], HP2s[-1,2], length=.05)\n}"},{"path":"host-parasitoid-relations.html","id":"in-fine-2","chapter":"9 Host-parasitoid relations","heading":"9.4 In Fine","text":"Parasitoids wildly diverse set taxa, largely undescribed.commonly model host-parasitoid discrete time.Hosts grow geometrically, die attacked.Parasitoids next generation simply number attacked hosts.Aggregation attack behavior appears allow stable coexistence.","code":""},{"path":"disease.html","id":"disease","chapter":"10 Disease","heading":"10 Disease","text":"discuss epidemiological disease models. Pathogens cause diseases, typically defined microorganisms (fungi, bacteria, viruses) host specificity, undergo population growth within host. curious reader may want consult S. P. Ellner Guckenheimer (2006) Bjornstad (2018).think, without tons evidence, one nice aspect disease ecology use epidemiological models helped ecologists feel comfortable short term dynamics also importance prediction. Human epidemiology rightly obsessed understanding disease outbreak front us, whether common cold, SARS-CoV-2 alter course. even interested able predict course outbreak. contrast, ecology often interested asymptotic dynamics rather short term, understanding prediction. place everything, good see two merged bit.simplest models disease funny, don’t model pathogens (enemy) . famous models, Kermack McCormick (1927), keep track different types hosts, primarily without disease:Susceptible hosts Individuals infected, become infected,Infected hosts Individuals already infected, andResistant hosts Individuals resistant disease, typically assumed built immunity past exposure,\\(N=S++R\\). important note \\(N\\), \\(S\\), \\(\\), \\(R\\) densities. , track numbers individuals fixed area. important direct consequences spread, transmission, disease (McCallum, Barlow, Hone 2001).Disease spreads infected individuals susceptible individuals. rate depends extent number alternatively, fraction population infected. Resistant individuals typically considered vectors pathogens, increased abundance resistant individuals slow transmission rate diluting two groups.","code":""},{"path":"disease.html","id":"closed-epidemics","chapter":"10 Disease","heading":"10.1 Closed epidemics","text":"good starting place simplest SIR models, closed epidemic. mean births, deaths, migration essentially zero, fixed population size. reasonable assumption relatively short time intervals, fine interested progression single disease outbreak.\n\\[\\begin{align*}\n  \\tag{10.1}\n  \\frac{d S}{d t} &= -\\beta \\\\\n  \\frac{d }{d t} &=\\beta  - \\gamma \\\\\n  \\frac{d R}{d t} &= \\gamma \n\\end{align*}\\]","code":"\n# Here we create the function for the simple SIR model.\nSIRd <- function(t, y, p) {\n  {\n        S <- y[1]\n        I <- y[2]\n        R <- y[3]\n    }\n  with( as.list(c(y, p)), {\n    dS.dt <- -B*I*S\n    dI.dt <- B*I*S - g*I\n    dR.dt <- g*I\n   return( list(c(dS.dt, dI.dt, dR.dt)) )\n  } )\n}"},{"path":"disease.html","id":"density-dependent-transmission","chapter":"10 Disease","heading":"10.1.1 Density-dependent transmission","text":"(10.1), total transmission rate depends density susceptible hosts. transmission coefficient, \\(\\beta\\), describes instantaneous rate number infected hosts increases per infected individual. directly analogous attack rate type prey-dependent models. Recall based law mass action, borrowed physics chemistry. assumes rate events occur (new infections) due complete random mixing reactants (\\(S,\\,\\)), rate reactants collide react can described single constant, \\(\\beta\\). density either type molecule increases, rate interaction. prey-dependent predation, referred \\(\\) linear functional response; refer \\(\\beta S\\) density-dependent transmission function. transmission rate instantaneous rate number new infections cases per unit time (McCallum, Barlow, Hone 2001).Resistant individuals might resistant one two reasons. may die, may develop immunities. either case, assume catch disease , spread disease. model assumses constant population size, continue count \\(R\\) individuals, regardless whether become immune die.individuals become resistant disease constant per capita rate, \\(\\gamma\\). rate \\(\\gamma\\) also inverse mean residence time, duration, disease57.Disease incidence number new infections cases occurring defined time interval. definition makes incidence discrete-time version transmission rate. Disease prevalence fraction population infected \\(/N\\).common question disease ecology ask conditions outbreak occur. Another way asking ask conditions cause \\(\\dot{}>0\\). can set \\(dI/dt > 0\\) solve something interesting required outbreak occur.\n\\[\\begin{align}\n\\tag{10.2}\n  0 & < \\beta - \\gamma \\notag\\\\\n  \\frac{\\gamma}{\\beta} &< S\n\\end{align}\\]\ntell us? First, divide \\(\\), means one infected, outbreak can’t happen—usual, typically unstable equilibrium 0. Second, tells us outbreak occur absolute density susceptibles58 greater \\(\\gamma / \\beta\\). consider pre-outbreak situation \\(S \\approx N\\), simply making population size (density) low enough can halt spread disease. outbreaks tend occur high density populations, agricultural hosts (e.g., cattle), historically urban human populations, schools.Vaccinations way reduce \\(S\\) without reducing \\(N\\). sufficient number individuals population vaccinated reduce \\(S\\) \\(\\gamma / \\beta\\), tends protect unvaccinated individuals well.Another common representation called force infection basic reproductive rate disease. assume large population \\(S \\approx N\\), rearranging (10.2) gives us\n\\[\\begin{equation}\n\\tag{10.3}\n  R_0=\\frac{\\beta N}{\\gamma}\n\\end{equation}\\]\n\\(R_0\\) basic reproductive rate disease. \\(R_0 > 1\\), outbreak (.e., disease growth) plausible. Try confuse density resistant hosts, \\(R\\), basic reproductive rate disease, \\(R_0\\). analogous finite rate increase population \\(\\lambda>1\\).model outbreak nonlethal disease (e.g., new cold virus winter university). assume disease neither life-threatening, anyone resistant, thus \\(R=0\\). can investigate SIR model pretending , often case, begin largely uninfected population \\(t=0\\), \\(I_0=1\\) \\(S_0\\approx N\\). first set parameters. Let’s assume cold lasts week - duration disease, \\(1/\\gamma\\). assumes duration ot cold symptoms exponentially distributed.important point reiterate point made —conclusions apply S, , R densities (McCallum, Barlow, Hone 2001). increase population size also area associated population, changed density. population size increases, density constant, interaction frequency increase. populations may increase density increase size, may . Mass action dynamics type functional response predators—constant linear increase per capita infection rate number susceptible hosts increases.","code":"\nparms <- c(B=.001, g=1/7)\nN <- 10^3; I <- R <- 1; S <- N - I - R\ny <- c(S=S, I=I, R=R)\n\n# Next we integrate for 20 weeks.\nweeks <- seq(0, 20, by=0.01)\nout1 <- data.frame( ode(y, weeks, SIRd, parms) )\nout2 <- pivot_longer(out1, cols=S:R, names_to=\"Host\", values_to=\"N\")\nggplot(out2, aes(time, N, linetype=Host)) + geom_line() + labs(x=\"Weeks\")"},{"path":"disease.html","id":"frequency-dependent-transmission","chapter":"10 Disease","heading":"10.1.2 Frequency-dependent transmission","text":"addition density-dependent transmission, investigators used forms density dependence. One common typically known frequency–dependent transmission, transmission depends prevalence, frequency infecteds population, \\(/N\\).\n\\[\\begin{align}\n  \\frac{d S}{d t} &= - \\beta \\frac{SI}{N} \\tag{10.4}\\\\\n  \\frac{d }{d t} &=   \\beta \\frac{SI}{N} - \\gamma \\tag{10.5}\\\\\n  \\frac{d }{d t} &=   \\gamma . \\tag{10.6}\n\\end{align}\\]create function system ODEs eq. .proper form transmission function depends mode transmission (McCallum, Barlow, Hone 2001). Imagine two people elevator, one sick (infected), one healthy susceptible, sick individual sneezes (S. P. Ellner Guckenheimer 2006). results particular probability, \\(\\beta\\), susceptible individual gets infected. Now imagine resistant individuals get elevator—adding resistant individuals change probability susceptible individual gets infected? Note changed. First, addition resistant individual, \\(N\\) increased, prevalence, \\(/N\\), decreased. However, densities \\(\\) \\(S\\) remain (1 per elevator). might happen? least two possible outcomes:sufficient amounts virus spread evenly throughout elevator, adding resistant individual change probability susceptible becoming sick, rate spread remain dependent densities \\(\\) \\(S\\)—rate vary declining prevalence.immediate neighbor gets exposed pathogen, probability neighbor susceptible declines increasing \\(R\\), thus rate spread decline declining prevalence.fairly easy imagine different scenarios, important justify form function. Density- frequency-dependent transmission two common caricatures.frequency–dependent transmission imply dynamics? Let’s solve \\(dI / dt > 0\\).\n\\[\\begin{align}\n  \\tag{10.7}\n  0 &< \\beta \\frac{SI}{N} - \\gamma \\notag\\\\\n  \\gamma &< \\beta \\frac{S}{N}.\n\\end{align}\\]\n, let’s consider pre-outbreak situation \\(S \\approx N\\), \\(S/N \\approx 1\\). case, basic reproductive rate \\(R_0=\\beta/\\gamma\\), independent \\(N\\). outbreak occur long \\(\\beta > \\gamma\\), regardless population density. direct contrast density-dependent transmission model ((10.4), (10.5)), outbreak prevented simply reduce population, \\(N\\), sufficently low density. modes transmission observed human non-human populations, important understand disease spread order predict dynamics.Another interesting phenomenon frequency–dependent transmission prevalence (\\(/N\\)) can decline increasing population size (Fig. ??). Two phenomena contribute pattern. First, outbreak completely susceptible population typically begins single individual, initial prevalence always \\(/N=1/N\\). Second, consequence , transmission rate lower larger populations \\(\\beta SI/N\\) small. consequence, prevalence remains low relatively long time. seasonal population, individuals large populations remain uninfected four months. Depending upon organism, long enough reproduce. contrast, density–dependent model typically shows oppositive, pattern, rapid, extreme outbreaks greater prevalence dense populations (Fig. ??).SIR dynamics frequency–dependent transmission (Fig. (fig:sirFD)).demonstrate prevalence can decline increasing population size frequency–dependent disease (e.g., smut plant (Antonovics Alexander 1992)). Let us assume resistance acquired, \\(\\gamma=0\\), \\(R = 0\\). can investigate SIR model pretending , often case, begin largely uninfected population \\(t=0\\), \\(I_0=1\\) \\(S_0\\approx N\\). first set parameters.next integrate six months, letting \\(R=S/2\\).Last, make figures.","code":"\nSIRf <- function(t, y, p) {\n  {\n        S <- y[1]\n        I <- y[2]\n        R <- y[3]\n        N <- S + I + R\n    }\n  with( as.list(c(y,p)), {\n    dS.dt <- -B*I*S/N\n    dI.dt <- B*I*S/N - g*I\n    dR.dt <- g*I\n   return( list(c(dS.dt, dI.dt, dR.dt)) )\n  } )\n}\nR <- 0; S <- I <- 1000; Ss <- Is <- seq(1, S, length=11); N <- S+I+R\nbetaD <- 0.1; betaF <- betaD*N\n\n# sapply will calculate the transmission functions for each combination of\n# the values of $I$ and $S$.\nmat1 <- sapply(Is, function(i) betaD * i * Ss)\nmat2 <- sapply(Is, function(i) betaF * i * Ss / (i + Ss + R) )\n# Now we plot these matrices. \n\n{\n  layout(matrix(1:2, nr=1))\npersp(mat1, theta=20, phi=15, r=10, zlim=c(0,betaD*S*I), \n      main=\"Density Dependent\",\n      xlab=\"I\", ylab=\"S\", zlab=\"Transmission Rate\")\npersp(mat2, theta=20, phi=15, r=10, zlim=c(0,betaF*S*I/N), \n      main=\"Frequency Dependent\",\n      xlab=\"I\", ylab=\"S\", zlab=\"Transmission Rate\")\n}\nS <- 4^(0:4);  I <- 1; parmsf <- c(B=1, g=0); parmsd <- c(B=1/16, g=0)\nMonths <- seq(0, 8, by=0.1)\noutd <- sapply(S, function(s) {out <- ode(c(s,I,R), Months, SIRd, parmsd)\n                               out[,3]/apply(out[,2:4], 1, sum) } )\noutf <- sapply(S, function(s) {out <- ode(c(s,I,R), Months, SIRf, parmsf)\n                               out[,3]/apply(out[,2:4], 1, sum) } )\n#TR <- sapply(S, function(s) {R <- s/2; parmsf[\"B\"]*s*I/(s+I+R)})\nmatplot(Months, outd, type='l', col=1, ylab=\"Prevalence (I/N)\")\nmatplot(Months, outf, type='l', col=1, ylab=\"Prevalence (I/N)\")\nlegend('bottomright', legend=S, lty=1:length(S),  bty='n')\n#plot(S, TR)"},{"path":"disease.html","id":"open-epidemics","chapter":"10 Disease","heading":"10.2 Open epidemics","text":"model assumes constant population size. expand include population growth death unrelated disease (Fig. 10.1).\nFigure 10.1: Conceptual model open epidemic. ’ll let lambda migration births, mu mortality. Births may come group.\nget specific, add births, \\(b\\), potentially types, sick (\\(S++R\\)), assume newborns susceptible . also add mortality term group (\\(\\mu S,\\,\\mu ,\\,\\mu R\\)).\n\\[\\begin{align}\n  \\tag{10.8}\n  \\frac{d S}{d t} &= b \\left( S++R \\right) - \\beta SI - \\mu S\\\\\n  \\frac{d }{d t} &=\\beta SI  - \\gamma - \\mu \\\\\n  \\frac{d R}{d t} &= \\gamma - \\mu R\n\\end{align}\\]\nNote births add susceptible group, whereas density independent mortality subtracts group.Disease model population growth\ncreate function system ODE’s (10.8).Let’s start work model—frequently means making simplifying assumptions. might start assuming infected resistant individuals can contribute offspring, disease relatively benign. Therefore, can assume mortality groups (\\(\\mu_i= \\mu\\)). ’ll also assume () constant population size. means birth rate equals mortality \\(b=\\mu\\).add additional complexity allowing transmission partially frequency dependent. introduce scaling parameter \\(z\\), transmission \n\\[\\beta \\frac{S}{N^z}\\]\n\\(z=0\\) pure density dependence, \\(z=1\\) pure frequency dependence.Note let \\(z,\\, b,\\, \\mu =0\\), simplest SIR model bagn chapter.Now imagine large city, say, million people. Let’s assume start population virtually susceptible people, introduce single infected person.Let us pretend disease runs course 10–14 days. Recall \\(\\gamma\\) (gamma) inverse duration disease.Given constant population size exponential growth, average life span inverse birth rate. Let us pretend average life span 50 years.model, force infection turns \\(R_0 = 1 + 1 / \\left(b + \\alpha\\right)\\), \\(\\alpha\\) average age onset disease (S. P. Ellner Guckenheimer 2006). can therefore estimate \\(\\beta\\) parameters, including population size, average life span, average age onset, average duration disease. instance, imagine disease children, average onset disease 5,y, haveso \\(\\beta\\) becomesFinally, can integrate population states. create named vector parameters, decide time interval.turns relatively extreme dynamics (Fig. 10.2), want tell ODE solver take baby steps, properly capture dynamics—use hmax argument make sure maximum step takes relatively small.\nFigure 10.2: Epidemic nonlethal disease, SIR model includes births deaths, constant population size.\nNote population quickly becomes resistant (Fig. 10.2). Note also oscillations, albeit damped oscillations. analytical treatment model, including eigenanalysis Jacobian matrix show us precisely predicted periodicity (S. P. Ellner Guckenheimer 2006). depends age onset, duration disease.","code":"\nA <- matrix(NA, nrow=7, ncol=7)\na <- matrix(c( 2,1, 3,2, 4,3, 5,2, 6,3, 7,4), ncol=2, byrow=TRUE)\nA[a] <- 1\nplotmat(A, pos=c(4,3), box.type=c('none', 'square','square','square','none','none','none'), curve=0,\n        arr.pos=.6, segment.from=.1, segment.to=.9,\n        relsize=.8, dtext=NA, box.size=.05,\n        name=c(expression(lambda), 'S', 'I', 'R', \n               expression(mu),\n               expression(mu),\n               expression(mu))) \nSIRmod <- function(t, y, p) {\n  S <- y[1]; I <- y[2]; R <- y[3]; N <- sum(y)\n  with( as.list(p), {\n    dS.dt <- b*N - B*I*S/N^z - mu*S\n    dI.dt <- B*I*S/N^z - g*I - mu*I\n    dR.dt <- g*I - mu*R\n   return( list(c(dS.dt, dI.dt, dR.dt)) )\n  } )\n  }\nN <- 10^6\nR <- 0; I <- 1; S <- N - I - R\ng <- 1/(13/365)\nb <- 1/50\nage <- 5\nR0 <- 1 + 1/(b*age)\nB <- R0 * (g + b) / N\nparms <- c(B = B, g = g, b = b, mu=b, z=0)\nyears <- seq(0,30, by=.1)\nout <- data.frame(ode(c(S=S,I=I,R=R), years, SIRmod, parms, hmax=.01)) \nSIRbd.out <- pivot_longer(out, cols=2:4, names_to=\"Populations\", values_to=\"Density\")\nggplot(SIRbd.out, aes(time, Density+1, colour=Populations)) + \n  geom_line() + scale_y_log10() + xlab('Years')"},{"path":"disease.html","id":"modeling-data-from-bombay","chapter":"10 Disease","heading":"10.3 Modeling data from Bombay","text":"try hand fitting SIR model data. Kermack McCormick ?? provided data number plague deaths per week Bombay59 1905–06. first enter look .60\nFigure 10.3: Cumulative deaths plague, Bombay, India, 1905–1906 (raw data fitted model, described section).\nenterprises, wish knew far depends fleas, rodents, humans, Yersinia pestis dynamics depend. squeeze real-life scenario model small number parameters requires assumptions.%begin assuming, Kermack Mckendrick , mortality bubonic plague, Bombay, 1905, quite high, close 90%. Next, realize data deaths. Given, however, mortality high, might approximate number infections saying Deaths = 0.9 \\(\\times\\) Infections.good starting place simple SIR model population constant size (10.1) (S. P. Ellner Guckenheimer 2006; Kermack McCormick 1927).","code":"\ndata(ross)\nqplot(x=Week, y=CumulativeDeaths, data=ross)"},{"path":"disease.html","id":"optimization","chapter":"10 Disease","heading":"10.3.1 Optimization","text":"next want let R find accurate estimates model parameters \\(\\beta,\\,\\gamma\\). best accessible reference Bolker (2008). Please read Appendix (moment, available request) explanation regarding optimization objective functions.Now create objective function. objective function compares model data, calculates measure fit (e.g., residual sum squares likelihood). objective function calculate likelihood61 particular values SIR model parameters. parameters include \\(\\gamma\\) \\(\\beta\\) SIR model. also estimate \\(I_0\\), initial size infected population \\(t=0\\). survey easily accessed census data suggests population time neighborhood \\(\\sim 9.5 \\times 10^5\\) individuals. also might assume \\(I_0\\) small number, perhaps \\(\\sim 1\\) principle, use . really like estimate \\(N\\) \\(I_0\\), ’ll save another day.details objective function:Arguments transformed parameters (allows optimizer work logit62 log scales).Transformed parameters backtransformed scale model.Parameters used integrate ODEs using ode, retaining resistant (.e. dead) group (fourth column output); provides predicted values given parameters time onset, standard deviation residuals around predicted values.returns negative log-likelihood data, given parameter values.objective function. Note last value negative sum log-probabilities data (given particular realization model).use function, sirLL, find likelihood best parameters. mle2 function bbmle library63 minimize negative log-likelihood generated sirLL, return values parameters interest.use robust, relatively slow method called Nelder-Mead (default). supply mle2 objective function list initial parameter values. can take minutes, ’s okay.Let’s look summary fit, far went. get.gets us parameter estimates, probably accurate computer couldn’t settle thought stable solution (convergence failure. occurs frequently ask computer estimate many, often correlated, parameters given data set. Therefore, make assumptions regarding selected parameters. Let us assume time two variable estimates correct, population size vulnerable population approximately exp(rround(coef(fit)[3],1)) number infections onset outbreak 9.6. hold constant ask R refit model, using default method.Next want find confidence intervals \\(\\beta\\) \\(\\gamma\\). can take several minutes, results likelihood profile parameters, show confidence regions parameters (Fig. 10.4).\nFigure 10.4: likelihood profile plots show us confidence intervals transformed SIR model parameters.\nLast get plot curve data. first backtransform coefficients objective function.get ready integrate disease dynamics time period.Last, plot model data (Fig. )., mean (Fig. 10.3? might check values mean, know reality. model predicts logit \\(\\gamma\\) confidence interval,corresponds confidence interval \\(\\gamma\\) ofRecall duration disease host \\(1/\\gamma\\). Therefore, model predicts confidence interval duration (days) ofThus, based analysis, duration disease 9.5 days. seems agree know biology Bubonic plague. duration, human host, typically thought last 4–10 days.","code":"\nsirLL=function(logit.B, logit.g, log.I0, log.N) {\n  #parameters\n  parms <- c(B=plogis(logit.B), g=plogis(logit.g));\n  # starting point\n  x0 <- c(S=exp(log.N), I=exp(log.I0), R=0)\n  # solve\n  Rs <- ode(y=x0, ross$Week, SIRd, parms, hmax=.01)[,4]\n  # calculate the root mean squared error of the fit\n  SD <- sqrt( sum( (ross$CumulativeDeaths - Rs)^2)/length(ross$Week) )\n  # calculate the negative loglikelihood\n   -sum(dnorm(ross$CumulativeDeaths, mean=Rs, sd=SD, log=TRUE))\n}\nlibrary(bbmle)\n# we used fixed to fix N and I0 to particular values and not estimate them.\nfit <- mle2(sirLL, start=list(logit.B=qlogis(1e-5), logit.g=qlogis(.2), \n                     log.N=log(9.5e5), log.I0=0), \n                     method=\"Nelder-Mead\") \nsummary(fit)## Length  Class   Mode \n##      1   mle2     S4\nfit2 <- mle2(sirLL, start=as.list(coef(fit)[1:2]),\n            fixed=list(log.N=coef(fit)[4], log.I0=coef(fit)[3]), method=\"BFGS\")\nsummary(fit2)\npr2 <- profile(fit2)\npar(mar=c(5,4,4,1))\nplot(pr2)\np <- as.numeric(c(plogis(coef(fit)[1:2]),\n       exp(coef(fit)[3:4])) ); p## [1] 8.018462e-05 7.364288e-01 2.992425e+00 1.461884e+04\ninits <- c(S = p[4], I=p[3], R=0)\nparams <- c(B=p[1], g=p[2])\noutdf <- data.frame( ode(inits, ross$Week, SIRd, params) )\nsir.Bombay <- pivot_longer(data=outdf, 2:4, names_to=\"Populations\", values_to=\"Density\")\nggplot(sir.Bombay, aes(time, Density, colour=Populations)) + geom_line() + \n  geom_point(data=ross, \n             mapping=aes(x=Week, y=CumulativeDeaths), \n             inherit.aes=FALSE )\n# inherit.aes=FALSE tells geom_point not color by \"Populations\" \n(CIs <- confint(pr2))##              2.5 %    97.5 %\n## logit.B -9.4425402 -9.416570\n## logit.g  0.9659977  1.114912\n(gs <- as.numeric(plogis(CIs[2,]) ))## [1] 0.7243210 0.7530437\n7*1/gs## [1] 9.664223 9.295610"},{"path":"consumer-resource-competition-and-mutualisms.html","id":"consumer-resource-competition-and-mutualisms","chapter":"11 Consumer-resource Competition and Mutualisms","heading":"11 Consumer-resource Competition and Mutualisms","text":"earlier chapter, used Lotka-Volterra models competition mutualism learn fundamental properties (-,-) (+,+) interactions. add model complexity illustrate mechanistic approach modeling greater biological reality.Chapter 8, consumer-resource interactions, learned variety approaches representing different types resources prey, different ways consumers consume . Please read chapter 8 proceeding . lot terms parameters use fully explained Chapter 8.","code":""},{"path":"consumer-resource-competition-and-mutualisms.html","id":"competition-for-one-resource","chapter":"11 Consumer-resource Competition and Mutualisms","heading":"11.1 Competition for one resource","text":"Let’s imagine competition two species shared limiting inorganic resource,\n\\[\\frac{dN_1}{dt}= N\\left(e_1a_1R - d_1\\right)\\]\n\\[\\frac{dN_2}{dt}= N_2\\left(e_2a_2R - d_2\\right)\\]\n\\(e\\) assimilation efficiency, \\(\\) consumption rate, \\(d\\) mortality. can see, two species interact directly–\\(N_2\\) expression \\(dN_1/dt\\) vice versa.expression \\(dR/dt\\) includes renewing resource,\n\\[\\frac{dR}{dt} = r(S-R) - e_1a_1N_1R - e_2a_2N_2R\\]\n\\(S\\) background resource supply rate, \\(r\\) resource renewal rate.graph mass-specific per capita growth rates functions resource concentrations. curves simply,\n\\[y = e_ia_i x - d_i\\]\n\\(y\\) per capita mass-specific growth rate (dN/dt), \\(x\\) resource concentration density (\\(R\\)).\nFigure 11.1: Mass-specific growth rates two species across range resource concentrations. Note growth rates equal death rates, consumer growth zero (arrows) determines species’ \\(R^*\\)s.\ncan calculate equilibrium resource concentration species create , \\(R^*\\)s. Recall find setting species per capita growth rates zero, solving \\(R\\).Fig. 11.1, see high resource concentrations, species 1 grows faster species 2. However, low resource concentrations, species 2 grows faster species 1. Resource concentrations change consumers take resources, whole system reach equilibrium?species (Fig. 11.1) increase biomass long resources high enough allow growth, whereas resources decline consumers grow take increasing amounts resources. Eventually consumer biomass high enough drive resources low mass-specific growth rate zero. happen different resource concentrations two species. see species 2 positive growth rate species 1 (Fig. 11.1). type resource competition single limiting resource named \\(R^*\\) rule (“R-star”):species lowest \\(R^*\\) shared limiting resource exclude others.refer type resource competition \\(R^*\\) competition.can create model integrate dynamics three components.Now run model.Now like, can find \\(N_2^*\\) \\(R^*=d_2/(e_2a_2)\\), \\(N_1 =0\\).\n\\[\\frac{dR}{dt} = 0 = r\\left(S-R\\right) - a_2N_2R\\]\nSubstituting \\(R^*\\) \\(R\\) gives us solution:\\[N^*_2 = r\\left(S\\frac{e_2}{d_2} - \\frac{1}{a_2}\\right)\\]\nclear expression increasing death rate (\\(d\\)) drive \\(N^*_2\\). However, increasing resource turnover rate, \\(b\\), assimilation efficiency, \\(e\\), uptake rate, \\(\\), cause \\(N_2^*\\) increase.model, per capita growth rates linear functions resource concentration. common use type II functional response consumers (Tilman 1982) (Fig. 11.2), described Chapter 8.\n\\[\\frac{dN_i}{Ndt}= b_i\\frac{R}{k_i + R} - d_i\\]\nFigure 11.2: Monod function per capita resource-dependent growth rates two different populations. type II functional responses.\nsaw earlier linear mass-specific growth rates, one species lower \\(R^*\\) , model predicts -compete .","code":"\ne1 <- 0.1; a1 <- 1; d1 <- 0.3\ne2 <- 0.1; a2 <- .5; d2 <- 0.1\n\n{\n  # setting the margins of the plot\n  par(mar=(c(5, 4,.5,.5)))\n  \n  # making the graph\n  curve(e1*a1*x - d1, 0,10, ylab=\"dN/(Ndt)\", xlab=\"Resource concentration\")\n  curve(e2*a2*x - d2, lty=2, col=2, add=TRUE)\n  abline(h=0, lty=3)\n  legend(\"topleft\", c(\"Sp. 1\", \"Sp. 2\"), lty=1:2, col=1:2, bty='n')\n  \n  #adding the arrows\n  x1 <- d1/(e1*a1); x2 <- d2/(e2*a2); len <- 0.1\n  arrows(c(x1,x2), c(-len, len), c(x1,x2), c(0,0), length=0.1)\n  }      \nR.star.sp1 <- d1/(e1*a1)\nR.star.sp2 <- d2/(e2*a2)\nc(R.star.sp1, R.star.sp2)## [1] 3 2\ncr_2plants  <- function(t,y,p){\n  N1 <- y[1]; N2 <- y[2]; R <- y[3]\n  with(as.list(p),{\n    dN1 <- N1*(e1*a1*R - d1)\n    dN2 <- N2*(e2*a2*R - d2)\n    dR <- r*(S-R) - a1*N1*R - a2*N2*R\n    return(list(c(dN1,dN2,dR)))\n  } )\n}\nt <- seq(0, 100, by=.5)\np <- list(e1=0.1, a1=1, d1=0.3, \n          e2=0.1, a2=.5, d2=0.1,\n          S=5, r=1)\n\ny.initial <- c(N1=.1, N2=.1, R=4)\nrout <- ode(y=y.initial, time=t, fun=cr_2plants, parms=p)\nr.long <- rout %>% as.data.frame %>% pivot_longer(cols=-time, names_to = \"State\", values_to = \"Grams\")\nggplot(data=r.long, aes(time, Grams, colour=State, linetype=State)) + \n  geom_line() \nb <-c(1, .5); k=c(5, .1); d = 0.3\n{curve(b[1]*x/(k[1]+x) - d, 0, 10, ylab=bquote(dP/(Pdt)), xlab=\"R\")\ncurve(b[2]*x/(k[2] + x) - d, lty=2, add=TRUE)\nabline(h=0, lty=3); text(7.5, 0, \"gain = loss\", adj=c(.5, -.3))\n}"},{"path":"consumer-resource-competition-and-mutualisms.html","id":"competition-for-substitutable-resources","chapter":"11 Consumer-resource Competition and Mutualisms","heading":"11.2 Competition for Substitutable resources","text":"two species, \\(N_1\\) \\(N_2\\), competing two shared substitutable resources, \\(R_1,\\,R_2\\), identify \\(e_{ij}\\) \\(a_{ij}\\), \\(e\\) assimilation efficiency, \\(\\) feeding rate. now two subscripts, \\(\\) refers consumer species \\(N_{}\\), \\(j\\) refers either resource 1 2 (\\(R_1\\), \\(R_2\\)). , following relations.\\[\\frac{dN_1}{dt}= N_1\\left(e_{11} a_{11} R_1 + e_{12} a_{12} R_2 - d_1\\right)\\]\n\\[\\frac{dN_2}{dt}= N_2\\left(e_{21} a_{21} R_1 + e_{22} a_{22} R_2 - d_2\\right)\\]\\[\\frac{dR_1}{dt}= r_1\\left(S-R_1\\right) - a_{11}N_1R_1 - a_{21}N_2 R_1\\]\n\\[\\frac{dR_2}{dt}= r_2\\left(S-R_2\\right) - a_{12}N_1R_2 - a_{22}N_2R_2\\]\\(a_i\\) per capita feeding rate consumer resource, \\(e_i\\) efficiency consumer converts unit resource new biomass, \\(d_i\\) per capita death rate consumers, \\(S\\) background supply rate resoure, \\(r(S-R)\\) turnover rate resources part available \\(R\\) pool.differential feeding rates, \\(a_{i1}\\) \\(a_{i2}\\), tell us lot relative requirements limitations experienced two consumers. \n\\[a_{i1} > a_{i2}\\]\n, else equal, species \\(\\) requires \\(R_1\\) \\(R_2\\) environment.create R function 4-D system ODEs.Next create parameter set species 1 grows unit \\(R_1\\) also consumes \\(R_2\\).\n(#fig:cr_2x2)Initial dynamics two species competing two shared substitutable resources. Species 1 uses resource 1 efficiently resource 2 also consumes , per capita. Conversely, species 2 uses resource 2 efficiently resource 1 also consumes per capita.\n","code":"\n## \ncr_2substitutable <- function(t, y, parameters){\n  N1 <- y[1] ; N2 <- y[2] ; R1 <- y[3]; R2 <- y[4]; \n  with(as.list(parameters), {\n    N1.dot <- N1 * ( e11*a11*R1 + e12*a12*R2  - d1 )\n    N2.dot <- N2 * ( e21*a21*R1 + e22*a22*R2  - d2 )\n    R1.dot <- r1 * (S1 - R1) - (a11*N1 + a21*N2)*R1\n    R2.dot <- r2 * (S2 - R2) - (a12*N1 + a22*N2)*R2\n    return( list(c(N1.dot, N2.dot, R1.dot, R2.dot)) )\n  } )\n}\nparameters <- c(# the environment supplies slightly more of resources 1\n                r1 = 1, r2=1, S1=1.8, S2=1.2, \n                # sp 1 grows more with each unit of R1\n                # sp 2 grows more with each unit of R2\n                e11=.1, e12=.1, e21=.1, e22=.1,\n                # sp 1 consumes more R1 than R2 and more than sp 2\n                # sp 2 consumes more R2 than R1 and more than sp 1\n                a11=2, a12=1, a21=1, a22=2, \n                # both spp die at the same rate\n                d1=.1, d2=.1)\nt <- seq(0, 20, by=.1); y.init <- c(N1=1, N2=1, R1=1.8, R2=1.2)\nout <- ode(y = y.init, times=t, func=cr_2substitutable, \n           parms=parameters)\noutL <- out %>% as.data.frame %>% pivot_longer(-time, names_to=\"State_vars\", values_to=\"abun.\")\nggplot(outL, aes(time, abun., colour=State_vars)) + geom_line()\noutput <- cr_2subst_graph(parameters)"},{"path":"consumer-resource-competition-and-mutualisms.html","id":"tilmans-resource-ratio-with-essential-resources","chapter":"11 Consumer-resource Competition and Mutualisms","heading":"11.3 Tilman’s resource ratio with essential resources","text":"Coefficients reflect resources 1 2, species \\(\\).\\(a_i\\) = relative resource production rate\\(e_{ij}\\)\\[ \\dot{R_1} = a_1\\left(S_1-R_1\\right) - \\left( \\dot{N_1} + m_1 \\right) - \\left( \\dot{N_2} + m_2 \\right)\\]\n\\[ \\dot{R_2} = a_2\\left(S_2-R_2\\right) - \\left( \\dot{N_1} + m_1 \\right)  - \\left( \\dot{N_2} + m_2 \\right) \\]\\[\\dot{N_1} = r_1 \\,\\mathrm{MIN}\\left(e_{11}c_{11}\\frac{R_1}{k_{11} + R_1} \\, , \\, e_{12}c_{21}\\frac{R_2}{k_{21} + R_1}\\right) - m_1\\]\\[\\dot{N_2} = r_2 \\,\\mathrm{MIN}\\left(e_{21}c_{12}\\frac{R_1}{k_{12} + R_1} \\, , \\, e_{22}c_{22}\\frac{R_2}{k_{22} + R_1}\\right) - m_2\\]\\[R_{j}^* = \\frac{k_{ji}m_i}{r_i-m_i}\\]","code":"\n## Something is not right here\nresratio <- function(t, y, parameters){\n  R1 <- y[1]; R2 <- y[2]; N1 <- y[3] ; N2 <- y[4] ;\n  with(as.list(parameters), {\n    N1.dot <- r1 * N1 * ( min( c( c11*R1/(k11 + R1), c21*R2/(k21 + R2) ) ) - m1 )\n    N2.dot <- r2 * N2 * ( min( c( c12*R1/(k12 + R1), c22*R2/(k22 + R2) ) ) - m2 )\n    ## R.dot must follow N.dot if we use N.dot in R.dot\n    R1.dot <- a1 * (S1 - R1) - \n      r1 * N1 * ( min( c( c11*R1/(k11 + R1), c21*R2/(k21 + R2) ) ))/e11 - \n      r2 * N2 * ( min( c( c12*R1/(k12 + R1), c22*R2/(k22 + R2) ) ))/e12 \n    R2.dot <- a2 * (S2 - R2) - \n      r1 * N1 * ( min( c( c11*R1/(k11 + R1), c21*R2/(k21 + R2) ) ))/e21 - \n      r2 * N2 * ( min( c( c12*R1/(k12 + R1), c22*R2/(k22 + R2) ) ))/e22 \n    return( list(c(R1.dot, R2.dot, N1.dot, N2.dot)) )\n  } )\n}\n\nparameters <- c(a1 = 1, a2=1, S1=10, S2=10, \n                r1=1, r2=1, m1=.1, m2=.1, \n                c11=1, c21=1, c12=1, c22=1, \n                k11=.1, k21=1, k12=1, k22=.1,\n                e11=.1, e21=.1, e12=.1, e22=.1)\n\nwith(as.list(parameters),{\n  curve(r1*c11*x/(k11 + x)-m1, 0, 3, xlab=expression(\"R\"[\"j\"]), \n        ylab=expression(\"r\"[\"i\"]*\"c\"[\"i\"]*\"R\"[\"j\"] /( \"k\"[\"ji\"] + \"R\"[\"j\"]) - \"m\"[\"i\"] ) )\n  curve(r1*c21*x/(k21 + x)-m1, 0, 3, add=T, lty=2)\n  curve(r2*c12*x/(k12 + x)-m2, 0, 3, col=4, add=T)\n  curve(r2*c22*x/(k22 + x)-m2, 0, 3, add=T, col=4, lty=2)\n  abline(h=0, lty=3)\n  legend('right', c('N1(R1)', 'N1(R2)', 'N2(R1)', 'N2(R2)'), \n         lty=c(1,2,1,2), col=c(1,1,4,4), lwd=2, bty='n')\n})\nt <- 0:100\ny0 <- c(R1=.5, R2=.5, N1=10, N2=10)\nrun1 <- ode(y=y0, times=t, func=resratio, parms=parameters)\nparameters; plot(run1)##   a1   a2   S1   S2   r1   r2   m1   m2  c11  c21  c12  c22  k11  k21  k12  k22 \n##  1.0  1.0 10.0 10.0  1.0  1.0  0.1  0.1  1.0  1.0  1.0  1.0  0.1  1.0  1.0  0.1 \n##  e11  e21  e12  e22 \n##  0.1  0.1  0.1  0.1\nrun1[101,]##        time          R1          R2          N1          N2 \n## 100.0000000   0.1111048   0.1111048   4.9447001   4.9447001"},{"path":"consumer-resource-competition-and-mutualisms.html","id":"consumer-resource-mutualism","chapter":"11 Consumer-resource Competition and Mutualisms","heading":"11.4 Consumer-resource mutualism","text":"section, model mutualisms using framework , unlike Lotka-Volterra approach, intended specifically describe resource consumption one partners (MacArthur 1972).\nFigure 11.3: Bidirection, unidirectional, indirect mutualisms. Normal arrowhead positive effect, whereas open dot arrowhead negative effect. dashed line indicates service, solid line indicates consumable resource.\ncases, mutualists may share services, moray\neel-grouper foraging. particular case, grouper giant\nmoray eel different foraging strategies, eel going \nreef crevices grouper waiting outside pick prey \nescape eel (Bshary et al. 2006). Sometimes mutualisms \ncalled -product mutualisms, cases \nevidence coordinated behavior, nonetheless mutualism arises via independent activities species.following, explore type mutualism one\nspecies provides resource species provides \nservice (Fig. 11.3). uni-directional mutualism flow resources unidrectional, one species (Holland Deangelis 2010).good example uni-directional mutualism seed dispersal via\nfrugivore disperses seeds. plant species provides \nfruit nutritious animal. primary benefit \nplant seeds carried away parent plant. may\nhelp seeds escape enemies accumulate near parent plants\n(Connell-Janzen hypothesis). addition, provides bet hedging\nopportunity wherein seeds dispersed variety habitats \none may better survival current location. \neven possible dispersal directed preferred\nhabitat consistently better parent plant due \nbetter resource levels environmental conditions\n(Wenny Levey 1998). animal benefits consuming fleshy part \nfruit surrounding seed. interesting case arises seed\npredators collect seeds kill buried,\ncached, moved seeds.Another important example example type mutualism pollination. Pollinators (bats, insects, birds) receive resources (nectar, pollen) provide services (pollination, gene flow).","code":""},{"path":"consumer-resource-competition-and-mutualisms.html","id":"a-model-of-uni-directional-mutualism","chapter":"11 Consumer-resource Competition and Mutualisms","heading":"11.4.1 A model of uni-directional mutualism","text":"describe model facultative unidirectional mutualism uses type II foraging model consumption resource provision service.growth equation plant species, \\(M_1\\), includes logistic growth, terms benefit receives mutualist frugivore cost paid frugivore.\\[\\frac{dM_1}{dt} = r_1 M_1\\left(1-d_1M_1\\right)  - aM_2\\left(\\frac{M_1}{h_1 + M_1}\\right) + sM_1\\left(\\frac{M_2}{h_2 + M_2}\\right)\\]plant species (\\(M_1\\)) grows logistically absence fruit consumption seed dispersal \\(r_1 M_1\\left(1-d_1M_1\\right)\\). Consumption fruits governed type II functional response frugivore \\(aM_2\\left(\\frac{M_1}{h_1 + M_1}\\right)\\), consumption rate single frugivore upper limit (Fig. 11.4). Successful seed dispersal establishment also governed type II functional response. success single seed reaches upper limit number frugivores continues increase, \\(c_1M_1\\left(\\frac{M_2}{h_2 + M_2}\\right)\\) (Fig. 11.4).\nFigure 11.4: Fruit consumption single frugivore governed type II functional response fruit abundance increases. Successful seed dispersal establishment governed type II functional response frugivores increase.\ngrowth equation frugivore species, \\(M_2\\), includes logistic growth, one term benefit gained plant.\\[\\frac{dM_2}{dt} =  r_2M_2\\left(1-d_2M_2\\right) + eaM_2\\left(\\frac{M_1}{h_1+M_1}\\right) \\]\nanimal seed disperser grows logistically absence consuming particular plant species \\(r_2M_2\\left(1-d_2M_2\\right)\\). animal benefits consuming fruit attacks rate \\(M_1\\), \\(aM_2\\left(\\frac{M_1}{h_1+M_1}\\right)\\), converts fruit new individuals efficiency \\(e\\).consumption > service = net predationservice > consumption = net mutualismHere provide code ODE complete bidirectional mutualism. define parameters, set equal zero represents unidirectional consumer-resource mutualism.parameters, graph time series.dynamics can result multiple basins attraction alternative stable states (Fig. 11.5).\nFigure 11.5: resource-service mutualism may result alternative stable states. species achieve moderate abundance, species increase toward stable mutualism. However, frugivore abundant relative plant, consumption dominates interaction drives equilibrium mutualism.\nHolland DeAngelis (2009) vary \\(a_{21}\\) \\((0.25,\\ldots,\\,0.4)\\) vary relation mutualism predation. Try now. Save picture results.","code":"\nggplot(data.frame(x=c(0, 1)), aes(x=x) ) + \n  stat_function(fun=function(x) { 10*x/(1+10*x) }) +\n  labs( x=\"Fruit abundance\", y=\"Consumption Rate of a frugivore\")\n\n\nggplot(data.frame(x=c(0, 1)), aes(x=x) ) + \n  stat_function(fun=function(x) { 10*x/(1+10*x) }) +\n  labs( x=\"Frugivore abundance\", y=\"Dispersal rate of a seed\")\n# The derivative \n## A two-species consumer-resource mutualism\n## Holland and DeAngelis 2009, Ecology Letters Ecology Letters, 12: 1357–1366.\n## The parameterization follows that in this article. It differs from those \n## in the above equations. Can you see the differences?\n\ncr_bimut <- function(t,y,parameters) {\n  M1 <- y[1] # \n  M2 <- y[2] # \n  with( as.list( parameters ), {\n    dM1 <- M1 * (r1 - d1*M1 + a12*M2/(h2 + M2) - B1*M2/(e1+M1) )\n    dM2 <- M2 * (r2 - d2*M2 + a21*M1/(h1 + M1) - B2*M1/(e2+M2) )\n    list( c( dM1, dM2 ))\n  }\n  )\n}\n### These parameters create a unidirectional, resource-service mutualism (B2 = 0)\n## Translating, a12 = a above, and a21 = ea above, and B1 = s above\n## therefore e = a21/a12\n\np.u <- list(r1 = 1, r2 = 1, d1=0.01, d2=0.01, \n            a12 = 0.4, a21 = 0.25, B1 = 0.3, B2 = 0, \n            h1=0.3, h2=0.3, e1=0.3, e2=0.3)\n\n#####\n# times series\nt <- seq(0,25, by=.1)\ny <- c(M1=50, M2=1)\n\nout <- ode(y=y, times=t, func= cr_bimut, parms=p.u)\noutdf <- data.frame(out)\noutL <- pivot_longer(outdf, -time, \n                     names_to=\"State_var\", values_to=\"N\")\nggplot(outL, aes(time, N, colour=State_var)) + geom_line()"},{"path":"consumer-resource-competition-and-mutualisms.html","id":"plant-soil-feedbacks","chapter":"11 Consumer-resource Competition and Mutualisms","heading":"11.5 Plant-soil feedbacks","text":"Vascular plants form basis terrestrial\necosystems, live intimate contact diverse\ngroup organisms Earth–soil microbes. Ecologists \nbegun focus intimate relationship, Jim Bever (Bever 2003) \none ecologists helping lead way (Fig. 11.6).\nFigure 11.6: Plants soil microbes can interact negative positive ways. Plants may grow poorly soil flora competitor’s.\nFig. 11.6 reflects following Lotka-Volterra style model plant species \\(N_A\\) \\(N_B\\), soil microbial floras \\(S_A\\) \\(S_B\\):\n\\[\\begin{equation}\n\\frac{dN_A}{dt} = r_A N_A \\left( 1 + \\alpha_A S_A + \\beta_A S_B -\n                                   \\frac{N_A + c_B N_B}{K_A}\\right) \n\\end{equation}\\]\neffects microbes (\\(\\alpha\\), \\(\\beta\\)) positive negative (e.g. pathogenic). plants carrying capacities (\\(K\\)), negative effects (\\(c\\)).corresponding equation plant species \n\\[\\begin{equation}\n\\frac{dN_B}{dt} = r_B N_B \\left( 1 + \\alpha_B S_A + \\beta_B S_B -\n                                   \\frac{c_A N_A + N_B}{K_B}\\right).\n\\end{equation}\\]often refer soil flora associated single plant species home flora, away flora. microbial flora comprises many, many species aggregate net effects. Bever (2003) simplified model placing constraints soil microbes, \\(S_A + S_B=1\\). allows focus relations among microbes plants. assumptions, showed net effect flora single state variable home flora species:\n\\[\\frac{dS_A}{dt} = S_A(1-S_A) \\left( \\frac{N_A}{N_A + N_B} - \\nu\\frac{N_B}{N_A + N_B}\\right)\\]\n\\[S_B=1-S_A\\].Coexistence criteria\nBever states (2003, p. 467, bottom second column) interactions stable \n\\[\\alpha_A + \\beta_B < \\alpha_B + \\beta_A \\]\nmeans effects home floras home plants less positive (negative) species.Bever also argued either plant species increase rare (.e. coexist), interspecific competition less benefits interactions soil floras. However, criterion eqn 5 (p. 469) sufficient, revealed lack consistency parameter set outcomes Fig. 4. , alter equation bit reveal probably work. use parameterization Chapter ?? consistent others (Bolker, Pacala, Neuhauser 2003; Chesson 2000b). reformulate carrying capacities \\(c_A\\) \\(c_B\\) \\[\\alpha_{AA}=1/K_A;\\,\\alpha_{BB}=K_B;\\,\\alpha_{BA}= c_A/K_B;\\,\\alpha_{AB}=c_B/K_A\\]\nrecall earlier work, showed species \\(\\) can invade \n\\[\\frac{\\alpha_{ij}}{\\alpha_{jj}} < 0\\]\ntranslates Lotka-Volterra invasion criterion species \n\\[\\frac{\\alpha_{AB}}{\\alpha_{BB}} =\\frac{c_b}{K_A}K_B\\]\ninvasion criterion species B \n\\[\\frac{\\alpha_{BA}}{\\alpha_{AA}} =\\frac{c_a}{K_B}K_A\\]\ncoexistence criterion species must able invade rare, including soil flora effect. Therefore, \\[\\begin{equation}\n\\left(\\frac{c_b}{K_A}K_B,\\, \\frac{c_a}{K_B}K_A\\right) < \\frac{(1+\\alpha_B)(1+\\beta_A)}{(1+\\alpha_A)(1+\\beta_B)}\n\\tag{11.1}\n\\end{equation}\\]conditions left must satisfied. numerator right, effect soil flora away plant species. denominator, effects flora home plant species. Thus, fraction right relative benefit soil flora.Now create ODE function let us see dynamics play . need model one soil flora \\(S_B = 1-S_A\\).parameterize model way reveals importance soil floras coexistence, according criteria stated (11.1). create vector parameters, test whether inequality (11.1) true. start absence soil flora effect.Use criterion , paper pencil, see discover. also R.Try hand , paper pencil. R.\nFigure 11.7: Dynamics competing plant species, subject self-limiting negative feedbacks soil pathogens.\n","code":"\nbever3 <- function(t,y,p){\n  with(as.list(c(y,p)), {\n    dNa <- ra * Na * (1+alphaA*SA + betaA*(1-SA) - (Na + cB*Nb)/Ka)\n    dNb <- rb * Nb * (1+alphaB*SA + betaB*(1-SA) - (cA*Na + Nb)/Kb)\n    dSA <- SA*(1-SA) * ( Na/(Na+Nb) - nu*Nb/(Na+Nb) )\n    return(list(c(dNa, dNb, dSA), SB=1-SA))\n  })\n  }\np0 <- list(ra=0.7, rb=0.5, Ka = 10, Kb=12, cA=.98, cB=.98, \n           alphaA=0, alphaB=0, betaA=0, betaB=0, nu=0.8)\nwith(p0, { cA/Kb*Ka  < (1+alphaB)*(1+betaA) / ( (1+alphaA)*(1+betaB)) })## [1] TRUE\nwith(p0, { cB/Ka*Kb < (1+alphaB)*(1+betaA) / ( (1+alphaA)*(1+betaB)) })## [1] FALSE                                                                            This shows us we will not get coexistence in the absence of soil flora. Now we add the soil flora.\n                                                                            \np <- list(ra=0.7, rb=0.5, Ka = 10, Kb=12, cA=.98, cB=.98, alphaA=-0.03, alphaB=0.1, betaA=0.1, betaB=-0.2, nu=0.8)\nwith(p, { cA/Kb*Ka  < (1+alphaB)*(1+betaA) / ( (1+alphaA)*(1+betaB)) })## [1] TRUE\nwith(p, { cB/Ka*Kb < (1+alphaB)*(1+betaA) / ( (1+alphaA)*(1+betaB)) })## [1] TRUE"},{"path":"consumer-resource-competition-and-mutualisms.html","id":"simulations-for-learning","chapter":"11 Consumer-resource Competition and Mutualisms","heading":"11.6 Simulations for learning","text":"Often, learn lot describing interactions simple enough terms can analyze interaction analytically, way analyzed Lotka-Volterra competition mutualism. complex cases, often find analytical, closed form, solution, , complex difficult extract meaning. cases, may able learn lot consequences model’s assumptions simulation. Using simulation, examine observed dynamics wide range parameter values infer general rules parameters parameter combinations influence dynamics.study, use simulations attempt determine rules govern long-term dynamics mutualism model linear density dependence intra- interspecific interactions. also use simulation confirm earlier analytical solution vice versa.","code":""},{"path":"consumer-resource-competition-and-mutualisms.html","id":"lvg","chapter":"11 Consumer-resource Competition and Mutualisms","heading":"11.6.1 lvg()","text":"core simulations use general purpose Lotka-Volterra model simpy takes interaction matrix \\(r\\) inputs.model, parameters list (type R data object) two components. first vector r, one species want model. second component list matrix interaction coefficients. matrix square (number rows columns). elements matrix must correct sign. instance, represent competition, relevant elements negative.create interaction matrix two-species Lotka-Volterra mutualism, species suffers intraspecific competition, benefits mutualist.Now let’s numerically integrate, simulate, model plot outcome. Comment code help remind going .\nFigure 11.8: Dyanmics Lotka-Volterra mutualism.\n","code":"\nlvg <- function (time, n, parameters) \n{\n  r <- parameters[[1]]\n  a <- parameters[[2]]\n  dns.dt <- r * n * (1 + (a %*% n))\n  return(list(c(dns.dt)))\n}\na <- matrix(c( -.1, .02,\n               .02, -.09), nrow = 2, byrow=TRUE)\na##       [,1]  [,2]\n## [1,] -0.10  0.02\n## [2,]  0.02 -0.09\n# Let r be the same fpor each species\nr <- c(1,1)\nparms <- list(r=r, a=a)\nparms## $r\n## [1] 1 1\n## \n## $a\n##       [,1]  [,2]\n## [1,] -0.10  0.02\n## [2,]  0.02 -0.09\nt=seq(0,30, by=.1)\nN0 <- c(N1=20, N2=5)\nlvout <- as.data.frame( ode(N0, t, lvg, parms) )\nlvL <- pivot_longer(lvout, -time, names_to=\"State_vars\", \n            values_to=\"N\")\n\nggplot(lvL, aes(time, N, colour=State_vars, linetype=State_vars)) + \n  geom_line() + \n  geom_hline(yintercept=c(-1/a[1,1], -1/a[2,2]), linetype=c(1,3)) +\n  annotate(geom=\"text\", \n           x=c(15, 20),y=c(-1/a[1,1], -1/a[2,2]), label=c(\"K1\", \"K2\"), vjust=-0.2 )"},{"path":"consumer-resource-competition-and-mutualisms.html","id":"systematic-simulations","chapter":"11 Consumer-resource Competition and Mutualisms","heading":"11.6.2 Systematic simulations","text":"use model explore consequences assumptions, want use range plausible assumptions. case like one exploring model natural phenomenon represents, use wide range parameter values include cases likely fail. case, hold intraspecific density dependence constant vary interspecific interaction coefficients zero twice value intraspecific interactions.start building bits pieces simulation use, use -loop cycle parameter combinations interested .","code":"\n# Use expand.grid to create systematically combinations of parameters\ndf <- expand.grid(a11 = -0.1, a12=seq(0, .2, by =.02),\n                  a21 = seq(0, .2, by=.02),  a22=-0.1 )\ndim(df) # The number of rows and columns## [1] 121   4\nhead(df) # the top of the data frame##    a11  a12 a21  a22\n## 1 -0.1 0.00   0 -0.1\n## 2 -0.1 0.02   0 -0.1\n## 3 -0.1 0.04   0 -0.1\n## 4 -0.1 0.06   0 -0.1\n## 5 -0.1 0.08   0 -0.1\n## 6 -0.1 0.10   0 -0.1\n# set intrinsic rates of increase...\nr <- c(1,1)\n\n# and starting values...\nN0 <- c(N1 = 10, N2= 10.001)\n\n# and times for which to return output.\nt <- 0:200\n\n# Set values that will be useful later on in our for-loop.\nn <- length( t + 1 )\nnpar <- nrow( df ) \n\n# create an empty data frame to hold our simulation output.\noutput <- data.frame( t = numeric(npar), N1 = numeric( npar ), \n                      N2 = numeric( npar ) )\n\n### USE A  FOR-LOOP TO INTEGRATE THE MODEL FOR EACH COMBINATION OF PARAMETERS\nfor( i in 1:npar ) {\n  coefs.true <- matrix( as.numeric( df[i,] ), \n                        nrow = 2, byrow = TRUE)\n  invisible(\n    capture.output( \n    # capture.output is a function that allows us to avoid seeing warnings...\n    # not usually a good idea to ignore warnings!!!\n    # but it is OK here....\n    lvout <- ode(N0, t, lvg, parms = list(r, coefs.true) )\n  ) )\n  \n  # hang on to only the last row of output, and  \n  # put it in the i-th row of our output data frame.\n  last <- nrow(lvout)\n   output[i,] <- lvout[last,]\n}\n\n# Combine columns of parameters and output.\nsimdat <- cbind(df, output)"},{"path":"consumer-resource-competition-and-mutualisms.html","id":"checking-simulation-results","chapter":"11 Consumer-resource Competition and Mutualisms","heading":"11.6.3 Checking simulation results","text":"Let’s look anomalous results, negative population sizes, infinite “” large sizes.run , see strange population sizes time always 200, showing numerical integration failed completing. Also, \\(N\\) included unreasonably large values.Let’s look rows either \\(N_1\\) \\(N_2\\) huge (\\(> 10\\,000\\)).Notice also values \\(t\\) indicate integration couldn’t find values beyond certain time point. Hmm. now, let’s assume simulation think results indicate true lack equilibrium.learn emerging rules? just plot values \\(\\alpha_{ij},\\,\\alpha_{ji}\\) \\(N\\) really, really big?\nFigure 11.9: Values \\(alpha\\) N extraordinarily large.\nlearn just figure? Write possible set conditions necessary get anomalous results.","code":"\n# Do simplistic numerical summaries.\nsummary(simdat[,5:7])##        t                  N1                   N2            \n##  Min.   :  0.6931   Min.   : 1.000e+01   Min.   : 1.000e+01  \n##  1st Qu.:  1.5576   1st Qu.: 2.100e+01   1st Qu.: 2.100e+01  \n##  Median :200.0000   Median : 7.000e+01   Median : 7.000e+01  \n##  Mean   :122.9019   Mean   :3.355e+146   Mean   :3.355e+146  \n##  3rd Qu.:200.0000   3rd Qu.:8.858e+145   3rd Qu.:8.858e+145  \n##  Max.   :200.0000   Max.   :8.187e+147   Max.   :8.187e+147\n# the vertical bar | means \"or\"\nsim.N <- subset(simdat, N1 > 10000 | N2 > 10000)\nhead(sim.N)##     a11  a12  a21  a22        t            N1            N2\n## 43 -0.1 0.18 0.06 -0.1 3.241398 2.434044e+103 1.390882e+103\n## 44 -0.1 0.20 0.06 -0.1 2.399838  1.164783e+99  6.212179e+98\n## 52 -0.1 0.14 0.08 -0.1 2.889456  1.856660e+65  1.392495e+65\n## 53 -0.1 0.16 0.08 -0.1 2.139629 1.175804e+109 8.140182e+108\n## 54 -0.1 0.18 0.08 -0.1 1.774181 9.054385e+146 5.820676e+146\n## 55 -0.1 0.20 0.08 -0.1 1.541959 1.041579e+147 6.249472e+146\nggplot(sim.N, aes(a12, a21)) + geom_point()"},{"path":"consumer-resource-competition-and-mutualisms.html","id":"comparing-simulation-results-to-analytical-solutions","chapter":"11 Consumer-resource Competition and Mutualisms","heading":"11.6.4 Comparing simulation results to analytical solutions","text":"time something novel modeling, need find way evaluate novel approach make sure think . analytical solution model, great compare analytical solution simulations.One thing can compare long-term steady state values get simulation analytical equilibria mutualism model.First, find analytical solutions equilibria predicted coefficients. Consult equilibrium solution first section chapter. compare numerical solutions.calculate predicted equilibria row coefficients, using solution.Let’s find subset potential problems, \\(N_1\\) \\(N_2\\) less zero really, really big (\\(>10000\\)).\nFigure 11.10: Analytically calculated predictions \\(N^*\\) vs. observed simulated \\(N\\).\nFascinating! analytical simulated results give us wacky, different results. Let’s examine coefficients generated results.notice coefficients?get term analytical equilibrium using first row data?reconcile results?understand anomalous results , let’s compare simulated analytical solutions \\(N_1\\) \\(N_2\\) greater zero less huge number.Next calculate differences analytical solutions simulated values.summaries show us differences analytical solutions numerical approximations , , small. good thing. gives us confidence simulations think ., can now tentatively assume simulations think , confidence results generate.practice, sometimes simulate complex model compare results simpler, tractable analytical solution. , get hang approach comparing simulations known solutions.","code":"\ndenom <- simdat[,1] * simdat[,4] - simdat[,2] * simdat[,3]\n# note this solution is subtracting the negative intraspecific comp coef.\n# making it consistent with our equations in section 1\nnum1 <- simdat[,2] - simdat[,4]\nnum2 <- simdat[,3] - simdat[,1]\nN1.eq <- num1 / denom\nN2.eq <-num2 / denom\n\n# combine with simulation data set\nsim.check1 <- cbind(simdat, N1.eq, N2.eq)\n# sim.check1[order(sim.check1$a12, sim.check1$a21),]\nproblems1 <- subset(sim.check1, (N1 < 0 | N2 < 0 | N1 > 1e4 | N2 > 1e4 ) )\n# look at the subset\nggplot(problems1, aes(N1, N1.eq)) + geom_point()\nproblems1[1:5,]##     a11  a12  a21  a22        t            N1            N2      N1.eq\n## 43 -0.1 0.18 0.06 -0.1 3.241398 2.434044e+103 1.390882e+103 -350.00000\n## 44 -0.1 0.20 0.06 -0.1 2.399838  1.164783e+99  6.212179e+98 -150.00000\n## 52 -0.1 0.14 0.08 -0.1 2.889456  1.856660e+65  1.392495e+65 -200.00000\n## 53 -0.1 0.16 0.08 -0.1 2.139629 1.175804e+109 8.140182e+108  -92.85714\n## 54 -0.1 0.18 0.08 -0.1 1.774181 9.054385e+146 5.820676e+146  -63.63636\n##         N2.eq\n## 43 -200.00000\n## 44  -80.00000\n## 52 -150.00000\n## 53  -64.28571\n## 54  -40.90909\ncheck2 <- subset(sim.check1, (N1.eq > 0 & N2.eq > 0) & (N1 < 1e4 & N2 < 1e4 ))\nN1.diff <- check2$N1 - check2$N1.eq\nN2.diff <- check2$N2 - check2$N2.eq\nsummary(N1.diff); summary(N2.diff)##       Min.    1st Qu.     Median       Mean    3rd Qu.       Max. \n## -1.421e-14  1.776e-15  3.553e-15  1.363e-13  7.105e-15  3.183e-12##       Min.    1st Qu.     Median       Mean    3rd Qu.       Max. \n## -2.842e-14  1.776e-15  3.553e-15  1.558e-13  7.105e-15  5.230e-12"},{"path":"consumer-resource-competition-and-mutualisms.html","id":"one-last-thing-using-the-jacobian-matrix","chapter":"11 Consumer-resource Competition and Mutualisms","heading":"11.6.5 One last thing: using the Jacobian matrix","text":"Use eigenanalysis Jacobian matrix assess stability equilibria. Consult eq. 5.21 Table 5.2 Stevens (2009).sensible equilibrium.results mean?nonsensical equilibriumWhat results mean?","code":"\nsubset(sim.check1, a12 == .02 & a21 == .02)##     a11  a12  a21  a22   t   N1   N2 N1.eq N2.eq\n## 13 -0.1 0.02 0.02 -0.1 200 12.5 12.5  12.5  12.5\n# form remember that we set r = 1\nJ1 <- matrix(c(-.1*12.5, -.02*12.5,\n               -.02*12.5, -.1*12.5), nrow=2, byrow=TRUE)\neigen(J1)## eigen() decomposition\n## $values\n## [1] -1.0 -1.5\n## \n## $vectors\n##            [,1]      [,2]\n## [1,] -0.7071068 0.7071068\n## [2,]  0.7071068 0.7071068\nsubset(sim.check1, a12 == .2 & a21 == .2)##      a11 a12 a21  a22         t            N1            N2 N1.eq N2.eq\n## 121 -0.1 0.2 0.2 -0.1 0.6931166 8.389656e+145 8.389656e+145   -10   -10\nJ2 <- matrix( c( -.1*(-10), -.2*(-10), \n                 -.2*(-10), -.1*(-10)), nrow=2, byrow=TRUE) \neigen(J2)## eigen() decomposition\n## $values\n## [1]  3 -1\n## \n## $vectors\n##           [,1]       [,2]\n## [1,] 0.7071068 -0.7071068\n## [2,] 0.7071068  0.7071068"},{"path":"consumer-resource-competition-and-mutualisms.html","id":"in-fine-3","chapter":"11 Consumer-resource Competition and Mutualisms","heading":"11.6.6 In Fine","text":", can digest communicate found? able answer questions:simulation perform thought know?simulation confirm something first assessed analytically? , ?explain differences simulations analytical equilibrium (extremely large vs. negative population sizes)?","code":""},{"path":"food-webs-and-other-networks.html","id":"food-webs-and-other-networks","chapter":"12 Food webs and other networks","heading":"12 Food webs and other networks","text":"food web real model set feeding relations among species functional groups. chapter two foci, () brief introduction multi-species webs networks, (ii) re-examination old lessons regarding effect food chain length web’s dynamical properties.\nFigure 12.1: food web map feeding relations. , snails (S) invertebrates () feed algae, fish, F, feed invertebrates algae. can represent graph matrix.\n","code":""},{"path":"food-webs-and-other-networks.html","id":"food-web-characteristics","chapter":"12 Food webs and other networks","heading":"12.1 Food Web Characteristics","text":"need language describe components food web, links nodes, also need language describe properties web whole. Generally speaking, networks food webs emergent properties (R. M. May 2006), number nodes network. Emergent properties typically considered nothing characteristics exist simpler levels organization. instance, one emergent property population density, population density measured individual; density emergent property.64 food web models based simple pairwise interactions, resulting emergent properties multispecies webs quickly become complex due indirect interactions coupled oscillations (Berlow et al. 2004; Vandermeer 2006). addition, extrinsic factor (e.g., seasonality) might influence species interactions may also influence emergent properties food webs.important network descriptors emergent properties include,Node point connection among links, .k.. trophospecies; node web may set organisms share sufficiently similar feeding relations; Fig. 12.1, \\(F\\) may single population one species, may suite species feed \\(\\) \\(\\).Link feeding relation; connection nodes trophospecies; may directed (one way) undirected. directed link indicated arrow, effect (\\(+,\\,-\\)) one species another. undirected link indicated line (arrow head), merely connection, usually positive negative effects assumed, quantified.Connectance proportion possible links realized. Connectance may based either directed, \\(C_{D}\\), undirected, \\(C_{U}\\), links. Fig. 12.1 \n\\[\\begin{gather*}\nC_{D}=\\frac{L}{S^{2}}=\\frac{8}{16}=0.5 \\\\\nC_{U}=\\frac{L}{\\left(S^2-S\\right)/2}=\\frac{4}{6}=0.67\n\\end{gather*}\\]\n\\(S\\) number species nodes.Degree distribution, \\(\\mathrm{Pr}()\\) probability randomly chosen node degree \\(\\), , connected \\(\\) nodes (R. M. May 2006). Fig. 12.1, \\(S\\) degree 1 (.e., connected one species). \\(F\\) \\(\\) degree 2, \\(\\) degree 3. divide number nodes (4, Fig. 12.1), degree distribution consists probabilities \\(\\mathrm{Pr}\\left(\\right)=\\{0.25,\\,0.5,\\,0.25\\}\\). webs increase size, can describe distribution statistical distribution. instance, web randomly placed connections, degree distribution binomial distribution (Cohen, Briand, Newman 1990).Characteristic path length Sometimes defined average shortest path two nodes (Dunne, Williams, Martinez 2002). instance, Fig. 12.1, shortest path \\(S\\) \\(\\) 1 link, \\(\\) \\(\\) 2 links. average pairwise shortest paths \\((1+1+1+1+2+2)/6=1.\\bar{3}\\). also sometimes defined average paths pair nodes.Modularity, Compartmentation degree subsets species highly connected independent species. tends arise consumer-resource interactions (Thebault Fontaine 2010).calculate modularity food web, first assume species interacts . Next, calculate proportion shared interactions, \\(p_{ij}\\) pair species, comparing lists species species pair interacts. numerator \\(p_{ij}\\) number species pair interact. denominator total number different species either species interacts. example, let’s calculate food web (Fig. 12.1). \\(S\\) interacts \\(S\\) \\(\\), \\(\\) interacts \\(\\), \\(\\), \\(F\\). Therefore, \\(S\\) \\(\\) interact \\(\\), whereas, together, \\(S\\) \\(\\) interact \\(S\\), \\(\\), \\(\\), \\(F\\). proportion, \\(p_{ij}\\), therefore \\(1/4 = 0.25\\). species pair. Next sum proportions, divide sum maximum possible number undirected links, \\(C_U\\).\\[\\begin{align*}\nC_{}&=\\frac{\\sum_{=1}^{S-1}\\sum_{j=+1}^{S}p_{ij}}{\\left(S^2-S\\right)/2}\\\\\n    &=3.5/6\\\\\n    &=0.58\n\\end{align*}\\]reiterate: pair species, \\(\\) \\(j\\) (\\(\\neq j\\)), \\(p_{ij}\\) proportion shared interactions, calculated number species interact species \\(\\) \\(j\\), divided number species interact either species \\(\\) species \\(j\\). , \\(S\\) number species nodes web.Nestedness degree specialists make connections generalists . completely nested network one can rank species number interactions, find species interact fewer species always interacting species generalists also interact . tends arise plant-pollinator networks (Thebault Fontaine 2010).Motif repeating pattern; commonly, unique set unidirectional patterns consumption (Fig. 12.2). motif profile species variety motifs species part , relative frequency play role.Small world architecture degree characteristic path length, \\(L\\), grows logarithm number nodes web, \\(N\\),\n\\[L \\propto log(N)\\]\noccurs nodes connected via small number links node large number connections. occurs social networks individuals connected via shared acquaintances.\nFigure 12.2: 13 different possible motifs three species. links record consumption. instance, S1 simple linear food chain S4 single species consumed two species. motifs D1-D8 include mutual consumption. likely occur species guild, adults one feed juveniles another.\nTrophic level, trophic position may simply categorized basal, intermediate top trophic positions. Basal positions trophospecies feed species. top positions trophospecies fed upon nothing. One can also calculate quantitative measure trophic level. important part omnivory, something rampant real food webs, complicates identification trophic level. can calculate trophic level top predator, \\(F\\) (Fig. 12.1), let us assume \\(F\\) gets two-thirds needs \\(\\), gets one-third \\(\\). \\(\\) second trophic level, given , trophic level \\(P\\) calculated \n\\[\\begin{equation*}\nT_{}=1+\\sum_{j=1}^{S}T_{j}p_{ij}=1+\\left(2\\left(0.67\\right)+1\\left(0.33\\right)\\right)=2.67\n\\end{equation*}\\]\n\\(T_{}\\) trophic level species \\(\\),\n\\(T_{j}\\) trophic level prey species \\(j\\),\n\\(p_{ij}\\) proportion diet predator\n\\(\\) consisting prey \\(j\\).Trophic level, trophic position may simply categorized basal, intermediate top trophic positions. Basal positions trophospecies feed species. top positions trophospecies fed upon nothing. One can also calculate quantitative measure trophic level. important part omnivory, something rampant real food webs, complicates identification trophic level. can calculate trophic level top predator, \\(F\\) (Fig. 12.1), let us assume \\(F\\) gets two-thirds needs \\(\\), gets one-third \\(\\). \\(\\) second trophic level, given , trophic level \\(P\\) calculated \n\\[\\begin{equation*}\nT_{}=1+\\sum_{j=1}^{S}T_{j}p_{ij}=1+\\left(2\\left(0.67\\right)+1\\left(0.33\\right)\\right)=2.67\n\\end{equation*}\\]\n\\(T_{}\\) trophic level species \\(\\),\n\\(T_{j}\\) trophic level prey species \\(j\\),\n\\(p_{ij}\\) proportion diet predator\n\\(\\) consisting prey \\(j\\).Omnivory Feeding one trophic level; merely feeding different species resources.Omnivory Feeding one trophic level; merely feeding different species resources.Intraguild predation type omnivory predation occurs consumers share resource; Fig. 12.1 \\(F\\) \\(\\) share prey \\(\\). \\(F\\) gets energy \\(\\), typically refer omnivory; \\(F\\) gets energy \\(\\), typically refer intraguild predation two species share resource occasionally eat .Intraguild predation type omnivory predation occurs consumers share resource; Fig. 12.1 \\(F\\) \\(\\) share prey \\(\\). \\(F\\) gets energy \\(\\), typically refer omnivory; \\(F\\) gets energy \\(\\), typically refer intraguild predation two species share resource occasionally eat .list food web descriptors fine start means exhaustive.","code":""},{"path":"food-webs-and-other-networks.html","id":"does-omnivory-destablize-food-chains","chapter":"12 Food webs and other networks","heading":"12.2 Does omnivory destablize food chains?","text":"many interesting questions food webs address; let us address one long history, yet, complete answer: determines length food chain? argued chance plays large role (Cohen, Briand, Newman 1990; Hubbell 2001; Williams Martinez 2000), others shown area (MacArthur Wilson 1967; Rosenzweig 1995) ecosystem size (Post 2002) may play roles. explanation focus dynamical stability. Communities species hypothesized less stable, therefore less likely persist observed nature. Stuart Pimm John Lawton (Pimm Lawton 1977) extended work testing whether food chain length limited instability long food chains.","code":""},{"path":"food-webs-and-other-networks.html","id":"multi-species-lotkavolterra-notation","chapter":"12 Food webs and other networks","heading":"12.2.1 Multi-species Lotka–Volterra notation","text":"many-species Lotka–Volterra model can represented compact form,\n\\[\\begin{equation}\n\\tag{12.1}\n\\frac{d X_{}}{d t}=X_{}\\left(b_{}+\\sum_{j=1}^{S}a_{ij}X_{j}\\right)\n\\end{equation}\\]\n\\(S\\) number species web, \\(b_i\\) intrinsic rate increase species \\(\\) (.e., \\(r_i\\)), \\(a_{ij}\\) per capita effect species \\(j\\) species \\(\\).\\(=j\\), \\(a_{ij}\\) refers intraspecific effect, typically negative. Recall earlier chapters competition, used \\(\\alpha_{ii}\\) represent intraspecific per capita effects. notational convenience, leave \\(\\) \\(j\\) equation, realizing \\(=j\\) intraspecific interactions. , let \\(a_{ij}\\) sign, either positive negative, sum effects. let \\(X=N\\), \\(b=r\\), \\(=r \\alpha\\), following equivalent:\n\\[\\begin{gather*}\n  \\dot{N_1} =r_1N_1\\left(1-\\alpha_{11}N_1 - \\alpha_{12}N_2\\right)\\\\\n  \\dot{X} =X_1\\left(b_1+a_{11}X_1+a_{12}X_2 \\right)\n\\end{gather*}\\]\nnotation (12.1) simple flexible. \\(a_{ij}\\) negative, may represent competition effect predator, \\(j\\), prey, \\(\\). \\(a_{ij}\\) positive, may represent mutualism effect prey~\\(j\\) predator~\\(\\).","code":""},{"path":"food-webs-and-other-networks.html","id":"background","chapter":"12 Food webs and other networks","heading":"12.2.2 Background","text":"\nFigure 12.3: Three six webs investigated Pimm Lawton (1977). Left right, correspond Pimm Lawton (1977) Figs. 1A, E, B. basal species exhibit negative density dependence.\nMay used specific quantitative definitions ideas. defined connectance proportion interactions web, given total number possible directed interactions (.e., directed connectance). Thus linear food chain four species (Fig. 12.3, web ), intraspecific competition basal (bottom) species connectance \\(4/16=0.25\\). May’s definition interaction strength square root average \\(a_{ij}^2\\) (\\(\\neq j\\)),\n\\[\\begin{equation}\n  \\tag{12.2}\n  =\\sqrt{ \\frac{\\sum_{=1}^S\\sum_{j=1, \\neq j}^S a_{ij}}{S^2-S}}.\n\\end{equation}\\]\nSquaring \\(a_{ij}\\) focuses magnitudes, putting negative positive values equal footing.important component May’s work explored properties randomly connected food webs. first glance might seem ludicrous, upon consideration, might wonder else one start. Often, simpler (case, random) might better. conclusions random connection models act null hypotheses food webs might structured; deviations May’s conclusions might explained deviations assumptions. Since work, many ecologists studied particular ways webs nature appear non-random.\nFigure 12.4: Relation average interaction strength number species able coexist (directed connectance \\(C_D = 0.3\\)). line represents maximum number species predicted able coexist equilibrium. Fewer species coexist, , average, species coexist equilibrium.\nPimm Lawton felt seemed reasonable long chains might less\nstable also predator-prey dynamics appear inherently unstable, \nconnected series unstable relations seemed less likely persist \nshorter chains. tested whether food chain length\nper se, number species, influenced stability food\nchains. Another question addressed concerned omnivory. time, surveys naturally occurring\nfood webs indicated omnivory rare (Pimm Lawton 1978). Pimm Lawton tested whether omnivory stabilized destabilized food webs (Pimm Lawton 1977, 1978).Like May, Pimm Lawton (Pimm Lawton 1977) used Lotka–Volterra models \ninvestigate ideas. designed six different food web configurations\nvaried food chain length, held number species constant (Fig.\n12.3). food web configuration, varied randomly interaction strength tested whether \notherwise randomly structured food web stable. food webs included\nnegative density dependence basal species.Pimm Lawton concluded () shorter chains stable longer chains, (ii) omnivory destabilized food webs. conclusions stood test time, Pimm Lawton failed highlight another aspect data — omnivory shortened return times webs qualitatively stable (Fig. 12.10). Thus, omnivory make stable webs didn’t destroy. Subsequent work elaborated , showing weak omnivory likely stabilize food webs (McCann, Hastings, Huxel 1998).","code":""},{"path":"food-webs-and-other-networks.html","id":"implementing-pimm-and-lawtons-methods","chapter":"12 Food webs and other networks","heading":"12.2.3 Implementing Pimm and Lawton’s Methods","text":"use R code illustrate one might replicate, begin extend, work Pimm Lawton (Pimm Lawton 1977).previous chapters, began explicit time derivatives, found partial derivatives solved equilibria. Rather , Pimm Lawton bypassed steps went straight evaluated Jacobian matrix. inserted random estimates elements Jacobian non-zero element food web matrix. estimates constrained within (presumably) reasonable limits, given large less abundant predators small abundant prey.methods followed approach.Specify food web interaction matrix.65Include negative density dependence basal species .Set upper lower bounds effects predators prey (\\(0\\) \n\\(-10\\)) prey predators(\\(0\\) \\(+0.1\\)); Jacobian elements.Generate large number random Jacobian matrices perform linear\nstability analysis.Determine qualitative stability (test \\(\\lambda_1<0\\)), return time random matrix. Use examine key features distributions return times (e.g., average return time).Compare stability return times among different food web configurations varied systematically food chain length presence\nomnivory, hold number species constant.worth discussing briefly Jacobian elements. R. M. May (1973) defined interaction strength Jacobian element matrix, represents total effect one individual population growth rate another species. Think calculate Jacobian — partial derivative one species’ growth rate respect size population. instantaneous change population growth rate per unit change population another, equilibrium. units chosen Jacobian elements thus mean individual predators relatively much larger effects population growth rates prey vice versa.Let’s build function Pimm Lawton . infinite number ways , suffice. First, ’ll create matrix represents qualitatively simplest longest food chain species feeds one species prey fed upon one consumer. Initially, use values greatest magnitude used Pimm Lawton.Note matrix indicates negative effect basal species , large negative effects (\\(-10\\)) consumer prey, small positive effects prey consumer.can quick check web using diagram package.Without additional arguments, shows us pretty much need see.subsequent calculations, convenient find matrix big matrix , , many species, \\(S\\), web.Next, create random realization matrix multiplying element times unique random number zero 1. matrix, requires \\(4^2\\) unique numbers.Next perform eigenanalysis , retaining eigenvalues.Pimm Lawton tested whether dominant eigenvalue greater 0 (unstable) less zero, calculated return time. simply record dominant eigenvalue (maximum real parts eigenvalues).Given stabilizing effect intraspecific negative density dependence, hang well.Given lessons May’s work, might also want calculate average interaction strength, including intraspecific interactions. set diagonal interactions equal zero, square remaining elements, find average, take square root.Recall weak omnivory supposed stabilize food webs (McCann Hastings 1997). webs include omnivory, calculate interaction strength omnivory way interactions, square root average squared \\(a_{ij}\\) (12.2).can wrap function specify \\(,\\,j\\) one directed omnivorous links. matter specify, either \\(ij\\) \\(ji\\).See arguments function.Now can check function single simulation first web,Now let’s 2000 times, Pimm Lawton . row independent randomization, columns dominant eigenvalue, intraspecific density dependence, average interaction strength.might like look basic summary statistics information collected — minima maxima mean?see 2000 random food chains, largest dominant eigenvalue still less zero (\\(\\lambda_1<0\\)). mean? means chains qualitatively stable, return times greater zero (\\(-1/\\lambda_1>0\\)).66May’s work showed stability related interaction strength. Let’s examine dominant eigenvalue related interaction strength.67May’s work showed stability related interaction strength. Let’s examine dominant eigenvalue related interaction strength.68\nFigure 12.5: Perturbations equilibrium tend dissipate rapidly (negative dominant eigenvalues) greater intraspecific negative density dependence (IntraDD) greater interspecific interaction strength (). graph also demonstrates independence IntraDD simulations.\nresults simulation (Fig. 12.5) show dominant eigenvalue can become negative greater intraspecific negative density dependence (IntraDD) greater intersepcifiic interaction strength (). Recall means — dominant eigenvalue akin perturbation growth rate equilibrium negative inverse return time. Therefore, stability can increase return time decrease increasing interaction strengths.Note also (Fig. 12.5) many eigenvalues seem close zero — mean return times? inverse small number big number, appears many return times , large, rendering webs effectively unstable. Let’s calculate return times examine summary.find maximum return time large number, even median fairly large (67). ever-changing world, meaningful difference return time 1000 generations vs. unstable neutrally stable?Pimm Lawton addressed picking arbitrarily large number (150) recording percentage return times greater . percentage tell us percentage webs effectively stable.Now let’s extract return times less equal 150 make histogram right number divisions bins allow look like one original (Pimm Lawton 1977).\nFigure 12.6: linear four-species food chain somewhat likely reasonble return times.\nhistogram (Fig. 12.6) provides us picture stability linear Lotka-Volterra food chain. Next, compare webs.","code":"\nAq = matrix(c(\n  -1,   -10,   0,     0,\n  0.1, 0,   -10,  0,\n  0,    0.1,   0,    -10,\n  0,      0,    0.1,   0),\n  nrow=4, byrow=TRUE)\nlibrary(diagram)\nplotmat(Aq,relsize=.8)\nS <- nrow(Aq)\nM <- Aq * runif(S^2)\neM <- eigen(M)[[\"values\"]]\ndeM <- max( Re(eM) )\nintraNDD <- sqrt(sum(diag(M)^2)/S)\ndiag(M) <- 0\nIS <- sqrt( sum(M^2)/(S*(S-1)) )\nargs(pimmlawton)## function (mat, N = 1, omni.i = NA, omni.j = NA, omega = NULL) \n## NULL\nset.seed(1)\npimmlawton(Aq)##        DomEig        Im   IntraDD        I\n## 1 -0.01593096 0.4626425 0.1327543 2.304443\nout.A <- pimmlawton(Aq, N=2000) \nsummary(out.A)##      DomEig                 Im            IntraDD                I         \n##  Min.   :-2.281e-01   Min.   :0.0000   Min.   :0.0001776   Min.   :0.2652  \n##  1st Qu.:-4.303e-02   1st Qu.:0.3009   1st Qu.:0.1178734   1st Qu.:2.2405  \n##  Median :-1.498e-02   Median :0.6342   Median :0.2456105   Median :2.8509  \n##  Mean   :-2.916e-02   Mean   :0.5916   Mean   :0.2464662   Mean   :2.7665  \n##  3rd Qu.:-3.534e-03   3rd Qu.:0.8813   3rd Qu.:0.3761273   3rd Qu.:3.3695  \n##  Max.   :-7.000e-08   Max.   :1.3732   Max.   :0.4997094   Max.   :4.7617\nout.A$I.rel <- with(out.A, log(I/IntraDD) )\npairs(out.A)\n# out.A$Idd <-  cut(out.A$IntraDD, \n#          quantile(out.A$IntraDD), include.lowest=TRUE )\n# ggplot(data=out.A, aes(I, DomEig)) + geom_point() +\n#   geom_smooth() + facet_wrap(~ Idd)\n  RT.A <- -1/out.A[[\"DomEig\"]]\n  summary(RT.A)##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n##        4       23       67    11698      283 13909682\n  sum( RT.A > 150 ) / 2000## [1] 0.348\nA.fast <-RT.A[RT.A < 150]\nhistA <- hist(A.fast, breaks=seq(0,150, by=5), main=NULL)"},{"path":"food-webs-and-other-networks.html","id":"shortening-the-chain","chapter":"12 Food webs and other networks","heading":"12.2.4 Shortening the Chain","text":"Now let’s repeat (quickly) shorter chain, number species (Fig. 12.3, web E). , first make web function. Next run 2000 simulations, check quick summary.Now can run simulation.summary shows , , webs stable (\\(\\lambda_1<0\\)). histogram return times also shows short return times (Fig. 12.8). Plots \\(\\lambda_1\\) vs. interaction strengths show short chain, three basal species role intraspecfic density dependence becomes even important, predator-prey interactions less important governing \\(\\lambda_1\\).\nFigure 12.7: food chain two levels, three basal species, perturbation growth rate (lambda_1) declines increasing intraspecific negative density dependence (IntraDD) unrelated predator-prey interaction strengths.\nNote shorter food chain, greater proportion \\(\\lambda_1\\) negative (farther away zero) four level food chain. Clearly , shortening web increasing amount negative density dependence stabilizes , spite still number species.Let us categorize long short return times, graph distribution short ones.\nFigure 12.8: One predator three prey, negative density dependence results stable webs.\n","code":"\nEq = matrix(c(\n  -1,   0,   0, -10,\n  0,   -1,   0, -10,\n  0,    0,   -1, -10,\n  0.1, 0.1, 0.1,  0),\n  nrow=4, byrow=TRUE)\n# to confirm we got it right:\n# plotmat(Eq, relsize=.8)\nout.E <- pimmlawton(Eq, N=2000)\nsummary(out.E)##      DomEig                Im            IntraDD              I        \n##  Min.   :-0.486312   Min.   :0.0000   Min.   :0.04714   Min.   :0.206  \n##  1st Qu.:-0.284289   1st Qu.:0.1425   1st Qu.:0.38941   1st Qu.:2.301  \n##  Median :-0.201512   Median :0.6742   Median :0.49014   Median :2.861  \n##  Mean   :-0.208653   Mean   :0.5832   Mean   :0.48049   Mean   :2.799  \n##  3rd Qu.:-0.124729   3rd Qu.:0.8967   3rd Qu.:0.58144   3rd Qu.:3.372  \n##  Max.   :-0.002686   Max.   :1.4232   Max.   :0.83458   Max.   :4.772\nlayout(matrix(1:2,nr=1))\nplot(DomEig ~ IntraDD, data=out.E)\nplot(DomEig ~ I, data=out.E)\nRT.E <- -1/out.E[[\"DomEig\"]]\nE.fast <-RT.E[RT.E < 150]\nhistE <- hist(E.fast, breaks=seq(0,150, by=5), main=NULL)"},{"path":"food-webs-and-other-networks.html","id":"adding-omnivory","chapter":"12 Food webs and other networks","heading":"12.2.5 Adding Omnivory","text":"Real webs also omnivory — feeding one trophic level. nagging question, now, concerns effect omnivory food web dynamics. Pimm Lawton compared food web dynamics without omnivory. Let’s now create omnivorous web used compare directly linear food chain (Fig. 12.3, B vs. ). Next run 2000 simulations, check quick summary.omnivory, now see webs \\(\\lambda_1>0\\), thus unstable. one main points made Pimm Lawton. Let’s look data just stable webs.means randomly constructed webs stable point equilibria. complete, let’s graph Pimm Lawton . graphed return times positive, ignored negative.\nFigure 12.9: relatively omnivorous webs qualitatively stable, moderate fraction low return times.\n","code":"\nBq <- matrix(c(\n  -1, -10,   0,     0,\n  0.1,  0,   -10,   -2,\n  0,    0.02,   0,    -10,\n  0,    0.1,    0.1,   0),\n  nrow=4, byrow=TRUE)\n#plotmat(Bq, relsize=.8)\n# recall we have to tell the function which links are omnivorous\nout.B <-  pimmlawton(Bq, N=2000, omni.i=2, omni.j=4)\nsummary(out.B)##      DomEig              Im             IntraDD               I        \n##  Min.   :-0.1879   Min.   :0.00000   Min.   :0.000291   Min.   :0.174  \n##  1st Qu.: 0.3012   1st Qu.:0.00000   1st Qu.:0.125840   1st Qu.:2.266  \n##  Median : 0.6625   Median :0.00000   Median :0.245659   Median :2.849  \n##  Mean   : 0.6889   Mean   :0.03929   Mean   :0.248152   Mean   :2.781  \n##  3rd Qu.: 1.0336   3rd Qu.:0.00000   3rd Qu.:0.371943   3rd Qu.:3.336  \n##  Max.   : 1.9895   Max.   :0.99803   Max.   :0.499965   Max.   :4.887  \n##      I.omni        \n##  Min.   :0.001468  \n##  1st Qu.:0.343668  \n##  Median :0.691801  \n##  Mean   :0.700981  \n##  3rd Qu.:1.048982  \n##  Max.   :1.412821\nout.B.stable <- out.B[out.B[,\"DomEig\"]<0,]\npairs(out.B.stable)\nRT.B <- -1/out.B[[\"DomEig\"]]\nB.fast <- RT.B[RT.B < 150 & RT.B > 0 ]\nout.B.fast <- out.B[RT.B < 150 & RT.B > 0,]\nhistB <- hist(B.fast, breaks=seq(0,150, by=5),\n              main=NULL)"},{"path":"food-webs-and-other-networks.html","id":"comparing-chain-a-versus-b","chapter":"12 Food webs and other networks","heading":"12.2.6 Comparing Chain A versus B","text":"Now let’s compare properties two chains, without, , omnivory, chains B (Fig. 12.3, webs B). stochastic simulations, means distributions results. instance, distribution return times chain distribution return times chain B. ,\ncan plot histograms . Pimm Lawton compared webs common sense ways. compared simple summaries, includingthe proportion random webs qualitatively stable (positive return times),proportion stable random webs return times greater 150.Now let’s try graphical displays. Rather simply chopping long return times, use base 10 logarithms return times \ndistributions right-skewed. First, make data frame column web ID (B) column return times. filter just positive return timesNext create histogram return times using probability density instead counts.69 also add nonparametric density estimator.\nFigure 12.10: Comparing distributions return times chain B. ‘Density’ probability density.\noverlaying distributions, make interesting observation. omnivorous webs positive return times (plotted) actually tended shorter return times linear chain. Pimm Lawton noted , emphasize . Rather, sensibly focused obvious result, 90% omnivorous webs negative return times, indicating absence stable point equilibrium.","code":"\nret.time <- data.frame(web=rep(LETTERS[1:2], each=2000),\n                       return.time = c(RT.A, RT.B)) %>% \n  filter(return.time>0)\nggplot(ret.time, aes(return.time, fill=web)) + \n  geom_histogram(aes(y = ..density..),\n                 alpha=.5, position=\"identity\") + \n  geom_density(aes(fill=NULL, colour=web)) + \n  scale_x_log10() "},{"path":"food-webs-and-other-networks.html","id":"re-evaluating-take-home-messages","chapter":"12 Food webs and other networks","heading":"12.2.7 Re-evaluating Take-Home Messages","text":"primary messages made Pimm Lawton (1977) thatshorter webs stable long chains,omnivory destabilized webs.conclusions major part lively debate surrounding issues. consistent apparent observation time, empirical food webs revealed little omnivory (Pimm Lawton 1977, 1978), food chains nature seemed much shorter occur, primary productivity (green plants algae) channeled upwards linear chain.Let’s consider assumptions.First, Pimm Lawton made argument, many others (including us), systems stable point equilibria (nodes foci) likely persist systems persistent oscillations, stable limit cycles. easy show system can pushed stable equilibrium oscillations eventually become big drive element system extinction. reasonable assumption, one challenged enough. measures system stability used, minimum occurs long series fluctuations (Huxel McCann 1998; McCann Hastings 1997).Second, Pimm Lawton ignored effects self-regulated basal species. exhibiting negative density dependence, basal species stabilized web. Pimm Lawton made shorter web, also added self-regulated populations. Thus, necessarily confounded chain length number species negative density dependence. change caused observed differences among webs? don’t know.Third, assumed effect web topology (.e., short vs. long chain) best evaluated average properties topology, rather maximum properties topology. criteria, webs without omnivory clearly better. average, webs without omnivory often stable chains omnivory, even return times tended quite long. Therefore, one might argue web assembles nature, likely persist (.e., stable) lacks omnivory.However, let us consider preceding argument . world messy place, constant insults disturbances, resources environmental conditions fluctuating constantly. addition, constant rain propagules dropping communities, species abundances changing time. sense , communities constantly perturbed. webs can persist face onslaught stable ones, ones shortest return times. just showed Pimm Lawton’s analyses showed stable webs tended omnivory. Subsequent work supports claim omnivory rampant nature (Polis 1991), supported theory shows weak interactions, including omnivory, stabilize food webs (McCann 1998; McCann Hastings 1997).One feature simulations ignored oscillations implied imaginary component eigenvalue. Recall larger imaginary parts imply shorter cycles, zero means oscillation .Pimm Lawton made important contributions lengthy debate, finally figuring interpret results.","code":""},{"path":"food-webs-and-other-networks.html","id":"perhaps-mutualism-stabilizes-bipartite-networks","chapter":"12 Food webs and other networks","heading":"12.3 Perhaps mutualism stabilizes bipartite networks","text":"Understanding effects network architecture network resilience core mission community ecology. section, compare mutualist antagonist interactions bipartite networks affect network resilience (Thebault Fontaine 2010). bipartite network one two separate groups species, species interact groups, never within groups. Two examples herbivores plants, pollinators plants. Thebault Fontaine (2010) compared empirical simulated plant-pollinator plant-herbivore bipartite webs found differed network structure consequences network stability.run code section, need install packages. ’ve already installed , just load .\nFigure 12.11: Possible effects species richness, connectance, modularity, nestedness network resilience.\nquestions derived Thébault Fontaine (2010), approach use different. simulated dynamic communities using systems ODEs similar seen earlier chapters mutualism consumer-resource interactions. ODEs included negative density dependence plants type II functional responses mutualists herbivores.use approach used earlier, May (1973), Pimm Lawton (1977) Pimm Lawton (1978). approach, simulate dynamics. Instead, assume species coexist, draw interaction strengths random specified distribution. determines instantaneous per capita effect ’s population growth rate, , Jacobian matrix describes interactions.approach, establish interactions random, pair species (plant animal) probability interacting. probability connectance (\\(L/(PA)\\)), \\(P\\) \\(\\) numbers plants animals network. Note measure connectance differs previous definitions, ruling within-group interactions. means structure (connected ) determined randomly rather result dynamics ODE models Thebault Fontaine (2010). , number species connectance draw random, within specified ranges.","code":"\npkgs <- c(\"bipartite\", \"igraph\", \"rARPACK\", \"lavaan\", \"semPlot\")\n# install.packages(pkgs)\ninvisible( # to hide messages\n  lapply(pkgs, library, character.only=TRUE)\n)"},{"path":"food-webs-and-other-networks.html","id":"creating-bipartite-webs","chapter":"12 Food webs and other networks","heading":"12.3.1 Creating bipartite webs","text":"’ll start demonstrating toy example bipartite web mutualists: plants pollinators. select numbers species connectance.generate random interactions species using binomial distribution. distribution coin flips rolling die. want flip single fair coin ten times, can use rbinom().say “ten observations 1 trial.”want flip 10 coins count number heads, :say “one observation ten trials.”bipartite web, create Sa * Sp coin flips observations one trial, probability 0.4 getting link.create matrix links (links). create topology.web may species interact others; ’s okay now. One day, might data like .Now let’s add interaction strength. ’ll rely semi-realistic assumption much pollinators interact plant species. generally observed interactions weak (e.g., infrequent visits) strong (e.g., frequent visits). pattern can approximated exponential distribution. create interactions plot .Next can make pretty pictures web. , ’ll need load bipartite package.\nFigure 12.12: Illustrations hypothetical plant-pollinator network. two matrices organize species highlight either nestedness (left) modularity (right).\nseveral good network packages R. use bipartite igraph. measure nestedness modularity using functions package bipartite.measure nestedness (WNODF, Almeida-Neto Ulrich (2011)) varies 0 100 completely nonnested nested networks. measure modularity varies 0 1 completely non-modular modular networks.measure stability plant animal matrix, first convert square matrix, add little negative denisty dependence, use eigenanalysis find dominant eigenvalue.just example type network create simulation—create bipartite web random number species, random connectance, within specified bounds.","code":"\n# The number of species of plants\nSp <- 5\n# The number of species of pollinators\nSa <- 12\n# the total number of species\nS <- Sa+Sp\n\n# The connectance in this web. \ncontc <- .4\n# size is the number of coins to flip at once.\nrbinom(n=10, size = 1, prob=0.5 )##  [1] 1 1 0 0 1 1 1 1 0 0\n# size is the number of coins to flip at once.\nrbinom(n=1, size = 10, prob=0.5 )## [1] 5\n# Create interactions at random, drawing 0's and 1's with a probability of contc=0.5\ninteractions <- rbinom( n = Sa * Sp, size=1, prob=contc)\nbip.network <- matrix(interactions, nrow=Sp, ncol=Sa)\nrownames(bip.network) <- paste(\"plant\", LETTERS[1:Sp], sep=\"\")\ncolnames(bip.network) <- paste(\"bug\", LETTERS[1:Sa], sep=\"\")\n#...and look at it\nbip.network##        bugA bugB bugC bugD bugE bugF bugG bugH bugI bugJ bugK bugL\n## plantA    0    0    0    1    1    0    0    1    0    0    0    0\n## plantB    0    0    0    1    0    1    0    0    0    0    1    0\n## plantC    0    0    1    0    0    0    1    0    0    0    1    0\n## plantD    0    1    0    0    0    1    0    0    0    1    0    0\n## plantE    0    1    0    1    0    0    0    0    1    0    1    0\n# Exponentially distributed of interaction strengths\n# Random numbers from and exponential distribution\nxp <- rexp(Sa*Sp)\n\n# express these as a probability distribution (divide by the sum)\nxp <- xp/sum(xp)\n\n# assign those exponential probabilities to our interactions,\n# creating the Quantitative network\nbip.networkQ <- bip.network * xp\n{\n  # library(bipartite) if needed\n  # visweb and plotweb are in the bipartite package\n  layout(matrix(c(1,2,3,4), nc=2, byrow=TRUE) )\n  hist(bip.networkQ, main=\"\", xlab=\"interaction strength\")\n  bipartite::plotweb(bip.networkQ, method='normal') \n  bipartite::visweb(bip.networkQ, type='nested')\n  bipartite::visweb(bip.networkQ, type='diagonal')\n  }\n# Nestedness:\n# quant. version of NODF  (Almeida-Neto et al. 2008, 2011)\nnetworklevel(bip.networkQ, index=c(\"weighted NODF\"))## weighted NODF \n##      7.272727\nmetaComputeModules(bip.networkQ, N=5, method=\"Beckett\") @ likelihood## [1] 0.5686917\nn <- matrix(0, nr=S, nc=S) \n# upper triangular part\nn[1:Sp, (Sp+1):S] <- bip.networkQ\n# lower triangular part\nn[(Sp+1):S, 1:Sp] <- t(bip.networkQ) \n# Add negative density dependence that is the \n# same magnitude as other species interactions\ndiag(n) <- -1*max(rowSums(n))\n\n#Calculate stability\nRe(eigen(n)$values[1])## [1] -0.02598075"},{"path":"food-webs-and-other-networks.html","id":"testing-effects-of-nestedness-and-modularity-on-network-resilience.","chapter":"12 Food webs and other networks","heading":"12.3.2 Testing effects of nestedness and modularity on network resilience.","text":"webs, can compare effects negative vs. positive interactions directly, create one network interaction strengths, simply reverse signs effects animals plants get herbivory vs. mutualism.simulate 1000 random bipartite webs using large number different numbers plant animal species. select connectance drawing randomly uniform distribution values argument C.generate random network, save one version represents mutualists (+,+), reverse sign effect animal represent herbivory (+,-).function bip_stability() performs eigananalysis resulting Jacobian matrix estimate resilience, define negative real part dominant eigenvalue. way, greater resilience larger positive number. calculates resilience mutualist herbivorous versions random network. also calculates nestedness modularity ways similar Thebault Fontaine (2010). can calculate modularity two ways, using either binary adjacency matrix (ones zeroes) quantitative matrix; latter takes much moore time calculate, uses binary matrix default. also tallies diversity total number species connectance total number links divided number possible links.function several arguments can see described help file. Among \n* Spp.Spp.p: vectors numbers animal plant species drawn random,\n* C: two-element vector provide min max possible connectances drawn random,\n* reps: number random networks create.use generate 1000 random webs. use examine relations various emergent properties networks.can get summary output 1000 simulated webs .webs stable? means, medians ranges web properties? percent differences resiliences two interaction types?can also graph pairwise relations.copy Thebault Fontaine (2010), might check whether relations similar .","code":"\n#library(primer)\nb <- bip_stability(Spp.a = 16:60, Spp.p = 8:30, C=c(.05, 0.5), reps=5000, quant=FALSE)\nsummary(b)##        S               C             modularity        nestedness    \n##  Min.   :13.00   Min.   :0.06491   Min.   :0.00000   Min.   : 0.000  \n##  1st Qu.:42.00   1st Qu.:0.17867   1st Qu.:0.00000   1st Qu.: 9.158  \n##  Median :54.00   Median :0.27190   Median :0.09162   Median :14.362  \n##  Mean   :54.56   Mean   :0.28361   Mean   :0.19515   Mean   :14.465  \n##  3rd Qu.:67.00   3rd Qu.:0.38816   3rd Qu.:0.37102   3rd Qu.:19.855  \n##  Max.   :90.00   Max.   :0.56818   Max.   :0.85802   Max.   :32.335  \n##   resilience.m       resilience.h     \n##  Min.   :0.003216   Min.   :0.001893  \n##  1st Qu.:0.019222   1st Qu.:0.013289  \n##  Median :0.026624   Median :0.019060  \n##  Mean   :0.027845   Mean   :0.020408  \n##  3rd Qu.:0.035156   3rd Qu.:0.026141  \n##  Max.   :0.069583   Max.   :0.057484\npairs(b)"},{"path":"food-webs-and-other-networks.html","id":"path-analysis","chapter":"12 Food webs and other networks","heading":"12.3.3 Path Analysis","text":"Now sort analysis Thebault Fontaine get Fig. 2 C,D. Path analysis relatively simple way model sets correlations among dependent variables. , use lavaan package.look , see curvature relations. simple path analysis, Thebault Fontaine, relations assumed linear. transform data tad help linearize relations.next scale data variables mean zero standard deviation 1. simplify interpretation path analysis output: regression coefficients partial correlation coefficients effect sizes comparable others.specify relationships, y ~ x “y function x.” fit model get path coefficients.mimic Thebault Fontaine, include interactions figure 2. start mutualism web. Start loading lavaan package haven’t previously.estimates pairwise regressions. path coefficients tell us strengths relations among network properties. make path diagram using .Next, thing herbivory.make path diagrams, ’ll need semPlot package.\nFigure 12.13: Given bipartite network structure identical interaction strengths, mutualistic (left) antagonistic webs (right) show slightly different relations among emergent properties. Recall also resilience \nsee relations among empergent properties differs two web types. reassuring relations richness connectance vs. nestedness modularity identical. topologies (connections) identical, difference sign interactions.differences lie slightly different effects resilience. differences, consistent Thebault Fontaine (2010)? consistent generally presumed role mutualisms consumption food webs?","code":"\nout.tr <- (b)^.75\ndat <- data.frame( scale(out.tr) ) \n# library(lavvan)\n# Step 1: Specify model\nmodel.m <- 'resilience.m ~ nestedness + modularity + S + C\n          nestedness ~  S + C\n          modularity ~ S + C '\n\n# Step 2: Estimate model of mutualism\nmod.m.fit <- sem(model.m, data=dat)\ncoef(mod.m.fit)##    resilience.m~nestedness    resilience.m~modularity \n##                      0.095                      0.129 \n##             resilience.m~S             resilience.m~C \n##                      0.621                      0.684 \n##               nestedness~S               nestedness~C \n##                      0.062                      0.959 \n##               modularity~S               modularity~C \n##                     -0.324                     -0.828 \n## resilience.m~~resilience.m     nestedness~~nestedness \n##                      0.125                      0.064 \n##     modularity~~modularity \n##                      0.152\n# Step 1: Specify model\nmodel.h <- 'resilience.h ~ nestedness + modularity + S + C\n          nestedness ~ S + C\n          modularity ~ S + C'\n\n# Step 2: Estimate model of herbivory\nmod.h.fit <- sem(model.h, data=dat)\n#coef(mod.h.fit)  \n# library(semPlot)\nsemPaths(mod.m.fit, what='path', whatLabels=\"std\", \n         curve=1, curvature=1, sizeMan=10,\n         edge.label.cex = 1.5, nCharNodes=4,\n         edge.label.position=.7, layout='tree2')\nsemPaths(mod.h.fit, what='path', whatLabels=\"std\", \n         curve=1, curvature=1, sizeMan=10,\n         edge.label.cex = 1.5, nCharNodes=4,\n         edge.label.position=.7, layout='tree2')"},{"path":"food-webs-and-other-networks.html","id":"exploring-pandora-right-here-at-home","chapter":"12 Food webs and other networks","heading":"12.4 Exploring Pandora, right here at home","text":"Na’vi Pandora know something world works, working hard understand . world highly antagonistic world, driven consumption - tangled bank, nature, red tooth claw. However, around us hidden beneath feet, many species cooperate survive thrive otherwise harsh world. cooperation can happen among species can also happen among individuals within species. Suzanne Simard others investigating belowground networks nutrient flux information sharing among individuals species.plant species develop mycorrhizae, fungi-root associations typically mutualistic interactions. fungi can often connect individuals species together, creating network one plant can information, nutrients, carbon another plant via fungal highway. However, connections structured still poorly known. effort shed light , Beiler, Simard, Durall (2015) described topology Douglas fir trees connected two species individual fungal genets, contrasting environments (12.14).","code":""},{"path":"food-webs-and-other-networks.html","id":"properties-assessed","chapter":"12 Food webs and other networks","heading":"12.4.1 Properties assessed","text":"Application networks mycorrhizaenode = treelink = one fungal genets connecting two treestriplet = three connected trees (open triplet connected two links, closed, three)Network propertieslink density (links/species)degree distribution (statistical distribution node degrees)global network clustering coefficient: fraction triplets closed (. closed triplets) / (. open + . closed triplets)mean lcoal clustering coefficient among nodes networkBetweenness centrality: number times node acts bridge along shortest path two nodes. important node making connections nodes?Node propertiesdegree (# links)normalized degree: (fraction: d / possible d)node clustering coefficient (local transivity; extent neighbors connected)evaluated whether observed properties differed properties emerge random networks number nodes average node degree empirical mycorrhizal networks. can generate graph using igraph package.Plot 1, xeric site, 26 trees 258 links. Therefore, average node degree must \\(258/26\\approx 9.9\\). can create random graph simply specify number vertices number edges.\nFigure 12.14: Example random graph using number vertices links plot 1 (Beiler et al. (2015)).\ncan compare observed average node clustering coefficient (\\(0.84 \\pm 0.37\\)) random graph created . Note transivity node clustering.find differ. observed can compared 1000s simulated random networks see unusual observed value . use toy example 100 simulations compare node clustering coefficient observed plot 1 expect random network.\nFigure 12.15: Observed node clustering appears unuusally high, relatively random networks.\nsee local node clustering higher one real plot expect chance. Remember measures extent node’s neighbors connected .Among results, Beiler et al. found node clustering coefficient node degree increased tree size. interesting spite increasing tree size, negative relation node clustering coef node degree (Fig. 2). Beiler et al. point happens ‘scale-free’ graphs.scale-free graph one probability node L links follows power law relation,\n\\[Pr(L) \\sim L^{-z}\\]\n, apparently, \\(2<z<3\\). Let’s demonstrate one plot.\nFigure 12.16: Emergent relation node clustering node degree scale-free random network, based number nodes links plot 1.\nNow let’s combine plots one graph. First collect data Beiler et al. (Table 1,2, Beiler et al. (2015)).Next make function generates random graph data Beiler et al. calculates properties need.scale free graphs, set power exponent something 2 3.following somewhat complicated looking code following plot sitegenerates scale-free random graphcalculates local node clustering coefficient (transivity) resulting “tree,”calculates degree “tree,”records site plot.binds together data collected plot site.\nFigure 12.17: Emergent relations node clustering node degree scale-free random networks, based number nodes links plot.\nresult one example (six examples) observe scale-free network. one random draw, may may particularly representative “typical” properties suggested Beiler et al. (2015). Many observed networks appear scale-free, least first glance (Barabasi 2009). may useful approximation networks node properties might self-reinforcing, better-connected nodes tend become ever better connected.Thus far book, ’ve barely scratched surface food webs networks. hope least ’ve gotten sense flavor investigation.","code":"\n# node clustering coefficient: 0.84\n# for Plot 1\nV <- 26\nE <- 258\n\ngr <- erdos.renyi.game(V, E, type = \"gnm\")\n# graph \"order\" and \"size\"\ngorder(gr); gsize(gr)## [1] 26## [1] 258\nplot(gr, vertex.label= NA, edge.arrow.size=0.02,vertex.size = 0.5, xlab = \"Random Network: G(V,E) model\")\nmean(transitivity(gr, type = \"local\"))## [1] 0.7959873\nncc.sims <- replicate(100, { \n  gr <- erdos.renyi.game(V, E, type = \"gnm\")\n  mean(transitivity(gr, type = \"local\"))\n  } )\nqplot(x=ncc.sims, geom=\"histogram\") + \n  geom_vline(xintercept = 0.84, linetype=2)\n# node clustering coefficients (per node)\nncc <- transitivity(gr, type = \"local\")\n# degrees of each node\nd <- degree(gr)\nqplot(d, ncc, geom=\"jitter\")\n# vertices\nV <- c(26, 13, 31, 27, 27, 41)\n# egdes\nE <- c(258, 66, 283, 254, 177, 434)\n# proportion of trees colonized\npV <- c(.846, .5, .875, .846, .778, .889)\n# mean node degree\nmean.deg <- c(18, 695, 17.15, 17.52, 12.21, 20.19)\n# mean node clustering coef.\nmean.ncc <- c(.84, .63, .84, .85, .83, .8)\nplot <- 1:6\ndf <- data.frame(plot=plot, V=V, E=E, pV=pV, mean.deg=mean.deg, mean.ncc=mean.ncc)\ndf##   plot  V   E    pV mean.deg mean.ncc\n## 1    1 26 258 0.846    18.00     0.84\n## 2    2 13  66 0.500   695.00     0.63\n## 3    3 31 283 0.875    17.15     0.84\n## 4    4 27 254 0.846    17.52     0.85\n## 5    5 27 177 0.778    12.21     0.83\n## 6    6 41 434 0.889    20.19     0.80\nexp.out <- 2.5\ndf2 <- apply(df[,1:3], 1, function(ve){\n  #make a scale-free random graph, given V and E\n  gsf <- sample_fitness_pl(ve[2], ve[3], exponent.out= exp.out,\n                           exponent.in = -1, loops = FALSE,\n                           multiple = FALSE, \n                           finite.size.correction = TRUE)\n  # calculate prpoerties\n  ncc <- transitivity(gsf, type = \"local\")\n  deg <- igraph::degree(gsf)\n  \n  #combine in a matrix\n  m <- matrix(c(plot=rep(ve[1], length(deg)), ncc, deg), ncol=3)\n  m\n })\n\n# bind together both sites and label columns\ndf.sf <- as.data.frame( do.call(rbind, df2) )\nnames(df.sf) <- c(\"plot\", \"ncc\", \"deg\")\n\n# plot the relation between node clustering coefficient\n# and node degree\nggplot(df.sf, aes(deg, ncc, colour=as.factor(plot)) ) +\n  geom_point()  + geom_smooth( method=\"lm\", se=FALSE) + \n  scale_y_log10() "},{"path":"diversity.html","id":"diversity","chapter":"13 Diversity","heading":"13 Diversity","text":"","code":""},{"path":"diversity.html","id":"background-1","chapter":"13 Diversity","heading":"13.1 Background","text":"\nFigure 13.1: Empirical rank–abundance distributions successional plant communities (old-fields) within temperate deciduous forest biome North America. ‘Year’ indicates time since abandonment agriculture. Data Buell-Small succession study (http://www.ecostudies.org/bss/).\nseems easy, least tractable, compare abundance single species two samples. chapter, introduce conceptsthat ecologists use compare entire communities two samples. focus two quantities: species composition, diversity. also discuss several issues related , including species–abundance distributions, ecological neutral theory, diversity partitioning, species–area relations. Several packages R include functions dealing specifically topics.Please see “Environmetrics” link within “Task Views” link CRAN website downloading R packages. Perhaps comprehensive (including diversity composition) vegan package, many others include important features well.","code":""},{"path":"diversity.html","id":"species-composition","chapter":"13 Diversity","heading":"13.2 Species Composition","text":"Differences species composition among communities form \\(\\beta\\)–diversity. Understanding patterns processes communities change differs space time perhaps principal goal community ecology. Beta-diversity term give differences. Understanding precisely mean essential correctly addressing questions, Anderson et al. (2011) provided us excellent roadmap help. questions answers rely proper understanding multivariate distance. requires us start species composition.Species composition merely set species site sample. Typically includes measure abundance site, may also simply list species site, “abundance” either presence absence.Imagine four sites (–D) collect density data two species, Salix whompii Fraxinus virga. can enter hypothetical data following abundances.Next, plot abundances species; plotted points sites (Fig. 13.2).\nFigure 13.2: Hypothetical species composition four sites (–D)\nFig. 13.2, see species composition site different composition site D. , distance site D greater sites. next question, , far apart two sites? Clearly, depends scale measurement (e.g., values axes), also measure distance multivariate space.","code":"\ndens <- data.frame(Salwho=c(1,0,2,3), Fravir=c(21,8,13,5))\nrow.names(dens) <- LETTERS[1:4]\ndens##   Salwho Fravir\n## A      1     21\n## B      0      8\n## C      2     13\n## D      3      5\nplot(dens, type='n'); text(dens, row.names(dens))"},{"path":"diversity.html","id":"measures-of-abundance","chapter":"13 Diversity","heading":"13.2.1 Measures of abundance","text":"pretended abundances absolute densities (.e., 1 = one stem per sample). course represent abundances differently. instance, calculate relative density, species sample represented proportion sample comprised species. site , divide species sum species.see Salix makes 5% sample Site , Fraxinus makes 95% sample. calculate relative densities species site, eliminates differences total density site sites total 1.also calculate relative measures type data, biomass percent cover.instances, relative density refers density species relative species sample (), can also density sample relative samples. thus make species total equal 1, abundance site reflects proportion species total abundance comprised site. instance, can make Salix densities relative .see sites B 14% Salix stems, site D 43%.Whether measures abundance absolute relative, like know different samples (sites) . Perhaps simplest way describe difference among sites calculate distances dissimilarities pair sites.","code":"\ndens[1,]/sum(dens[1,])##       Salwho    Fravir\n## A 0.04545455 0.9545455\ndens[,1]/sum(dens[,1])## [1] 0.1666667 0.0000000 0.3333333 0.5000000"},{"path":"diversity.html","id":"dissimilarities-and-distances","chapter":"13 Diversity","heading":"13.2.2 Dissimilarities and Distances","text":"data just presence absence species, can calculate difference sites using Jaccard index similarity,\\[J_{AB} = \\frac{\\cap B}{\\cup B}\\]\nnumerator number species set shared species (present sites) denominator number species set present either site. Among sites, Jaccard index site B site \n\\[J_{BA} = \\frac{1}{2}\\]\nsite B C D well. Jaccard dissimilarity \\(1 - J\\). \\(0.5\\) site B site, zero pairs.quantitative version , \n\\[J_{AB} = \\frac{\\sum_{=1}^S \\min (x_i)}{\\sum_{=1}^S \\max (x_i)}\\]\n\\(x_i\\) abundance \\(\\). sites B, ,\\[J_{AB} = \\frac{0+8}{1+21}=4/11 = 0.\\overline{36}\\]\ndissimilarity \\(1-J_{AB}\\).Euclidean distance another important way measure differences sites. two species, two dimensional space, Fig. 13.2. Euclidean distance two sites merely length vector connecting sites. calculate \\(\\sqrt{x^2+y^2}\\), \\(x\\) \\(y\\) \\((x,y)\\) distances pair sites. \\(x\\) distance sites B C difference Salix abundance two sites,dens data frame sites rows, species different columns. \\(y\\) distance sites B C difference Fraxinus abundance two sites.Euclidean distance thereforeWe calculate pairwise Euclidean distances sites –D based 2 species using built-functions R.can generalize include number species, becomes increasingly harder visualize. can add third species, Mandragora officinarum, recalculate pairwise distances sites, now three species.can plot species abundances , pairs(dens) give us pairwise plots given three species. However, really want species 3-D plot. load another package create 3-D scatterplot.\nthree dimensions, Euclidean distances calculated basic way, add third species, calculation becomes \\(\\sqrt{x^2 + y^2 +z^2}\\). Note take square root (opposed cube root) originally squared distance. can generalize two sites \\(S\\) species \n\\[D_E = \\sqrt{\\sum_{=1}^S\\left( x_{ai} - x_{bi}\\right)^2}\\]course, difficult (impossible?) visualize arrangements sites three axes (.e., \\(>3\\) species), can always calculate distances pairs sites, regardless many species .many ways, addition Euclidean distances, calculate differences. Among commonly used ecology \nBray–Curtis dissimilarity, goes names, including Sørenson dissimilarity\n\\[D_{BC} = \\frac{\\sum_{=1}^S\\left| x_{ai} - x_{bi}\\right|}{\\sum_{=1}^S (x_{ai} + x_{bi})}\\]\n\\(S\\) number species samples. Bray–Curtis dissimilarity merely total difference species abundances two sites, divided total abundances site. Bray–Curtis dissimilarity (couple others) tends result intuitively pleasing distances common rare species relatively similar weights, whereas Euclidean distance depends strongly abundant species. happens Euclidean distances based squared differences, whereas Bray–Curtis uses absolute differences. Squaring always amplifies importance larger values. Fig. 13.3 compares graphs based Euclidean Bray–Curtis differences raw data.[Add note distance vs. dissimilarity, triangle inequality]","code":"\nx <- dens[2,1] - dens[3,1]\ny <- dens[2,2] - dens[3,2]\nsqrt(x^2 + y^2)## [1] 5.385165\n(alldists <- dist(dens))##           A         B         C\n## B 13.038405                    \n## C  8.062258  5.385165          \n## D 16.124515  4.242641  8.062258\ndens[[\"Manoff\"]] <- c(11,3,7,5)\n(spp3 <- dist(dens))##           A         B         C\n## B 15.297059                    \n## C  9.000000  6.708204          \n## D 17.204651  4.690416  8.306624\nlibrary(scatterplot3d)\nsc1 <- scatterplot3d(dens,  type='h', pch=\"\",\n      xlim=c(0,5), ylim=c(0, 25), zlim=c(0,15))\ntext(sc1$xyz.convert(dens), labels=rownames(dens))"},{"path":"diversity.html","id":"displaying-multidimensional-distances","chapter":"13 Diversity","heading":"13.2.3 Displaying multidimensional distances","text":"simple way display distances three species create plot two dimensions attempts arrange sites approximately correct distances apart. general impossible achieve precisely, distances can approximately correct. One technique tries create optimal (albiet approximate) arrangement non-metric multidimensional scaling. add fourth species (Aconitum lycoctonum) data set plotting distances.non-metric multidimensional scaling function  package. calculates distances us using original data. display Euclidean distances among sites (Fig. 13.3).\nFigure 13.3: Nonmetric multidimensional (NMDS) plots showing approximate distances sites. two figures display raw data, Euclidean distances tend emphasize differences due abundant species, whereas Bray-Curtis . NMDS provides iterative optimizations, find slightly different arrangements time run .\n","code":"\ndens$Acolyc <- c(16, 0, 9,4)\n# ignore warnings for these toy examples\nmdsE <- metaMDS(dens, distance=\"euc\", autotransform=FALSE, trace=0)\nplot(mdsE, display=\"sites\", type=\"text\")\nmdsB <- metaMDS(dens, distance=\"bray\", autotransform=FALSE, trace=0)\nplot(mdsB, display=\"sites\", type=\"text\")"},{"path":"diversity.html","id":"diversity-1","chapter":"13 Diversity","heading":"13.3 Diversity","text":"mind, urgent interesting goal ecology evolutionary biology understanding determinants biodiversity. Biodiversity many things many people, typically think measure variety biological life present, perhaps taking account relative abundances. ecologists, often think species diversity quantitative measure variety number different species. direct analogues genetic diversity within population (Crow Kimura 1970; Vellend Geber 2005), connections species genetic diversity include shared patterns shared mechanisms. confine entirely discussion species diversity, variety different species present.","code":""},{"path":"diversity.html","id":"species-diversity","chapter":"13 Diversity","heading":"13.4 Species diversity","text":"Species diversity represents variety species community sample community. Fig. 13.1 shows us glance distributions species abundances, thus diversities, plant community different points time undergoes secondary succession. figure see number different species present (x-axis), relative abundances (y-axis). image gives us intuition variety species might encounter. shows us whether might expect encounter many different species, whether community might dominated one just species. sense try capture single number call “diversity index.”Species diversity closely allied mechanisms coexistence. two areas differ diversity, likely ask . number variety species present depend many species available colonize area, also mechanisms allow coexist locally. MacArthur Wilson (1963) envisioned terms ecology, number species area s function rates immigration local extinction,\n\\[S = \\Delta - \\Delta E\\]\nmechanisms coexistence govern \\(\\Delta E\\). equation basis theory island biogeography (MacArthur Wilson 1963, 1967). later.many diversity indices calculate; , calculate four different measures: species richness, Shannon-Weiner diversity, Simpson’s diversity, Simpson’s inverse diversity. sometimes referred slightly different names, important figure exactly someone done.Let’s start creating two samples two different communities.\nFigure 13.4: Two toy communities.\ntwo samples different numbers species, different distributions. Community Y even distribution species abundances, whereas community X dominated single species. Now ’ll calculate different measures species diversity.Species richness simply number different species sample. value x-axis figure. calculate data, determine lengths vectors nonzero abundances.Species richness increases number individuals sample increases. Therefore, care taken comparing richness two different samples make sure sufficiently comparable.ecologists use term ‘species diversity’ referring species richness, rather index incorporates relative abundance well. One common Shannon-Weiner diversity Shannon index. quantity roots information theory entropy. measures disorder data set. instance, nearly individuals single species, data highly predictable ordered. contrast, many individuals many different species, difficult describe simple way, difficult predict sample look like–disorder, entropy, high. Shannon index \n\\[H=-\\sum_{-1}^Sp_i\\log p_i\\]\n\\(p_i\\) proportion individuals belonging species \\(\\).numbers provide relative estimates “variety.” increase increasing species richness increasing evenness abundances. hypothetical upper limit, ranges minimum zero single species, five six hyper-diverse communities.Simpson diversity indices based Simpson dominance index. dominance index probability two randomly selected individuals belong species,\n\\[D = \\sum_{=1}^S p_i^2\\]\nvaries 1 single species declines toward zero increasing numbers species increasing number species. describing alleles, instead trees, value inbreeding coefficient, genetic homozygosity Nei (1987). also referred Gini coefficient, formulated measure income inequality. value used two ways aid calculation diversity. One Simpson’s diversity index arithmetic complement,\n\\[S_c = 1-D\\],\nprobability two randomly selected individuals belong different species. also initial slope expected individuals (\\(x\\)) vs. species (\\(y\\)) curve (R. Lande, DeVries, Walla 2000), variance species composition (Russell Lande May 1996).show equivalence Simpson’s index variance species composition. First, reimagine community X collections individuals comprising different species identities. create pretend community six individuals (rows) 3 species (columns). Somewhat oddly, identify degree individual comprised species; case, individuals can one species.70 let two individuals species.transposed matrix, individuals columns species membership identity rows. first individual belongs species , etc. can plot individuals community space, like (Fig. 13.5).\nFigure 13.5: 14 individuals three species community, plotted ‘compsition space.’ large black dot multivariate mean, centroid, center gravity composition space. Simpson’s diversity variance species composition individuals.\nNext can calculate centroid, multivariate mean. merely vector species means.Given centroid, begin calculate variance () subtracting species vector (0s, 1s) mean, (ii) squaring deviates, (3) summing get sum squares.divide sum number individuals community (\\(N\\))compare calculation Simpson’s complement , find . , finite sample size correction .Simpson’s complement diversity index converges quickly increasing sample size, making reliable index small sample sizes. also unbiased estimator (Russell Lande May 1996), \n\\[\\hat{S_c} = \\frac{N}{N-1}(1-D)\\]Simpson’s inverse diversity index inverse dominance,\n\\[S_I = \\frac{1}{D}\\]\nvalue considered ‘effective’ number species, discounts rarest species (Nee 2005) closely allied population genetics theory one definition ‘effective number alleles’ (Nee 2005; Crow Kimura 1970).can calculate defining functions. create grouped data frame calculate summary statistics, using dplyr package (part tidyverse).case, indices agree , intuition: community Y ‘diverse.’diversity indices actually directly related — comprise estimates entropy, amount disorder multiplicity possible states system, directly related via single constant (Keylock 2005). However, important consequence differences richness depends heavily rare species, Simpson’s complement depends heavily relative abundance common species, Shannon-Wiener stands somewhere two.","code":"\ncomm <- rep(c(\"X\",\"Y\"), each=4)\nspp <- letters[c(1:4, 1:4)]\nabun <- c(10,3,1,0, 4,1,6,3)\nrank <- c(1,2,3,4, 2,4,1,3)\ndf <- data.frame(comm=comm, spp=spp, n=abun, rank=rank)\nggplot(df, aes(rank, n, colour=comm, linetype=comm)) + \n  geom_line() + lims(y=c(1,10)) \ntapply(X=df$n, INDEX=df$comm, \n       FUN = function(x) {length(x[x>0])} )## X Y \n## 3 4\n# a function that starts with abundances and calculates H\nshannon <- function(n) { \n  n <- n[n>0] # remove zero values\n  p <- n/sum(n)\n  -1 * sum( p*log(p) )\n  }\ntapply(X=df$n, INDEX=df$comm, \n       FUN = shannon)##         X         Y \n## 0.7589368 1.2396594\nX <- matrix(0, nrow=14, ncol=3, \n            dimnames=list(NULL, c(\"A\", \"B\", \"C\")))\nX[1:10,1] <- 1\nX[11:13,2] <- 1\nX[14,3] <- 1\nt(X)##   [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]\n## A    1    1    1    1    1    1    1    1    1     1     0     0     0     0\n## B    0    0    0    0    0    0    0    0    0     0     1     1     1     0\n## C    0    0    0    0    0    0    0    0    0     0     0     0     0     1\nlibrary(scatterplot3d)\nX3D <- scatterplot3d(jitter(X, .1), type='h', angle=60, pch=rep(1:3, c(10,3,1)) )\nX3D$points3d(x=10/14, y=3/14, z=1/14,  type='h', pch=19, cex=2)\n(centroid1 <- colMeans(X))##          A          B          C \n## 0.71428571 0.21428571 0.07142857\n(SS <- sum( sapply(1:3, function(j) (X[,j] - centroid1[j]))^2) )## [1] 6.142857\nSS/14## [1] 0.4387755\nSc <- function(x) {\n  p <- x/sum(x)\n  1-sum(p^2)\n}\nSi <- function(x) {\n  p <- x/sum(x)\n  1/sum(p^2)\n}\n\ndfg <- group_by(df, comm) # group by community\n\n# calculate indices for each community type.\nsummarize(dfg,\n          richness = length( n[n>0]),\n          H = shannon(n),\n          Sc = Sc(n),\n          Si = Si(n)\n          )## # A tibble: 2 × 5\n##   comm  richness     H    Sc    Si\n##   <chr>    <int> <dbl> <dbl> <dbl>\n## 1 X            3 0.759 0.439  1.78\n## 2 Y            4 1.24  0.684  3.16"},{"path":"diversity.html","id":"rarefaction-and-total-species-richness","chapter":"13 Diversity","heading":"13.5 Rarefaction and total species richness","text":"Rarefaction process generating relationship number species vs. number individuals sample. typically determined randomly resampling individuals (N. J. Gotelli Colwell 2001). Rarefaction allows direct comparison richness two samples, corrected numbers individuals. particularly important richness depends heavily number individuals sample. Thus rarefaction finds general relation number species vs. number individuals, limited less equal number species actually observed. related curve species-accumulation curve collector’s curve, simply useful haphazard accumulation new species (cumulative sum) investigator samples new individuals.Another issue ecologists face trying estimate true number species area, given samples collected. number species larger number species observed, often referred total species richness asymptotic richness. Samples almost always find subset species present area region, might prefer know many species really , general area sampled. many ways , better others, none perfect. methods estimate minimum numbers species, assume unsampled areas homogeneous similar sampled areas.using methods seriously, inquisitive reader consult (N. J. Gotelli Colwell 2001; Magurran 2004) references http://viceroy.eeb.uconn.edu/EstimateS. , briefly explore example R.","code":""},{"path":"diversity.html","id":"an-example-of-rarefaction-and-total-species-richness","chapter":"13 Diversity","heading":"13.5.1 An example of rarefaction and total species richness","text":"Let us sample seasonal tropical rainforest Barro Colorado Island (BCI) goal provide baseline data later comparison studies.use data 50 ha plot included vegan package (Condit et al. 2002; Oksanen et al. 2019). pretend sampled every tree 10 cm DBH,71 10 plots scattered throughout 50 ha area. say forest within plots located? consider scale sampling. experimental unit grain 1 ha plots. Imagine plots scattered throughout 50 ha plot, extent sampling full 50 ha (sensu Wiens 1989).First, let’s pretend sampled 10 1 ha plots extracting samples larger dataset.data set plots rows species names columns; data numbers individuals species (columns) plot (rows).Next, total numbers species, pooling plots together. sum columns, remove zeroes.Based sample, find species richness samples pooled tally non-zero species.goal estimate number species area. need estimators total species richness, can assume surrounding forest homogeneous. First, ’ll use abundance-based coverage estimators, ACE Chao 1, appear give reasonable estimates (Magurran 2004).see observed number species two estimators, standard errors.Next use frequency-based estimator, Chao 2, data need presence/absence, also need multiple sample plots. using multiple plots, get idea rare species use estimate many rare species might unsampled.also get jackknifed estimate. give estimate minimum true number species area around samples.Typically use estimators accompanied form rarefaction. perform rarefaction, need select numbers individuals want rarefied samples. use multiples 500 also total number individuals sample. use built-function draw species random numbers individuals, , perform rarefaction.Next want graph , bells whistles. set graph 10 plot, individual-based rarefaction, leave room graph total richness estimators well (Fig. 13.6).\nFigure 13.6: Baseline tree species richness estimation based ten 1 ha plots, using individual-based rarefaction. also include Chao 2 total richness estimators observed total tree richness 50 ha plot comparison (black dot).\nshows us total richness estimator overestimate total number species within extent relatively homogenous sample area (Fig. 13.6). sense, estimators estimating minimum total number species thus conservative.Simpson’s diversity provides interesting description rarifcation curve. expected number species sample \\(N\\) individuals drawn community total species richness \\(S\\), \n\\[\\mathrm{E}[\\hat{S}] = S-\\sum_{=1}^S (1-p_i)^N\\]\n\\(p_i\\) frequency relative abundance species \\(\\). initial slope rarifaction curve, \n\\[\\frac{\\Delta \\mathrm{E}[\\hat{S}]}{\\Delta N}\\]\n\\(\\Delta N = 2-1=1\\). numerator difference expected number species sample two vs. one individual. can work , remind rules working sums, sum \\(p_i\\) 1, definition. Also, helps realize \\(N=1\\), \\(E[\\hat{S}] = 1\\).\\[\\begin{align*}\n\\Delta E[\\hat{S}] &= S-\\sum_{=1}^S(1-p_i)^2 - \\left( S-\\sum_{=1}^S(1-p_i) \\right)\\\\\n  &= S - \\sum_{=1}^S(1-2p_i+p_i^2) - 1\\\\\n &= S - \\sum_{=1}^S(1) + \\sum_{=1}^S (2p_i) - \\sum_{=1}^S(p_i^2) - 1\\\\\n &= S - S + 2 - \\sum_{=1}^S(p_i^2) - 1\\\\\n & = 1 - \\sum_{=1}^S(p_i^2)\n\\end{align*}\\], else equal, Simpson’s diversity important part shape species accumulation curve. slope probability two individuals drawn random belong two different species. :)","code":"\nlibrary(vegan)\ndata(BCI);\nbci <- BCI[seq(5,50, by=5),]\nbci[1:5, c(1,5)]##    Abarema.macradenia Adelia.triloba\n## 5                   0              1\n## 10                  1              0\n## 15                  0              2\n## 20                  0              0\n## 25                  0              0\nN <- colSums(bci) \nN <- N[N>0]\nsum(N>0)## [1] 179\nestimateR(N)##      S.obs    S.chao1   se.chao1      S.ACE     se.ACE \n## 179.000000 202.000000  12.763215 190.638313   6.779286\n(chaoF <- specpool(bci))##     Species     chao  chao.se jack1 jack1.se    jack2     boot  boot.se  n\n## All     179 202.4321 11.99975 203.3 8.606393 214.9444 190.7196 5.146857 10\nno.of.inds <- c(seq(500, 4500, by=500), sum(N))\nrar3 <- rarefy(N, sample=no.of.inds, se=T, MARG=2)\nplot(no.of.inds , rar3[1,],  ylab=\"Species Richness\", axes=FALSE,\n     xlab=\"No. of Individuals\", type='n',  ylim=c(0,250), \n     xlim=c(500,5900) )\n# estimate\nlines(no.of.inds, rar3[1,], type='b')\n# approximate confidence intervals\nlines(no.of.inds, rar3[1,]+2*rar3[2,], lty=3)\nlines(no.of.inds, rar3[1,]-2*rar3[2,], lty=3)\naxis(1, at=1:5*1000); axis(2); box(); \ntext(2500, 200, \"Individual-based rarefaction (10 plots)\")\n\n# add the Chao 2 estimator\nsegments(5500, chaoF[1,'chao'] - 2*chaoF[1,'chao.se'], \n         5500, chaoF[1,'chao'] + 2*chaoF[1,'chao.se'], \n         lwd=3, col='darkgrey')\ntext(5500, 150, \"Chao 2 estimate\", srt=90, adj=c(1,.5) )\n\npoints(5800, dim(BCI)[2], pch=19, cex=1.2)\ntext(5800, 150, \"Obs. S in 50 ha\", srt=90, adj=c(1,.5) )"},{"path":"diversity.html","id":"distributions","chapter":"13 Diversity","heading":"13.6 Distributions","text":"estimators total species richness assume species abundances follow sort distribution species common, rare. explore particular types distributions used quantify aspect community structure.Like vector numbers, can make histogram species abundances. example, make histogram bci tree densities, species density (left, Fig. 13.7). shows us patently true nearly ecological communities, species rare.\nFigure 13.7: Three related types distributions tree species densities Barro Colorado Island. Left, histogram raw data; center, species–abundance distribution, histogram log-transformed abundances, accompanied normal probability density function; right, rank–abundance distribution, typically presented log-transformed data, complement cumulative probability density function (1-pdf). Normal distributions applied using mean standard deviation log-transformed data, times total number species.\n","code":""},{"path":"diversity.html","id":"log-normal-distribution","chapter":"13 Diversity","heading":"13.6.1 Log-normal distribution","text":"Given general empirical patterns, species rare, Frank Preston (Preston 1948, 1962) proposed describe communities using logarithms species abundances (center, Fig. 13.7).72 often reveals community can described approximately normal distribution applied log-transformed data, log-normal ditribution. can also display rank–abundance distribution (right, Fig. 13.7). , assign abundant species rank = 1, least abundant rank = \\(S\\), sample \\(S\\) species, plot log-abundance vs. rank.R. M. May (1975) described several ways common processes may drive log-normal distributions, cause common data sets. commonly cited note log-normal distributions arise observation (.e., random variable) results product independent factors. , species’ density determined largely independent factors act multiplicatively species, resulting densities log-normally distributed. process known ecological drift, pure demographic stochasticity species equal fitness drive log-normal-like distribution (see later section neutral theory).Well dozen types abundance distributions exist describe abundance patterns, log-normal (Magurran 2004). can represented rank–abundance distributions.","code":""},{"path":"diversity.html","id":"other-distributions","chapter":"13 Diversity","heading":"13.6.2 Other distributions","text":"geometric distribution, also known niche preemption distribution, reflects simple idea, wherein species pre-empts constant fraction remaining niche space (R. M. May 1975; Motomura 1932). instance, first species uses 20% niche space, second species uses 20% remaining 80%, etc. frequency \\(\\)th abundant species \n\\[N_i = \\frac{N_T}{C}d\\left(1-d\\right)^{-1}\\]\n\\(d\\) abundance common species, \\(C\\) just constant make \\(\\sum N_i = N_T\\), \\(C=1-\\left(1-d\\right)^{S_T}\\). Thus describes geometric rank–abundance distribution.log-series distribution (Fisher, Corbet, Williams 1943) describes expected frequency species \\(n\\) individuals,\n\\[\\begin{equation}\n\\tag{13.1} \nF\\left(S_n\\right) = \\frac{\\alpha x^n}{n}\n\\end{equation}\\]\n\\(\\alpha\\) constant represents diversity (greater \\(\\alpha\\) means greater diversity); \\(\\alpha\\) diverse rainforest might 30–100. constant \\(x\\) fitted free parameter, always true \\(0.9 < x < 1.0\\) \\(x\\) increases toward 0.99 \\(N/S \\20\\) (Magurran 2004). \\(x\\) can estimated \\(S/N=[(1-x)/x] \\cdot [-\\ln(1-x)]\\). Note described rank–abundance distribution, species abundances ranks can nonetheless plotted manner (R. M. May 1975).can estimate Fisher’s alpha using optimal.theta() untb library.log-series rank–abundance distribution thus bit pain, relying standard exponential integral (R. M. May 1975), \\(E_1(s) = \\int_s^\\infty exp(-t)/t\\,dt\\). Given range \\(N\\), calculate ranks \n\\[F\\left(N\\right) = \\alpha \\int_s^\\infty exp(-t)/t\\,dt\\]\ncan let \\(t=1\\) \\(s = N \\log \\left(1 + \\alpha/N_T\\right)\\). code .log-series distribution interesting property total number species sample \\(N\\) individuals \\(S_T = \\alpha \\log(1+N/\\alpha)\\). parameter \\(\\alpha\\) sometimes used measure diversity. data log-series distributed, \\(\\alpha\\) approximately number species expect 1 individual, \\(x\\approx 1\\). Two general theories predict log-series distribution, including neutral theory, maximum entropy. Oddly, two theories predict log-series distribution, make opposite assumptions niches individuals (see next section).MacArthur’s broken stick distribution classic distribution results even distribution species abundances (MacArthur 1957). expected number individuals species \\(\\) \n\\[N_i = \\frac{N_T}{S_T}\\sum_{n=}^{S_T}\\frac{1}{n}\\]\n\\(N_T\\) \\(S_T\\) total number individuals species sample, respectively. MacArthur described resulting simultaneous breakage stick random points along stick. resulting size fragments \\(N_i\\) . MacArthur’s broken stick model thus stochastic deterministic model. simulation stick breakage direct analogue deterministic analytical expression.similarly tactile stick-breaking distributions create host different rank–abundance patterns (Tokeshi 1999). particular, stick can broken sequentially, first one random point, random point along one two newly broken fragments, additional point along one three broken fragments, etc., \\(S_T-1\\) breaks creating \\(S_T\\) species. critical difference models becomes subsequent fragment selected. probability selecting fragment related directly size, becomes identical MacArthur’s broken stick model. hand, subsequent piece selected randomly, regardless size, results something similar log-normal distribution (Sugihara 1980; Tokeshi 1990). variations fragment selection generate patterns (Tokeshi 1999).plot empirical rank-abundance distribution BCI data census 50 ha plot, along several fitted distributions. fit using radfit function vegan package. add log series distribution.\nFigure 13.8: Entire BCI rank abundance distribution several fitted models. ‘Null’ broken stick distribution, dashed line log series.\n","code":"\n# fit the distributions\nN <- rev(sort(colSums(BCI)))\n# get the expected ranks for the log series distribution\n# standard exponential integral\nsei <- function(t = 1) exp(-t)/t\nalpha <- optimal.theta(N)\nNt <- sum(N)\nrank.logseries <- sapply(N, function(x) {\n  n <- x * log(1 + alpha/Nt )\n  f <- integrate(sei, n, Inf)\n  fv <- f[[\"value\"]]\n  alpha * fv } )\n\nmod <- radfit(N)\npar(mar=c(5,4,1,1))\nplot(mod) \nlines(rank.logseries, N, lty=2)"},{"path":"diversity.html","id":"pattern-vs.-process","chapter":"13 Diversity","heading":"13.6.3 Pattern vs. process","text":"Note resemblance stick-breaking niche evolution — envision whole stick available niche space, energy, limiting resources, fragment represents portion total occupied species. Thus, various patterns breakage act models niche partitioning relative abundance patterns. biological stochastic processes create specific distributions. instance, completely random births, deaths, migration, speciation create log-series distribution log-normal-like distributions (see neutral theory ). noted independent, multiplicatively interacting factors can create log-normal distribution.Although intriguing ponder processes can generate particular patterns, infer definitively underlying processes patterns observe. different processes can generate pattern. Nonetheless, particuar patterns can suggest certain hypotheses underlying processes. Many ecologists argue describing patterns predicting important goals ecology (Peters 1988), others argue understanding mechanistic process important goal. Regardless, camps agree can’t draw firm conclusions processes based solely patterns — nowhere ecology fallacy prevalent abundance distributions (Hairston Sr. 1991).","code":""},{"path":"diversity.html","id":"neutral-theory-of-biodiversity-and-biogeography","chapter":"13 Diversity","heading":"13.7 Neutral Theory of Biodiversity and Biogeography","text":"One model abundance distributions particularly important, elaborate . referred variously unified neutral theory biodiversity biogeography (Hubbell 2001) often ‘neutral theory’ ‘eccological drift’ short. Neutral theory important much models abundance distributions. testable theory makes quantitative predictions across several levels organization, evolutionary ecological processes.Just evolutionary biology neutral theories gene allele frequencies, ecology neutral theories population community structure dynamics (Bell 2000; Caswell 1976; Hubbell 2001). Neutral communities species computationally mathematically related often identical models genes alleles (Ewens 2004) (Table 13.1). Thus, lessons learned genetic drift often apply neutral models communities. Indeed, neutral ecological dynamics local scale often referred ecological drift, populations change via demographic stochasticity.73Stephen Hubbell proposed unified neutral theory biodiversity biogeography (hereafter NTBB, (Hubbell 2001)) null expectation dynamics individuals, help explain relative abundances tropical trees. Hubbell describes direct descendant MacArthur Wilson’s theory island biogeography (MacArthur Wilson 1963, 1967) (see , species–area relations). Hubbell proposed null hypothesis also — controversial part — model community dynamics closely approximates reality.\nFigure 13.9: *Left: local community forest canopy trees (small box) nested inside part metacommunity tropical forest. true metaccommunity extend far beyond boundaries figure include true potential source propagules. Shades grey indicate different species. local community sample larger community (50 ha forest dynamics plot BCI) receives migrants metacommunity. Mutation gives rise new species metacommunity. particular local community, 50 ha plot island Panama canal, metacommunity include surrounding forest island, also Panama, perhaps much neotropics. Right: Neutral ecological drift. Ten species, 90 individuals, undergo random walks within finite local community, immigration. , one generation equal nine deaths nine births. Note slow decline unevenness — 1000 deaths, species become extinct.\nrelevant world NTBB metacommunity (left, Fig. 13.9), , collection local communities connected dispersal (Leibold et al. 2004).74 metacommunity populated entirely individuals functionally identical. NTBB theory dynamics individuals, modeling individual births, deaths, migration mutation. assumes within guild, late successional tropical trees, species essentially neutral respect fitness, , exhibit fitness equivalence. means probabilities birth, death, mutation migration identical individuals. Therefore, changes population sizes occur via random walks, , via stochastic increases decreases time step (right, Fig. 13.9). Random walks imply absence competition indirect enemy mediated negative density dependence. Rather, competition thought diffuse, equal among individuals. discuss details context simulation. Negative density dependence arises either specific constraint total number individuals community (Hubbell 2001), traits individuals related probabilities births, deaths, speciation (Volkov et al. 2005).basic paradox NTBB, absence migration mutation, diversity gradually declines zero, monodominance. random walk due fitness equivalence eventually result loss species except one. However, loss diversity single local community predicted , slow, countered immigration speciation (discuss details ). Thus, species increase deterministically rare — makes concept coexistence different stable coexistance criteria discussed previous chapters. Coexistance stable rather stochastic event limited time horizon balanced emergence new species.communities thought undergo random walks toward monodominance, diversity maintained particular region? Two factors maintain species local community. First, immigration local community metacommunity can bring new species. Even though local community undergoing random walk toward monodominance, local community may become dominated one species pool species equal fitness. Thus separate local communities predicted become dominated different species, differences among local communities help maintain diversity metacommunity landscape.75 Second, longer time scales larger spatial scales, speciation (.e., mutation lineage-splitting) within entire metacommunity maintains biodiversity. Mutation consequent speciation provide ultimate source variation. Random walks toward extinction large communities lengthy extinctions balanced speciation.Introducing new symbols jargon ecological neutral theory, state diversity metacommunity, \\(\\theta\\), function number individuals metacommunity, \\(J_M\\), per capita rate new species arise (via mutation) \\(\\nu\\) (\\(\\theta = 2J_M \\nu\\); Table 13.1). local community undergoes ecological drift; drift causes slow loss diversity, balanced per capita (\\(J_L\\)) immigration rate \\(m\\).\nTable 13.1: Comparison properties jargon used ecological population genetic neutral theory (Alonso, Etienne, McKane 2006). \\(x\\) continuous variable relative abundance species allele (\\(0 \\le x \\le 1\\), \\(x = n/J\\)). Note potentially confused Fisher’s log-series \\(\\langle \\phi_n \\rangle = \\theta x^n /n\\), discrete species abundance distribution terms numbers individuals, \\(n\\) (relative abundance), \\(x=b/d\\).\nturns abundance distribution infinitely large\nmetacommunity Fisher’s log-series distribution, \\(\\theta\\)\nneutral theory \\(\\alpha\\) Fisher’s log-series (Alonso McKane 2004; Leigh E. G. 1999; Volkov et al. 2003). However, one local community, random walks rare species likely include zero, thus become extinct local community chance alone. causes deviation Fisher’s log-series local community reducing number rarest species predicted Fisher’s log-series. particular, tends create log-normal–like distribution, much often see real data (Fig. 13.7). theoretical findings match observed data thus consistent hypothesis communities may governed, substantive part, neutral drift migration.theory empirical data show species coexist may similar predicted chance alone (Leibold McPeek 2006), similarity (.e., fitness equality) among species helps maintain higher diversity otherwise possible (Chesson 2000a). Chesson makes important distinction stabilizing mechanisms, create attractors, equalizing mechanisms, reduce differences among species, slow competitive exclusion facilitate stabilization (Chesson 2000a).NTBB spurred tremendous debate roles chance determinism, dispersal-assembly niche-assembly, evolutionary processes ecology, go ‘community ecology’ (see, e.g., articles Functional Ecology, 19(1), 2005; Ecology, 87(6), 2006). theory narrowest sense falsified field experiments observation studies [Clark McLachlan (2003); Wootton2005]. However, degree stochasticity \ndispersal versus niche partitioning structure communities\nremains generally unknown. Continued refinements elaboration (e.g., [Alonso McKane (2004); R. S. Etienne (2007); Green Plotkin (2007), Volkov et al. (2007)) seem promising, continuing intrigue scientists different perspectives natural communities Latimer, Silander, Cowling (2005).Even communities turn completely non-neutral, NTBB provides baseline community dynamics patterns increased rigor evidence required demonstrate mechanisms controlling coexistence diversity. Alonso, Etienne, McKane (2006) state, “… good theory predictions per free parameter bad theory. yardstick, neutral theory fares fairly well.” (see also Marquet et al. 2014).","code":""},{"path":"diversity.html","id":"different-flavors-of-neutral-communities","chapter":"13 Diversity","heading":"13.7.1 Different flavors of neutral communities","text":"Neutral dynamics local community can simulated slightly different ways, envisioned type random walk. random walk occurs individuals reproduce die random, consequence population increases decreases chance.simplest version random walk assumes births deaths consequent increases decreases population size equally likely equal magnitude. problem type random walk community can increase size (number individuals) without upper bound, can disappear entirely, chance. know doesn’t happen, critically important first step conceptualizing neutral dynamic (Caswell 1976).Hubbell added another level biological reality fixing total number individuals local community, \\(J_L\\), constant. individual dies, replaced another individual, thus keeping population size constant. Replacements come within local community probability \\(1-m\\), replacements come greater metacommunity probability \\(m\\). dynamics metacommunity slow compared local community can safely pretend fixed, unchanging.Volkov et al. (2003) took different approach assuming species undergoes independent biased random walks. imagine species undergoes completely independent random walk, interacting species. key birth rate, \\(b\\), slightly less death rate, \\(d\\) — bias toward death gives us name biased random walk. deterministic model immigration speciation, result slow population decline zero. stochastic model, however, populations increase abundance chance alone. Slow random walks toward extinctions balanced speciation metacommunity (probability~\\(\\nu\\)).species undergo independent biased random walks, mean species don’t compete otherwise struggle existence? . reason \\(b < d\\) precisely species struggle existence, sufficiently high fitness, lucky, survive. Neutral theory predicts species observe nature — lucky, also sufficiently high fitness.metacommunity, average number species, \\(\\langle \\phi_n^M \\rangle\\), population size \\(n\\) \n\\[\\begin{equation}\n\\tag{13.2}\n  \\langle \\phi_n^M \\rangle = \\theta \\frac{x^n}{n}\n\\end{equation}\\]\n\\(x = b/d\\), \\(\\theta = 2J_M\\nu\\) (Volkov et al. 2003). \\(M\\) superscript refers metacommunity, angle brackets indicate merely average. \\(b/d\\) barely less one, biased random walk offset speciation, \\(\\nu\\). Now see exactly Fisher’s log-series distribution (13.1), \\(x=b/d\\) \\(\\theta = \\alpha\\). Volkov et al. thus show neutral metacommunity, \\(x\\) biological interpretation.expected size entire metacommunity simply sum average species’ \\(n\\).\n\\[\\begin{equation}\n  \\tag{13.3}\n  J_M = \\sum_{n=1}^{\\infty} n \\langle \\phi_n^M \\rangle = \n  \\theta \\frac{x}{1-x}\n\\end{equation}\\]\nThus size metacommunity emergent property dynamics, rather external constraint. mind, seems number individuals metacommunity must result responses individuals external environment.Volkov et al. went derive expressions births, deaths,\naverage relative abundances local community. Given individual equal probability dying reproducing, replacements can also come metacommunity probability proportional abundance metacommunity, one can specify rules populations local communities fixed size. probability increase, \\(b_{n,k}\\), decrease, \\(d_{n,k}\\), species, \\(k\\), population size \\(n\\).\n\\[\\begin{align}\n  b_{n,k} & = \\left(1-m\\right)\\frac{n}{J_L}\\frac{J_L-n}{J_L-1} + m\\frac{\\mu_k}{J_M}\\left(1-\\frac{n}{J_L}\\right)   \\tag{13.4}\\\\\n  d_{n,k}&=(1-m)\\frac{n}{J_L}\\frac{J_L-n}{J_L-1} + m\\left(1-\\frac{\\mu_k}{J_M}\\right)\\frac{n}{J_L} \\tag{13.5}\n\\end{align}\\]\nexpressions sum two joint probabilities, comprised several independent events. events immigration, birth death individuals different species. describe probabilities. population size \\(n\\) species \\(k\\), can indicate per capita, per death probabilities including\\(m\\), probability replacement immigrant metacommunity, \\(1-m\\), probability replacement local community.\\(n/J_L\\), probability individual selected\nrandomly local community belongs species \\(k\\), \\(1  - n/J_L\\) \\((J-n)/(J_L)\\), probability individual\nselected randomly local community belongs species \\(k\\).\\((J-n)/(J_L-1)\\), conditional probability , given\nindividual species \\(k\\) already drawn \npopulation, individual selected randomly local\ncommunity belongs species species \\(k\\).\\(\\mu_k/J_M\\), probability individual randomly\nselected metacommunity belongs species \\(k\\), \\(1 -  n/J_M\\), probability individual randomly selected \nmetacommunity belongs species \\(k\\).probabilities probability unspecified event — event might birth, death, immigration.translate (13.4), (13.5) literally, note\n\\(b\\) \\(d\\) two terms. first term dynamics\nrelated local community, happen probability \\(1-m\\). second related immigration metacommunity occurs probability \\(m\\). Consider also death replaced birth species, birth countered death species, cancel , nothing ever happened. Therefore term requires probability related species \\(k\\) non-\\(k\\).Eq. (13.4), \\(b_{n,k}\\), probability individual added population species \\(k\\). first term joint probability addition population comes within local community (\\(1-m\\)) birth comes species \\(k\\) (\\(n/J_L\\)) death individual species (\\((J_L-n)/(J_L-1)\\)).76 second term joint probability addition population comes metacommunity via immigration (\\(m\\)) immigrant species \\(k\\) (\\(\\mu_k/J_M\\)) accompanied death individual species (\\(n/J_L\\)).individual may subtracted population following similar logic. Eq. , \\(d_{n.k}\\), probability death remove individual population species \\(k\\). first term joint probability death occurs species \\(k\\) (\\(n/J_L\\)) replacement comes local community (\\(1-m\\)) species \\(k\\) (\\((J_L-n)/(J_L-1)\\)). second term joint probability death occurs species \\(k\\) (\\(n/J_L\\)), replaced immigrant (\\(m\\)) immigrant species metacommunity \\(k\\) (\\(1-\\mu_k/J_M\\)).","code":""},{"path":"diversity.html","id":"investigating-neutral-communities","chapter":"13 Diversity","heading":"13.7.2 Investigating neutral communities","text":"explore netural communities using untb package, contains variety functions teaching research neutral theory.Pure driftAfter loading package setting graphical parameters, let’s run simulation drift. Recall drift results slow extinction one species. start local community 20 species, 25 individuals77 simulation runs 1000 generations (9/900 individuals die per generation). Note display.untb() great pretty pictures, whereas untb() better serious simulations.]keep matrix 450 trees 1000\ntime steps can investigate properties \ncommunity. output matrix element integer\nwhose value represents species ID. Rows time steps can\nthink columns spots ground occupied trees. Thus \nparticular spot ground may occupied individual one\nspecies long time, suddenly switch identity, dies\nreplaced individual another species. Thus \ncommunity always 450 individuals (columns), identities \n450 change time, according rules laid \n(13.4), (13.5). different species represented different integer; show identities ten individuals (columns) generations 901–3.Thus, generation 901, tree . 1 species 6 generation 902, tree . 3 species 20.can make pretty pictures communities time steps 1, 100, 2500, single point tree, coding species identity shades grey. use nice color palette, hcl(), based hue, chroma, luminance, instance hcl([,]*30+50).function applies community, time step, grey() function. Recall species identity integer; use integer characterize species’ shade grey.Next create three graphs three time points, appropriate data, colors, titles.\nFigure 13.10: Three snapshots one community, drifting time. Shades grey represent different species. second third rows rank-abundances species -abundance distributions corresponding communities . Drift results slow loss diversity.\nBottom line: drift causes slow loss species local communities (Fig. 13.10). illustrated without dispersal, drift cause different species become abundant different places variation random. way, drift maintains diversity large scales, metacommunity. Last, low rates dispersal among local communities maintains diversity local communities without changing entire metacommunity single large local community. Thus dispersal limitiation, absence, maintains diversity.Next, let’s examine dynamics time. plot individual species trajectories (Fig. ).random walks general, observed variance coefficient variation (\\(CV=\\hat{\\sigma}/\\bar{x}\\)) population grow time (Clark McLachlan 2003). calculate average population \\(CV\\) cumulative observations (note convenient use nested (s)apply functions). Let’s calculate \\(CV\\)’s every tenth time step.Now plot average \\(CV\\) time. average observed \\(CV\\) increase (Fig. ).Real dataLast, examine BCI data set (Condit et al. 2002). load data (data 50 1,ha plots \\(\\times\\) 225 species, vegan package), sum species abundances get species total entire 50,h plot (Fig. ??).\nlike estimate \\(\\theta\\) \\(m\\) data, \nrequires specialized software data set realistic number\nindividuals. Specialized software provide maximum likelihood\nestimates (reasonable amount computing time) \\(m\\) \n\\(\\theta\\) large communities (Rampal S. Etienne 2005; Hankin, R.K.S 2007; Jabot Chave 2009). BCI data used repeatedly, rely estimates literature (\\(\\theta \\approx 48\\), \\(m \\approx 0.1\\)) [Rampal S. Etienne (2005);Volkov:2003ly]. use approach Volkov et al. (2003) generate expected species abundances (Fig. ??).Jabot Chave (2009) arrived estimates differed previous estimates orders magnitude. novel approach estimated \\(\\theta\\) \\(m\\) derived species abundance data phylogenetic data (\\(\\theta \\approx 571\\), \\(m \\approx 0.002\\)). possible neutral theory makes rich array predictions, based ecological evolutionary processes. data little bit different (due later census), analyses revealed radically different estimates, much greater diversity larger metacommunity (greater \\(\\theta\\)), much lower immigration rates (smaller \\(m\\)).derive expected species abundance distributions. first based solely census data, similar previous expections. However, also included phylogenetic data, found different expected species abundance distributions (Fig. 13.11).\nFigure 13.11: Jabot Chave found used species abundances (previous investigators) pattern similar previous findings (solid line). However, adding phylogenetic information led different expectations (dashed line)\nSymmetry rare species advantageAn important aspect neutral theory quantification symmetric rare species advantage. symmetry hypothesis posits species symmetrical rare species advantage (Volkov et al. 2005, 2007). , species increase rare degree (equal negative density dependence). strict sense, individuals remain birth death probabilities change population size manner species. obviously reduces chance random walks extinction, nonetheless among species. Estimation magnitude rare species advantage interesting addition stepwise increasing complexity.sum : safe say neutral theory already made thinking community structure dynamics sophisticated subtle, extending island biogeography individuals. theory providing quantitative, pattern-generating models, analogous null hypotheses. advent specialized software, theory now becoming useful analysis data (Rampal S. Etienne 2005; Hankin, R.K.S 2007; Jabot Chave 2009).","code":"\nlibrary(untb)\na <- untb(start=rep(1:20, 25), prob=0, gens=2500, D=9, keep=TRUE)\n( a2 <- a[901:903, 1:10 ] )##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]\n## [1,]    6    2   20   20   20   10   10    6   15    15\n## [2,]    6    2   20   20   20   10   10    6   15    15\n## [3,]    6    2   20   20   20   10   10    6   15    15\ntimes <- c(1,50,2500)\nsppcolors <- sapply(times, function(i) grey((a[i,]-1)/20) )\nlayout(matrix(1:3, nr=1))\npar(mar=c(1,1,3,1))\nfor(j in 1:3){\nplot(c(1,20), c(1,25), type=\"n\", axes=FALSE)\npoints(rep(1:20,25), rep(1:25,each=20), pch=19, cex=2, col=sppcolors[,j])\ntitle(paste(\"Time = \", times[j], sep=\"\"))\n}\nlayout(matrix(1:9, nr=3, byrow=TRUE))\npar(mar=c(1,1,3,1))\nfor(j in 1:3){\nplot(c(1,20), c(1,25), type=\"n\", axes=FALSE)\npoints(rep(1:20,25), rep(1:25,each=20), pch=19, cex=1.5, col=sppcolors[,j])\ntitle(paste(\"Time = \", times[j], sep=\"\"))\n}\n\npar(mar=c(5,4,1,1))\nfor(i in times){\nplot(as.count(a[i,]), \n     ylim=c(1,max(as.count(a[2000,]))), xlim=c(0,20))\n}\n\npar(mar=c(6,4,1,3))\nout <- lapply(times, function(i)  preston(a[i,]) )\nbins <- matrix(0, nrow=3, ncol=length(out[[3]]) )\nfor(i in 1:3) bins[i,1:length(out[[i]])] <- out[[i]]\nbins##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]\n## [1,]    0    0    0    0    0   20    0    0    0\n## [2,]    0    0    0    0    0   18    2    0    0\n## [3,]    0    0    0    1    1    1    3    0    2\ncolnames(bins) <- names(preston(a[times[3],]))\nfor(i in 1:3){\n  par(las=2)\nbarplot(bins[i,], ylim=c(0,20), xlim=c(0,8), ylab=\"No. of Species\", xlab=\"Abundance Category\" )\n}\nsppmat <- species.table(a)\nmatplot(1:times[3], sppmat[1:times[3],], type='l', ylab=\"Population Density\")\ncvtimes <- seq(2, 2500, by=10)\nCV.within <- sapply(cvtimes, function(i) {# Use sapply with i as a row counter\n  ## For each row i, use apply to caluculate the variance for each\n  ## population from 1:i\n  cvs <- apply(sppmat[1:i,],2, function(x) sd(x)/mean(x) )\n  mean(cvs) # get the mean among populations (for each i).\n  } )\n#popvar.among <- apply(sppmat, 1, var)\nplot( cvtimes, CV.within, type='l' )\nn <- colSums(BCI)\npar(las=2, mar=c(7,4,1,1))\nxs <- plot(preston(rep(1:225,n), n=12, original=TRUE))\nv1 <- volkov(sum(n), c(48, 0.1), bins=TRUE)\nplot(preston(rep(1:225,n), n=12, original=TRUE))\npoints(xs, v1[1:12], type='b')\n# Census data only\nv2 <- volkov(sum(n), c(48, 0.1), bins=TRUE)\n# With phylogenetic data as well.\nv4 <- volkov(sum(n), c(571, 0.002), bins=TRUE)\n\nplot(preston(rep(1:225,n), n=12, original=TRUE))\nxs <- plot(preston(rep(1:225,n), n=12, original=TRUE))\naxis(1, at=xs, labels=FALSE)\npoints(xs, v2[1:12], type='b', lty=1, col=1)\npoints(xs, v4[1:12], type='b', lty=2, col=2)"},{"path":"diversity.html","id":"speciesarea-relations","chapter":"13 Diversity","heading":"13.8 Species–area relations","text":"number species observe clearly depends number individuals sample, turn may depend size area count individuals. reason alone, may interested relation species area. However, area alos important likely correlated habitat heterogeneity, dispersal limitation, even reproductive isolation. study species-area relations includes understanding things fit together.relation number species found samples different area long tradition (Arrhenius 1921; MacArthur 1972; MacArthur Wilson 1963, MacArthur1967; Preston 1960; Rosenzweig 1995), now important part subdiscipline macroecology (Brown 1995; J. Harte et al. 2008).generally, species–area relation (SAR) simply empirical pattern number species found patches different size, plotted function sizes respective patches (Fig. ??). patches may isolated , islands South Pacific (MacArthur Wilson 1963), mountaintops covered coniferous forest surrounded sea desert (Brown Davidson 1977), calcareous grasslands agricultural landscape (Hambäack et al. 2007). hand, patches might nested sets, larger patch contains others (Crawley Harral 2001; Plotkin et al. 2000).Quantitatively, relation often proposed simple power law,\n\\[\\begin{equation}\n  \\tag{13.6}\n  S = cA^z\n\\end{equation}\\]\n\\(S\\) number species patch size \\(\\), \\(c\\) \\(z\\) fitted constants. often plotted log–log relation, makes linear.\n\\[\\begin{equation}\n  \\tag{13.7}\n  \\log\\left(S\\right) = b + z \\log()\n\\end{equation}\\]\n\\(b\\) intercept (equal \\(\\log c\\)) \\(z\\) slope. forms used, sometimes better capture relation (S. M. Scheiner 2003).simply draw species area curves.fit species–area curve data, examine slope. fit nonlinear power relation (\\(y=cA^z\\)); appropriate, instance, residual noise around line magnitude patch areas. use reduced major axis regression, appropriate equivalent uncertainty error \\(x\\) \\(y\\). Last (often), use simple linear regression log-transformed data, appropriate know \\(x\\) high degree accuracy, measure \\(y\\) error, transformation causes residual errors similar magnitude areas. start last (log-transformed). plot data, fit linear model common log-transformed data.\nFigure 13.12: Two different fits moth species-area data.\nNote Figure 13.12, fits differ slightly two methods. Let’s compare confidence intervals slopes — certainly expect similar, given picture just drew.note estimates slopes quite similar. addition, \\(\\log \\) also similar intercept linear model. Determining better two methods (others) beyond scope book, aware methods can matter.major impetus species–area relation came () Preston’s work connections species–area relation log-normal species abundance distribution (Preston 1960, 1962), (ii) MacArthur Wilson’s theory island biogeography (MacArthur Wilson 1967).Preston posited , given log-normal species abundance distributions (see ), increasingly large samples accumulate species particular rates. Direct extensions work, linking neutral theory maximum entropy theory species abundances species–area relations continued (Bell 2001; J. Harte et al. 2008; Hubbell 2001).","code":"\nA <- 10^1:10; c <- 1.5; z <- 0.25\ncurve(c*x^z, 10, 10^10, n=500, ylab=\"No. of Species\", xlab=\"Area (ha)\")\ncurve(log(c,10) + z*x, 1, 10, ylab=quote(log[10](\"No. of Species\")), \n      xlab=quote(log[10](\"Area (ha)\")) )\ndata(moths)\nmod.nonlin <- nls(spp ~ a*area^z, start=list(a=1, z=.2),data=moths)\nmod <- lm(log(spp,10) ~log(area,10), data=moths)\nplot(log(spp,10) ~ log(area,10), moths)\nabline(mod)\ncurve(log(coef(mod.nonlin)[1],10) +  x*coef(mod.nonlin)[2], \n      0, 3, add=TRUE, lty=2)\n# linear fit to transformed data\nconfint(mod)##                    2.5 %   97.5 %\n## (Intercept)   1.50842866 1.677286\n## log(area, 10) 0.09025952 0.196390\n# nonlinear fit to raw data\nconfint(mod.nonlin)##          2.5%      97.5%\n## a 31.61609496 50.1918074\n## z  0.08491709  0.1957816"},{"path":"diversity.html","id":"island-biogeography","chapter":"13 Diversity","heading":"13.8.1 Island biogeography","text":"MacArthur Wilson proposed simple theory wherein number species oceanic island function immigration rate new species, extinction rate existing species (Fig. 13.13). number species one time dynamic equilibrium, resulting slow inevitable extinction slow continual arrival replacements. Thus species composition island predicted change time, , undergo turnover. appreciation ecological evolution processes govern number variety species islands continues grow (R. J. Whittaker et al. 2017).Let us imagine immigration rate, \\(y\\), function number species already island, \\(x\\) (Fig. 13.13). relation negative slope, number species rises, chance new individual actually represents new species decline. immigration rate highest species island, \\(x=0\\), fall zero every conceivable species already . addition, slope decelerating (concave ) species much likely others immigrate. means immigration rate drops steeply likely immigrants arrive, unlikely immigrants missing. Immigrants may colonize quickly two reasons. First, Preston noted, species simply much common others. Second, species much better dispersers others.Now let us imagine extinction rate, \\(y\\), function number species, \\(x\\) (Fig. 13.13). relation positive slope, probability extinction increases number species. predicted accelerating slope (concave-), essentially sorts reasons governing shape immigration curve: species less common others, therefore likely become extinct due demographic environmental stochasticity, second, species lower fitness number reasons. number species accumulates, likely become extinction-prone species (rare /lower fitness) present, therefore able become extinct.rate change number species island,\n\\(\\Delta S\\), difference immimigration, \\(\\), extinction, \\(E\\), \n\\[\\begin{equation}\n  \\tag{13.8}\n   \\Delta S = - E.\n\\end{equation}\\]\n\\(\\Delta S = 0\\), equilibrium. knew quantitative form immigration extinction, solve equilibrium. equilibrium point \\(x\\) axis, \\(S\\), two rates cross (Fig. 13.13).MacArthur Wilson’s theory island biogeography, rates driven sizes islands, wherelarger islands lower extinction rates larger average population sizes, andlarger islands higher colonization rates larger targets dispersing species.distance island sources propagules also predicted influence rates, whereislands closer mainlands higher colonization rates new species propagules likely arrive , andthe effect area important islands far mainlands islands close mainlands.Like much good theory, simple ideas, profound\neffects way ecologists thought communities. Now \nideas, dispersal mediated coexistence landscape structure,\ncontinue influence community ecologists.Drawing immigration extinction curves\nFigure 13.13: Immigration extinction curves theory island biogeography. declining curves represent immigration rates functions number species present island. increasing curves represent extinction rates, also functions island richness. See text discussion heights curves, .e., controls rates. dashed lines represent island shrinking size.\nassume immigration rate, \\(\\), can represented simple negative exponential function \\(\\exp (I_0 - )\\), \\(I_0\\) rate immigration empty island, \\(-\\) per species negative effect immigration rate.\nNote extinction rate, \\(E\\), must zero species present. Imagine extinction rate function density average density declines number species increases, \\(\\bar{N} = 1/S\\).78We subtract 1 merely make sure \\(E=0\\) \\(R=0\\).number species, \\(R\\), result \\(\\Delta S = 0= -E\\), point lines cross.\n\\[\\begin{gather}\n  = e^{I_0 - bS}\\\\\n  E = e^{dS}-1 \\\\\n\\delta S = 0 = -E\n\\end{gather}\\]\nfind empirically creating function \\(S\\) \nminimize — minimize \\((-E)^2\\); squaring difference gives\nquantity convenient property minimum approached either positive negative values.feed optimizer one-parameter functions, specify know optimum achieved somewhere interval 1 50.output tells us minimum achieved \\(S \\approx 16.9\\).Now imagine rising sea level causes island area shrink. predicted ? couldreduce base immigration rate island smaller target,increase extinction rate reduced densities.Let us represent reduced immigration rate reducing \\(I_0\\).Next increase extinction rate increasing per species rate.11 species, roughly 35% decline (\\((17-11)/17 = 0.35\\)).beauty theory focuses attention landscape level processes, often outside spatial temporal limits sampling regimes. specifies factor helps determine immigration rate extinction rate, including island area proximity source propagules, predicted alter equilibrium number species point time. emphasize identity species change time, , undergo turnover, new species arrive old species become extinct. rate turnover, however, likely slow, species likely immigrate least likely become extinct species year year.","code":"\nI0 <- log(1)\nb <- .1\ncurve(exp(I0 - b*x),0, 50, \n      xlab='No. of Species (R)', ylab=\"Rate (I or E)\")\nd <- .01\ncurve(exp(d*x)-1, 0, 50) \n# use add=TRUE to add the line to a previous graph\ndeltaS <- function(S) { (exp(I0-b*S) - (exp(d*S)-1))^2 }\noptimize(f=deltaS, interval=c(1,50))[[\"minimum\"]]## [1] 16.91321\nI0 <- log(1/2)\ncurve(exp(I0 - b*x), 0,50, lty=2)\n# use add=TRUE to add to a previous plot\nd <- .014\ncurve(exp(d*x)-1, 0, 50, lty=2)\noptimize(f=deltaS, interval=c(1,50))[[\"minimum\"]]## [1] 10.99834"},{"path":"diversity.html","id":"diversity-partitioning","chapter":"13 Diversity","heading":"13.9 Diversity Partitioning","text":"frequently refer biodiversity (.e., richness, Simpson’s, Shannon-Wiener diversity) different spatial scales \\(\\alpha\\), \\(\\beta\\), \\(\\gamma\\) diversity.Alpha diversity, \\(\\alpha\\), diversity point location single sample.Beta diversity, \\(\\beta\\), diversity due multiple localities. saw , \\(\\beta\\) diversity also used describe differences species composition among sites.Gamma diversity, \\(\\gamma\\), diversity region, least diversity species set samples collected large area (large extent relatve single sample).Diversity across spatial scales can partitioned one two ways, either using additive ormultiplicative partitioning.Additive partitioning [Crist Veech (2006); Crist:2003ym; Russell Lande May (1996)] represented \n\\[\\begin{equation}\n  \\tag{13.9}\n  \\bar{\\alpha} + \\beta = \\gamma \n\\end{equation}\\]\n\\(\\bar{\\alpha}\\) average diversity samples, \\(\\gamma\\) typically diversity pooled samples, \\(\\beta\\) found difference (\\(\\beta = \\gamma - \\bar{\\alpha}\\)). can think \\(\\beta\\) average number species found sample, know region. Additive partitioning allows direct comparison average richness among samples hierarchical level organization three measures diversity (\\(\\alpha\\), \\(\\beta\\), \\(\\gamma\\)) expressed units. makes analogous partitioning variance ANOVA. case multiplicative partitioning diversity.R. H. Whittaker (1960) proposed multiplicative partitioning diversity,\\[\\begin{equation}\n\\tag{13.10}\n  \\bar{\\alpha}\\beta = \\gamma \n\\end{equation}\\]\n\\(\\beta\\) conversion factor describes relative change species composition among samples. Sometimes type \\(\\beta\\) diversity thought number different community types set samples. However, one must use interpretation great caution, either meaning \\(\\beta\\) diversity depends completely sizes extent samples used \\(\\alpha\\) diversity.\nFigure 13.14: Hierarchical sampling moth species richness forest patches Indiana Ohio, USA. \\(\\alpha\\)-diversity diversity single site (richness indicated numbers). \\(\\gamma\\)-diversity total number species found samples (\\(\\gamma=230\\) spp.). Additive \\(\\beta\\)-diversity difference, \\(\\gamma - \\bar{\\alpha}\\), average number species observed single sample. Diversity partitioning can done two levels, sites within ecoregions ecoregions within geographic region (see example text details).\nLet us examine limits \\(\\beta\\) diversity extremely small extremely large samples. Imagine sample units contain, average, one individual (therefore one species) 10\\(^6\\) samples. richness measure diversity, \\(\\bar{\\alpha}=1\\). Now imagine samples find total 100 species, \\(\\gamma=100\\). additive multiplicative partitions \\(\\beta_{}=99\\), \\(\\beta_{M}=100\\), respectively. size sample unit increases, sample include individuals therefore diversity, definition, \\(\\beta\\) decline. sample gets large enough, sample capture species sample gets large includes species (.e., \\(\\bar{\\alpha} \\\\gamma\\)). point, \\(\\beta_A \\0\\) \\(\\beta_M \\1\\).\nFigure 13.15: Relations \\(eta_A\\) (additive partitioning) \\(\\beta_M\\) (multiplicative partitioning) \\(\\bar{\\alpha}\\), fixed \\(\\gamma=500\\) species. example, defined diversityas species richness, units \\(\\beta_A\\) \\(\\alpha\\) number species per sample, \\(\\bar{\\alpha}\\) mean number species sample. contrast, multiplicative partition, \\(\\beta\\) number communities.\nNote \\(\\beta_A\\) \\(\\beta_M\\) change rates (Fig. ). increase sample size sample includes average two species (\\(\\bar{\\alpha} = 2\\)), \\(\\beta_A = 98\\) \\(\\beta_M =50\\). sample big enough average 50 species (\\(\\bar{\\alpha} = 50\\)), \\(\\beta_A = 50\\) \\(\\beta_M =2\\).Multiplicative \\(\\beta_M\\) sometimes thought number independent “communities” set samples. make sense sampling regime designed capture representative parts different communities. example, sampled elevational gradient, productivity gradient, smallest sample sufficiently large representative point along gradient79 \\(\\beta_M\\) provide measure relative turnover composition “number different communities.” However, know , else equal, composition also predicted vary randomly across landscape. Therefore, sample small, really representative community, small size samples inflate \\(\\beta_M\\) change interpretation.example, consider BCI data, consists 50 contiguous 1,ha plots. First, find \\(\\gamma\\) (species data set, number columns), \\(\\bar{\\alpha}\\) (mean species number per 1,ha plot).Next find additive \\(\\beta\\)-diversity multiplicative \\(\\beta\\)-diversity.Now interpret . plots located relatively uniform tropical rainforest. Therefore, samples drawn single community type. However, samples small. Therefore, 1 ha plot (\\(10^4\\) m\\(^2\\) size) misses species finds, average (\\(\\beta_A > \\bar{\\alpha}\\)). addition, \\(\\beta_M=2.48\\), indicating great deal turnover species composition. mistakenly interpret indicating something like \\(\\sim 2.5\\) independent community types samples. , however, single community type — additive partitioning little simpler transparent interpretation.meanings \\(\\beta\\)-diversity, linked neutral theory, see (Morlon et al. 2008).","code":"\na <- seq(1,100, by=.1)\ng <- max(a)\nbA <- g-a\nbM <- g/a\nmatplot(a, cbind(bA, bM), type='l', xlab=quote(bar(italic(alpha))), ylab=quote(italic(beta)), col=1)\n(gamma <- dim(BCI)[2])## [1] 225\n(alpha.bar <- mean( specnumber(BCI) ))## [1] 90.78\n(beta.A <- gamma - alpha.bar)## [1] 134.22\n(beta.M <- gamma/alpha.bar)## [1] 2.478519"},{"path":"diversity.html","id":"partitioning-speciesarea-relations","chapter":"13 Diversity","heading":"13.9.1 Partitioning species–area relations","text":"may already wondering link island biogeography \\(\\beta\\)-diversity. , move island island, move small islands large islands, typically encounter additional species, mean \\(\\beta\\)-diversity. Sure enough, connections (Crist Veech 2006), older edition primer walks .Let us consider study moth diversity (Fig. 13.14) Keith Summerville Thomas Crist (Summerville Crist 2003, 2004). subset data presented consists woody plant feeding moths collected southwest Ohio, USA. Thousands individuals trapped 21 forest patches, distributed two adjacent ecoregions (12 sites - North Central Tillplain [NCT], 9 sites - Western Allegheny Plateau [WAP], Fig. 13.14). data set includes total 230 species, 179 species present NCT ecoregion 173 species present WAP ecoregion. subtotals, can already see ecoregion combined total species (\\(\\gamma\\)).partition richness three spatial scales: sites within ecoregions (\\(\\bar{\\alpha}_1\\)), ecoregions (\\(\\bar{\\alpha}_2\\)), overall (\\(\\gamma\\)). result two \\(\\beta\\)-diversities: \\(\\beta_1\\) among sites within ecoregion, \\(\\beta_2\\) ecoregions. relations among straightforward.\n\\[\\begin{gather}\n  \\tag{13.11}\n  \\bar{\\alpha}_2 = \\bar{\\alpha}_1 + \\beta_1\\\\\n  \\gamma = \\bar{\\alpha}_2 +  \\beta_2 \\\\\n  \\gamma = \\bar{\\alpha}_1 + \\beta_1 + \\beta_2\n\\end{gather}\\]R, merely implement equations using \ndata Fig. 13.14. First, get\naverage site richness, \\(\\bar{\\alpha}_1\\). different\nnumbers individuals different site, richness depends strongly number individuals sample, may want weight sites number individuals. However, make perhaps questionable argument moment trapping effort similar sites, adjust numbers individuals. assume different numbers individuals reflect different population sizes, let number individuals one local determinants richness.Next calculate average richness richness ecoregions. 12 sites NCT, nine sites WAP might argued landscape constraints, use weighted average richness, adjusted number sites.80 also create object \\(\\gamma=230\\).Next, get remaining quantities interest, show partition consistent.\nFigure 13.16: Hierarchical partitioning moth species richness forest patches.\npartitioning reveals \\(\\beta_1\\) largest fraction overall \\(\\gamma\\)-richness (Fig. 13.16). indicates spite large distance sampling areas located different ecoregions, different soil types associated flora, variation occurs among sites within regions. greater difference moth community composition among ecoregions, \\(\\beta_2\\)-richness made greater proportion total.calculations show us simple additive partition can , although complicated analyses certainly possible. can important weight appropriately various measures diversity (e.g., number individuals sample, number samples per hierarchical level). number individuals particular tremendous influence richness, less influence Simpson’s diversity partitioning. freely available PARTITION software perform additive partitioning (sample sizes weights) perform statistical tests (Veech Crist 2007).Connecting species–area curveThe total number moth species patches , , \\(\\gamma\\). average richness patches \\(\\bar{\\alpha}\\), also note part determines average area patch. , species missing patch, part reason might patch smaller . therefore partition \\(\\beta\\) yet one category: species missing due patch size, \\(\\beta_{area}\\). new quantity average difference \\(\\bar{\\alpha}\\) diversity predicted largest patch (Fig. 13.17). general ,\n\\[\\begin{equation}\n  \\tag{13.12}\n  \\beta = \\beta_{area} + \\beta_{replace}\n\\end{equation}\\]\n\\(\\beta_{replace}\\) average number species missing explained patch size.context data (Fig. 13.17), now realize \\(\\beta_1 = \\beta_{area} + \\beta_{ecoregion}\\), full partition becomes\n\\[\\begin{equation}\n  \\tag{13.13}\n\\gamma = \\bar{\\alpha}_1 + \\beta_{area} + \\beta_{ecoregion} + \\beta_{geogr.region}\n\\end{equation}\\]\n\\(\\beta_{replace} = \\beta_{ecoregion} + \\beta_{geogr.region}\\). Note earlier chapter, explore effect area. case, \\(\\beta_{ecoregion}\\) included effect area effect ecoregion; partitioned variation variation due patch size, well variation due ecoregion. reduces amount unexplained variation among sites within ecoregion.Let’s calculate differences now. use quantities calculated \\(\\bar{\\alpha}_1\\), \\(\\bar{\\alpha}_2\\), \\(\\gamma\\), nonlinear species–area model . can start create graph similar Fig. 13.17. ’ll start fitting model used .Now plot data draw fitted line.Next need find predicted richness maximum\narea. use statistical model find .can now find \\(\\beta_{area}\\), \\(\\beta_{eco}\\) \\(\\beta_{geo}\\).Now partitioned \\(\\gamma\\) little bit finely beastiary \\(\\beta\\)’s, \\(\\bar{\\alpha}_1\\) average site richness.\\(\\beta_{area}\\) average number species observed, due different patch sizes.\\(\\beta_{eco}\\) average number species observed site, missing due patch size, ecoregion.\\(\\beta_{geo}\\) average number species found samples different ecoregions.Finally, add lines graph show partitions.Now quantified forest fragment area explains moth species richness. understanding spatial distribution biodiversity provides way better quantify patterns governed dispersal habitat preference, allows us better describe manage biodiversity human-dominated landscapes.\nFigure 13.17: Combining species–area relations additive diversity partitioning. Forest fragment area explains relatively little diversity accumulates isolated patches distributed space. However, likely area associated collection samples (.e., distances among fragments) contributes beta[eco] beta[geo].\n","code":"\na1 <- mean(moths[['spp']])\na2 <- sum(c(NCT=179, WAP=173) * c(12,9)/21)\ng <- 230\nb1 <- a2-a1\nb2 <- g-a2\nabg <- c(a1=a1, b1=b1, a2=a2, b2=b2, g=g)\nabg##        a1        b1        a2        b2         g \n##  65.42857 111.00000 176.42857  53.57143 230.00000\na1 + b1 + b2 == g## [1] TRUE\nmod.nonlin <- nls(spp ~ a*area^z, start=list(a=1, z=.2),data=moths)\nplot(spp ~ area, data=moths, ylim=c(30,230), #log='y',\n     xlab=\"Area (ha)\", ylab=\"No. of Species (R)\")\ncurve(coef(mod.nonlin)[1] * x^coef(mod.nonlin)[2], \n      0, max(moths[['area']]), add=TRUE, lty=2, lwd=2)\n#text(150, 200, \n #    bquote(italic(\"R\") == .(round(coef(mod.nonlin)[1],1)) * \n  #                  italic(\"A\")^.(round(coef(mod.nonlin)[2],2)) )\n   #  )\nabline(h=g, lty=3)\ntext(275, g, quote(gamma), adj=c(.5,1.5), cex=1.5)\n(MaxR <- predict(mod.nonlin, list(area=max(moths[['area']]) )) )## [1] 88.6185\nb.area <- MaxR - a1\nb.eco <- a2-(b.area+a1)\nb.geo <- g - a2\nabline(h=g, lty=3)\nabline(h=b.eco+b.area+a1, lty=3)\nabline(h=b.area+a1, lty=3)\nabline(h=a1, lty=3)"},{"path":"diversity.html","id":"summary-1","chapter":"13 Diversity","heading":"13.10 Summary","text":"examined communities multivariate entities can describe compare variety ways.Composition includes species (multivariate data), whereas species diversity univariate description variety species present.many ways quantify species diversity, tend correlated. simplest richness (number species present), whereas statistics take species’ relative abundances account.Species abundance distributions rank abundance distributions analogous probability distributions, provide thorough ways describe patterns abundance variety communities. illustrate basic law community ecology: species rare. Null models community structure processes make predictions shape distributions.Ecological neutral theory provides dynamical model, unlike null model, allows quantitative predictions relating demographic, immigration, speciation rates, species abundance distributions, patterns variation space time.Another law community ecology number species increases sample area appears influenced immigration extinction rates.can partition diversity different spatial scales understand structure communities landscapes.","code":""},{"path":"appendix.html","id":"appendix","chapter":"14 Appendix","heading":"14 Appendix","text":"","code":""},{"path":"appendix.html","id":"very-introductory-materials","chapter":"14 Appendix","heading":"14.1 Very introductory materials","text":"R: https://www.r-project.org/.htmlGetting started R, (R documentation): https://cran.r-project.org/doc/manuals/r-release/R-intro.htmlGetting started R interactively, using RStudio interface: https://swirlstats.com/two statistics texts, great introductory material getting started R language.http://users.miamioh.edu/fishert4/sta363/ (great statistics text)http://r-statistics.co/ (graphics stats; ads)Arranging summarizing data dplyr: https://cran.r-project.org/web/packages/dplyr/vignettes/dplyr.htmlR language. Use every day, learn quickly.","code":""},{"path":"appendix.html","id":"writing-your-own-functions","chapter":"14 Appendix","heading":"14.2 Writing your own functions","text":"One cool thing R can write functions. Indeed extensibility R makes home cutting edge working, edge cutters (.e., leading scientists) can write code can use. People actually write entire packages, integrated collections functions, R extended hundreds packages available download R mirrors.Let’s make function calculate mean. Let’s pretend work unethical boss wants show average sales higher really . Therefore function provide mean plus 5%.Thus function can take input, stuff, including produce graphics, interact operating system, manipulated numbers. decide arguments function, case, x cheat. Note supplied number cheat; results cheat argument default value, supply . argument default, supply . default value, can change . Now try .","code":"\nMyBogusMean <- function(x, cheat=0.05) { SumOfX <- sum(x)\n                             n <- length(x)\n                             trueMean <- SumOfX/n \n                           (1 + cheat) * trueMean}\nRealSales <- c(100, 200, 300)\nMyBogusMean(RealSales)## [1] 210\nMyBogusMean(RealSales, cheat=0.1)## [1] 220\nMyBogusMean(RealSales, cheat=0)## [1] 200"},{"path":"appendix.html","id":"iterated-actions-the-apply-family-and-loops","chapter":"14 Appendix","heading":"14.3 Iterated Actions: the apply Family and Loops","text":"often want perform action …, perhaps thousands millions times. cases, action independent — just want lot. cases, choice methods. times, action depends previous action. case, always use -loops.81 discuss first methods work independent actions.","code":""},{"path":"appendix.html","id":"iterations-of-independent-actions","chapter":"14 Appendix","heading":"14.3.1 Iterations of independent actions","text":"Imagine matrix data frame want thing column (row). use apply, “apply” function column (row). tell apply data want use, tell “margin” want focus , tell function. margin side matrix. describe matrices number rows, columns, “2 5 matrix,” rows constitute first margin, columns constitute second margin. create \\(2 \\times 5\\) matrix, take mean rows, first margin. sum columns second margin.See ?rowMeans simple, even faster, operations.Similarly, lapply “apply” function element list, column data frame, always returns list. function sapply something similar, simplify result, less complex data structure possible.independent operation 10 times using sapply, defining function --fly calculate mean random draw five observations standard normal distribution.","code":"\nm <- matrix( 1:10, nrow=2)\nm##      [,1] [,2] [,3] [,4] [,5]\n## [1,]    1    3    5    7    9\n## [2,]    2    4    6    8   10\napply(m, MARGIN=1, mean)## [1] 5 6\napply(m, MARGIN=2, sum)## [1]  3  7 11 15 19\nsapply(1:10, function(i) mean( rnorm(5) ) )##  [1] -0.08837270 -0.06003405 -0.39673085  0.48373156  0.55228638 -0.47503345\n##  [7]  0.64569465  0.36796809  0.25172968  0.71059443"},{"path":"appendix.html","id":"dependent-iterations","chapter":"14 Appendix","heading":"14.3.2 Dependent iterations","text":"Often repeated actions depend previous outcomes, \npopulation growth. provide couple examples accomplish loops.One thing keep mind loops R computation fastest first make holder output. simulate random walk, , instance, start 25 individuals time = 0, increase decrease amount drawn randomly normal distribution, mean zero standard deviation 2. round “amount” nearest integer (zero-th decimal place). output differ random process.","code":"\ngens <- 10\noutput <- numeric(gens + 1)\noutput[1] <- 25\nfor( t in 1:gens ) output[t + 1] <- output[t] + round( rnorm(n=1, mean=0, sd=2), 0)\noutput##  [1] 25 26 26 25 24 28 27 26 25 25 27"},{"path":"appendix.html","id":"probability-distributions-and-randomization","chapter":"14 Appendix","heading":"14.4 Probability Distributions and Randomization","text":"R variety probability distributions built-. normal distribution, instance, four functions.dnorm probability density function, creates widely observed bell-shaped curve.pnorm cumulative probability function usually use describe probability test statistic greater equal critical value.qnorm quantile function takes probabilities input.rnorm random number generator draws values (quantiles) distribution specified mean standard deviation., default parameter values return standard normal distribution (\\(\\mu=0\\), \\(Sigma=1\\)), parameters can changed.95% confidence intervals.Next create histogram using 20 random draws normal\ndistribution mean 11 standard deviation 6; overlay probability density function (Fig. 14.1).\nFigure 14.1: Histogram random numbers drawn normal distribution \\(\\mu=11\\) \\(\\sigma=6\\). normal probability density function drawn well.\n","code":"\nqnorm(p=c(0.025,0.975))## [1] -1.959964  1.959964\nmyplot <- hist(rnorm(20, m=11, sd=6), probability=TRUE)\nmyplot\nlines(myplot$mids, dnorm(myplot$mids, m=11, sd=6) )"},{"path":"appendix.html","id":"numerical-integration-of-ordinary-differential-equations","chapter":"14 Appendix","heading":"14.5 Numerical integration of ordinary differential equations","text":"order study continuous population dynamics, often like integrate complex nonlinear functions population dynamics. , need use numerical techniques turn infinitely small steps calculus, \\(\\d x\\), small, finite steps, order approximate change \\(y\\), given change \\(x\\), \\(dy/dx\\). Mathematicians computer scientists devised clever ways accurately precisely. R, best package deSolve, contains several solvers differential equations perform numerical integration. access solvers (.e. numerical integraters) using ode function deSolve package. function, ode, “wrapper” underlying suite functions work. , provides simple way use one small suite functions.ordinary differential equation (ODE) logistic growth, \\(dN/dt = rN(1-\\alpha N)\\), say “solve” equation particular time interval given set parameters initial conditions initial population size. instance, say solve logistic growth model time \\(t=0,\\, 1 \\ldots \\, 20\\), parameters \\(r=1\\), \\(\\alpha=0.001\\), \\(N_0=10\\).Let’s example ode, using logistic growth. first define function particular way. arguments function must time, vector populations, vector list model parameters.Note like convert \\(y\\) readable transparent state variable (\\(N\\) case). also like use allows use names parameters (Petzoldt 2003); works p vector named paramters (see ). Finally, return derivative list one component.following equivalent, slightly less readable transparent.requires order parameters expected, \\(r\\) first \\(\\alpha\\) second.solve ODE, need specify parameters, initial conditions. using vector named parameters, need make sure name ! also need supply time steps want.Now put ode, correct arguments. output matrix, first column time steps, remaining state variables. First load deSolve package.going model two species, y becomes vector length 2. create function Lotka-Volterra competition, \n\\[\\frac{d N_1}{d t} = r_1 N_1\\left(1 - \\alpha_{11} N_1 - \\alpha_{12} N_2 \\right)\\]\n\\[\\frac{d N_2}{d t} = r_2N_2\\left(1 - \\alpha_{22}N_2 - \\alpha_{21}N_1 \\right)\\]Note LVComp assumes \\(N\\) \\(r\\) vectors, competition coefficients matrix. instance, function extracts first element r first species (r[1]); intraspecific competition coefficient species 1, uses element first column first row ([1,1]). vector population sizes, \\(N\\), contains one value population one time point. Thus , vector contains two elements (one two species); holds values, repeatedly, time point. output contain population sizxes time.integrate populations, need specify new initial conditions, new parameters two-species model.ode function wrapper variety ODE solvers; default lsoda well tested tool. addition, several bells whistles need take advantage , although mention one,hmax. tells lsoda largest step can take. great , stiff ODE (wiggly complex dynamic), ODE assumes can take bigger step . Setting hmax smallish number limit size step help ensure integration proceeds .One solvers deSolve, lsodar, also return roots (equilibria), system ODEs, exist. find roots (.e. solutions, equilibria) two species enemy-victim model.use lsodar find equilibria, need specify root finding function whose inputs sme ODE function, returns scalar (single number) determines whether rate change (\\(dy/dx\\)) sufficiently close zero can say system stopped changed, , reached steady state equilibrium. sum absolute rates change species, subtract 10\\(^{-10}\\); difference zero, decide , pratcial purposes, system stopped changing.Note unlist changes list returned EV simple vector, can summed.Next specify parameters, time. want root, specify want value \\(y\\) really long time (\\(t=10^{10}\\)). lsodar function stop sooner , return equilibrium finds, time step occurred.Now run function.see steady state population sizes \\(V=100\\) \\(E=12.5\\), given starting point, steady state achieved \\(t=500.8\\). information available; see ?lsodar loading deSolve package.can also find equilibrium steady state using rootSolve package.","code":"\nlogGrowth <- function(t, y, p){\n  N <- y[1]\n  with(as.list(p), {\n    dN.dt <- r * N * (1 - a * N)\n    return( list( dN.dt ) )\n  } )\n}\n  logGrowth <- function(t, y, p){\n    dN.dt <- p[1] * y[1] * (1 - p[2] * y[1])\n    return( list( dN.dt ) )\n  }\np <- c(r=1, a = 0.001)\ny0 <- c(N=10)\nt <- 1:20\nlibrary(deSolve)\nout <- ode(y=y0, times=t, func=logGrowth, parms=p)\nout[1:5,]##      time         N\n## [1,]    1  10.00000\n## [2,]    2  26.72369\n## [3,]    3  69.45310\n## [4,]    4 168.66426\n## [5,]    5 355.46079\nplot(out)\nLVComp <- function(t, y, p){\n  N <- y\n  with(as.list(p), {\n    dN1.dt <- r[1] * N[1] * (1 - a[1,1]*N[1] - a[1,2]*N[2])\n    dN2.dt <- r[2] * N[2] * (1 - a[2,1]*N[1] - a[2,2]*N[2])\n    return( list( c(dN1.dt, dN2.dt) ) )\n  } )\n}\na <- matrix(c(0.02, 0.01, 0.01, 0.03), nrow=2)\nr <- c(1,1)\np2 <- list(r, a)\nN0 <- c(10,10)\nt2 <- c(1,5,10,20)\nout <- ode(y=N0, times=t2, func=LVComp, parms=p2)\nout[1:4,]##      time        1        2\n## [1,]    1 10.00000 10.00000\n## [2,]    5 35.53914 21.79929\n## [3,]   10 39.61141 20.35672\n## [4,]   20 39.99332 20.00667\nplot(out)\nEV <- function(t, y, p){\n  with(as.list(p), {\n    dv.dt <- b * y[1]*(1-.005*y[1]) - a*y[1]*y[2]\n    de.dt <-a*e*y[1]*y[2] - s*y[2]\n    return( list( c(dv.dt, de.dt) ) )\n  } )\n}\nrootfun <- function (t,y,p) { \ndstate <- unlist(EV(t,y,p)) #rate of change vector \nreturn(sum(abs(dstate))-1e-10) \n} \np <- c(b = 0.5, a = 0.02, e=0.1, s=0.2)\nt <- c(0,1e10)\nout <- ode(y=c(45,200), t, EV, parms=p, rootfun=rootfun, method=\"lsodar\")\nout[,]##          time   1     2\n## [1,]   0.0000  45 200.0\n## [2,] 500.8094 100  12.5\nlibrary(rootSolve)\nequil <- runsteady(y=c(45,200), times=c(0,1E5), func=EV, parms=p)\nround(equil$y, 3)## [1] 100.0  12.5"},{"path":"appendix.html","id":"eigenanalysis-1","chapter":"14 Appendix","heading":"14.6 Eigenanalysis","text":"Performing eigenanalysis R easy. use  function returns list two components. first named component vector eigenvalues second named component matrix corresponding eigenvectors. numeric possible, complex, elements complex numbers.typical demographic stage matrix.Singular value decomposition (SVD) generalization eigenanalysis used R applications eigenanalysis used historically, SVD numerically accurate ( principle components analysis).","code":"\nA <- matrix(c(0, .1, 10, .5), nrow=2)\neig.A <- eigen(A)\nstr(eig.A)## List of 2\n##  $ values : num [1:2] 1.281 -0.781\n##  $ vectors: num [1:2, 1:2] -0.9919 -0.127 -0.997 0.0778\n##  - attr(*, \"class\")= chr \"eigen\""},{"path":"appendix.html","id":"eigenanalysis-of-demographic-versus-jacobian-matrices","chapter":"14 Appendix","heading":"14.6.1 Eigenanalysis of demographic versus Jacobian matrices","text":"Eigenanalyses demographic Jacobian matrices worth comparing. one sense, similar meanings — describe asymptotic (long-term) properties system, either population size (demographic matrix) perturbation equilibrium. quantitative interpretation eigenvalues therefore differ.case stage (age) structured demographic model, elements demographic matrix discrete per capita increments change specified time interval. directly analogous finite rate increase, \\(\\lambda\\), discrete unstructured models. (Indeed, unstructured discrete growth model stage-structured model one stage). Therefore, eigenvalues demographic matrix units — per capita increment change. dominant eigenvalue greater 1.0 population increase, less 1 (merely less zero) population decline.case Jacobian matrix, comprised continuous partial differential equations, elements per capita instantaneous rates change. differential equations, describe instantanteous rates change, analogous \\(r\\). Therefore, values greater zero indicate increases, values less zero indicate decreases. rates evaluated equilibrium, equilibrium acts like new zero — positive values indicate growth away equilibrium, negative values indicate shrinkage back toward equilibrium. evaluate elements equilibrium, numbers get units \\(r\\), values greater zero indicate increase, values less zero indicate decrease. change describe instantaneous per capita rate change population respect others. eigenvalues summarizing elements Jacobian matrix thus must less zero disturbance decline., summary, elements demographic matrix discrete increments real time interval. Therefore eigenvalues represent relative per capita growth rates discrete time interval, interpret eigenvalues respect 1.0. hand, elements Jacobian matrix instantaneous per captia rates change evaluated equilibrium. Therefore eigenvalues represent per capita instantaneous rates change tiny perturbation equilibrium. interpret eigenvalues respect 0 indicating whether perturbation grows shrinks.","code":""},{"path":"appendix.html","id":"derivation-of-the-right-eigenvalues","chapter":"14 Appendix","heading":"14.7 Derivation of the right eigenvalues","text":"\\[\\begin{align*}\nAw &=\\lambda w\\\\\nAw-\\lambda w &=0\\\\\nAw - \\lambda w  &=\\mathbf{0} \\\\\n\\left(- \\lambda \\right)w  &=0 \n\\end{align*}\\]rules determinants, follows ,\n\\[\\mathrm{det} \\left| - \\lambda \\right| =0\\]empirical example.know determinant zero, can use create simple quadratic equation terms \\(\\lambda\\), solve. First, let’s remember difference :\n\\[\\mathbf{} - \\lambda\\mathbf{} = \\begin{pmatrix} \n-\\lambda & b \\\\\nc & d - \\lambda\n\\end{pmatrix}\\]can use determinant solve lambda.\n\\[ \\mathrm{det} \\begin{pmatrix} \n-\\lambda & b \\\\\nc & d - \\lambda\n\\end{pmatrix} = (-\\lambda)(d-\\lambda) - bc = 0\\]\n\\[\\lambda^2 - (+d)\\lambda + (ad-bc) = 0\\]\n\\[\\lambda = \\frac{-(+d) \\pm \\sqrt{(+d)^2 - 4(ad-bc)}}{2}\\]\none way find two eigenvalues \\(2 \\times 2\\) matrix, whether demographic projection matrix, predator-prey interaction matrix, something else.","code":"\nA <- matrix(1:4, nrow=2)\nlambda <- eigen(A)$values[1]\nw <- eigen(A)$vectors[,1]\nI <- diag(c(1,1))\nround(lambda*w - A%*%w, 4)##      [,1]\n## [1,]    0\n## [2,]    0\nround(lambda*I%*%w - A%*%w, 4)##      [,1]\n## [1,]    0\n## [2,]    0\nround((lambda*I - A)%*%w, 4)##      [,1]\n## [1,]    0\n## [2,]    0\ndet( lambda*I-A )## [1] 0"},{"path":"appendix.html","id":"symbols-used-in-this-book","chapter":"14 Appendix","heading":"14.8 Symbols used in this book","text":"convinced one biggest hurdles learning theoretical ecology — one easiest overcome — able “read” hear head. requires able pronounce Greek symbols. us learned pronounce \\(\\alpha\\) primary school. Therefore, provide incomplete simplistic American English pronunciation guide () rest us, symbols book. tricky, different people pronounce differently.Symbols pronunciation; occasional usage applies lowercase, unless otherwise specified. symbols common variants. symbol might part equation; ecologists frequently ascribe meanings defined time used.\nTable 14.1: Symbols pronunciation; occasional usage applies lowercase, unless otherwise specified. symbols common variants. symbol might part equation; ecologists frequently ascribe meanings defined time used.\n","code":""},{"path":"references.html","id":"references","chapter":"15 References","heading":"15 References","text":"","code":""}]
