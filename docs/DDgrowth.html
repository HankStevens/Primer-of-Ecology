<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>5 Density-dependent growth | Primer of Ecology using R</title>
<meta name="author" content="Hank Stevens">
<meta name="description" content="Let’s go back to our Song Sparrow (Melospiza melodia) data that we used to illustrate density-independent growth — now we graph all the data.  Figure 5.1: Song Sparrow Melospiza melodia* counts,...">
<meta name="generator" content="bookdown 0.23 with bs4_book()">
<meta property="og:title" content="5 Density-dependent growth | Primer of Ecology using R">
<meta property="og:type" content="book">
<meta property="og:description" content="Let’s go back to our Song Sparrow (Melospiza melodia) data that we used to illustrate density-independent growth — now we graph all the data.  Figure 5.1: Song Sparrow Melospiza melodia* counts,...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="5 Density-dependent growth | Primer of Ecology using R">
<meta name="twitter:description" content="Let’s go back to our Song Sparrow (Melospiza melodia) data that we used to illustrate density-independent growth — now we graph all the data.  Figure 5.1: Song Sparrow Melospiza melodia* counts,...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.10/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-VCV8MES4YY"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-VCV8MES4YY');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Primer of Ecology using R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="theory.html"><span class="header-section-number">1</span> Theory in Ecology</a></li>
<li><a class="" href="oft.html"><span class="header-section-number">2</span> Optimal Foraging</a></li>
<li><a class="" href="expo.html"><span class="header-section-number">3</span> Simple density-independent growth</a></li>
<li><a class="" href="DID.html"><span class="header-section-number">4</span> Density-independent Demography</a></li>
<li><a class="active" href="DDgrowth.html"><span class="header-section-number">5</span> Density-dependent growth</a></li>
<li><a class="" href="meta.html"><span class="header-section-number">6</span> Populations in Space</a></li>
<li><a class="" href="direct-competition-and-mutualism.html"><span class="header-section-number">7</span> Direct competition and mutualism</a></li>
<li><a class="" href="cr.html"><span class="header-section-number">8</span> Consumer-resource Interactions</a></li>
<li><a class="" href="host-parasitoid-relations.html"><span class="header-section-number">9</span> Host-parasitoid relations</a></li>
<li><a class="" href="disease.html"><span class="header-section-number">10</span> Disease</a></li>
<li><a class="" href="consumer-resource-competition-and-mutualisms.html"><span class="header-section-number">11</span> Consumer-resource Competition and Mutualisms</a></li>
<li><a class="" href="food-webs-and-other-networks.html"><span class="header-section-number">12</span> Food webs and other networks</a></li>
<li><a class="" href="diversity.html"><span class="header-section-number">13</span> Diversity</a></li>
<li><a class="" href="appendix.html"><span class="header-section-number">14</span> Appendix</a></li>
<li><a class="" href="references.html"><span class="header-section-number">15</span> References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="DDgrowth" class="section level1" number="5">
<h1>
<span class="header-section-number">5</span> Density-dependent growth<a class="anchor" aria-label="anchor" href="#DDgrowth"><i class="fas fa-link"></i></a>
</h1>
<p>Let’s go back to our Song Sparrow (<em>Melospiza melodia</em>) data that we used to illustrate density-independent growth — now we graph <em>all</em> the data.</p>
<div class="figure">
<span style="display:block;" id="fig:sparrowDD"></span>
<img src="figs/sparrowDD-1.png" alt="*Song Sparrow *Melospiza melodia* counts, $N$, from 1966--2003 and the relation between observed counts and annual growth rate determined from those counts, fit with ordinary least squares regression. See Chapter 3 for data source.*" width="50%"><img src="figs/sparrowDD-2.png" alt="*Song Sparrow *Melospiza melodia* counts, $N$, from 1966--2003 and the relation between observed counts and annual growth rate determined from those counts, fit with ordinary least squares regression. See Chapter 3 for data source.*" width="50%"><p class="caption">
Figure 5.1: <em>Song Sparrow </em>Melospiza melodia* counts, <span class="math inline">\(N\)</span>, from 1966–2003 and the relation between observed counts and annual growth rate determined from those counts, fit with ordinary least squares regression. See Chapter 3 for data source.*
</p>
</div>
<p>When we plot the annual per capita growth rate, <span class="math inline">\(r_t = \log (N_{t+1}/N_t)\)</span>, as a function of <span class="math inline">\(N\)</span>, we see a pattern emerge. At low <span class="math inline">\(N\)</span>, <span class="math inline">\(r&gt;0\)</span>, whereas at high <span class="math inline">\(N\)</span>, <span class="math inline">\(r &lt; 0\)</span>. The annual growth rate depends on the size or density of the population. This is the sort of thing we mean we we use the term <em>density-dependent growth</em>.</p>
<p>What might limit the population growth of these sparrows? Space available for male territories in their successional-scrub type habitat? Availability of seeds, fruits and invertebrates? We don’t necessarily know precisely what limits it, but if it is something related to their own abundance, then we can treat density as a proxy for the amount of limitation.</p>
<p>Density-dependent population growth is the case where the per capita population growth rate depends statistically on the density of the population. When the slope of that relation is negative as it is in Fig. <a href="DDgrowth.html#fig:sparrowDD">5.1</a>, we call this <em>negative density-dependence</em>. Negative density dependence a characteristic of a population undergoing <em>intraspecific competition</em>, where individuals of the same species compete for shared resources and have negative effects on their demographic rates. So, how would we represent this algebraically?<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;root: Arabic. &lt;em&gt;Al-jabr&lt;/em&gt;&lt;/p&gt;"><sup>29</sup></a></p>
<div id="continuous-logistic-growth" class="section level2" number="5.1">
<h2>
<span class="header-section-number">5.1</span> Continuous logistic growth<a class="anchor" aria-label="anchor" href="#continuous-logistic-growth"><i class="fas fa-link"></i></a>
</h2>
<p>When it was originally introduced to ecology by Verlhurst in the late 1800s, he described the limits to population growth in terms of an upper limit <span class="math inline">\(K\)</span>,
<span class="math display" id="eq:logK">\[\begin{equation}
\frac{dN}{dt}= rN\left(1-\frac{N}{K}\right) \tag{5.1}
\end{equation}\]</span>
where <span class="math inline">\(K\)</span> is referred to as the <em>carrying capacity</em>. It is the population size where the negative effects of crowding prevent additional population growth. This happens in this equation because when <span class="math inline">\(N=K\)</span>, population growth rate falls to zero, because <span class="math inline">\(\left(1-K/K\right)=1-1=0\)</span>.</p>
<p>Notice that the first part of this equation is exponential growth <span class="math inline">\(rN\)</span>, which is then modified by a negative effect of a growing population. As <span class="math inline">\(N\)</span> grows, so does <span class="math inline">\((1-N/K)\)</span> and causes <span class="math inline">\(dN/dt\)</span> to shrink. As <span class="math inline">\(N\)</span> approaches <span class="math inline">\(K\)</span>, <span class="math inline">\(dN/dt\)</span> approaches zero, and the population stops changing and stays at <span class="math inline">\(N=K\)</span>.</p>
<p>We refer to <span class="math inline">\(K\)</span> as an <em>attractor</em> because <span class="math inline">\(N\)</span> moves in a deterministic fashion toward <span class="math inline">\(K\)</span> – <span class="math inline">\(K\)</span> attracts <span class="math inline">\(N\)</span>. We explore the meanings of <em>attractor</em> and related terms throughout the book.</p>
<p><strong>Theory alert!</strong> Recall that Alan <span class="citation"><a href="references.html#ref-Hastings2011" role="doc-biblioref">A. Hastings</a> (<a href="references.html#ref-Hastings2011" role="doc-biblioref">2011</a>)</span> identified principles of macroscopic theory of population growth, that (i) populations exponentially, unless (ii) something prevents exponential growth. Here we see one of those somethings – negative density dependence.</p>
<p>Another common representation of this model, the one we use here is
<span class="math display" id="eq:logalpha">\[\begin{equation}
\frac{dN}{dt}= rN\left(1-\alpha N\right) \tag{5.2}
\end{equation}\]</span>
where <span class="math inline">\(\alpha=1/K\)</span>. In this manner, <span class="math inline">\(\alpha\)</span> represents the per capita effect of an individual on its population growth rate. More on that next.</p>
</div>
<div id="dynamics-around-the-equilibria-stability" class="section level2" number="5.2">
<h2>
<span class="header-section-number">5.2</span> Dynamics around the equilibria — stability<a class="anchor" aria-label="anchor" href="#dynamics-around-the-equilibria-stability"><i class="fas fa-link"></i></a>
</h2>
<p>The <em>stability</em> of a system<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;A system might be nearly any set of interacting parts, such as a population, or an economy, or the internet.&lt;/p&gt;"><sup>30</sup></a> is a measure of how much it tends to stay the same, in spite of external disturbances or changes in the state of the system.</p>
<p>The term <em>stability</em> has been given many more specific meanings, including resilience, resistant, reactivity, and permanence. We won’t go into these here, but one could consider them different facets of stability <span class="citation">(<a href="references.html#ref-Chen2001" role="doc-biblioref">Chen and Cohen 2001</a>)</span>.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Resistance refers to the tendency to resist change in the first place; resilience refers to the long term rate of return to an equilibrium; reactivity refers to the rate of change immediately following such a disturbance &lt;span class="citation"&gt;(&lt;a href="references.html#ref-Neubert1997" role="doc-biblioref"&gt;Neubert and Caswell 1997&lt;/a&gt;)&lt;/span&gt;, and permanence is the degree to which a system does not simplify by entering one of its boundary equilibria.&lt;/p&gt;'><sup>31</sup></a> We will focus on resilience, the tendency for a population to return an equilibrium, or be <em>attracted toward</em> an equilibrium, if it is perturbed from it.</p>
<p>Consider the stability of a marble inside a wok. If the wok doesn’t move, then the marble just sits in the lowest spot on the bottom. If the wok is bumped, the marble jiggles and rolls around a bit, but settles back down to the bottom. This is a stable system because there is a point at the bottom of the bowl (the attractor) toward which the marble rolls — all points inside the wok allow the marble to find the lowest point (the attractor). For this reason, we call the collection of points on the inside surface of the wok the <em>basin of attraction</em>. The steeper the sides, the more quickly the marble moves toward the bottom. This rate is referred to as its <em>resilience</em>.</p>
<p>To translate the notion of a basin into a population, let the position of marble inside the wok be the value of <span class="math inline">\(N\)</span> at any particular point. Bumping the wok is any disturbance that causes a change in <span class="math inline">\(N\)</span>. The slope of the sides of the wok reflects the biology and its mathematics that cause <span class="math inline">\(N\)</span> to move quickly or slowly back toward the bottom. For the logistic model, this rate is determined by <span class="math inline">\(r\)</span> and <span class="math inline">\(\alpha\)</span>, and also by <span class="math inline">\(N\)</span> itself. The attractor at the very bottom of the bowl is the population’s carrying capacity, <span class="math inline">\(K=1/\alpha\)</span>.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;The marble’s inertia, which contributes to its momentum, is analogous to a time lag in density dependence that we wil see in the discrete model; with a time lag, a population can overshoot the equilibrium.&lt;/p&gt;"><sup>32</sup></a></p>
<p>When we imagine a marble in a wok, it becomes easy to envision <span class="math inline">\(K\)</span> as an attractor at the bottom of the bowl. That is why we consider the carrying capacity a stable equilibrium point, or attractor, even if other factors, such as a disturbance, may cause <span class="math inline">\(N\)</span> to deviate from it.</p>
<p>The equilibrium we have focused on has been <span class="math inline">\(K\)</span>, but recall that <span class="math inline">\(N=0\)</span> is also an equilibrium. This equilibrium is actually the edge of the wok — the slightest jiggle, and the marble falls in and moves toward the center of the wok, <span class="math inline">\(K\)</span>. The biological analog of this “jiggle” is the additional of one or a very small numbers of individuals to an otherwise extinct population. For example, consider that a sterile Petri dish with nutrient agar has an <em>E. coli</em> population size of zero. If that <em>E. coli</em> <span class="math inline">\(N=0\)</span> gets “perturbed” with a single added cell, the population will move quickly toward its carrying capacity <span class="math inline">\(K\)</span>. In this sense, <span class="math inline">\(N=0\)</span> is an equilibrium, but it is an <em>unstable</em> equilibrium. We also call such an unstable equilibrium a <em>repeller</em>.</p>
<div id="analytical-linear-stability-analysis" class="section level3" number="5.2.1">
<h3>
<span class="header-section-number">5.2.1</span> Analytical linear stability analysis<a class="anchor" aria-label="anchor" href="#analytical-linear-stability-analysis"><i class="fas fa-link"></i></a>
</h3>
<p>We are interested in the dynamics or stability of <span class="math inline">\(N\)</span> at each of the equilibria, <span class="math inline">\(N^*\)</span>. Here we use <em>analytical linear stability analysis</em> to show mathematically what we described above with the marble and the wok. While somewhat limited in its scope, linear stability is nonetheless a powerful technique for dynamic model analysis.</p>
<p>In a nutshell, what we do is determine whether the growth rate, which is zero at each equilibrium, becomes positive or negative in response to a small change in <span class="math inline">\(N\)</span>. That is, if <span class="math inline">\(N\)</span> takes a tiny step away from the equilbrium, does that tiny step shrink, or grow? If a tiny step results in a shrinking of that step, back toward the equilibrium, that demonstrates stability. If a tiny step results in growth and a bigger step, that demonstrates instability. That is what analytical stability analysis tells us.</p>
<p>Consider a plot of the growth rate, <span class="math inline">\(dN/dt\)</span> <em>vs.</em> <span class="math inline">\(N\)</span> (Fig. <a href="DDgrowth.html#fig:FNN">5.2</a>). The equilibria, <span class="math inline">\(N^*\)</span>, are the <span class="math inline">\(N\)</span> (<span class="math inline">\(x\)</span>-axis) at which <span class="math inline">\(dN/dt=0\)</span> (points a, d). Note where population growth rate is positive and where it is negative. What will happen to this population if it finds itself at <span class="math inline">\(N=50\)</span>? It will grow, moving along the <span class="math inline">\(x\)</span>-axis, until population growth rate slows so much that it comes to rest where <span class="math inline">\(N=1/\alpha=K=100\)</span>. Thus, <span class="math inline">\(N\)</span> changes until it converges on the equilibrium, <span class="math inline">\(N^*\)</span>, where <span class="math inline">\(dN/dt=0\)</span>. Alternatively at <span class="math inline">\(N=110\)</span>, <span class="math inline">\(dN/dt\)</span> is negative, and so <span class="math inline">\(N\)</span> shrinks back down to <span class="math inline">\(K\)</span> (point d). This return toward <span class="math inline">\(K\)</span> means that <span class="math inline">\(K\)</span> is an attractor and a stable equilibrium.</p>
<p>Next, consider <span class="math inline">\(N=0\)</span>, at point a; it cannot change on its own. However, if “perturbed” at all, with the addition of one or more individuals, then this “perturbation” will grow, sending <span class="math inline">\(N\)</span> across the <span class="math inline">\(x\)</span>-axis, away from <span class="math inline">\(N=0\)</span>, toward <span class="math inline">\(N=K\)</span>. This stasis at <span class="math inline">\(N=0\)</span>, and movement away from <span class="math inline">\(N=0\)</span> with the slightest perturbation means that <span class="math inline">\(N=0\)</span> is a repeller and an unstable equilibrium.</p>
<p><em>Linear stability analysis will calculate the degree of attraction or repulsion at a local point.</em></p>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot the phase portrait - use the phaseR package</span>
<span class="va">logisticPP</span> <span class="op">&lt;-</span> <span class="fu">phasePortrait</span><span class="op">(</span><span class="va">logistic</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">105</span><span class="op">)</span>, parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">100</span><span class="op">)</span>,
              ylab<span class="op">=</span><span class="st">"Population Growth Rate (dN/dt)"</span>, xlab<span class="op">=</span><span class="st">"N"</span><span class="op">)</span>
<span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">115</span><span class="op">)</span>
<span class="va">pop.growth.rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span> <span class="va">N</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span>  <span class="va">N</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span> <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">N</span>, <span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="va">pop.growth.rate</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="va">N</span>, <span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="va">pop.growth.rate</span><span class="op">)</span>, <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,adj<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:FNN"></span>
<img src="figs/FNN-1.png" alt="*Population growth rate, $dN/dt$, as a function of $N$. This kind of graph is called a phase portrait or phase plane. Points a--e are labelled for convenience. At values of $N$ associated with points $a$ and $d$, population growth rate equals zero. At values of $N$ associated with $b$ and $c$ growth rate is positive, and for $e$ growth rate is negative. Note this is growth rate as a function of $N$ (time is not explicitly part of this graph)*" width="90%"><p class="caption">
Figure 5.2: <em>Population growth rate, <span class="math inline">\(dN/dt\)</span>, as a function of <span class="math inline">\(N\)</span>. This kind of graph is called a phase portrait or phase plane. Points a–e are labelled for convenience. At values of <span class="math inline">\(N\)</span> associated with points <span class="math inline">\(a\)</span> and <span class="math inline">\(d\)</span>, population growth rate equals zero. At values of <span class="math inline">\(N\)</span> associated with <span class="math inline">\(b\)</span> and <span class="math inline">\(c\)</span> growth rate is positive, and for <span class="math inline">\(e\)</span> growth rate is negative. Note this is growth rate as a function of <span class="math inline">\(N\)</span> (time is not explicitly part of this graph)</em>
</p>
</div>
<p>How fast will <span class="math inline">\(N\)</span> return to <span class="math inline">\(N^*=K\)</span>, if perturbed? Let’s start by imagining that we have two populations with different intrinsic rates of increase (<span class="math inline">\(r=1,\,0.5\)</span>), and focus in on the growth rate at <span class="math inline">\(N^*=K\)</span> (Fig. <a href="DDgrowth.html#fig:stab2">5.3</a>). For which one of these populations will <span class="math inline">\(dN/dt\)</span> go to zero more quickly? If each population loses a few individuals and declines by <span class="math inline">\(x\)</span> to <span class="math inline">\(N^*-x\)</span>, which population will return to <span class="math inline">\(N^*\)</span> more quickly? Not surprisingly, it is the population with the higher <span class="math inline">\(r\)</span> — when <span class="math inline">\(r=1\)</span>, its population growth rate (<span class="math inline">\(y\)</span>-axis) is greater than when <span class="math inline">\(r=0.5\)</span>, and therefore will return at a faster rate.</p>
<p>Note also that this same population (<span class="math inline">\(r=1\)</span>) has a negative growth rate of greater magnitude at <span class="math inline">\(N^*+x\)</span>. Regardless of whether it gains or loses individuals, it will return to <span class="math inline">\(N^*\)</span> more quickly than the population with the lower <span class="math inline">\(r\)</span>.</p>
<div class="figure">
<span style="display:block;" id="fig:stab2"></span>
<img src="figs/Stability2.png" alt="*Very close to an equilibrium, a population recovers from a perturbation, moving toward the equilibrium attractor, at rate $e^{-r}$. Left, slopes of population growth $vs.$ $N$ near the equilibrium; around the equilibrium attractor, small decreases in $N$ lead to positive growth rate, whereas small increases lead to negative growth rate; the population with the steeper slope changes faster. Right, regardless of the particular $r$ of a population, a population recovers from a perturbation, moving toward the equilibrium attractor, at rate $e^{-r}$*" width="50%"><img src="figs/Stability3.png" alt="*Very close to an equilibrium, a population recovers from a perturbation, moving toward the equilibrium attractor, at rate $e^{-r}$. Left, slopes of population growth $vs.$ $N$ near the equilibrium; around the equilibrium attractor, small decreases in $N$ lead to positive growth rate, whereas small increases lead to negative growth rate; the population with the steeper slope changes faster. Right, regardless of the particular $r$ of a population, a population recovers from a perturbation, moving toward the equilibrium attractor, at rate $e^{-r}$*" width="50%"><p class="caption">
Figure 5.3: <em>Very close to an equilibrium, a population recovers from a perturbation, moving toward the equilibrium attractor, at rate <span class="math inline">\(e^{-r}\)</span>. Left, slopes of population growth <span class="math inline">\(vs.\)</span> <span class="math inline">\(N\)</span> near the equilibrium; around the equilibrium attractor, small decreases in <span class="math inline">\(N\)</span> lead to positive growth rate, whereas small increases lead to negative growth rate; the population with the steeper slope changes faster. Right, regardless of the particular <span class="math inline">\(r\)</span> of a population, a population recovers from a perturbation, moving toward the equilibrium attractor, at rate <span class="math inline">\(e^{-r}\)</span></em>
</p>
</div>
<p>How do we quantify the rate of return at <span class="math inline">\(N^*\)</span> so that we can compare two or more populations? The slope of the curve at <span class="math inline">\(N^*\)</span> quantifies the rate of return, because the slope is the exponential return rate. To calculate the slope of a curve we use calculus, because the slope of a curve is a derivative. In this case, we need the derivative of the growth rate (<span class="math inline">\(dN/dt\)</span>) with respect to the variable on the <span class="math inline">\(x\)</span>-axis, <span class="math inline">\(N\)</span>. Such a derivative is called a <em>partial derivative</em>. Therefore we need the partial derivative of growth rate, with respect to <span class="math inline">\(N\)</span>. This will be the slope of the growth rate with respect to <span class="math inline">\(N\)</span>.</p>
<p>To find the partial derivative, let us denote the population growth rate as <span class="math inline">\(\dot{N}=dN/dt\)</span> (“N-dot”),
<span class="math display" id="eq:dot">\[\begin{equation}
  \tag{5.3}
  \dot{N} = rN\left(1-\alpha N\right).
\end{equation}\]</span>
<span class="math inline">\(\dot{N}\)</span> is a common symbol for a time derivative such as a growth rate, and we use it here merely to simplify the notation.</p>
<p>Given <span class="math inline">\(\dot{N}\)</span>, its partial derivative with respect to <span class="math inline">\(N\)</span> is
<span class="math display" id="eq:pdlog">\[\begin{equation}
  \tag{5.4}
  \frac{\partial \dot{N}}{\partial N} = r - 2r\alpha N.
\end{equation}\]</span>
Further, we are interested in the equilibrium, where <span class="math inline">\(N = 1/\alpha\)</span>. If we substitute this into eq.  and simplify, this reduces to
<span class="math display" id="eq:pdlog2">\[\begin{equation}
  \tag{5.5}
  \frac{\partial \dot{N}}{\partial N} = -r \, .
\end{equation}\]</span>
At <span class="math inline">\(N^*=1/\alpha\)</span>, the slope is <span class="math inline">\(-r\)</span>. *This negative slope at the equilibrium demonstrates the stability of this equilibrium.</p>
<p>Near <span class="math inline">\(N^*\)</span>, population growth rate is <span class="math inline">\(-rx\)</span>.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Because &lt;span class="math inline"&gt;\(\Delta y/\Delta x = - r\)&lt;/span&gt;, i.e. the change in &lt;span class="math inline"&gt;\(y\)&lt;/span&gt; equals the change in &lt;span class="math inline"&gt;\(x\)&lt;/span&gt; times the slope.&lt;/p&gt;'><sup>33</sup></a> That is, the rate of change of <span class="math inline">\(x\)</span> (Figs. <a href="DDgrowth.html#fig:stab2">5.3</a>) is
<span class="math display" id="eq:9">\[\begin{equation}
  \tag{5.6}
  \frac{dx}{dt} = -rx
\end{equation}\]</span>
This allows us to pretend that the perturbation will diminish exponentially, because the growth rate is constant. We say “pretend,” because we realize that this rate applies only in the small region where we can assume the slope is a straight line. We can describe the size of <span class="math inline">\(x\)</span> at any time <span class="math inline">\(t\)</span> by integrating this well-known differential equation with respect to time as
<span class="math display" id="eq:8">\[\begin{equation}
  \tag{5.7}
  x_t = x_0e^{-r t}
\end{equation}\]</span>
where <span class="math inline">\(x_0\)</span> is the size of the initial displacement relative to the equilibrium, and <span class="math inline">\(x_t\)</span> is the size of the displacement at time <span class="math inline">\(t\)</span> relative to the equilibrium.</p>
<p>If we choose an <span class="math inline">\(x_t\)</span> carefully, and do so for any and all such analyses, we can determine the time required to reach <span class="math inline">\(x_t\)</span> and we call that time the <em>characteristic return time</em>. To determine the characteristic return time, we will let <span class="math inline">\(x_t=x_0/e\)</span>, thus defining the characteristic return time as the amount of time required to reduce the perturbation by 63% (i.e. <span class="math inline">\(1/e\)</span>). We can solve for <span class="math inline">\(t\)</span> by dividing through by <span class="math inline">\(x_0\)</span> and taking the <span class="math inline">\(\log\)</span> of both sides,
<span class="math display" id="eq:returntime">\[\begin{align}
  \tag{5.8}
  \frac{x_0}{e} &amp;= x_0e^{-r t}\\
  \log\left(e^{-1}\right) &amp;= -r t\\
  t &amp;= -\frac{1}{\left(-r\right)}.
\end{align}\]</span>
Thus we see return time, <span class="math inline">\(t\)</span>, here is a positive number, with the same units as <span class="math inline">\(r\)</span>, and depends on the slope of the the growth rate with respect to <span class="math inline">\(N\)</span>. It also depends on the assumption of linearity very close to the equilibrium.</p>
<p><em>To review</em>, we took the partial derivative of <span class="math inline">\(dN/dt\)</span> with respect to <span class="math inline">\(N\)</span>, and then evaluated the partial derivative at <span class="math inline">\(N^*\)</span> to get the rate of change of the perturbation, <span class="math inline">\(x\)</span>. A negative value indicates that the perturbation will decline through time, indicating a stable equilibrium or attractor. A positive value would indicate that the perturbation will grow over time, thus indicating an unstable equilibrium, or a repellor.</p>
<p>We can use R’s minimal symbolic capabilities to get derivatives. Here we get the partial derivative and then evaluate it for the two equilibria (Fig. <a href="DDgrowth.html#fig:FNN">5.2</a>).</p>
<div class="sourceCode" id="cb153"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.01</span>; <span class="va">r</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">pop.growth.rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span> <span class="va">r</span> <span class="op">*</span> <span class="va">N</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span>  <span class="va">alpha</span><span class="op">*</span><span class="va">N</span><span class="op">)</span> <span class="op">)</span>
<span class="co"># find the partial derivative of dNdt</span>
<span class="va">dF.dN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/deriv.html">D</a></span><span class="op">(</span><span class="va">pop.growth.rate</span>,<span class="st">"N"</span><span class="op">)</span>
<span class="va">dF.dN</span> <span class="co"># here it is</span></code></pre></div>
<pre><code>## r * (1 - alpha * N) - r * N * alpha</code></pre>
<div class="sourceCode" id="cb155"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># set N equal to zero and the carrying capacity</span>
<span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">/</span><span class="va">alpha</span><span class="op">)</span> 
<span class="co"># calculate the slopes of dN/dt vs. N at those two points</span>
<span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="va">dF.dN</span><span class="op">)</span></code></pre></div>
<pre><code>## [1]  1 -1</code></pre>
<p>The first value, 1, corresponds to the first value of <span class="math inline">\(N\)</span>, which is <span class="math inline">\(N=0\)</span>. Because it is positive, this indicates that the perturbation will increase with time, meaning that <span class="math inline">\(N=0\)</span> is a repellor. The second value, <span class="math inline">\(-1\)</span>, is negative, and so indicates that the perturbation will decrease with time, meaning that <span class="math inline">\(N=1/\alpha\)</span> is an attractor.</p>
</div>
<div id="projection-with-numerical-integration" class="section level3" number="5.2.2">
<h3>
<span class="header-section-number">5.2.2</span> Projection with numerical integration<a class="anchor" aria-label="anchor" href="#projection-with-numerical-integration"><i class="fas fa-link"></i></a>
</h3>
<p>In simple density-independent growth, we were able to project a population using the integral of the exponential growth equation, <span class="math inline">\(N_t=N_0 e^{rt}\)</span>. As our models become more complex, we are no longer able to to do that. Instead, we use <em>numerical integration</em> to project models of continuous growth through time. We use numerical techniques that turn the infinitely small intervals of calculus (<span class="math inline">\(dx\)</span>, <span class="math inline">\(dy\)</span>) into very, very small, but finite steps. Mathematicians and computer scientists have devised very clever ways of doing this very accurately and precisely. In R, the best package for this is <code>deSolve</code>, which contains several <em>solvers</em> for differential equations that perform numerical integration. We will access these solvers (i.e. numerical integraters) using the <code>ode</code> function in the <code>deSolve</code> package. This function, <code>ode</code>, is a wrapper for the underlying suite of functions that do the work.</p>
<p>When we have an ordinary differential equation (ODE) such as logistic growth,<span class="math inline">\(dN/dt = rN(1-\alpha N)\)</span> we say that we “solve” the equation,</p>
<ul>
<li>over a particular time interval</li>
<li>given a set of parameters and</li>
<li>particular initial conditions or initial population size.</li>
</ul>
<p>For instance, we say that we solve the logistic growth model for time at <span class="math inline">\(t=0,\, 1 \ldots \, 20\)</span>, with parameters <span class="math inline">\(r=1\)</span>, <span class="math inline">\(\alpha=0.001\)</span>, and <span class="math inline">\(N_0=10\)</span>.</p>
<p>Let’s do an example with <code>ode</code>, using logistic growth. We first have to define a function in a particular way. The arguments for the function must be, in order: time, a vector of populations, and a vector or list of model parameters. Note that this function is already in the primer package as <code><a href="https://rdrr.io/pkg/primer/man/clogistic.html">clogistic()</a></code>, so you don’t have to run this code to use the function.</p>
<div class="sourceCode" id="cb157"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">clogistic</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">time</span>, <span class="va">y</span>, <span class="va">parameters</span><span class="op">)</span><span class="op">{</span>
  <span class="co"># y is a single value of N; if we have more than one population, </span>
  <span class="co"># e.g. competition, then y would have two values, one for </span>
  <span class="co"># each population.</span>
  
  <span class="co"># parameters is a vector of...parameters....</span>
  
  <span class="co"># Both y and parameters have names for each element,</span>
  <span class="co"># e.g., y &lt;- c(N=10) - see the text.</span>
  
  <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">parameters</span><span class="op">)</span><span class="op">)</span>, <span class="op">{</span>
    <span class="co"># "with" creates an "environment" within which R looks for values</span>
    <span class="co"># c() combines the two vectors into one</span>
    <span class="co"># as.list() turns the resulting vector into a list</span>
    
    <span class="co"># our differential equation for growth</span>
    <span class="va">dN.dt</span> <span class="op">&lt;-</span> <span class="va">r</span> <span class="op">*</span> <span class="va">N</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span> <span class="op">*</span> <span class="va">N</span><span class="op">)</span>
    
    <span class="co"># making the function create output, which must be a list with</span>
    <span class="co"># one element</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> <span class="va">dN.dt</span> <span class="op">)</span> <span class="op">)</span>
  <span class="op">}</span> <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>While it isn’t necessary, we use <code><a href="https://rdrr.io/r/base/with.html">with()</a></code> to allow us to use the names of variables and parameters <span class="citation">(<a href="references.html#ref-Petzoldt:2003dp" role="doc-biblioref">Petzoldt 2003</a>)</span>. This works only when <code>y</code> and <code>p</code> are vectors with named variables and parameters. Finally, we use <code>return</code> to cause the function to produce the derivative in a <code>list</code>.</p>
<p>The following is equivalent, but slightly less readable or transparent.</p>
<pre><code>  logistic2 &lt;- function(t, y, p){
    dN.dt &lt;- p[1] * y[1] * (1 - p[2] * y[1])
    return( list( dN.dt ) )</code></pre>
<p>To solve the ODE, we will need to specify parameters–we wil have to tell R the values we want to use for <span class="math inline">\(r\)</span> and <span class="math inline">\(\alpha\)</span>.</p>
<div class="sourceCode" id="cb159"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>r<span class="op">=</span><span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span></code></pre></div>
<p>We also need to tell R the size of the population to start with, at <span class="math inline">\(t=0\)</span>, or <span class="math inline">\(N_0\)</span>. We refer to this as the <em>initial condition</em>, and we will start with a population size of <span class="math inline">\(N_0=1\)</span>. We also need to supply the time steps we want as output. R will project the population size for all times up until and including the last time step we specify.</p>
<div class="sourceCode" id="cb160"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># We name the state variable and the parameters</span>
<span class="va">y0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>N<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="va">t</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">20</span></code></pre></div>
<p>Now you put it all into <code>ode()</code>, with the correct arguments. The output is a matrix, with the first column being the time steps, and the remaining being your state variables. Because you loaded <code>primer</code>, the <code>deSolve</code> package should be loaded already.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Loading the &lt;code&gt;primer&lt;/code&gt; package loads &lt;code&gt;deSolve&lt;/code&gt; automatically.&lt;/p&gt;"><sup>34</sup></a></p>
<div class="sourceCode" id="cb161"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">ode</span><span class="op">(</span>y<span class="op">=</span><span class="va">y0</span>, times<span class="op">=</span><span class="va">t</span>, func<span class="op">=</span><span class="va">clogistic</span>, parms<span class="op">=</span><span class="va">p</span><span class="op">)</span>
<span class="va">out</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span></code></pre></div>
<pre><code>##      time         N
## [1,]    0  1.000000
## [2,]    1  2.713627
## [3,]    2  7.342179
## [4,]    3 19.709440
## [5,]    4 51.820737</code></pre>
<p>We can plot the output as well. The <code>deSolve</code> package directs R to use special methods to plot output from <code>ode</code>.</p>
<div class="sourceCode" id="cb163"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:odeplot"></span>
<img src="figs/odeplot-1.png" alt="*Output from a numerical integration of logistic growth, where N0==10, r=1, alpha=0.001.*" width="90%"><p class="caption">
Figure 5.4: <em>Output from a numerical integration of logistic growth, where N0==10, r=1, alpha=0.001.</em>
</p>
</div>
<p>Here we see the classic S-shaped curve of logistic growth. Regardless where we start, the population will always settle down on <span class="math inline">\(K=1/\alpha\)</span>.
<strong>Before reading on, predict</strong> the shape of this curve if:</p>
<ul>
<li>
<span class="math inline">\(r\)</span> is smaller, or larger.</li>
<li>
<span class="math inline">\(\alpha\)</span> is smaller, or larger.</li>
<li>the initial population size is above <span class="math inline">\(K\)</span>
</li>
</ul>
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, by<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span>; <span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">1.5</span><span class="op">)</span>
<span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.002</span>, <span class="fl">0.001</span><span class="op">)</span>; <span class="va">N0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">1500</span><span class="op">)</span>
<span class="va">input</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span>r<span class="op">=</span><span class="va">r</span>, alpha<span class="op">=</span><span class="va">alpha</span>, N<span class="op">=</span><span class="va">N0</span><span class="op">)</span>
<span class="va">outdf</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
<span class="co">#outdf &lt;- data.frame(time=NULL, N=NULL, N0=NULL, r=NULL, alpha=NULL)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">input</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> 
  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>N<span class="op">=</span><span class="va">input</span><span class="op">[</span><span class="va">i</span>,<span class="st">"N"</span><span class="op">]</span><span class="op">)</span>
  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>r<span class="op">=</span><span class="va">input</span><span class="op">[</span><span class="va">i</span>,<span class="st">"r"</span><span class="op">]</span>, alpha<span class="op">=</span><span class="va">input</span><span class="op">[</span><span class="va">i</span>,<span class="st">"alpha"</span><span class="op">]</span> <span class="op">)</span>
  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">ode</span><span class="op">(</span><span class="va">y</span>, times<span class="op">=</span><span class="va">t</span>, fun<span class="op">=</span><span class="va">clogistic</span>, <span class="va">p</span><span class="op">)</span>
  <span class="va">out2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">out</span>, N0<span class="op">=</span><span class="va">y</span>, r<span class="op">=</span><span class="va">p</span><span class="op">[</span><span class="st">"r"</span><span class="op">]</span>, alpha<span class="op">=</span><span class="va">p</span><span class="op">[</span><span class="st">"alpha"</span><span class="op">]</span><span class="op">)</span>
  <span class="va">outdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind.data.frame</a></span><span class="op">(</span><span class="va">outdf</span>, <span class="va">out2</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">outdf</span><span class="op">$</span><span class="va">N0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span> <span class="va">outdf</span><span class="op">$</span><span class="va">N0</span> <span class="op">)</span>
<span class="va">outdf</span><span class="op">$</span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">outdf</span><span class="op">$</span><span class="va">alpha</span> <span class="op">)</span>
<span class="fu">ggplot</span><span class="op">(</span><span class="va">outdf</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">time</span>, <span class="va">N</span>, colour<span class="op">=</span><span class="va">N0</span>, linetype<span class="op">=</span><span class="va">alpha</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">r</span><span class="op">~</span><span class="va">.</span>, labeller<span class="op">=</span><span class="va">label_both</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:logisticVariety"></span>
<img src="figs/logisticVariety-1.png" alt="*How variation in logistic growth parameters influence the dynamics.*" width="75%"><p class="caption">
Figure 5.5: <em>How variation in logistic growth parameters influence the dynamics.</em>
</p>
</div>
<p>We see that the refer to <span class="math inline">\(K\)</span> as an <em>attractor</em> because <span class="math inline">\(N\)</span> moves in a deterministic fashion toward <span class="math inline">\(K\)</span>. We explore the meanings of <em>attractor</em> and related terms throughout the book.</p>
<p>The <code>phaseR</code> package has some sweet plotting functions for systems of 1 or two ODEs. We used it above for the phase portrait, and here we use it for the trajectories.</p>
<div class="sourceCode" id="cb165"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot the velocity field, nullclines and several trajectories</span>

<span class="co">## These create arrows (vectors) whose length and direction</span>
<span class="co">## reveal the velocity at different points</span>
<span class="va">logistic_flowField</span>     <span class="op">&lt;-</span> <span class="fu">flowField</span><span class="op">(</span><span class="va">logistic</span>,
                                    xlim       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span>,
                                    ylim       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>,
                                    parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,
                                    points     <span class="op">=</span> <span class="fl">21</span>,
                                    system     <span class="op">=</span> <span class="st">"one.dim"</span>,
                                    add        <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">## A </span>
<span class="va">logistic_nullclines</span>    <span class="op">&lt;-</span> <span class="fu">nullclines</span><span class="op">(</span><span class="va">logistic</span>,
                                     xlim       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span>,
                                     ylim       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>,
                                     parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,
                                     system     <span class="op">=</span> <span class="st">"one.dim"</span><span class="op">)</span>
<span class="va">logistic_trajectory</span>    <span class="op">&lt;-</span> <span class="fu">trajectory</span><span class="op">(</span><span class="va">logistic</span>,
                                     y0         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span><span class="op">)</span>,
                                     tlim       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span>,
                                     parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,
                                     system     <span class="op">=</span> <span class="st">"one.dim"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:phaserLogistic"></span>
<img src="figs/phaserLogistic-1.png" alt="*A velocity field is kind of like a magnetic field, showing what rate and direction of trajectories throughout this space. A nullcline is an isocline where the rate of change is zero (the straight horizontal lines in this figure). Here r = 1, and K=2.*" width="90%"><p class="caption">
Figure 5.6: <em>A velocity field is kind of like a magnetic field, showing what rate and direction of trajectories throughout this space. A nullcline is an isocline where the rate of change is zero (the straight horizontal lines in this figure). Here r = 1, and K=2.</em>
</p>
</div>
</div>
</div>
<div id="other-forms-of-density-dependent-growth" class="section level2" number="5.3">
<h2>
<span class="header-section-number">5.3</span> Other forms of density-dependent growth<a class="anchor" aria-label="anchor" href="#other-forms-of-density-dependent-growth"><i class="fas fa-link"></i></a>
</h2>
<p>There are many forms of density-dependent growth, some of which will we describe below. Let’s start by decoupling the density-dependence of birth and death rates <span class="citation">(<a href="references.html#ref-Gotelli2001" role="doc-biblioref">N. J. Gotelli 2001</a>)</span>.</p>
<div id="effects-of-n-on-birth-and-death-rates" class="section level3" number="5.3.1">
<h3>
<span class="header-section-number">5.3.1</span> Effects of N on birth and death rates<a class="anchor" aria-label="anchor" href="#effects-of-n-on-birth-and-death-rates"><i class="fas fa-link"></i></a>
</h3>
<p>Recall from chapter 3 that <span class="math inline">\(r=b-d\)</span>. Now we will let <span class="math inline">\(b\)</span> and <span class="math inline">\(d\)</span> be functions of population size <span class="math inline">\(N\)</span> (<span class="math inline">\(b=F(N)\)</span>, <span class="math inline">\(d=G(N)\)</span>). We could let <span class="math inline">\(F(N)\)</span> and <span class="math inline">\(G(N)\)</span> take a wide variety of different forms. For now, however, let’s say that <span class="math inline">\(N\)</span> has <em>linear</em> effects on these rates so that
<span class="math display">\[\begin{align}
b &amp;=b_0 - aN\\
d &amp;= d_0 + cN
\end{align}\]</span>
which appear in Fig. <a href="DDgrowth.html#fig:bd">5.7</a>.</p>
<div class="figure">
<span style="display:block;" id="fig:bd"></span>
<img src="figs/bd-1.png" alt="*Per capita birth and death rates can be functions of density (dashed lines). The carrying capacity (K) occurs at the point where the per capita birth and death rates are equal. The solid line represents the per capita population growth rate, which is zero when N=K.*" width="75%"><p class="caption">
Figure 5.7: <em>Per capita birth and death rates can be functions of density (dashed lines). The carrying capacity (K) occurs at the point where the per capita birth and death rates are equal. The solid line represents the per capita population growth rate, which is zero when N=K.</em>
</p>
</div>
<p>Now population growth rate is
<span class="math display">\[\begin{align}
\frac{dN}{dt} &amp;= [(b_0-aN)-(d_0 + cN)] N\\
&amp; =[(b_0-d_0) - (a+c)N] N\\
&amp; = (b_0-d_0)(1-\frac{a+c}{b_0-d_0}N)N
\end{align}\]</span>
where the net negative effect of <span class="math inline">\(N\)</span> on per capita population growth rate is <span class="math display">\[\alpha = \frac{a+c}{b_0-d_0}\]</span>
where the numerator is the total direct negative effect of <span class="math inline">\(N\)</span> on birth and death rates, and the denominator is <span class="math inline">\(r\)</span>, the net maximum per capita growth rate which occurs as <span class="math inline">\(N\)</span> approaches zero.</p>
</div>
<div id="theta-logistic-growth" class="section level3" number="5.3.2">
<h3>
<span class="header-section-number">5.3.2</span> Theta-logistic growth<a class="anchor" aria-label="anchor" href="#theta-logistic-growth"><i class="fas fa-link"></i></a>
</h3>
<p>Here we explore a simple extension of the logistic model, the <em>theta-logistic</em> model, which adds a parameter to increase flexibility and generality.
<span class="math display" id="eq:11">\[\begin{equation}
  \tag{5.9}
  \frac{dN}{dt} = rN\left(1 - \left(\alpha N\right)^\theta \right) 
\end{equation}\]</span>
Here <span class="math inline">\(\theta\)</span> is strictly positive (<span class="math inline">\(\theta&gt;0\)</span>); <span class="math inline">\(\theta=0\)</span> means zero growth, and <span class="math inline">\(\theta &lt; 0\)</span> would mean negative growth below <span class="math inline">\(K\)</span>, and unbounded positive growth above <span class="math inline">\(K\)</span>. Approximations of eq. <a href="DDgrowth.html#eq:11">(5.9)</a> that allow <span class="math inline">\(\theta \leq 0\)</span> are possible <span class="citation">(<a href="references.html#ref-Sibly:2005ys" role="doc-biblioref">Sibly et al. 2005</a>)</span>, but the interpretation becomes strained.</p>
<p>Here we make a function that we can use with <code>ode()</code>, the numerical integration function. You’ll need to run this code to use it later.</p>
<div class="sourceCode" id="cb166"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">thetalogistic</span>  <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">times</span>, <span class="va">y</span>, <span class="va">parms</span><span class="op">)</span> <span class="op">{</span>
  <span class="co">## with() and as.list() create an environment in which R will see </span>
  <span class="co">## the named elements in `parms`. </span>
  <span class="va">n</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
  <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="va">parms</span><span class="op">)</span>, <span class="op">{</span>
    <span class="va">dN.dt</span> <span class="op">&lt;-</span> <span class="va">r</span> <span class="op">*</span> <span class="va">n</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="va">alpha</span><span class="op">*</span><span class="va">n</span><span class="op">)</span><span class="op">^</span><span class="va">theta</span><span class="op">)</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">dN.dt</span><span class="op">)</span> <span class="op">)</span> <span class="op">)</span> <span class="op">}</span>  <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>By varying <span class="math inline">\(\theta\)</span>, we can change the linear density dependence of the simple logistic model to curvilinear density dependence (Fig. ). This curvilinearity arises because when <span class="math inline">\(\alpha N &lt; 1.0\)</span> (i.e. <span class="math inline">\(0 &lt; N &lt; K\)</span>),
<span class="math display" id="eq:12">\[\begin{align*}
  \tag{5.10}
   \left(\alpha N\right)^\theta &amp;&lt; \alpha N,\quad \theta &gt; 1\\
   \left(\alpha N\right)^\theta &amp;&gt; \alpha N,\quad \theta &lt; 1.
\end{align*}\]</span>
In contrast, when <span class="math inline">\(\alpha N=1.0\)</span>, then <span class="math inline">\(\left(\alpha N\right)^\theta &lt; \alpha N\)</span>. This means that <span class="math inline">\(\theta\)</span> does not affect <span class="math inline">\(K\)</span>.</p>
<p>When <span class="math inline">\(\theta &gt; 1\)</span>, this weakens density dependence at low <span class="math inline">\(N\)</span>, so the population grows faster than logistic, all else being equal. When <span class="math inline">\(\theta &lt; 1\)</span>, this strengthens density dependence at low <span class="math inline">\(N\)</span>, causing the population to grow more slowly than logistic, all else being equal.</p>
<p>The effects of <span class="math inline">\(\theta\)</span> on density dependence controls the shape of relation between growth rate <span class="math inline">\(vs\)</span>. <span class="math inline">\(N\)</span> (a.k.a. the production function, Fig. ). First, note that for a given <span class="math inline">\(r\)</span>, growth rate for <span class="math inline">\(N&lt;K\)</span> increases with <span class="math inline">\(\theta\)</span>. Second, note that the position of peak of the production function shifts to the right as <span class="math inline">\(\theta\)</span> increases. That is, as <span class="math inline">\(\theta\)</span> increases, the <span class="math inline">\(N\)</span> at which the maximum growth rate occurs also increases. If we wanted to shift the peak growth rate to a higher <span class="math inline">\(N\)</span> without also increasing the height of the peak, we could decrease <span class="math inline">\(r\)</span> simultaneously.</p>
<p>We could speculate on biological meaning of <span class="math inline">\(\theta\)</span> and the shape of the denisty dependence. For instance, very high <span class="math inline">\(\theta\)</span> suggests a threshold, wherein the population exhibits little density dependence until very close to <span class="math inline">\(K\)</span>. Perhaps this is related to territoriality, or a spatial refuge from predators. Alternatively, low <span class="math inline">\(\theta\)</span> might suggest resource preemption, wherein a small number of individuals can sequester large amounts of resources, but increasing <span class="math inline">\(N\)</span> results in reduced preemption. For organisms with very plastic body sizes (plants, fish), this could mean that at low <span class="math inline">\(N\)</span>, average body size is large, but as <span class="math inline">\(N\rightarrow K\)</span>, average body size decreases. While <span class="math inline">\(\theta\)</span>, <em>per se</em>, is devoid of mechanism, discovering the magnitude of <span class="math inline">\(\theta\)</span> for different types of species <span class="citation">(<a href="references.html#ref-Sibly:2005ys" role="doc-biblioref">Sibly et al. 2005</a>)</span> could lead to the generation of new testable hypotheses about what controls populations.</p>
<div class="sourceCode" id="cb167"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">r</span> <span class="op">&lt;-</span> <span class="fl">.75</span>; <span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.01</span>; <span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>; <span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">110</span>
<span class="co">## Per capita PGR</span>
<span class="va">theta.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">theta</span>, <span class="kw">function</span><span class="op">(</span><span class="va">th</span><span class="op">)</span> <span class="op">{</span><span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="va">alpha</span><span class="op">*</span><span class="va">N</span><span class="op">)</span><span class="op">^</span><span class="va">th</span><span class="op">}</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html">matplot</a></span><span class="op">(</span><span class="va">N</span>, <span class="va">theta.out</span>, type<span class="op">=</span><span class="st">'l'</span>, col<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">'topright'</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"theta ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span> <span class="op">)</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">:</span><span class="fl">1</span>, bty<span class="op">=</span><span class="st">'n'</span><span class="op">)</span>

<span class="co">## PGR</span>
<span class="va">thetaGR.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">theta</span>, <span class="kw">function</span><span class="op">(</span><span class="va">th</span><span class="op">)</span> <span class="op">{</span><span class="va">r</span><span class="op">*</span><span class="va">N</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="va">alpha</span><span class="op">*</span><span class="va">N</span><span class="op">)</span><span class="op">^</span><span class="va">th</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html">matplot</a></span><span class="op">(</span><span class="va">N</span>, <span class="va">thetaGR.out</span>, type<span class="op">=</span><span class="st">'l'</span>, col<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span><span class="op">)</span>
<span class="co">##</span>
<span class="va">r</span> <span class="op">&lt;-</span> <span class="fl">3.4</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">N</span>, <span class="va">r</span><span class="op">*</span><span class="va">N</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="va">alpha</span><span class="op">*</span><span class="va">N</span><span class="op">)</span><span class="op">^</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">24</span>, <span class="st">"r=3.4"</span><span class="op">)</span>

<span class="va">prms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>r <span class="op">=</span> <span class="fl">0.75</span>, alpha <span class="op">=</span> <span class="fl">0.01</span>, theta<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">20</span>, by<span class="op">=</span><span class="fl">.1</span><span class="op">)</span>
<span class="va">thetaN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">theta</span>, <span class="kw">function</span><span class="op">(</span><span class="va">th</span><span class="op">)</span> <span class="op">{</span><span class="va">prms</span><span class="op">[</span><span class="st">"theta"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">th</span>
                                      <span class="fu">ode</span><span class="op">(</span>y<span class="op">=</span><span class="fl">1</span>, times<span class="op">=</span><span class="va">t</span>, <span class="va">thetalogistic</span>, <span class="va">prms</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">}</span> <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html">matplot</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">thetaN</span>, type<span class="op">=</span><span class="st">'l'</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:ThetaDD"></span>
<img src="figs/ThetaDD-1.png" alt="*Theta-logistic per capita rates, population growth rates, and dynamics for $    heta&lt;1$, $   heta=1$, and $  heta&gt;1$. In a review of population dynamics, Sibly et al. (2005) use theta-logistic density dependence to show that populations most frequently have a concave-up, $ heta &lt; 1$, pattern.*" width="33%"><img src="figs/ThetaDD-2.png" alt="*Theta-logistic per capita rates, population growth rates, and dynamics for $ heta&lt;1$, $   heta=1$, and $  heta&gt;1$. In a review of population dynamics, Sibly et al. (2005) use theta-logistic density dependence to show that populations most frequently have a concave-up, $ heta &lt; 1$, pattern.*" width="33%"><img src="figs/ThetaDD-3.png" alt="*Theta-logistic per capita rates, population growth rates, and dynamics for $ heta&lt;1$, $   heta=1$, and $  heta&gt;1$. In a review of population dynamics, Sibly et al. (2005) use theta-logistic density dependence to show that populations most frequently have a concave-up, $ heta &lt; 1$, pattern.*" width="33%"><p class="caption">
Figure 5.8: <em>Theta-logistic per capita rates, population growth rates, and dynamics for $ heta&lt;1$, $ heta=1$, and $ heta&gt;1$. In a review of population dynamics, Sibly et al. (2005) use theta-logistic density dependence to show that populations most frequently have a concave-up, $ heta &lt; 1$, pattern.</em>
</p>
</div>
</div>
<div id="allee-effect" class="section level3" number="5.3.3">
<h3>
<span class="header-section-number">5.3.3</span> Allee effect<a class="anchor" aria-label="anchor" href="#allee-effect"><i class="fas fa-link"></i></a>
</h3>
<p>The <em>Allee effect</em> is a positive relation between average individual fitness and population size <span class="citation">(<a href="references.html#ref-Drake2011al" role="doc-biblioref">Drake and Kramer 2011</a>)</span>. For us, this translates as a positive relation between per capita population growth rate and population size.</p>
<p>An Allee effect is likely to arise in sexually reproducing populations. This occurs because at very low population sizes, male and female individuals are less likely to encounter each other and so mating frequency is very low. As population size increases, females and males are more likely to encounter each other, and mating increases.</p>
<p>One way to represent this is with an additional term in our model, which incorporates a threshold population size, below which population growth rate is negative. Here <span class="math inline">\(a\)</span> is the threshold population size,
<span class="math display" id="eq:logallee">\[\begin{equation}
\frac{dN}{dt}= rN\left(1-\alpha N\right)\left(1 - \frac{a+\tau}{N+\tau}\right) \tag{5.11}
\end{equation}\]</span></p>
<p>so that if the population size falls below the threshold, it cannot recover (<span class="math inline">\(N&lt;a\)</span>, <span class="math inline">\(dN/dt &lt; 0\)</span>). Parameter <span class="math inline">\(\tau\)</span> is greater than 0, and controls how severe the consequence is for <span class="math inline">\(N&lt;a\)</span>. The smaller <span class="math inline">\(\tau\)</span> is, the more negative population growth becomes. A function to project this dynamic is available in <code>primer</code> as <code><a href="https://rdrr.io/pkg/primer/man/alogistic.html">alogistic()</a></code>.</p>
<div class="sourceCode" id="cb168"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## for simplicity, we let r=1 so we can ignore it here.</span>
<span class="va">pgrA</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">N</span>, <span class="va">alpha</span>, <span class="va">a</span>, <span class="va">tau</span><span class="op">)</span><span class="op">{</span> <span class="va">N</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">alpha</span><span class="op">*</span><span class="va">N</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="va">a</span><span class="op">+</span><span class="va">tau</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">N</span><span class="op">+</span><span class="va">tau</span><span class="op">)</span><span class="op">)</span> <span class="op">}</span>
<span class="va">myData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span> N<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">110</span><span class="op">)</span> <span class="op">)</span> <span class="co"># ggplot requires a data frame</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data<span class="op">=</span><span class="va">myData</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">N</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># set the basic properties of the plot</span>
  <span class="co"># in the stat_function, we indicate the parameters in our equation.</span>
    <span class="fu">stat_function</span><span class="op">(</span>fun<span class="op">=</span><span class="va">pgrA</span>, geom<span class="op">=</span><span class="st">"line"</span>, n<span class="op">=</span><span class="fl">1001</span>,
                  args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.01</span>, a<span class="op">=</span><span class="fl">20</span>, tau<span class="op">=</span><span class="fl">.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">labs</span><span class="op">(</span>y<span class="op">=</span><span class="st">"Population growth rate (dN/dt)"</span>, x<span class="op">=</span><span class="st">"Population size (N)"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="co">#theme_classic() + </span>
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">0</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> 
<span class="va">p</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:allee"></span>
<img src="figs/allee-1.png" alt="*The Allee effect the a positive relation bewteen population growth rate and population size, often best envisioned as a negative consequence of small population size. Here, the threshold population size is 20, meaning that $dN/dt &lt; 0$, when $N &lt; 20$.*" width="75%"><p class="caption">
Figure 5.9: <em>The Allee effect the a positive relation bewteen population growth rate and population size, often best envisioned as a negative consequence of small population size. Here, the threshold population size is 20, meaning that <span class="math inline">\(dN/dt &lt; 0\)</span>, when <span class="math inline">\(N &lt; 20\)</span>.</em>
</p>
</div>
</div>
<div id="the-integral-of-logistic-growth" class="section level3" number="5.3.4">
<h3>
<span class="header-section-number">5.3.4</span> The integral of logistic growth<a class="anchor" aria-label="anchor" href="#the-integral-of-logistic-growth"><i class="fas fa-link"></i></a>
</h3>
<p>We might as well add that there is an expression for <span class="math inline">\(N_{t}\)</span>, analogous to <span class="math inline">\(N_{t}=N_{0}\exp(rt)\)</span> for exponential growth. If we integrate eq. <a href="DDgrowth.html#eq:logalpha">(5.2)</a> with respect to time, we have
<span class="math display">\[\begin{equation}
N_{t}=\frac{N_{0}e^{rt}}{1+\alpha N_{0}\left(e^{rt}-1\right)}.
\label{fig:clogisticNt}
\end{equation}\]</span>
Note the resemblance to the exponential equation. We have the exponential equation in the numerator, divided by a correction factor which starts at 1 when <span class="math inline">\(t=0\)</span>. The correction factor then grows with time, at a rate which is virtually the same as exponential growth but adjusted by <span class="math inline">\(\alpha\)</span> and scaled by <span class="math inline">\(N_{0}\)</span>. Thus when <span class="math inline">\(t=0\)</span>, and if <span class="math inline">\(N_0\)</span> is small, we have near-exponential growth, decreased merely by a factor of <span class="math inline">\(\alpha N_0\)</span>.</p>
</div>
</div>
<div id="discrete-density-dependent-growth" class="section level2" number="5.4">
<h2>
<span class="header-section-number">5.4</span> Discrete Density-dependent Growth<a class="anchor" aria-label="anchor" href="#discrete-density-dependent-growth"><i class="fas fa-link"></i></a>
</h2>
<p>The continuous logistic equation is probably our simplest example of population growth, aside from pure exponential growth. Here we describe the discrete-time version. Recall that the discrete time version of population growth rate is
<span class="math display">\[\frac{\Delta N}{\Delta t}=\frac{N_{t+1}-N_t}{(t+1) - t}=N_{t+1}-N_t\]</span>
because our time step is one (1) entire time unit (typically a year). The discrete time logistic function is therefore
<span class="math display" id="eq:3dd">\[\begin{equation}
  N_{t+1} - N_t = r_d N_t\left(1-\alpha N_t\right)
  \tag{5.12}
\end{equation}\]</span></p>
<p>Here <span class="math inline">\(r_d\)</span> has the same meaning it did in chapter 3, where <span class="math inline">\(r_d = b-d-bd\)</span>. When <span class="math inline">\(r_d\)</span> is quite small in a slow growing population, this is very similar to the continuous form. However, as <span class="math inline">\(r_d\)</span> becomes larger in a faster growing population, the dynamics can get quite exciting.</p>
<p>Let’s explore the dynamics of this numerically by writing a function to project discrete logistic growth. A pre-written function is available in <code>primer</code> by the same name.</p>
<p>To project a discrete time model, we have to project entire one year at a time. We did this for structured demographic models, and unstructured geometric growth and our sparrow simulation. We will do it here using a function in the <code>deSolve</code> package that imposes a one year time step, specifically for discrete time models, including difference equations.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;&lt;code&gt;deSolve&lt;/code&gt; allows several different ways to project discrete time models. Consult &lt;code&gt;vignette('deSolve', package='deSolve')&lt;/code&gt;.&lt;/p&gt;"><sup>35</sup></a></p>
<p>We set up the model as we did with the continuous time model.</p>
<div class="sourceCode" id="cb169"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dlogistic</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">t</span>, <span class="va">y</span>, <span class="va">p</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">N</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
  <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>,<span class="op">{</span>
      <span class="va">N.diff</span> <span class="op">&lt;-</span>  <span class="va">rd</span> <span class="op">*</span> <span class="va">N</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span> <span class="op">*</span> <span class="va">N</span><span class="op">)</span> 
      <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">N.diff</span><span class="op">)</span><span class="op">)</span>  <span class="op">}</span><span class="op">)</span> <span class="op">}</span></code></pre></div>
<p>We then specific the parameters, the initial state or population size, and the time steps. Note that for a discrete time model the <strong>time steps must be annual increments</strong>. We then project the population.</p>
<div class="sourceCode" id="cb170"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>rd<span class="op">=</span><span class="fl">1</span>, alpha<span class="op">=</span><span class="fl">.01</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>N<span class="op">=</span><span class="fl">10</span><span class="op">)</span>
<span class="va">years</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">10</span>
<span class="va">outd</span> <span class="op">&lt;-</span> <span class="fu">ode</span><span class="op">(</span>func <span class="op">=</span> <span class="va">dlogistic</span>, y <span class="op">=</span> <span class="va">y</span>, times <span class="op">=</span> <span class="va">years</span>,
 parms <span class="op">=</span> <span class="va">p</span>, method <span class="op">=</span> <span class="st">"euler"</span><span class="op">)</span>
<span class="va">outd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">outd</span><span class="op">)</span>
<span class="fu">ggplot</span><span class="op">(</span><span class="va">outd</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">time</span>, <span class="va">N</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x<span class="op">=</span><span class="fl">1</span>, y <span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="va">p</span><span class="op">[</span><span class="st">"alpha"</span><span class="op">]</span><span class="op">+</span><span class="fl">2</span>, label<span class="op">=</span><span class="st">"K = 1/alpha"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:dlogistic"></span>
<img src="figs/dlogistic-1.png" alt="*Discrete growth can look a lot like continuous growth as long as the per capita growth rate is low.*" width="90%"><p class="caption">
Figure 5.10: <em>Discrete growth can look a lot like continuous growth as long as the per capita growth rate is low.</em>
</p>
</div>
<div id="effects-of-r_d" class="section level3" number="5.4.1">
<h3>
<span class="header-section-number">5.4.1</span> Effects of <span class="math inline">\(r_d\)</span><a class="anchor" aria-label="anchor" href="#effects-of-r_d"><i class="fas fa-link"></i></a>
</h3>
<p>Changing <span class="math inline">\(\alpha\)</span> or <span class="math inline">\(K\)</span> does not change radically the dynamics of this model. However, increasing <span class="math inline">\(r_d\)</span> changes the dynamics a lot. This is in contrast to what happens in continuous logsitic growth. When we increase <span class="math inline">\(r_d\)</span> sufficiently, we get <em>stable limit cycles</em> and if we raise <span class="math inline">\(r_d\)</span> high enough, we get <em>chaos</em>.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Not the evil spy agency featured in the 1960’s US television show, &lt;em&gt;Get Smart&lt;/em&gt;.&lt;/p&gt;"><sup>36</sup></a>.</p>
<div class="sourceCode" id="cb171"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rd.v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1.3</span>, <span class="fl">2.8</span>, by<span class="op">=</span><span class="fl">.3</span><span class="op">)</span>
<span class="va">N0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>N<span class="op">=</span><span class="fl">10</span><span class="op">)</span>; <span class="va">t</span> <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">20</span>
<span class="va">Ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">rd.v</span>, <span class="kw">function</span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>rd<span class="op">=</span><span class="va">r</span>, alpha<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span>
  <span class="va">outd</span> <span class="op">&lt;-</span> <span class="fu">ode</span><span class="op">(</span>func <span class="op">=</span> <span class="va">dlogistic</span>, y <span class="op">=</span> <span class="va">N0</span>, times <span class="op">=</span> <span class="va">t</span>,
 parms <span class="op">=</span> <span class="va">p</span>, method <span class="op">=</span> <span class="st">"euler"</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>
  <span class="op">}</span>
 <span class="op">)</span> 
<span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>t<span class="op">=</span><span class="va">t</span>, <span class="va">Ns</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"t"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"rd="</span>,<span class="va">rd.v</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span>
<span class="va">out.l</span> <span class="op">&lt;-</span> <span class="fu">pivot_longer</span><span class="op">(</span><span class="va">out</span>, cols<span class="op">=</span><span class="op">-</span><span class="fl">1</span>, names_to<span class="op">=</span><span class="st">"r.d"</span>, values_to<span class="op">=</span><span class="st">"N"</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="va">out.l</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">t</span>, <span class="va">N</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">r.d</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:dlogcycles"></span>
<img src="figs/dlogcycles-1.png" alt="*How variation in $r_d$ influences dynamics of discrete logistic growth.*" width="75%"><p class="caption">
Figure 5.11: <em>How variation in <span class="math inline">\(r_d\)</span> influences dynamics of discrete logistic growth.</em>
</p>
</div>
<p>At low <span class="math inline">\(r_d\)</span>, we have simple asymptotic approach to <span class="math inline">\(K\)</span>. As <span class="math inline">\(r_d\)</span> increases, we see the population overshoot the carrying capacity and exhibit <em>damped oscillations</em>. When <span class="math inline">\(2 &lt; r_d &lt; 2.449\)</span>, the population is attracted to two-point limit cycles. In this case, <em>these two points are stable attractors</em>. Regardless where the population starts out, it is attracted to the same two points, for a given <span class="math inline">\(r_d\)</span>. As <span class="math inline">\(r_d\)</span> increases further, the number of points increases to a four-point limit cycle (e.g., at <span class="math inline">\(r_d=2.5\)</span>), then an eight-point cycle, a 16-point limit cycle, and so on. These points are stable attractors. As <span class="math inline">\(r_d\)</span> increases further , however, stable limit cycles shift into <em>chaos</em> (<span class="math inline">\(r_d&gt;2.57\)</span>). Chaos is a non-repeating, deterministic fluctuating trajectory, that is bounded, and sensitive to initial conditions.</p>
<p><span class="citation"><a href="references.html#ref-May:1974fk" role="doc-biblioref">R. M. May</a> (<a href="references.html#ref-May:1974fk" role="doc-biblioref">1974</a>)</span> shocked the ecological community when he first demonstrated stable limit cycles and chaos using this model. His groundbreaking work, done on a hand calculator, showed how very complicated, seemingly random dynamics emerge as a result of very simple deterministic rules. Among other things, it made population biologists wonder whether prediction was possible at all. In general, however, chaos seems to require very special circumstances, including very high population growth.</p>
<p>Is there a biological interpretation of these fluctuations? Consider some simple environment, in which small vegetation-eating animals with high reproductive rates eat almost all the vegetation in one year. The following year, the vegetation will not have recovered, but the animal population will still be very high. Thus the high growth rate causes a disconnect between the actual population size, and the negative effects of those individuals comprising the population. <em>The negative effects of the actions of individuals (e.g., resource consumption) are felt by the offspring of those individuals, rather than the individuals themselves</em>. We won’t belabor the point here, but it is certainly possible to extend this delayed density dependence to a wide variety of populations. The discrete logistic model has a built in delay, or <em>time lag</em>, of one time step, because the growth increment makes a single leap of one time step. This delay is missing from the analogous continuous time model because the growth increment covers an infinity small time step, thanks to the miracles of calculus.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;A time lag can be explicitly built in to a continuous time model, with only a small effort.&lt;/p&gt;"><sup>37</sup></a></p>
</div>
<div id="bifurcations" class="section level3" number="5.4.2">
<h3>
<span class="header-section-number">5.4.2</span> Bifurcations<a class="anchor" aria-label="anchor" href="#bifurcations"><i class="fas fa-link"></i></a>
</h3>
<p>Up until now, we have examined <span class="math inline">\(N\)</span> as a function of time. We have
graphed it for different <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(N_0\)</span>, but time was always on
the <span class="math inline">\(x\)</span>-axis. Now we are going to examine <span class="math inline">\(N\)</span> as a function of <span class="math inline">\(r_d\)</span>, so <span class="math inline">\(r_d\)</span> is on the <span class="math inline">\(x\)</span>-axis. Specifically, we will plot the stable limits or attractors <span class="math inline">\(vs\)</span>. <span class="math inline">\(r_d\)</span> (Fig. <a href="#fig:bifurcation"><strong>??</strong></a>). What does it mean? For <span class="math inline">\(r_{d} &lt; 2\)</span>, there is only a single <span class="math inline">\(N\)</span>. This is what we mean by a stable point equilibrium, or point attractor.</p>
<p>As long as <span class="math inline">\(r_d\)</span> is small, <span class="math inline">\(N\)</span> always converges to a particular point.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;It need not be the same &lt;span class="math inline"&gt;\(N\)&lt;/span&gt; for each &lt;span class="math inline"&gt;\(r_d\)&lt;/span&gt;, although in this case it is.&lt;/p&gt;'><sup>38</sup></a> When <span class="math inline">\(2&lt;r_{d}&lt;2.45\)</span>, then all of a sudden there are two different <span class="math inline">\(N\)</span>; that is, there is a two-point stable limit cycle. Note that when <span class="math inline">\(r_d\approx 2\)</span> these oscillations between the two point attractors around <span class="math inline">\(K\)</span> are small, but as we increase <span class="math inline">\(r_d\)</span>, those two points are farther apart. The point at which the limit cycle emerges, at <span class="math inline">\(r_d=2\)</span>, is called a <em>bifurcation</em>; it is a splitting of the single attractor into two attractors. At <span class="math inline">\(r_{d}\approx 2.45\)</span>, there is another bifurcation, and each the two stable attractors split into two, resulting in a total of four unique <span class="math inline">\(N\)</span>. At <span class="math inline">\(r_{d}\approx 2.53\)</span>, there are eight <span class="math inline">\(N\)</span>.</p>
<p>All of these points are <em>periodic attractors</em> because <span class="math inline">\(N\)</span> is drawn to these particular points at regular intervals. As <span class="math inline">\(r_d\)</span> increases the number of attractors will continue to double, growing geometrically. Eventually, we reach a point when there becomes an infinite number of unique points, <em>that are determined by <span class="math inline">\(r_{d}\)</span></em>.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;They are also determined by the initial &lt;span class="math inline"&gt;\(N\)&lt;/span&gt;, but we will get to that later.&lt;/p&gt;'><sup>39</sup></a> This completely deterministic, non-repeating pattern in <span class="math inline">\(N\)</span> is a property of <em>chaos</em>. Chaos is not a random phenomenon; rather it is the result of deterministic mechanisms generating non-repeating patterns.</p>
<p>Here we perform more comprehensive simulations, and plot the point and periodic attractors <em>vs</em>. <span class="math inline">\(r_d\)</span>. First we pick some constraints for the simulation: the number of different <span class="math inline">\(r_d\)</span>, the sequence of <span class="math inline">\(r_d\)</span> values, and the number of time steps.</p>
<div class="sourceCode" id="cb172"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Iff you are interested....</span>
<span class="va">num.rd</span> <span class="op">&lt;-</span> <span class="fl">1001</span> <span class="co"># the number of rd's you want</span>
<span class="va">rd.s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1.5</span>,<span class="fl">3</span>, length<span class="op">=</span><span class="va">num.rd</span><span class="op">)</span> <span class="co"># the actual rd values</span>
<span class="va">t</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1000</span> <span class="co"># how long to run each population</span>
<span class="va">N0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>N<span class="op">=</span><span class="fl">99</span><span class="op">)</span> <span class="co"># N-zero</span>
<span class="co">## do all the dynamical simulations putting each run</span>
<span class="co">## into a column of a matrix.</span>
<span class="va">Ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">rd.s</span>, <span class="kw">function</span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>rd<span class="op">=</span><span class="va">r</span>, alpha<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span>
  <span class="va">outd</span> <span class="op">&lt;-</span> <span class="fu">ode</span><span class="op">(</span>y <span class="op">=</span> <span class="va">N0</span>, times <span class="op">=</span> <span class="va">t</span>, func <span class="op">=</span> <span class="va">dlogistic</span>, 
 parms <span class="op">=</span> <span class="va">p</span>, method <span class="op">=</span> <span class="st">"euler"</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>
  <span class="op">}</span>
 <span class="op">)</span> 
<span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>t<span class="op">=</span><span class="va">t</span>, <span class="va">Ns</span><span class="op">)</span> <span class="co"># put times to the front of the matrix</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"t"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"rd="</span>,<span class="va">rd.s</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="co"># relabel columns</span>
<span class="va">out.last</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">out</span>, <span class="va">t</span> <span class="op">&gt;</span> <span class="fl">0.8</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span> <span class="co"># keep only the last 20%</span>
<span class="co">## put the data in the "long format"</span>
<span class="va">out.l</span> <span class="op">&lt;-</span> <span class="fu">pivot_longer</span><span class="op">(</span><span class="va">out.last</span>, cols<span class="op">=</span><span class="op">-</span><span class="fl">1</span>, names_to<span class="op">=</span><span class="st">"r.d"</span>, values_to<span class="op">=</span><span class="st">"N"</span><span class="op">)</span>
<span class="va">out.l</span> <span class="op">&lt;-</span> <span class="fu">arrange</span><span class="op">(</span><span class="va">out.l</span>, <span class="va">r.d</span>, <span class="va">t</span><span class="op">)</span> <span class="co"># re-order the data</span>
<span class="co">## extract text out of the 'r.d' label that is the numeric value</span>
<span class="va">text.values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">out.l</span><span class="op">$</span><span class="va">r.d</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html">regexpr</a></span><span class="op">(</span><span class="st">"="</span>, <span class="va">out.l</span><span class="op">$</span><span class="va">r.d</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>, <span class="fl">100</span><span class="op">)</span> 
<span class="co">## convert the characters of "1.5" to the number 1.5</span>
<span class="va">out.l</span><span class="op">$</span><span class="va">rd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span> <span class="va">text.values</span> <span class="op">)</span>

<span class="co">## plot the stable limits to show the bifurcations</span>
<span class="fu">ggplot</span><span class="op">(</span><span class="va">out.l</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">rd</span>, <span class="va">N</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span>pch<span class="op">=</span><span class="st">"."</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:bifurcation-1"></span>
<img src="figs/bifurcation-1.png" alt="*Illustration of the long term dynamics of discrete logistic population growth. When a small change in a continuous parameter results in a change in the number of attractors (e.g. a single point equilibrium to a stable 2-point limit cycle), we call this a bifurcation.*" width="75%"><p class="caption">
Figure 5.12: <em>Illustration of the long term dynamics of discrete logistic population growth. When a small change in a continuous parameter results in a change in the number of attractors (e.g. a single point equilibrium to a stable 2-point limit cycle), we call this a bifurcation.</em>
</p>
</div>
<div class="sourceCode" id="cb173"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out.l.chaotic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span> <span class="va">out.l</span>, <span class="va">rd</span> <span class="op">&gt;</span> <span class="fl">2.6</span> <span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="va">out.l.chaotic</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">rd</span>, <span class="va">N</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span>pch<span class="op">=</span><span class="st">"."</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:bifurcation-2"></span>
<img src="figs/bifurcation-2.png" alt="*Illustration of the long term dynamics of discrete logistic population growth. When a small change in a continuous parameter results in a change in the number of attractors (e.g. a single point equilibrium to a stable 2-point limit cycle), we call this a bifurcation.*" width="75%"><p class="caption">
Figure 5.13: <em>Illustration of the long term dynamics of discrete logistic population growth. When a small change in a continuous parameter results in a change in the number of attractors (e.g. a single point equilibrium to a stable 2-point limit cycle), we call this a bifurcation.</em>
</p>
</div>
<p>There has been a great deal of effort expended trying to determine whether a particular model or real population exhibits true chaos. In any practical sense, it may be somewhat unimportant whether a population exhibits true chaos, or merely a higher order periodic attractor <span class="citation">(<a href="references.html#ref-Ellner:2005fk" role="doc-biblioref">S. P. Ellner and Turchin 2005</a>)</span>. The key point here is that very simple models, and therefore potentially simple mechanisms, can generate very complex dynamics.</p>
<p>Another very important characteristic feature of chaotic populations is that they are very sensitive to initial conditions. Thus emerges the idea that whether a butterfly in Sierra Leone flaps its wings twice or thrice may determine whether a hurricane hits the southeastern United States in New Orleans, Louisiana, or in Galveston, Texas.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Clearly, this suggests that the solution to increased storm severity due to global warming is to kill all butterflies.&lt;/p&gt;"><sup>40</sup></a></p>
<p>If we generate simulations where we vary initial population size by a single individual, we find that this can have an enormous impact on the similarity of two populations’ dynamics, and on our ability to predict future population sizes (Fig. @(fig:DDGChaosInitN)). Note how the populations start with similar trajectories, but soon diverge so that they experience different sequences of minima and maxima (Fig. @(fig:DDGChaosInitN)). This is part of what was so upsetting to ecologists about May’s 1974 paper — perhaps even the simplest deterministic model could create dynamics so complex that we could not distinguish them from random <span class="citation">(<a href="references.html#ref-May:1974fk" role="doc-biblioref">R. M. May 1974</a>)</span>. Over time, however, we came to learn that (i) we could distinguish random dynamics from some chaos-like dynamics, and (ii) the hunt for chaos could be very exciting, if most frequently disappointing <span class="citation">(<a href="references.html#ref-Becks2005" role="doc-biblioref">Becks et al. 2005</a>; <a href="references.html#ref-Constantino1995" role="doc-biblioref">Constantino et al. 1995</a>; <a href="references.html#ref-Kendall:1998ys" role="doc-biblioref">Kendall, Prendergast, and Bjornstad 1998</a>)</span>.</p>
<p>We start with three populations, all very close in initial abundance, <span class="math inline">\(N_0 \in \{97,98,99\}\)</span>. We then project the population with a <span class="math inline">\(r_d\)</span> to generate chaos for 30 time steps.</p>
<div class="sourceCode" id="cb174"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">N.init</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">97</span>,<span class="fl">98</span>,<span class="fl">99</span><span class="op">)</span>
<span class="va">t</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">30</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>rd<span class="op">=</span><span class="fl">2.7</span>, alpha<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span>
<span class="va">out</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span>
  <span class="co"># project the population</span>
  <span class="va">N0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>N<span class="op">=</span><span class="va">N.init</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>
  <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu">ode</span><span class="op">(</span>y<span class="op">=</span><span class="va">N0</span>, times<span class="op">=</span><span class="va">t</span>, <span class="va">dlogistic</span>, 
           parms<span class="op">=</span><span class="va">p</span>, method<span class="op">=</span><span class="st">"euler"</span><span class="op">)</span>
  <span class="co"># fill a column with the initial value</span>
  <span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">a</span>, N0<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">N0</span><span class="op">)</span><span class="op">)</span> <span class="co"># b now has cols: t, N, rd</span>
  <span class="co"># store data in rows of out "bind rows" with rbind</span>
  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind.data.frame</a></span><span class="op">(</span><span class="va">out</span>, <span class="va">b</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu">ggplot</span><span class="op">(</span>data<span class="op">=</span><span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">time</span>, <span class="va">N</span>, colour<span class="op">=</span><span class="va">N0</span>, linetype<span class="op">=</span><span class="va">N0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:DDGChaosInitN"></span>
<img src="figs/DDGChaosInitN-1.png" alt="*Effects of differences in initial population size on the short term and long term dynamics, and their correspondence, of three populations.*" width="75%"><p class="caption">
Figure 5.14: <em>Effects of differences in initial population size on the short term and long term dynamics, and their correspondence, of three populations.</em>
</p>
</div>
<p>One last issue that we should note is the extent to which our populations are <em>bounded</em>. A population may have complex dynamics, but we may be able to characterize a given population by its upper and lower bounds. In spite of the differences created by the initial conditions, the upper and lower bounds of our chaotic populations were very similar (Fig. <a href="DDgrowth.html#fig:DDGChaosInitN">5.14</a>). Note also as <span class="math inline">\(r_d\)</span> increases (Fig. <a href="#fig:bifurcation"><strong>??</strong></a>) the oscillations increase very systematically.</p>
<p>One way to see the deterministic nature of chaos is to trace population size from each time point to the next time point. We put <span class="math inline">\(N_t\)</span> on the <span class="math inline">\(x\)</span>-axis and <span class="math inline">\(N_{t+1}\)</span> on the <span class="math inline">\(y\)</span>-axis, and connect all successive points.</p>
<div class="sourceCode" id="cb175"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">N0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>N<span class="op">=</span><span class="fl">2</span><span class="op">)</span>; <span class="va">t</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1000</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>rd <span class="op">=</span> <span class="fl">2.8</span>, alpha <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span>
<span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">ode</span><span class="op">(</span><span class="va">N0</span>, <span class="va">t</span>, <span class="va">dlogistic</span>, <span class="va">p</span>, method<span class="op">=</span><span class="st">"euler"</span><span class="op">)</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">[</span><span class="fl">901</span><span class="op">:</span><span class="fl">1000</span>, <span class="fl">2</span><span class="op">]</span>
<span class="va">ntp1</span> <span class="op">&lt;-</span> <span class="va">n</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>
<span class="va">nt</span> <span class="op">&lt;-</span> <span class="va">n</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">]</span>
<span class="fu">qplot</span><span class="op">(</span><span class="va">nt</span>, <span class="va">ntp1</span>, geom<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"point"</span>, <span class="st">"path"</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>y<span class="op">=</span><span class="st">"N[t+1]"</span>, x<span class="op">=</span><span class="st">"N[t]"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:logweb"></span>
<img src="figs/logweb-1.png" alt="*A chaotic discrete logistic population shows certain highly predictable patterns including population sizes limited to a quadratic form revealed here.*" width="75%"><p class="caption">
Figure 5.15: <em>A chaotic discrete logistic population shows certain highly predictable patterns including population sizes limited to a quadratic form revealed here.</em>
</p>
</div>
<p>In general, we can describe many characteristics of populations, even if we cannot predict exactly what the population size will be five years hence. For instance, we can describe the shape of density dependence (linear, nonlinear), and characteristics of <span class="math inline">\(N\)</span>, such as the average, the variance, the periodicity, the upper and lower bounds, and the color (i.e. degree of temporal auto-correlation). Indeed, these characteristics may vary among types of organisms, body sizes, or environments.</p>
<div id="ricker-and-more" class="section level4" number="5.4.2.1">
<h4>
<span class="header-section-number">5.4.2.1</span> Ricker and more<a class="anchor" aria-label="anchor" href="#ricker-and-more"><i class="fas fa-link"></i></a>
</h4>
<p>There are many more models of density dependent growth. Some, like the theta-logistic and the Richards models, are more flexible and have more parameters. Others, like the Gompertz model, are used more widely in other fields, such as cancer research for tumor growth, von Bertalanffy for body size growth, and the Ricker model for fisheries.</p>
<p>The Ricker model looks a lot like our friend, exponential growth, but where <span class="math inline">\(r\)</span> is modified by density. Here we see them side by side.</p>
<p><span class="math display">\[\begin{equation}
N_{t+1} = N_t e^{r} \quad ; \quad N_{t+1}=N_t e^{r_d \left(1-N_t/K\right)}
\end{equation}\]</span></p>
<p>Like discrete logistic growth, the Ricker model<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Bill Ricker, the eponym of the famous model, made very important contributions to the study of poplation dynamics and fisheries science.&lt;/p&gt;"><sup>41</sup></a> will also exhibit chaos at high per capita growth rates (<span class="math inline">\(r_d&gt;&gt;1\)</span>).</p>
</div>
</div>
</div>
<div id="maximum-sustained-yield" class="section level2" number="5.5">
<h2>
<span class="header-section-number">5.5</span> Maximum Sustained Yield<a class="anchor" aria-label="anchor" href="#maximum-sustained-yield"><i class="fas fa-link"></i></a>
</h2>
<p>The classical model of harvesting fisheries and wildlife populations is based on a particular conceptualization of <em>maximum sustained yield</em> (MSY). Maximum sustained yield is historically defined as the population size where both population growth rate and harvest rate are at a maximum. For the logistic growth model, this is half the carrying capacity. We can solve this by finding the maximum of the production function. To do this we use calculus (differentiation) to find where the slope of the production function equals zero. Starting with the partial derivative with respect to <span class="math inline">\(N\)</span> (eq. <a href="DDgrowth.html#eq:pdlog">(5.4)</a>), we solve for zero.
<span class="math display" id="eq:msy1">\[\begin{align}
  \tag{5.13}
    0 &amp;= r - 2r\alpha N\\
    N &amp;= \frac{r}{2r\alpha} = \frac{K}{2}
\end{align}\]</span>
Similarly, we could determine this peak for the <span class="math inline">\(\theta\)</span>-logistic model as well.
<span class="math display" id="eq:msyth">\[\begin{align}
  \tag{5.14}
  \frac{\partial \dot{N}}{\partial N} &amp;=r - \left(\theta+1\right)r\left(\alpha N\right)^\theta\\
0 &amp;= \frac{K}{\left(\theta+1\right)^{1/\theta}}
\end{align}\]</span>
When <span class="math inline">\(\theta=1\)</span>, this reduces to <span class="math inline">\(K/2\)</span>, as for the logistic model. As we saw above, <span class="math inline">\(\theta &lt; 1\)</span> causes this value to be less than <span class="math inline">\(K/2\)</span>.</p>
<p>Even if we assume the logistic model is appropriate for a given population, harvests in practice seldom reduce populations to <span class="math inline">\(K/2\)</span>, because often <span class="math inline">\(N\)</span> and <span class="math inline">\(K\)</span> vary with time and are difficult to estimate. Moreover, economic forces often lead to over-harvesting. More contemporary models of harvesting incorporate these concepts <span class="citation">(<a href="references.html#ref-Roughgarden:1996fr" role="doc-biblioref">Roughgarden and Smith 1996</a>)</span> but still may not prevent fisheries collapse driven by social and political pressures. We should note that when more detailed information is available on age- or stage-specific survivorship and reproduction, age- or stage-structured models of harvesting are the preferred method (e.g., Chapter 2). For many populations, such as marine fisheries, however, data are often available only on stock size (<span class="math inline">\(N\)</span>) and total catch (<span class="math inline">\(H\)</span>). In some fisheries models, the total catch is fixed and does not vary with <span class="math inline">\(N\)</span>. This leads to highly unstable population dynamics and fortunately is no longer practiced in most fisheries. Usually the total catch <span class="math inline">\(H\)</span> is modeled as a function of <span class="math inline">\(N\)</span>.</p>
<p>Let us assume that total catch or harvest, <span class="math inline">\(H\)</span>, is a simple linear function of <span class="math inline">\(N\)</span>; the total harvest rate <span class="math inline">\(FN\)</span> is usually described this way.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;We could, but will not, further describe this by &lt;span class="math inline"&gt;\(F=qE\)&lt;/span&gt;, where &lt;span class="math inline"&gt;\(q\)&lt;/span&gt; is the catchability coefficient for the fishery, and &lt;span class="math inline"&gt;\(E\)&lt;/span&gt; is fishing effort in hours.&lt;/p&gt;'><sup>42</sup></a> In this case, a maximum sustained yield can be determined from the logistic growth-harvest model. This basic model is then
<span class="math display" id="eq:FN">\[\begin{align}
  \tag{5.15}
\frac{dN}{dt}&amp;=rN(1-\frac{N}{K})-FN
\end{align}\]</span>
where <span class="math inline">\(FN=H\)</span> harvest rate, and <span class="math inline">\(F\)</span> is the per capita fishing mortality rate. Here we assume a fixed per capita catch mortality <span class="math inline">\(F\)</span> so that total harvest is <span class="math inline">\(H=F\times N\)</span>. Maximum sustained yield should then occur at <span class="math inline">\(K/2\)</span> (Fig. <a href="DDgrowth.html#fig:msy1">5.16</a>). Therefore would like to know the value of <span class="math inline">\(F\)</span> for which a new <span class="math inline">\(N^* = K/2\)</span> rather than <span class="math inline">\(K\)</span>. We can determine the value of <span class="math inline">\(F\)</span> for which this is true by finding when <span class="math inline">\(dN/dt=0\)</span> and <span class="math inline">\(N=K/2\)</span>.
<span class="math display" id="eq:F">\[\begin{align}
  0 &amp;= r\frac{K}{2}\left(1-\frac{\frac{K}{2}}{K}\right)-F\frac{K}{2}\\
  F &amp;= \frac{r}{2} \tag{5.16}
\end{align}\]</span></p>
<div class="sourceCode" id="cb176"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pgrlog</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">N</span>, <span class="va">r</span>, <span class="va">alpha</span><span class="op">)</span><span class="op">{</span> <span class="va">r</span><span class="op">*</span><span class="va">N</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">alpha</span><span class="op">*</span><span class="va">N</span><span class="op">)</span> <span class="op">}</span>
<span class="va">r</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>; <span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.01</span>
<span class="va">myData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span> N<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">110</span><span class="op">)</span> <span class="op">)</span> <span class="co"># ggplot requires a data frame</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data<span class="op">=</span><span class="va">myData</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">N</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># set the basic properties of the plot</span>
  <span class="co"># in the stat_function, we indicate the parameters in our equation.</span>
    <span class="fu">stat_function</span><span class="op">(</span>fun<span class="op">=</span><span class="va">pgrlog</span>, geom<span class="op">=</span><span class="st">"line"</span>, n<span class="op">=</span><span class="fl">1001</span>,
                  args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>r<span class="op">=</span><span class="va">r</span>, alpha <span class="op">=</span> <span class="va">alpha</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">labs</span><span class="op">(</span>y<span class="op">=</span><span class="st">"Population growth rate (dN/dt)"</span>, x<span class="op">=</span><span class="st">"Population size (N)"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_abline</span><span class="op">(</span>intercept<span class="op">=</span><span class="fl">0</span>, slope<span class="op">=</span><span class="va">r</span><span class="op">/</span><span class="fl">2</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span>
<span class="va">p</span>

<span class="va">pgrH</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">N</span>, <span class="va">r</span>, <span class="va">alpha</span>, <span class="va">f</span><span class="op">)</span><span class="op">{</span> <span class="va">r</span><span class="op">*</span><span class="va">N</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">alpha</span><span class="op">*</span><span class="va">N</span><span class="op">)</span> <span class="op">-</span> <span class="va">f</span><span class="op">*</span><span class="va">N</span> <span class="op">}</span>
<span class="va">f</span> <span class="op">&lt;-</span> <span class="va">r</span><span class="op">/</span><span class="fl">2</span>
<span class="va">myData2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span> N<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">60</span><span class="op">)</span> <span class="op">)</span> <span class="co"># ggplot requires a data frame</span>
<span class="va">h</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data<span class="op">=</span><span class="va">myData2</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">N</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># set the basic properties of the plot</span>
  <span class="co"># in the stat_function, we indicate the parameters in our equation.</span>
    <span class="fu">stat_function</span><span class="op">(</span>fun<span class="op">=</span><span class="va">pgrH</span>, geom<span class="op">=</span><span class="st">"line"</span>, n<span class="op">=</span><span class="fl">1001</span>,
                  args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>r<span class="op">=</span><span class="va">r</span>, alpha <span class="op">=</span> <span class="va">alpha</span>, f <span class="op">=</span> <span class="va">f</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">labs</span><span class="op">(</span>y<span class="op">=</span><span class="st">"PGR w/ harvesting (dN/dt)"</span>, x<span class="op">=</span><span class="st">"Population size (N)"</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span>
<span class="va">h</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:msy1"></span>
<img src="figs/msy1-1.png" alt="*To find the predicted population growth rate with harvesting, we start with Logistic growth rate (solid line) and then substract harvest rate (dashed line).*" width="50%"><img src="figs/msy1-2.png" alt="*To find the predicted population growth rate with harvesting, we start with Logistic growth rate (solid line) and then substract harvest rate (dashed line).*" width="50%"><p class="caption">
Figure 5.16: <em>To find the predicted population growth rate with harvesting, we start with Logistic growth rate (solid line) and then substract harvest rate (dashed line).</em>
</p>
</div>
<p>If harvesting occurs at a rate of <span class="math inline">\(F&lt;r/2\)</span>, the slope of the harvest line is shallower than in Fig. <a href="DDgrowth.html#fig:msy1">5.16</a>, and we refer to this as <em>under-harvesting</em>. If the rate is <span class="math inline">\(F&gt;r/2\)</span>, then the slope is steeper than in Fig. <a href="DDgrowth.html#fig:msy1">5.16</a>, and we refer to this as <em>over-harvesting</em>. <span class="citation"><a href="references.html#ref-Roughgarden:1996fr" role="doc-biblioref">Roughgarden and Smith</a> (<a href="references.html#ref-Roughgarden:1996fr" role="doc-biblioref">1996</a>)</span> show that under-harvesting is the most ecologically stable, whereas over-harvesting is frequently thought to be the economically optimal approach if we don’t care about the long-term wellbeing of the fishing industry.</p>
<p>Typically the economically optimal approach leads to over-harvesting because the marginal income on a fishery is related to the interest rate on invested income, <span class="math inline">\(F= (r + \rho)/2\)</span>, where <span class="math inline">\(\rho\)</span> is the interest rate (usually <span class="math inline">\(\rho\)</span> is set to 0.05). We can substitute this into eq. <a href="DDgrowth.html#eq:FN">(5.15)</a> and solve for <span class="math inline">\(N\)</span> (ignoring <span class="math inline">\(N=0\)</span>).
<span class="math display" id="eq:ecopt">\[\begin{align*}
  \tag{5.17}
  0&amp;=rN(1-\frac{N}{K})-\frac{r + \rho}{2}N\\
   N\frac{r}{K}&amp;=r -\frac{r}{2} -\frac{\rho}{2}\\
  N &amp;=\frac{K}{2}\left(1-\frac{\rho}{r}\right)
\end{align*}\]</span>
Thus, unless <span class="math inline">\(\rho=0\)</span>, the typical economic optimum <span class="math inline">\(N_{e}^*\)</span> will be smaller than <span class="math inline">\(N*=K/2\)</span>. This makes intuitive economic sense if we consider income from invested profits. The margin of error, however, is much smaller, putting the fisheries population, and the investment of fishing fleets and associated econmoies at greater risk. <span class="citation"><a href="references.html#ref-Roughgarden:1996fr" role="doc-biblioref">Roughgarden and Smith</a> (<a href="references.html#ref-Roughgarden:1996fr" role="doc-biblioref">1996</a>)</span> showed that ecological stability of a fishery is likely to beget economic and cultural stability. They show that the supposed “economic optimal” harvesting rate was so low that it increased the extinction risk of the harvested population to unacceptably high levels. The collapse of a fishery is, of course, both economically and culturally devastating.</p>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="DID.html"><span class="header-section-number">4</span> Density-independent Demography</a></div>
<div class="next"><a href="meta.html"><span class="header-section-number">6</span> Populations in Space</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#DDgrowth"><span class="header-section-number">5</span> Density-dependent growth</a></li>
<li><a class="nav-link" href="#continuous-logistic-growth"><span class="header-section-number">5.1</span> Continuous logistic growth</a></li>
<li>
<a class="nav-link" href="#dynamics-around-the-equilibria-stability"><span class="header-section-number">5.2</span> Dynamics around the equilibria — stability</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#analytical-linear-stability-analysis"><span class="header-section-number">5.2.1</span> Analytical linear stability analysis</a></li>
<li><a class="nav-link" href="#projection-with-numerical-integration"><span class="header-section-number">5.2.2</span> Projection with numerical integration</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#other-forms-of-density-dependent-growth"><span class="header-section-number">5.3</span> Other forms of density-dependent growth</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#effects-of-n-on-birth-and-death-rates"><span class="header-section-number">5.3.1</span> Effects of N on birth and death rates</a></li>
<li><a class="nav-link" href="#theta-logistic-growth"><span class="header-section-number">5.3.2</span> Theta-logistic growth</a></li>
<li><a class="nav-link" href="#allee-effect"><span class="header-section-number">5.3.3</span> Allee effect</a></li>
<li><a class="nav-link" href="#the-integral-of-logistic-growth"><span class="header-section-number">5.3.4</span> The integral of logistic growth</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#discrete-density-dependent-growth"><span class="header-section-number">5.4</span> Discrete Density-dependent Growth</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#effects-of-r_d"><span class="header-section-number">5.4.1</span> Effects of \(r_d\)</a></li>
<li><a class="nav-link" href="#bifurcations"><span class="header-section-number">5.4.2</span> Bifurcations</a></li>
</ul>
</li>
<li><a class="nav-link" href="#maximum-sustained-yield"><span class="header-section-number">5.5</span> Maximum Sustained Yield</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Primer of Ecology using R</strong>" was written by Hank Stevens. It was last built on 2021-08-24.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
