<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10 Disease | Primer of Ecology using R</title>
  <meta name="description" content="10 Disease | Primer of Ecology using R" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="10 Disease | Primer of Ecology using R" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="HankStevens/Primer-of-Ecology" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10 Disease | Primer of Ecology using R" />
  
  
  

<meta name="author" content="Hank Stevens" />


<meta name="date" content="2021-08-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="host-parasitoid-relations.html"/>
<link rel="next" href="consumer-resource-competition-and-mutualisms.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-VCV8MES4YY"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-VCV8MES4YY');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="theory.html"><a href="theory.html"><i class="fa fa-check"></i><b>1</b> Theory in Ecology</a>
<ul>
<li class="chapter" data-level="1.1" data-path="theory.html"><a href="theory.html#examples-of-theories"><i class="fa fa-check"></i><b>1.1</b> Examples of theories</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="theory.html"><a href="theory.html#hierarchy-theory"><i class="fa fa-check"></i><b>1.1.1</b> Hierarchy theory</a></li>
<li class="chapter" data-level="1.1.2" data-path="theory.html"><a href="theory.html#a-general-theory-of-ecology"><i class="fa fa-check"></i><b>1.1.2</b> A general theory of ecology</a></li>
<li class="chapter" data-level="1.1.3" data-path="theory.html"><a href="theory.html#efficient-theory"><i class="fa fa-check"></i><b>1.1.3</b> Efficient theory</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="theory.html"><a href="theory.html#metabolic_scaling"><i class="fa fa-check"></i><b>1.2</b> An example: Metabolic Theory of Ecology</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="theory.html"><a href="theory.html#body-size-dependence"><i class="fa fa-check"></i><b>1.2.1</b> Body-size dependence</a></li>
<li class="chapter" data-level="1.2.2" data-path="theory.html"><a href="theory.html#temperature-dependence"><i class="fa fa-check"></i><b>1.2.2</b> Temperature dependence</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="theory.html"><a href="theory.html#power-law-scaling-implies-constant-relative-differences"><i class="fa fa-check"></i><b>1.3</b> Power law scaling implies constant relative differences</a></li>
<li class="chapter" data-level="1.4" data-path="theory.html"><a href="theory.html#meet-mete-maximum-entropy-theory-of-ecology"><i class="fa fa-check"></i><b>1.4</b> Meet METE: Maximum Entropy Theory of Ecology</a></li>
<li class="chapter" data-level="1.5" data-path="theory.html"><a href="theory.html#in-fine"><i class="fa fa-check"></i><b>1.5</b> <em>In fine</em></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="oft.html"><a href="oft.html"><i class="fa fa-check"></i><b>2</b> Optimal Foraging</a>
<ul>
<li class="chapter" data-level="2.1" data-path="oft.html"><a href="oft.html#a-prey-model"><i class="fa fa-check"></i><b>2.1</b> A prey model</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="oft.html"><a href="oft.html#our-intuition"><i class="fa fa-check"></i><b>2.1.1</b> Our intuition</a></li>
<li class="chapter" data-level="2.1.2" data-path="oft.html"><a href="oft.html#mathematical-support"><i class="fa fa-check"></i><b>2.1.2</b> Mathematical support</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="oft.html"><a href="oft.html#the-patch-model"><i class="fa fa-check"></i><b>2.2</b> The patch model</a></li>
<li class="chapter" data-level="2.3" data-path="oft.html"><a href="oft.html#a-simulation-of-a-prey-model"><i class="fa fa-check"></i><b>2.3</b> A simulation of a prey model</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="oft.html"><a href="oft.html#lab-exercise"><i class="fa fa-check"></i><b>2.3.1</b> Lab exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="expo.html"><a href="expo.html"><i class="fa fa-check"></i><b>3</b> Simple density-independent growth</a>
<ul>
<li class="chapter" data-level="3.1" data-path="expo.html"><a href="expo.html#discrete-growth-rates-of-fruit-flies-in-my-kitchen"><i class="fa fa-check"></i><b>3.1</b> Discrete growth rates of fruit flies in my kitchen</a></li>
<li class="chapter" data-level="3.2" data-path="expo.html"><a href="expo.html#fruit-flies-with-continuous-overlapping-generations"><i class="fa fa-check"></i><b>3.2</b> Fruit flies with continuous overlapping generations</a></li>
<li class="chapter" data-level="3.3" data-path="expo.html"><a href="expo.html#properties-of-geometric-and-exponential-growth"><i class="fa fa-check"></i><b>3.3</b> Properties of geometric and exponential growth</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="expo.html"><a href="expo.html#average-growth-rate"><i class="fa fa-check"></i><b>3.3.1</b> Average growth rate</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="expo.html"><a href="expo.html#modeling-with-data-simulated-dynamics"><i class="fa fa-check"></i><b>3.4</b> Modeling with Data: Simulated Dynamics</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="expo.html"><a href="expo.html#data-based-approaches"><i class="fa fa-check"></i><b>3.4.1</b> Data-based approaches</a></li>
<li class="chapter" data-level="3.4.2" data-path="expo.html"><a href="expo.html#creating-and-visualizing-the-data"><i class="fa fa-check"></i><b>3.4.2</b> Creating and visualizing the data</a></li>
<li class="chapter" data-level="3.4.3" data-path="expo.html"><a href="expo.html#one-simulation"><i class="fa fa-check"></i><b>3.4.3</b> One simulation</a></li>
<li class="chapter" data-level="3.4.4" data-path="expo.html"><a href="expo.html#multiple-simulations"><i class="fa fa-check"></i><b>3.4.4</b> Multiple simulations</a></li>
<li class="chapter" data-level="3.4.5" data-path="expo.html"><a href="expo.html#a-distribution-of-possible-futures"><i class="fa fa-check"></i><b>3.4.5</b> A distribution of possible futures</a></li>
<li class="chapter" data-level="3.4.6" data-path="expo.html"><a href="expo.html#analyzing-results"><i class="fa fa-check"></i><b>3.4.6</b> Analyzing results</a></li>
<li class="chapter" data-level="3.4.7" data-path="expo.html"><a href="expo.html#inferring-processes-underlying-growth-rate"><i class="fa fa-check"></i><b>3.4.7</b> Inferring processes underlying growth rate</a></li>
<li class="chapter" data-level="3.4.8" data-path="expo.html"><a href="expo.html#f-environmental-noise"><i class="fa fa-check"></i><b>3.4.8</b> 1/<span class="math inline">\(f\)</span> environmental noise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="DID.html"><a href="DID.html"><i class="fa fa-check"></i><b>4</b> Density-independent Demography</a>
<ul>
<li class="chapter" data-level="4.1" data-path="DID.html"><a href="DID.html#a-two-stage-matrix-model"><i class="fa fa-check"></i><b>4.1</b> A two stage matrix model</a></li>
<li class="chapter" data-level="4.2" data-path="DID.html"><a href="DID.html#a-brief-primer-on-matrices"><i class="fa fa-check"></i><b>4.2</b> A brief primer on matrices</a></li>
<li class="chapter" data-level="4.3" data-path="DID.html"><a href="DID.html#decomposing-a"><i class="fa fa-check"></i><b>4.3</b> Decomposing <strong>A</strong></a></li>
<li class="chapter" data-level="4.4" data-path="DID.html"><a href="DID.html#a-three-stage-model"><i class="fa fa-check"></i><b>4.4</b> A three stage model</a></li>
<li class="chapter" data-level="4.5" data-path="DID.html"><a href="DID.html#projection"><i class="fa fa-check"></i><b>4.5</b> Projection</a></li>
<li class="chapter" data-level="4.6" data-path="DID.html"><a href="DID.html#analyzing-the-transition-matrix"><i class="fa fa-check"></i><b>4.6</b> Analyzing the transition matrix</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="DID.html"><a href="DID.html#eigenanalysis"><i class="fa fa-check"></i><b>4.6.1</b> Eigenanalysis</a></li>
<li class="chapter" data-level="4.6.2" data-path="DID.html"><a href="DID.html#finite-rate-of-increase"><i class="fa fa-check"></i><b>4.6.2</b> Finite rate of increase</a></li>
<li class="chapter" data-level="4.6.3" data-path="DID.html"><a href="DID.html#stable-stage-distribution"><i class="fa fa-check"></i><b>4.6.3</b> Stable stage distribution</a></li>
<li class="chapter" data-level="4.6.4" data-path="DID.html"><a href="DID.html#calculating-the-stable-stage-distribution"><i class="fa fa-check"></i><b>4.6.4</b> Calculating the stable stage distribution</a></li>
<li class="chapter" data-level="4.6.5" data-path="DID.html"><a href="DID.html#reproductive-value"><i class="fa fa-check"></i><b>4.6.5</b> Reproductive value</a></li>
<li class="chapter" data-level="4.6.6" data-path="DID.html"><a href="DID.html#sensitivity-and-elasticity"><i class="fa fa-check"></i><b>4.6.6</b> Sensitivity and elasticity</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="DID.html"><a href="DID.html#integral-projection"><i class="fa fa-check"></i><b>4.7</b> Integral projection</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="DID.html"><a href="DID.html#a-size-based-ipm-of-smooth-coneflower"><i class="fa fa-check"></i><b>4.7.1</b> A size-based IPM of smooth coneflower</a></li>
<li class="chapter" data-level="4.7.2" data-path="DID.html"><a href="DID.html#population-summaries"><i class="fa fa-check"></i><b>4.7.2</b> Population summaries</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="DID.html"><a href="DID.html#r-packges-for-demography"><i class="fa fa-check"></i><b>4.8</b> R packges for demography</a></li>
<li class="chapter" data-level="4.9" data-path="DID.html"><a href="DID.html#exploring-a-real-population"><i class="fa fa-check"></i><b>4.9</b> Exploring a real population</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="DDgrowth.html"><a href="DDgrowth.html"><i class="fa fa-check"></i><b>5</b> Density-dependent growth</a>
<ul>
<li class="chapter" data-level="5.1" data-path="DDgrowth.html"><a href="DDgrowth.html#continuous-logistic-growth"><i class="fa fa-check"></i><b>5.1</b> Continuous logistic growth</a></li>
<li class="chapter" data-level="5.2" data-path="DDgrowth.html"><a href="DDgrowth.html#dynamics-around-the-equilibria-stability"><i class="fa fa-check"></i><b>5.2</b> Dynamics around the equilibria — stability</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="DDgrowth.html"><a href="DDgrowth.html#analytical-linear-stability-analysis"><i class="fa fa-check"></i><b>5.2.1</b> Analytical linear stability analysis</a></li>
<li class="chapter" data-level="5.2.2" data-path="DDgrowth.html"><a href="DDgrowth.html#projection-with-numerical-integration"><i class="fa fa-check"></i><b>5.2.2</b> Projection with numerical integration</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="DDgrowth.html"><a href="DDgrowth.html#other-forms-of-density-dependent-growth"><i class="fa fa-check"></i><b>5.3</b> Other forms of density-dependent growth</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="DDgrowth.html"><a href="DDgrowth.html#effects-of-n-on-birth-and-death-rates"><i class="fa fa-check"></i><b>5.3.1</b> Effects of N on birth and death rates</a></li>
<li class="chapter" data-level="5.3.2" data-path="DDgrowth.html"><a href="DDgrowth.html#theta-logistic-growth"><i class="fa fa-check"></i><b>5.3.2</b> Theta-logistic growth</a></li>
<li class="chapter" data-level="5.3.3" data-path="DDgrowth.html"><a href="DDgrowth.html#allee-effect"><i class="fa fa-check"></i><b>5.3.3</b> Allee effect</a></li>
<li class="chapter" data-level="5.3.4" data-path="DDgrowth.html"><a href="DDgrowth.html#the-integral-of-logistic-growth"><i class="fa fa-check"></i><b>5.3.4</b> The integral of logistic growth</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="DDgrowth.html"><a href="DDgrowth.html#discrete-density-dependent-growth"><i class="fa fa-check"></i><b>5.4</b> Discrete Density-dependent Growth</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="DDgrowth.html"><a href="DDgrowth.html#effects-of-r_d"><i class="fa fa-check"></i><b>5.4.1</b> Effects of <span class="math inline">\(r_d\)</span></a></li>
<li class="chapter" data-level="5.4.2" data-path="DDgrowth.html"><a href="DDgrowth.html#bifurcations"><i class="fa fa-check"></i><b>5.4.2</b> Bifurcations</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="DDgrowth.html"><a href="DDgrowth.html#maximum-sustained-yield"><i class="fa fa-check"></i><b>5.5</b> Maximum Sustained Yield</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="meta.html"><a href="meta.html"><i class="fa fa-check"></i><b>6</b> Populations in Space</a>
<ul>
<li class="chapter" data-level="6.1" data-path="meta.html"><a href="meta.html#source-sink-dynamics"><i class="fa fa-check"></i><b>6.1</b> Source-sink Dynamics</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="meta.html"><a href="meta.html#complications-and-cases"><i class="fa fa-check"></i><b>6.1.1</b> Complications and cases</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="meta.html"><a href="meta.html#metapopulations"><i class="fa fa-check"></i><b>6.2</b> Metapopulations</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="meta.html"><a href="meta.html#the-classic-levins-model"><i class="fa fa-check"></i><b>6.2.1</b> The classic Levins model</a></li>
<li class="chapter" data-level="6.2.2" data-path="meta.html"><a href="meta.html#propagule-rain"><i class="fa fa-check"></i><b>6.2.2</b> Propagule rain</a></li>
<li class="chapter" data-level="6.2.3" data-path="meta.html"><a href="meta.html#the-rescue-effect-and-the-core-satellite-model"><i class="fa fa-check"></i><b>6.2.3</b> The rescue effect and the core-satellite model</a></li>
<li class="chapter" data-level="6.2.4" data-path="meta.html"><a href="meta.html#parallels-with-logistic-growth"><i class="fa fa-check"></i><b>6.2.4</b> Parallels with Logistic Growth</a></li>
<li class="chapter" data-level="6.2.5" data-path="meta.html"><a href="meta.html#levins-vs.-hanski"><i class="fa fa-check"></i><b>6.2.5</b> Levins <span class="math inline">\(vs\)</span>. Hanski</a></li>
<li class="chapter" data-level="6.2.6" data-path="meta.html"><a href="meta.html#habitat-destruction"><i class="fa fa-check"></i><b>6.2.6</b> Habitat Destruction</a></li>
<li class="chapter" data-level="6.2.7" data-path="meta.html"><a href="meta.html#illustrating-the-effects-of-habitat-destruction"><i class="fa fa-check"></i><b>6.2.7</b> Illustrating the effects of habitat destruction</a></li>
<li class="chapter" data-level="6.2.8" data-path="meta.html"><a href="meta.html#different-assumptions-lead-to-different-predictions-about-rates-of-extinction"><i class="fa fa-check"></i><b>6.2.8</b> Different assumptions lead to different predictions about rates of extinction</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="meta.html"><a href="meta.html#hanskis-incidence-function"><i class="fa fa-check"></i><b>6.3</b> Hanski’s incidence function</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="direct-competition-and-mutualism.html"><a href="direct-competition-and-mutualism.html"><i class="fa fa-check"></i><b>7</b> Direct competition and mutualism</a>
<ul>
<li class="chapter" data-level="7.1" data-path="direct-competition-and-mutualism.html"><a href="direct-competition-and-mutualism.html#interspecific-competition"><i class="fa fa-check"></i><b>7.1</b> Interspecific competition</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="direct-competition-and-mutualism.html"><a href="direct-competition-and-mutualism.html#equilbria"><i class="fa fa-check"></i><b>7.1.1</b> Equilbria</a></li>
<li class="chapter" data-level="7.1.2" data-path="direct-competition-and-mutualism.html"><a href="direct-competition-and-mutualism.html#dynamics-at-the-equilibria"><i class="fa fa-check"></i><b>7.1.2</b> Dynamics at the Equilibria</a></li>
<li class="chapter" data-level="7.1.3" data-path="direct-competition-and-mutualism.html"><a href="direct-competition-and-mutualism.html#return-time-and-the-effect-of-r"><i class="fa fa-check"></i><b>7.1.3</b> Return Time and the Effect of <span class="math inline">\(r\)</span></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="direct-competition-and-mutualism.html"><a href="direct-competition-and-mutualism.html#interspecific-mutualism"><i class="fa fa-check"></i><b>7.2</b> Interspecific mutualism</a></li>
<li class="chapter" data-level="7.3" data-path="direct-competition-and-mutualism.html"><a href="direct-competition-and-mutualism.html#generalized-lotka-volterra-models"><i class="fa fa-check"></i><b>7.3</b> Generalized Lotka-Volterra models</a></li>
<li class="chapter" data-level="7.4" data-path="direct-competition-and-mutualism.html"><a href="direct-competition-and-mutualism.html#summary"><i class="fa fa-check"></i><b>7.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="cr.html"><a href="cr.html"><i class="fa fa-check"></i><b>8</b> Consumer-resource Interactions</a>
<ul>
<li class="chapter" data-level="8.1" data-path="cr.html"><a href="cr.html#ratio-dependence"><i class="fa fa-check"></i><b>8.1</b> Ratio dependence</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="cr.html"><a href="cr.html#dynamics-of-ratio-dependent-predation"><i class="fa fa-check"></i><b>8.1.1</b> Dynamics of ratio dependent predation</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="cr.html"><a href="cr.html#prey-dependence"><i class="fa fa-check"></i><b>8.2</b> Prey dependence</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="cr.html"><a href="cr.html#dyanmics-of-prey-dependent-predation"><i class="fa fa-check"></i><b>8.2.1</b> Dyanmics of prey-dependent predation</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="cr.html"><a href="cr.html#interlude-functional-response---what-an-individual-predator-does-fr"><i class="fa fa-check"></i><b>8.3</b> Interlude: Functional response - what an individual predator does (#fr)</a></li>
<li class="chapter" data-level="8.4" data-path="cr.html"><a href="cr.html#stability-analysis-for-the-prey-dependent-lotkavolterra-model"><i class="fa fa-check"></i><b>8.4</b> Stability analysis for the prey-dependent Lotka–Volterra model</a></li>
<li class="chapter" data-level="8.5" data-path="cr.html"><a href="cr.html#resource-growth-functions"><i class="fa fa-check"></i><b>8.5</b> Resource growth functions</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="cr.html"><a href="cr.html#consumption-of-a-renewable-resource"><i class="fa fa-check"></i><b>8.5.1</b> Consumption of a renewable resource</a></li>
<li class="chapter" data-level="8.5.2" data-path="cr.html"><a href="cr.html#prey-carrying-capacity-and-type-ii-functional-response"><i class="fa fa-check"></i><b>8.5.2</b> Prey carrying capacity and type II functional response</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="cr.html"><a href="cr.html#paradox-of-enrichment"><i class="fa fa-check"></i><b>8.6</b> Paradox of enrichment</a></li>
<li class="chapter" data-level="8.7" data-path="cr.html"><a href="cr.html#consumption-of-two-resources"><i class="fa fa-check"></i><b>8.7</b> Consumption of two resources</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="cr.html"><a href="cr.html#interpreting-consumption-and-assimilation"><i class="fa fa-check"></i><b>8.7.1</b> Interpreting consumption and assimilation</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="cr.html"><a href="cr.html#in-fine-1"><i class="fa fa-check"></i><b>8.8</b> In fine</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="host-parasitoid-relations.html"><a href="host-parasitoid-relations.html"><i class="fa fa-check"></i><b>9</b> Host-parasitoid relations</a>
<ul>
<li class="chapter" data-level="9.1" data-path="host-parasitoid-relations.html"><a href="host-parasitoid-relations.html#independent-and-random-attacks"><i class="fa fa-check"></i><b>9.1</b> Independent and random attacks</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="host-parasitoid-relations.html"><a href="host-parasitoid-relations.html#simulating-simple-host-parasitoid-dynamics"><i class="fa fa-check"></i><b>9.1.1</b> Simulating simple host-parasitoid dynamics</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="host-parasitoid-relations.html"><a href="host-parasitoid-relations.html#aggregation-leads-to-coexistence"><i class="fa fa-check"></i><b>9.2</b> Aggregation leads to coexistence</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="host-parasitoid-relations.html"><a href="host-parasitoid-relations.html#equilibria-for-a-discrete-time-model"><i class="fa fa-check"></i><b>9.2.1</b> Equilibria for a discrete-time model</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="host-parasitoid-relations.html"><a href="host-parasitoid-relations.html#stability-of-hostparasitoid-dynamics"><i class="fa fa-check"></i><b>9.3</b> Stability of host–parasitoid dynamics</a></li>
<li class="chapter" data-level="9.4" data-path="host-parasitoid-relations.html"><a href="host-parasitoid-relations.html#in-fine-2"><i class="fa fa-check"></i><b>9.4</b> <em>In Fine</em></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="disease.html"><a href="disease.html"><i class="fa fa-check"></i><b>10</b> Disease</a>
<ul>
<li class="chapter" data-level="10.1" data-path="disease.html"><a href="disease.html#closed-epidemics"><i class="fa fa-check"></i><b>10.1</b> Closed epidemics</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="disease.html"><a href="disease.html#density-dependent-transmission"><i class="fa fa-check"></i><b>10.1.1</b> Density-dependent transmission</a></li>
<li class="chapter" data-level="10.1.2" data-path="disease.html"><a href="disease.html#frequency-dependent-transmission"><i class="fa fa-check"></i><b>10.1.2</b> Frequency-dependent transmission</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="disease.html"><a href="disease.html#open-epidemics"><i class="fa fa-check"></i><b>10.2</b> Open epidemics</a></li>
<li class="chapter" data-level="10.3" data-path="disease.html"><a href="disease.html#modeling-data-from-bombay"><i class="fa fa-check"></i><b>10.3</b> Modeling data from Bombay</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="disease.html"><a href="disease.html#optimization"><i class="fa fa-check"></i><b>10.3.1</b> Optimization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="consumer-resource-competition-and-mutualisms.html"><a href="consumer-resource-competition-and-mutualisms.html"><i class="fa fa-check"></i><b>11</b> Consumer-resource Competition and Mutualisms</a>
<ul>
<li class="chapter" data-level="11.1" data-path="consumer-resource-competition-and-mutualisms.html"><a href="consumer-resource-competition-and-mutualisms.html#competition-for-one-resource"><i class="fa fa-check"></i><b>11.1</b> Competition for one resource</a></li>
<li class="chapter" data-level="11.2" data-path="consumer-resource-competition-and-mutualisms.html"><a href="consumer-resource-competition-and-mutualisms.html#competition-for-substitutable-resources"><i class="fa fa-check"></i><b>11.2</b> Competition for Substitutable resources</a></li>
<li class="chapter" data-level="11.3" data-path="consumer-resource-competition-and-mutualisms.html"><a href="consumer-resource-competition-and-mutualisms.html#tilmans-resource-ratio-with-essential-resources"><i class="fa fa-check"></i><b>11.3</b> Tilman’s resource ratio with essential resources</a></li>
<li class="chapter" data-level="11.4" data-path="consumer-resource-competition-and-mutualisms.html"><a href="consumer-resource-competition-and-mutualisms.html#consumer-resource-mutualism"><i class="fa fa-check"></i><b>11.4</b> Consumer-resource mutualism</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="consumer-resource-competition-and-mutualisms.html"><a href="consumer-resource-competition-and-mutualisms.html#a-model-of-uni-directional-mutualism"><i class="fa fa-check"></i><b>11.4.1</b> A model of uni-directional mutualism</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="consumer-resource-competition-and-mutualisms.html"><a href="consumer-resource-competition-and-mutualisms.html#plant-soil-feedbacks"><i class="fa fa-check"></i><b>11.5</b> Plant-soil feedbacks</a></li>
<li class="chapter" data-level="11.6" data-path="consumer-resource-competition-and-mutualisms.html"><a href="consumer-resource-competition-and-mutualisms.html#simulations-for-learning"><i class="fa fa-check"></i><b>11.6</b> Simulations for learning</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="consumer-resource-competition-and-mutualisms.html"><a href="consumer-resource-competition-and-mutualisms.html#lvg"><i class="fa fa-check"></i><b>11.6.1</b> <code>lvg()</code></a></li>
<li class="chapter" data-level="11.6.2" data-path="consumer-resource-competition-and-mutualisms.html"><a href="consumer-resource-competition-and-mutualisms.html#systematic-simulations"><i class="fa fa-check"></i><b>11.6.2</b> Systematic simulations</a></li>
<li class="chapter" data-level="11.6.3" data-path="consumer-resource-competition-and-mutualisms.html"><a href="consumer-resource-competition-and-mutualisms.html#checking-simulation-results"><i class="fa fa-check"></i><b>11.6.3</b> Checking simulation results</a></li>
<li class="chapter" data-level="11.6.4" data-path="consumer-resource-competition-and-mutualisms.html"><a href="consumer-resource-competition-and-mutualisms.html#comparing-simulation-results-to-analytical-solutions"><i class="fa fa-check"></i><b>11.6.4</b> Comparing simulation results to analytical solutions</a></li>
<li class="chapter" data-level="11.6.5" data-path="consumer-resource-competition-and-mutualisms.html"><a href="consumer-resource-competition-and-mutualisms.html#one-last-thing-using-the-jacobian-matrix"><i class="fa fa-check"></i><b>11.6.5</b> One last thing: using the Jacobian matrix</a></li>
<li class="chapter" data-level="11.6.6" data-path="consumer-resource-competition-and-mutualisms.html"><a href="consumer-resource-competition-and-mutualisms.html#in-fine-3"><i class="fa fa-check"></i><b>11.6.6</b> <em>In Fine</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html"><i class="fa fa-check"></i><b>12</b> Food webs and other networks</a>
<ul>
<li class="chapter" data-level="12.1" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#food-web-characteristics"><i class="fa fa-check"></i><b>12.1</b> Food Web Characteristics</a></li>
<li class="chapter" data-level="12.2" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#does-omnivory-destablize-food-chains"><i class="fa fa-check"></i><b>12.2</b> Does omnivory destablize food chains?</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#multi-species-lotkavolterra-notation"><i class="fa fa-check"></i><b>12.2.1</b> Multi-species Lotka–Volterra notation</a></li>
<li class="chapter" data-level="12.2.2" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#background"><i class="fa fa-check"></i><b>12.2.2</b> Background</a></li>
<li class="chapter" data-level="12.2.3" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#implementing-pimm-and-lawtons-methods"><i class="fa fa-check"></i><b>12.2.3</b> Implementing Pimm and Lawton’s Methods</a></li>
<li class="chapter" data-level="12.2.4" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#shortening-the-chain"><i class="fa fa-check"></i><b>12.2.4</b> Shortening the Chain</a></li>
<li class="chapter" data-level="12.2.5" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#adding-omnivory"><i class="fa fa-check"></i><b>12.2.5</b> Adding Omnivory</a></li>
<li class="chapter" data-level="12.2.6" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#comparing-chain-a-versus-b"><i class="fa fa-check"></i><b>12.2.6</b> Comparing Chain A versus B</a></li>
<li class="chapter" data-level="12.2.7" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#re-evaluating-take-home-messages"><i class="fa fa-check"></i><b>12.2.7</b> Re-evaluating Take-Home Messages</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#perhaps-mutualism-stabilizes-bipartite-networks"><i class="fa fa-check"></i><b>12.3</b> Perhaps mutualism stabilizes bipartite networks</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#creating-bipartite-webs"><i class="fa fa-check"></i><b>12.3.1</b> Creating bipartite webs</a></li>
<li class="chapter" data-level="12.3.2" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#testing-effects-of-nestedness-and-modularity-on-network-resilience."><i class="fa fa-check"></i><b>12.3.2</b> Testing effects of nestedness and modularity on network resilience.</a></li>
<li class="chapter" data-level="12.3.3" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#path-analysis"><i class="fa fa-check"></i><b>12.3.3</b> Path Analysis</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#exploring-pandora-right-here-at-home"><i class="fa fa-check"></i><b>12.4</b> Exploring Pandora, right here at home</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="food-webs-and-other-networks.html"><a href="food-webs-and-other-networks.html#properties-assessed"><i class="fa fa-check"></i><b>12.4.1</b> Properties assessed</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="diversity.html"><a href="diversity.html"><i class="fa fa-check"></i><b>13</b> Diversity</a>
<ul>
<li class="chapter" data-level="13.1" data-path="diversity.html"><a href="diversity.html#background-1"><i class="fa fa-check"></i><b>13.1</b> Background</a></li>
<li class="chapter" data-level="13.2" data-path="diversity.html"><a href="diversity.html#species-composition"><i class="fa fa-check"></i><b>13.2</b> Species Composition</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="diversity.html"><a href="diversity.html#measures-of-abundance"><i class="fa fa-check"></i><b>13.2.1</b> Measures of abundance</a></li>
<li class="chapter" data-level="13.2.2" data-path="diversity.html"><a href="diversity.html#dissimilarities-and-distances"><i class="fa fa-check"></i><b>13.2.2</b> Dissimilarities and Distances</a></li>
<li class="chapter" data-level="13.2.3" data-path="diversity.html"><a href="diversity.html#displaying-multidimensional-distances"><i class="fa fa-check"></i><b>13.2.3</b> Displaying multidimensional distances</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="diversity.html"><a href="diversity.html#diversity-1"><i class="fa fa-check"></i><b>13.3</b> Diversity</a></li>
<li class="chapter" data-level="13.4" data-path="diversity.html"><a href="diversity.html#species-diversity"><i class="fa fa-check"></i><b>13.4</b> Species diversity</a></li>
<li class="chapter" data-level="13.5" data-path="diversity.html"><a href="diversity.html#rarefaction-and-total-species-richness"><i class="fa fa-check"></i><b>13.5</b> Rarefaction and total species richness</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="diversity.html"><a href="diversity.html#an-example-of-rarefaction-and-total-species-richness"><i class="fa fa-check"></i><b>13.5.1</b> An example of rarefaction and total species richness</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="diversity.html"><a href="diversity.html#distributions"><i class="fa fa-check"></i><b>13.6</b> Distributions</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="diversity.html"><a href="diversity.html#log-normal-distribution"><i class="fa fa-check"></i><b>13.6.1</b> Log-normal distribution</a></li>
<li class="chapter" data-level="13.6.2" data-path="diversity.html"><a href="diversity.html#other-distributions"><i class="fa fa-check"></i><b>13.6.2</b> Other distributions</a></li>
<li class="chapter" data-level="13.6.3" data-path="diversity.html"><a href="diversity.html#pattern-vs.-process"><i class="fa fa-check"></i><b>13.6.3</b> Pattern <em>vs.</em> process</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="diversity.html"><a href="diversity.html#neutral-theory-of-biodiversity-and-biogeography"><i class="fa fa-check"></i><b>13.7</b> Neutral Theory of Biodiversity and Biogeography</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="diversity.html"><a href="diversity.html#different-flavors-of-neutral-communities"><i class="fa fa-check"></i><b>13.7.1</b> Different flavors of neutral communities</a></li>
<li class="chapter" data-level="13.7.2" data-path="diversity.html"><a href="diversity.html#investigating-neutral-communities"><i class="fa fa-check"></i><b>13.7.2</b> Investigating neutral communities</a></li>
</ul></li>
<li class="chapter" data-level="13.8" data-path="diversity.html"><a href="diversity.html#speciesarea-relations"><i class="fa fa-check"></i><b>13.8</b> Species–area relations</a>
<ul>
<li class="chapter" data-level="13.8.1" data-path="diversity.html"><a href="diversity.html#island-biogeography"><i class="fa fa-check"></i><b>13.8.1</b> Island biogeography</a></li>
</ul></li>
<li class="chapter" data-level="13.9" data-path="diversity.html"><a href="diversity.html#diversity-partitioning"><i class="fa fa-check"></i><b>13.9</b> Diversity Partitioning</a>
<ul>
<li class="chapter" data-level="13.9.1" data-path="diversity.html"><a href="diversity.html#partitioning-speciesarea-relations"><i class="fa fa-check"></i><b>13.9.1</b> Partitioning species–area relations</a></li>
</ul></li>
<li class="chapter" data-level="13.10" data-path="diversity.html"><a href="diversity.html#summary-1"><i class="fa fa-check"></i><b>13.10</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>14</b> Appendix</a>
<ul>
<li class="chapter" data-level="14.1" data-path="appendix.html"><a href="appendix.html#very-introductory-materials"><i class="fa fa-check"></i><b>14.1</b> Very introductory materials</a></li>
<li class="chapter" data-level="14.2" data-path="appendix.html"><a href="appendix.html#writing-your-own-functions"><i class="fa fa-check"></i><b>14.2</b> Writing your own functions</a></li>
<li class="chapter" data-level="14.3" data-path="appendix.html"><a href="appendix.html#iterated-actions-the-apply-family-and-loops"><i class="fa fa-check"></i><b>14.3</b> Iterated Actions: the <code>apply</code> Family and Loops</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="appendix.html"><a href="appendix.html#iterations-of-independent-actions"><i class="fa fa-check"></i><b>14.3.1</b> Iterations of independent actions</a></li>
<li class="chapter" data-level="14.3.2" data-path="appendix.html"><a href="appendix.html#dependent-iterations"><i class="fa fa-check"></i><b>14.3.2</b> Dependent iterations</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="appendix.html"><a href="appendix.html#probability-distributions-and-randomization"><i class="fa fa-check"></i><b>14.4</b> Probability Distributions and Randomization</a></li>
<li class="chapter" data-level="14.5" data-path="appendix.html"><a href="appendix.html#numerical-integration-of-ordinary-differential-equations"><i class="fa fa-check"></i><b>14.5</b> Numerical integration of ordinary differential equations</a></li>
<li class="chapter" data-level="14.6" data-path="appendix.html"><a href="appendix.html#eigenanalysis-1"><i class="fa fa-check"></i><b>14.6</b> Eigenanalysis</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="appendix.html"><a href="appendix.html#eigenanalysis-of-demographic-versus-jacobian-matrices"><i class="fa fa-check"></i><b>14.6.1</b> Eigenanalysis of demographic versus Jacobian matrices</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="appendix.html"><a href="appendix.html#derivation-of-the-right-eigenvalues"><i class="fa fa-check"></i><b>14.7</b> Derivation of the right eigenvalues</a></li>
<li class="chapter" data-level="14.8" data-path="appendix.html"><a href="appendix.html#symbols-used-in-this-book"><i class="fa fa-check"></i><b>14.8</b> Symbols used in this book</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>15</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Primer of Ecology using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="disease" class="section level1" number="10">
<h1><span class="header-section-number">10</span> Disease</h1>
<p>Here we discuss epidemiological disease models. Pathogens cause diseases, and are typically defined as microorganisms (fungi, bacteria, and viruses) with some host specificity, and which undergo population growth within the host. The curious reader may want to consult <span class="citation"><a href="#ref-Ellner:2006qe" role="doc-biblioref">S. P. Ellner and Guckenheimer</a> (<a href="#ref-Ellner:2006qe" role="doc-biblioref">2006</a>)</span> and <span class="citation"><a href="#ref-Bjornstad2018b" role="doc-biblioref">Bjornstad</a> (<a href="#ref-Bjornstad2018b" role="doc-biblioref">2018</a>)</span>.</p>
<p>I think, without tons of evidence, that one nice aspect of disease ecology and the use epidemiological models is that they have helped ecologists feel more comfortable with short term dynamics and also the importance of prediction. Human epidemiology is rightly obsessed with understanding the disease outbreak in front of us, whether it is the common cold, or SARS-CoV-2 and how to alter its course. It is even more interested in being able to predict the course of an outbreak. In contrast, ecology has often been more interested in asymptotic dynamics rather than short term, and more on understanding than prediction. There is a place for everything, and it is good to see the two having merged a bit.</p>
<p>Our simplest models of disease are funny, in that they don’t model pathogens (the enemy) at all. These famous models, by <span class="citation"><a href="#ref-Kermack:1927fk" role="doc-biblioref">Kermack and McCormick</a> (<a href="#ref-Kermack:1927fk" role="doc-biblioref">1927</a>)</span>, keep track of different types of hosts, primarily those with and without disease:</p>
<ul>
<li><strong>Susceptible hosts</strong> Individuals which are not infected, but could become infected,</li>
<li><strong>Infected hosts</strong> Individuals which are already infected, and</li>
<li><strong>Resistant hosts</strong> Individuals which are resistant to the disease, typically assumed to have built up an immunity through past exposure,</li>
</ul>
<p>where <span class="math inline">\(N=S+I+R\)</span>. It is important to note that <span class="math inline">\(N\)</span>, <span class="math inline">\(S\)</span>, <span class="math inline">\(I\)</span>, and <span class="math inline">\(R\)</span> are <em>densities</em>. That is, we track numbers of individuals in a fixed area. This is important because it has direct consequences for the spread, or transmission, of disease <span class="citation">(<a href="#ref-McCallum2001" role="doc-biblioref">McCallum, Barlow, and Hone 2001</a>)</span>.</p>
<p>Disease spreads from infected individuals to susceptible individuals. The rate depends to some extent on the number or alternatively, on the fraction of the population that is infected. Resistant individuals are not typically considered vectors of the pathogens, and so increased abundance of resistant individuals slow the transmission rate by diluting the other two groups.</p>
<div id="closed-epidemics" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> Closed epidemics</h2>
<p>A good starting place is the simplest SIR models, that for a <em>closed</em> epidemic. By this we mean that births, deaths, and migration are essentially zero, such that we have a fixed population size. This is a reasonable assumption over relatively short time intervals, which is fine if we are interested in the progression of a single disease outbreak.
<span class="math display" id="eq:SIRd">\[\begin{align*}
  \tag{10.1}
  \frac{d S}{d t} &amp;= -\beta IS\\
  \frac{d I}{d t} &amp;=\beta IS  - \gamma I\\
  \frac{d R}{d t} &amp;= \gamma I
\end{align*}\]</span></p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="disease.html#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here we create the function for the simple SIR model.</span></span>
<span id="cb283-2"><a href="disease.html#cb283-2" aria-hidden="true" tabindex="-1"></a>SIRd <span class="ot">&lt;-</span> <span class="cf">function</span>(t, y, p) {</span>
<span id="cb283-3"><a href="disease.html#cb283-3" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb283-4"><a href="disease.html#cb283-4" aria-hidden="true" tabindex="-1"></a>        S <span class="ot">&lt;-</span> y[<span class="dv">1</span>]</span>
<span id="cb283-5"><a href="disease.html#cb283-5" aria-hidden="true" tabindex="-1"></a>        I <span class="ot">&lt;-</span> y[<span class="dv">2</span>]</span>
<span id="cb283-6"><a href="disease.html#cb283-6" aria-hidden="true" tabindex="-1"></a>        R <span class="ot">&lt;-</span> y[<span class="dv">3</span>]</span>
<span id="cb283-7"><a href="disease.html#cb283-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb283-8"><a href="disease.html#cb283-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>( <span class="fu">as.list</span>(<span class="fu">c</span>(y, p)), {</span>
<span id="cb283-9"><a href="disease.html#cb283-9" aria-hidden="true" tabindex="-1"></a>    dS.dt <span class="ot">&lt;-</span> <span class="sc">-</span>B<span class="sc">*</span>I<span class="sc">*</span>S</span>
<span id="cb283-10"><a href="disease.html#cb283-10" aria-hidden="true" tabindex="-1"></a>    dI.dt <span class="ot">&lt;-</span> B<span class="sc">*</span>I<span class="sc">*</span>S <span class="sc">-</span> g<span class="sc">*</span>I</span>
<span id="cb283-11"><a href="disease.html#cb283-11" aria-hidden="true" tabindex="-1"></a>    dR.dt <span class="ot">&lt;-</span> g<span class="sc">*</span>I</span>
<span id="cb283-12"><a href="disease.html#cb283-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>( <span class="fu">list</span>(<span class="fu">c</span>(dS.dt, dI.dt, dR.dt)) )</span>
<span id="cb283-13"><a href="disease.html#cb283-13" aria-hidden="true" tabindex="-1"></a>  } )</span>
<span id="cb283-14"><a href="disease.html#cb283-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="density-dependent-transmission" class="section level3" number="10.1.1">
<h3><span class="header-section-number">10.1.1</span> Density-dependent transmission</h3>
<p>In <a href="disease.html#eq:SIRd">(10.1)</a>, the total transmission rate depends on the density of susceptible hosts. The <em>transmission coefficient</em>, <span class="math inline">\(\beta\)</span>, describes the instantaneous rate at which the number of infected hosts increases per infected individual. It is directly analogous to the attack rate of type I prey-dependent models. Recall that it is based on the law of mass action, borrowed from physics and chemistry. It assumes that the rate at which events occur (new infections) is due to complete and random mixing of the reactants (<span class="math inline">\(S,\,I\)</span>), and the rate at which the reactants collide and react can be described by a single constant, <span class="math inline">\(\beta\)</span>. As density of either type of molecule increases, so too does the rate of interaction. In prey-dependent predation, we referred to <span class="math inline">\(aN\)</span> as a linear functional response; here we refer to <span class="math inline">\(\beta S\)</span> as the <em>density-dependent transmission function</em>. The <em>transmission rate</em> is the instantaneous rate for the number of <em>new infections</em> or cases per unit time <span class="citation">(<a href="#ref-McCallum2001" role="doc-biblioref">McCallum, Barlow, and Hone 2001</a>)</span>.</p>
<p>Resistant individuals might be resistant for one of two reasons. They may die, or they may develop immunities. In either case, we assume they cannot catch the disease again, nor spread the disease. As this model assumses a constant population size, we continue to count all <span class="math inline">\(R\)</span> individuals, regardless of whether they become immune or die.</p>
<p>The individuals become resistant to this disease at the constant per capita rate, <span class="math inline">\(\gamma\)</span>. The rate <span class="math inline">\(\gamma\)</span> is also the inverse of the mean residence time, or <em>duration</em>, of the disease<a href="#fn57" class="footnote-ref" id="fnref57"><sup>57</sup></a>.</p>
<p>Disease <em>incidence</em> is the number of new infections or cases occurring over a defined time interval. This definition makes incidence a discrete-time version of transmission rate. Disease <em>prevalence</em> is the fraction of the population that is infected <span class="math inline">\(I/N\)</span>.</p>
<p>A common question in disease ecology is to ask under what conditions will an outbreak occur. Another way of asking that is to ask what conditions cause <span class="math inline">\(\dot{I}&gt;0\)</span>. We can set <span class="math inline">\(dI/dt &gt; 0\)</span> and solve for something interesting about what is required for an outbreak to occur.
<span class="math display" id="eq:sird-threshold">\[\begin{align}
\tag{10.2}
  0 &amp; &lt; \beta IS - \gamma I\notag\\
  \frac{\gamma}{\beta} &amp;&lt; S
\end{align}\]</span>
What does this tell us? First, because we could divide through by <span class="math inline">\(I\)</span>, it means that if no one is infected, then an outbreak can’t happen—it is the usual, but typically unstable equilibrium at 0. Second, it tells us that an outbreak will occur if the absolute density of susceptibles<a href="#fn58" class="footnote-ref" id="fnref58"><sup>58</sup></a> is greater than <span class="math inline">\(\gamma / \beta\)</span>. If we consider the pre-outbreak situation where <span class="math inline">\(S \approx N\)</span>, then simply making the population size (and density) low enough can halt the spread of disease. This is why outbreaks tend to occur in high density populations, such as agricultural hosts (e.g., cattle), or historically in urban human populations, or in schools.</p>
<p>Vaccinations are a way to reduce <span class="math inline">\(S\)</span> without reducing <span class="math inline">\(N\)</span>. If a sufficient number of individuals in the population are vaccinated to reduce <span class="math inline">\(S\)</span> below <span class="math inline">\(\gamma / \beta\)</span>, this tends to protect the unvaccinated individuals as well.</p>
<p>Another common representation of this is called the <em>force of infection</em> or <em>basic reproductive rate of the disease.</em> If we assume that in a large population <span class="math inline">\(S \approx N\)</span>, then rearranging <a href="disease.html#eq:sird-threshold">(10.2)</a> gives us
<span class="math display" id="eq:R0">\[\begin{equation}
\tag{10.3}
  R_0=\frac{\beta N}{\gamma}
\end{equation}\]</span>
where <span class="math inline">\(R_0\)</span> is the basic reproductive rate of the disease. If <span class="math inline">\(R_0 &gt; 1\)</span>, then an outbreak (i.e., disease growth) is plausible. Try not to confuse density of resistant hosts, <span class="math inline">\(R\)</span>, with the basic reproductive rate of the disease, <span class="math inline">\(R_0\)</span>. This is analogous to the finite rate of increase of a population where <span class="math inline">\(\lambda&gt;1\)</span>.</p>
<p>Here we model the outbreak of a nonlethal disease (e.g., a new cold virus in winter at university). We assume that the disease is neither life-threatening, and nor is anyone resistant, thus <span class="math inline">\(R=0\)</span>. We can investigate the SIR model by pretending that, as is often the case, we begin with a largely uninfected population and <span class="math inline">\(t=0\)</span>, so <span class="math inline">\(I_0=1\)</span> and <span class="math inline">\(S_0\approx N\)</span>. We first set parameters. Let’s assume that a cold lasts about a week - that is the duration of the disease, which is <span class="math inline">\(1/\gamma\)</span>. This assumes that the duration ot he cold symptoms are exponentially distributed.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="disease.html#cb284-1" aria-hidden="true" tabindex="-1"></a>parms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">B=</span>.<span class="dv">001</span>, <span class="at">g=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">7</span>)</span>
<span id="cb284-2"><a href="disease.html#cb284-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>; I <span class="ot">&lt;-</span> R <span class="ot">&lt;-</span> <span class="dv">1</span>; S <span class="ot">&lt;-</span> N <span class="sc">-</span> I <span class="sc">-</span> R</span>
<span id="cb284-3"><a href="disease.html#cb284-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">S=</span>S, <span class="at">I=</span>I, <span class="at">R=</span>R)</span>
<span id="cb284-4"><a href="disease.html#cb284-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-5"><a href="disease.html#cb284-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Next we integrate for 20 weeks.</span></span>
<span id="cb284-6"><a href="disease.html#cb284-6" aria-hidden="true" tabindex="-1"></a>weeks <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="at">by=</span><span class="fl">0.01</span>)</span>
<span id="cb284-7"><a href="disease.html#cb284-7" aria-hidden="true" tabindex="-1"></a>out1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="fu">ode</span>(y, weeks, SIRd, parms) )</span>
<span id="cb284-8"><a href="disease.html#cb284-8" aria-hidden="true" tabindex="-1"></a>out2 <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(out1, <span class="at">cols=</span>S<span class="sc">:</span>R, <span class="at">names_to=</span><span class="st">&quot;Host&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;N&quot;</span>)</span>
<span id="cb284-9"><a href="disease.html#cb284-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(out2, <span class="fu">aes</span>(time, N, <span class="at">linetype=</span>Host)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Weeks&quot;</span>)</span></code></pre></div>
<p><img src="figs/cold-1.png" width="90%" /></p>
<p>It is important at this point to reiterate a point we made above—<em>these conclusions apply when S, I, and R are densities</em> <span class="citation">(<a href="#ref-McCallum2001" role="doc-biblioref">McCallum, Barlow, and Hone 2001</a>)</span>. If you increase population size but also the area associated with the population, then you have not changed density. If population size only increases, but density is constant, then interaction frequency does not increase. Some populations may increase in density as they increase is size, but some may not. Mass action dynamics are the same as type I functional response as predators—there is a constant linear increase in per capita infection rate as the number of susceptible hosts increases.</p>
</div>
<div id="frequency-dependent-transmission" class="section level3" number="10.1.2">
<h3><span class="header-section-number">10.1.2</span> Frequency-dependent transmission</h3>
<p>In addition to density-dependent transmission, investigators have used other forms of density dependence. One the most common is typically known as <em>frequency–dependent</em> transmission, where transmission depends on the <em>prevalence</em>, or the frequency of infecteds in the population, <span class="math inline">\(I/N\)</span>.
<span class="math display" id="eq:SIRfd3" id="eq:SIRfd2" id="eq:SIRfd1">\[\begin{align}
  \frac{d S}{d t} &amp;= - \beta \frac{SI}{N} \tag{10.4}\\
  \frac{d I}{d t} &amp;=   \beta \frac{SI}{N} - \gamma I \tag{10.5}\\
  \frac{d I}{d t} &amp;=   \gamma I. \tag{10.6}
\end{align}\]</span></p>
<p>Here we create the function for the system of ODEs in eq. .</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="disease.html#cb285-1" aria-hidden="true" tabindex="-1"></a>SIRf <span class="ot">&lt;-</span> <span class="cf">function</span>(t, y, p) {</span>
<span id="cb285-2"><a href="disease.html#cb285-2" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb285-3"><a href="disease.html#cb285-3" aria-hidden="true" tabindex="-1"></a>        S <span class="ot">&lt;-</span> y[<span class="dv">1</span>]</span>
<span id="cb285-4"><a href="disease.html#cb285-4" aria-hidden="true" tabindex="-1"></a>        I <span class="ot">&lt;-</span> y[<span class="dv">2</span>]</span>
<span id="cb285-5"><a href="disease.html#cb285-5" aria-hidden="true" tabindex="-1"></a>        R <span class="ot">&lt;-</span> y[<span class="dv">3</span>]</span>
<span id="cb285-6"><a href="disease.html#cb285-6" aria-hidden="true" tabindex="-1"></a>        N <span class="ot">&lt;-</span> S <span class="sc">+</span> I <span class="sc">+</span> R</span>
<span id="cb285-7"><a href="disease.html#cb285-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb285-8"><a href="disease.html#cb285-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>( <span class="fu">as.list</span>(<span class="fu">c</span>(y,p)), {</span>
<span id="cb285-9"><a href="disease.html#cb285-9" aria-hidden="true" tabindex="-1"></a>    dS.dt <span class="ot">&lt;-</span> <span class="sc">-</span>B<span class="sc">*</span>I<span class="sc">*</span>S<span class="sc">/</span>N</span>
<span id="cb285-10"><a href="disease.html#cb285-10" aria-hidden="true" tabindex="-1"></a>    dI.dt <span class="ot">&lt;-</span> B<span class="sc">*</span>I<span class="sc">*</span>S<span class="sc">/</span>N <span class="sc">-</span> g<span class="sc">*</span>I</span>
<span id="cb285-11"><a href="disease.html#cb285-11" aria-hidden="true" tabindex="-1"></a>    dR.dt <span class="ot">&lt;-</span> g<span class="sc">*</span>I</span>
<span id="cb285-12"><a href="disease.html#cb285-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>( <span class="fu">list</span>(<span class="fu">c</span>(dS.dt, dI.dt, dR.dt)) )</span>
<span id="cb285-13"><a href="disease.html#cb285-13" aria-hidden="true" tabindex="-1"></a>  } )</span>
<span id="cb285-14"><a href="disease.html#cb285-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The proper form of the transmission function depends on the mode of transmission <span class="citation">(<a href="#ref-McCallum2001" role="doc-biblioref">McCallum, Barlow, and Hone 2001</a>)</span>. Imagine two people are on an elevator, one sick (infected), and one healthy but susceptible, and then the sick individual sneezes <span class="citation">(<a href="#ref-Ellner:2006qe" role="doc-biblioref">S. P. Ellner and Guckenheimer 2006</a>)</span>. This results in a particular probability, <span class="math inline">\(\beta\)</span>, that the susceptible individual gets infected. Now imagine resistant individuals get on the elevator—should adding resistant individuals change the probability that the susceptible individual gets infected? Note what has and has not changed. First, with the addition of a resistant individual, <span class="math inline">\(N\)</span> has increased, and prevalence, <span class="math inline">\(I/N\)</span>, has decreased. However, the densities of <span class="math inline">\(I\)</span> and <span class="math inline">\(S\)</span> remain the same (1 per elevator). What might happen? There are at least two possible outcomes:</p>
<ol style="list-style-type: decimal">
<li>If sufficient amounts of the virus spread evenly throughout the elevator, adding a resistant individual does <em>not</em> change the probability of the susceptible becoming sick, and the rate of spread will remain dependent on the densities of <span class="math inline">\(I\)</span> and <span class="math inline">\(S\)</span>—the rate will not vary with declining prevalence.</li>
<li>If only the immediate neighbor gets exposed to the pathogen, then the probability that the neighbor is susceptible declines with increasing <span class="math inline">\(R\)</span>, and thus the rate of spread <em>will</em> decline with declining prevalence.</li>
</ol>
<p>It is fairly easy to imagine different scenarios, and it is very important to justify the form of the function. Density- and frequency-dependent transmission are the two most common caricatures.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="disease.html#cb286-1" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">0</span>; S <span class="ot">&lt;-</span> I <span class="ot">&lt;-</span> <span class="dv">1000</span>; Ss <span class="ot">&lt;-</span> Is <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, S, <span class="at">length=</span><span class="dv">11</span>); N <span class="ot">&lt;-</span> S<span class="sc">+</span>I<span class="sc">+</span>R</span>
<span id="cb286-2"><a href="disease.html#cb286-2" aria-hidden="true" tabindex="-1"></a>betaD <span class="ot">&lt;-</span> <span class="fl">0.1</span>; betaF <span class="ot">&lt;-</span> betaD<span class="sc">*</span>N</span>
<span id="cb286-3"><a href="disease.html#cb286-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-4"><a href="disease.html#cb286-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply will calculate the transmission functions for each combination of</span></span>
<span id="cb286-5"><a href="disease.html#cb286-5" aria-hidden="true" tabindex="-1"></a><span class="co"># the values of $I$ and $S$.</span></span>
<span id="cb286-6"><a href="disease.html#cb286-6" aria-hidden="true" tabindex="-1"></a>mat1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(Is, <span class="cf">function</span>(i) betaD <span class="sc">*</span> i <span class="sc">*</span> Ss)</span>
<span id="cb286-7"><a href="disease.html#cb286-7" aria-hidden="true" tabindex="-1"></a>mat2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(Is, <span class="cf">function</span>(i) betaF <span class="sc">*</span> i <span class="sc">*</span> Ss <span class="sc">/</span> (i <span class="sc">+</span> Ss <span class="sc">+</span> R) )</span>
<span id="cb286-8"><a href="disease.html#cb286-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we plot these matrices. </span></span>
<span id="cb286-9"><a href="disease.html#cb286-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-10"><a href="disease.html#cb286-10" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb286-11"><a href="disease.html#cb286-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">nr=</span><span class="dv">1</span>))</span>
<span id="cb286-12"><a href="disease.html#cb286-12" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(mat1, <span class="at">theta=</span><span class="dv">20</span>, <span class="at">phi=</span><span class="dv">15</span>, <span class="at">r=</span><span class="dv">10</span>, <span class="at">zlim=</span><span class="fu">c</span>(<span class="dv">0</span>,betaD<span class="sc">*</span>S<span class="sc">*</span>I), </span>
<span id="cb286-13"><a href="disease.html#cb286-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span><span class="st">&quot;Density Dependent&quot;</span>,</span>
<span id="cb286-14"><a href="disease.html#cb286-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab=</span><span class="st">&quot;I&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;S&quot;</span>, <span class="at">zlab=</span><span class="st">&quot;Transmission Rate&quot;</span>)</span>
<span id="cb286-15"><a href="disease.html#cb286-15" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(mat2, <span class="at">theta=</span><span class="dv">20</span>, <span class="at">phi=</span><span class="dv">15</span>, <span class="at">r=</span><span class="dv">10</span>, <span class="at">zlim=</span><span class="fu">c</span>(<span class="dv">0</span>,betaF<span class="sc">*</span>S<span class="sc">*</span>I<span class="sc">/</span>N), </span>
<span id="cb286-16"><a href="disease.html#cb286-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span><span class="st">&quot;Frequency Dependent&quot;</span>,</span>
<span id="cb286-17"><a href="disease.html#cb286-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab=</span><span class="st">&quot;I&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;S&quot;</span>, <span class="at">zlab=</span><span class="st">&quot;Transmission Rate&quot;</span>)</span>
<span id="cb286-18"><a href="disease.html#cb286-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="figs/unnamed-chunk-120-1.png" width="90%" /></p>
<p>What does frequency–dependent transmission imply about dynamics? Let’s solve for <span class="math inline">\(dI / dt &gt; 0\)</span>.
<span class="math display" id="eq:19">\[\begin{align}
  \tag{10.7}
  0 &amp;&lt; \beta \frac{SI}{N} - \gamma I \notag\\
  \gamma &amp;&lt; \beta \frac{S}{N}.
\end{align}\]</span>
As we did above, let’s consider the pre-outbreak situation where <span class="math inline">\(S \approx N\)</span>, so that <span class="math inline">\(S/N \approx 1\)</span>. In that case, the basic reproductive rate is <span class="math inline">\(R_0=\beta/\gamma\)</span>, which is <em>independent of <span class="math inline">\(N\)</span></em>. An outbreak will occur as long as <span class="math inline">\(\beta &gt; \gamma\)</span>, regardless of population density. This is in direct contrast to the density-dependent transmission model (<a href="disease.html#eq:SIRfd1">(10.4)</a>, <a href="disease.html#eq:SIRfd2">(10.5)</a>), where outbreak could be prevented if we simply reduce the population, <span class="math inline">\(N\)</span>, to a sufficently low density. Both modes of transmission are observed in human and non-human populations, so it is important to understand how the disease is spread in order to predict its dynamics.</p>
<p>Another interesting phenomenon with frequency–dependent transmission is that prevalence (<span class="math inline">\(I/N\)</span>) can decline with increasing population size (Fig. <a href="#fig:sirFD"><strong>??</strong></a>). Two phenomena contribute to this pattern. First, outbreak in a completely susceptible population typically begins with a single individual, and so initial prevalence is always <span class="math inline">\(I/N=1/N\)</span>. Second, as a consequence of this, the transmission rate is lower in larger populations because <span class="math inline">\(\beta SI/N\)</span> is small. As a consequence, prevalence remains low for a relatively long time. In a seasonal population, most individuals in large populations remain uninfected after four months. Depending upon the organism, this could be long enough to reproduce. In contrast, a density–dependent model typically shows the oppositive, pattern, with more rapid, extreme outbreaks and greater prevalence in more dense populations (Fig. <a href="#fig:sirFD"><strong>??</strong></a>).</p>
<p><em>SIR</em> dynamics with frequency–dependent transmission (Fig. (fig:sirFD)).</p>
<p>Here we demonstrate that prevalence can decline with increasing population size in a frequency–dependent disease (e.g., a smut on plant <span class="citation">(<a href="#ref-Antonovics1992" role="doc-biblioref">Antonovics and Alexander 1992</a>)</span>). Let us assume that resistance cannot be acquired, so <span class="math inline">\(\gamma=0\)</span>, and <span class="math inline">\(R = 0\)</span>. We can investigate the SIR model by pretending that, as is often the case, we begin with a largely uninfected population and <span class="math inline">\(t=0\)</span>, so <span class="math inline">\(I_0=1\)</span> and <span class="math inline">\(S_0\approx N\)</span>. We first set parameters.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="disease.html#cb287-1" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">^</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>);  I <span class="ot">&lt;-</span> <span class="dv">1</span>; parmsf <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">B=</span><span class="dv">1</span>, <span class="at">g=</span><span class="dv">0</span>); parmsd <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">B=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">16</span>, <span class="at">g=</span><span class="dv">0</span>)</span></code></pre></div>
<p>We next integrate for six months, letting <span class="math inline">\(R=S/2\)</span>.</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="disease.html#cb288-1" aria-hidden="true" tabindex="-1"></a>Months <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="at">by=</span><span class="fl">0.1</span>)</span>
<span id="cb288-2"><a href="disease.html#cb288-2" aria-hidden="true" tabindex="-1"></a>outd <span class="ot">&lt;-</span> <span class="fu">sapply</span>(S, <span class="cf">function</span>(s) {out <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="fu">c</span>(s,I,R), Months, SIRd, parmsd)</span>
<span id="cb288-3"><a href="disease.html#cb288-3" aria-hidden="true" tabindex="-1"></a>                               out[,<span class="dv">3</span>]<span class="sc">/</span><span class="fu">apply</span>(out[,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>], <span class="dv">1</span>, sum) } )</span>
<span id="cb288-4"><a href="disease.html#cb288-4" aria-hidden="true" tabindex="-1"></a>outf <span class="ot">&lt;-</span> <span class="fu">sapply</span>(S, <span class="cf">function</span>(s) {out <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="fu">c</span>(s,I,R), Months, SIRf, parmsf)</span>
<span id="cb288-5"><a href="disease.html#cb288-5" aria-hidden="true" tabindex="-1"></a>                               out[,<span class="dv">3</span>]<span class="sc">/</span><span class="fu">apply</span>(out[,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>], <span class="dv">1</span>, sum) } )</span>
<span id="cb288-6"><a href="disease.html#cb288-6" aria-hidden="true" tabindex="-1"></a><span class="co">#TR &lt;- sapply(S, function(s) {R &lt;- s/2; parmsf[&quot;B&quot;]*s*I/(s+I+R)})</span></span></code></pre></div>
<p>Last, we make the figures.</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="disease.html#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(Months, outd, <span class="at">type=</span><span class="st">&#39;l&#39;</span>, <span class="at">col=</span><span class="dv">1</span>, <span class="at">ylab=</span><span class="st">&quot;Prevalence (I/N)&quot;</span>)</span>
<span id="cb289-2"><a href="disease.html#cb289-2" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(Months, outf, <span class="at">type=</span><span class="st">&#39;l&#39;</span>, <span class="at">col=</span><span class="dv">1</span>, <span class="at">ylab=</span><span class="st">&quot;Prevalence (I/N)&quot;</span>)</span>
<span id="cb289-3"><a href="disease.html#cb289-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;bottomright&#39;</span>, <span class="at">legend=</span>S, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(S),  <span class="at">bty=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb289-4"><a href="disease.html#cb289-4" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(S, TR)</span></span></code></pre></div>
<p><img src="figs/sirFD-1.png" width="40%" /><img src="figs/sirFD-2.png" width="40%" /></p>
</div>
</div>
<div id="open-epidemics" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> Open epidemics</h2>
<p>The above model assumes a constant population size. Here expand this to include population growth and death unrelated to disease (Fig. <a href="disease.html#fig:sirmod">10.1</a>).</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="disease.html#cb290-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow=</span><span class="dv">7</span>, <span class="at">ncol=</span><span class="dv">7</span>)</span>
<span id="cb290-2"><a href="disease.html#cb290-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>( <span class="dv">2</span>,<span class="dv">1</span>, <span class="dv">3</span>,<span class="dv">2</span>, <span class="dv">4</span>,<span class="dv">3</span>, <span class="dv">5</span>,<span class="dv">2</span>, <span class="dv">6</span>,<span class="dv">3</span>, <span class="dv">7</span>,<span class="dv">4</span>), <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb290-3"><a href="disease.html#cb290-3" aria-hidden="true" tabindex="-1"></a>A[a] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb290-4"><a href="disease.html#cb290-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plotmat</span>(A, <span class="at">pos=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">3</span>), <span class="at">box.type=</span><span class="fu">c</span>(<span class="st">&#39;none&#39;</span>, <span class="st">&#39;square&#39;</span>,<span class="st">&#39;square&#39;</span>,<span class="st">&#39;square&#39;</span>,<span class="st">&#39;none&#39;</span>,<span class="st">&#39;none&#39;</span>,<span class="st">&#39;none&#39;</span>), <span class="at">curve=</span><span class="dv">0</span>,</span>
<span id="cb290-5"><a href="disease.html#cb290-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">arr.pos=</span>.<span class="dv">6</span>, <span class="at">segment.from=</span>.<span class="dv">1</span>, <span class="at">segment.to=</span>.<span class="dv">9</span>,</span>
<span id="cb290-6"><a href="disease.html#cb290-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">relsize=</span>.<span class="dv">8</span>, <span class="at">dtext=</span><span class="cn">NA</span>, <span class="at">box.size=</span>.<span class="dv">05</span>,</span>
<span id="cb290-7"><a href="disease.html#cb290-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">name=</span><span class="fu">c</span>(<span class="fu">expression</span>(lambda), <span class="st">&#39;S&#39;</span>, <span class="st">&#39;I&#39;</span>, <span class="st">&#39;R&#39;</span>, </span>
<span id="cb290-8"><a href="disease.html#cb290-8" aria-hidden="true" tabindex="-1"></a>               <span class="fu">expression</span>(mu),</span>
<span id="cb290-9"><a href="disease.html#cb290-9" aria-hidden="true" tabindex="-1"></a>               <span class="fu">expression</span>(mu),</span>
<span id="cb290-10"><a href="disease.html#cb290-10" aria-hidden="true" tabindex="-1"></a>               <span class="fu">expression</span>(mu))) </span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:sirmod"></span>
<img src="figs/sirmod-1.png" alt="*Conceptual model of an open epidemic. We'll let lambda be migration and births, and mu be mortality. Births may come from any group.*" width="90%" />
<p class="caption">
Figure 10.1: <em>Conceptual model of an open epidemic. We’ll let lambda be migration and births, and mu be mortality. Births may come from any group.</em>
</p>
</div>
<p>Here we get specific, and add births, <span class="math inline">\(b\)</span>, potentially by all types, sick or not (<span class="math inline">\(S+I+R\)</span>), and we assume that the newborns are susceptible only. We also add a mortality term to each group (<span class="math inline">\(\mu S,\,\mu I,\,\mu R\)</span>).
<span class="math display" id="eq:SIRbd">\[\begin{align}
  \tag{10.8}
  \frac{d S}{d t} &amp;= b \left( S+I+R \right) - \beta SI - \mu S\\
  \frac{d I}{d t} &amp;=\beta SI  - \gamma I - \mu I\\
  \frac{d R}{d t} &amp;= \gamma I - \mu R
\end{align}\]</span>
Note that the births add only to the susceptible group, whereas density independent mortality subtracts from each group.</p>
<p><strong>Disease model with population growth</strong>
Here we create the function for the system of ODE’s in <a href="disease.html#eq:SIRbd">(10.8)</a>.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="disease.html#cb291-1" aria-hidden="true" tabindex="-1"></a>SIRmod <span class="ot">&lt;-</span> <span class="cf">function</span>(t, y, p) {</span>
<span id="cb291-2"><a href="disease.html#cb291-2" aria-hidden="true" tabindex="-1"></a>  S <span class="ot">&lt;-</span> y[<span class="dv">1</span>]; I <span class="ot">&lt;-</span> y[<span class="dv">2</span>]; R <span class="ot">&lt;-</span> y[<span class="dv">3</span>]; N <span class="ot">&lt;-</span> <span class="fu">sum</span>(y)</span>
<span id="cb291-3"><a href="disease.html#cb291-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>( <span class="fu">as.list</span>(p), {</span>
<span id="cb291-4"><a href="disease.html#cb291-4" aria-hidden="true" tabindex="-1"></a>    dS.dt <span class="ot">&lt;-</span> b<span class="sc">*</span>N <span class="sc">-</span> B<span class="sc">*</span>I<span class="sc">*</span>S<span class="sc">/</span>N<span class="sc">^</span>z <span class="sc">-</span> mu<span class="sc">*</span>S</span>
<span id="cb291-5"><a href="disease.html#cb291-5" aria-hidden="true" tabindex="-1"></a>    dI.dt <span class="ot">&lt;-</span> B<span class="sc">*</span>I<span class="sc">*</span>S<span class="sc">/</span>N<span class="sc">^</span>z <span class="sc">-</span> g<span class="sc">*</span>I <span class="sc">-</span> mu<span class="sc">*</span>I</span>
<span id="cb291-6"><a href="disease.html#cb291-6" aria-hidden="true" tabindex="-1"></a>    dR.dt <span class="ot">&lt;-</span> g<span class="sc">*</span>I <span class="sc">-</span> mu<span class="sc">*</span>R</span>
<span id="cb291-7"><a href="disease.html#cb291-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>( <span class="fu">list</span>(<span class="fu">c</span>(dS.dt, dI.dt, dR.dt)) )</span>
<span id="cb291-8"><a href="disease.html#cb291-8" aria-hidden="true" tabindex="-1"></a>  } )</span>
<span id="cb291-9"><a href="disease.html#cb291-9" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
<p>Let’s start to work with this model—that frequently means making simplifying assumptions. We might start by assuming that if infected and resistant individuals can contribute to offspring, then the disease is relatively benign. Therefore, we can assume that mortality is the same for all groups (<span class="math inline">\(\mu_i= \mu\)</span>). We’ll also assume (again) a constant population size. This means that birth rate equals mortality or <span class="math inline">\(b=\mu\)</span>.</p>
<p>We add additional complexity by allowing transmission to be partially frequency dependent. We introduce a scaling parameter <span class="math inline">\(z\)</span>, where transmission is
<span class="math display">\[\beta I \frac{S}{N^z}\]</span>
so that when <span class="math inline">\(z=0\)</span> we have pure density dependence, and <span class="math inline">\(z=1\)</span> is pure frequency dependence.</p>
<p>Note that if we let <span class="math inline">\(z,\, b,\, \mu =0\)</span>, the we have the simplest SIR model with which we bagn the chapter.</p>
<p>Now imagine a large city, with say, a million people. Let’s then assume that we start of with a population of virtually all susceptible people, but we introduce a single infected person.</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="disease.html#cb292-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">6</span></span>
<span id="cb292-2"><a href="disease.html#cb292-2" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">0</span>; I <span class="ot">&lt;-</span> <span class="dv">1</span>; S <span class="ot">&lt;-</span> N <span class="sc">-</span> I <span class="sc">-</span> R</span></code></pre></div>
<p>Let us further pretend that the disease runs its course over about 10–14 days. Recall that <span class="math inline">\(\gamma\)</span> (gamma) is the inverse of the <em>duration</em> of the disease.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="disease.html#cb293-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">13</span><span class="sc">/</span><span class="dv">365</span>)</span></code></pre></div>
<p>Given a constant population size and exponential growth, then the average life span is the inverse of the birth rate. Let us pretend that the average life span is 50 years.</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="disease.html#cb294-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">50</span></span></code></pre></div>
<p>For this model, the force of infection turns out to be <span class="math inline">\(R_0 = 1 + 1 / \left(b + \alpha\right)\)</span>, where <span class="math inline">\(\alpha\)</span> is the average age at onset of the disease <span class="citation">(<a href="#ref-Ellner:2006qe" role="doc-biblioref">S. P. Ellner and Guckenheimer 2006</a>)</span>. We can therefore estimate <span class="math inline">\(\beta\)</span> from all the other parameters, including population size, average life span, average age at onset, and the average duration of the disease. For instance, imagine that we have a disease of children, where the average onset of disease is 5,y, so we have</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="disease.html#cb295-1" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb295-2"><a href="disease.html#cb295-2" aria-hidden="true" tabindex="-1"></a>R0 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>(b<span class="sc">*</span>age)</span></code></pre></div>
<p>so <span class="math inline">\(\beta\)</span> becomes</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="disease.html#cb296-1" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> R0 <span class="sc">*</span> (g <span class="sc">+</span> b) <span class="sc">/</span> N</span></code></pre></div>
<p>Finally, we can integrate the population and its states. We create a named vector of parameters, and decide on the time interval.</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="disease.html#cb297-1" aria-hidden="true" tabindex="-1"></a>parms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">B =</span> B, <span class="at">g =</span> g, <span class="at">b =</span> b, <span class="at">mu=</span>b, <span class="at">z=</span><span class="dv">0</span>)</span>
<span id="cb297-2"><a href="disease.html#cb297-2" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">30</span>, <span class="at">by=</span>.<span class="dv">1</span>)</span></code></pre></div>
<p>It turns out that because of the relatively extreme dynamics (Fig. <a href="disease.html#fig:sirbd">10.2</a>), we want to tell the ODE solver to take baby steps, so as to properly capture the dynamics—we use the <code>hmax</code> argument to make sure that the maximum step it takes is relatively small.</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="disease.html#cb298-1" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">ode</span>(<span class="fu">c</span>(<span class="at">S=</span>S,<span class="at">I=</span>I,<span class="at">R=</span>R), years, SIRmod, parms, <span class="at">hmax=</span>.<span class="dv">01</span>)) </span>
<span id="cb298-2"><a href="disease.html#cb298-2" aria-hidden="true" tabindex="-1"></a>SIRbd.out <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(out, <span class="at">cols=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">names_to=</span><span class="st">&quot;Populations&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;Density&quot;</span>)</span>
<span id="cb298-3"><a href="disease.html#cb298-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(SIRbd.out, <span class="fu">aes</span>(time, Density<span class="sc">+</span><span class="dv">1</span>, <span class="at">colour=</span>Populations)) <span class="sc">+</span> </span>
<span id="cb298-4"><a href="disease.html#cb298-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;Years&#39;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:sirbd"></span>
<img src="figs/sirbd-1.png" alt="*Epidemic for a nonlethal disease, with an SIR model which includes births and deaths, and a constant population size.*" width="70%" />
<p class="caption">
Figure 10.2: <em>Epidemic for a nonlethal disease, with an SIR model which includes births and deaths, and a constant population size.</em>
</p>
</div>
<p>Note that the population quickly becomes resistant (Fig. <a href="disease.html#fig:sirbd">10.2</a>). Note also that we have oscillations, albeit damped oscillations. An analytical treatment of the model, including eigenanalysis of the Jacobian matrix could show us precisely the predicted periodicity <span class="citation">(<a href="#ref-Ellner:2006qe" role="doc-biblioref">S. P. Ellner and Guckenheimer 2006</a>)</span>. It depends on the the age at onset, and the duration of the disease.</p>
</div>
<div id="modeling-data-from-bombay" class="section level2" number="10.3">
<h2><span class="header-section-number">10.3</span> Modeling data from Bombay</h2>
<p>Here we try our hand at fitting the SIR model to some data. Kermack and McCormick <a href="#Kermack:1927fk"><strong>??</strong></a> provided data on the number of plague deaths per week in Bombay<a href="#fn59" class="footnote-ref" id="fnref59"><sup>59</sup></a> in 1905–06. We first enter them and look at them.<a href="#fn60" class="footnote-ref" id="fnref60"><sup>60</sup></a></p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="disease.html#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(ross)</span>
<span id="cb299-2"><a href="disease.html#cb299-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(<span class="at">x=</span>Week, <span class="at">y=</span>CumulativeDeaths, <span class="at">data=</span>ross)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:sir2"></span>
<img src="figs/sir2-1.png" alt="*Cumulative deaths for plague, in Bombay, India, 1905--1906 (raw data and fitted model, as described in this section).*" width="90%" />
<p class="caption">
Figure 10.3: <em>Cumulative deaths for plague, in Bombay, India, 1905–1906 (raw data and fitted model, as described in this section).</em>
</p>
</div>
<p>As with most such enterprises, we wish we knew far more than we do about the which depends on fleas, rodents, humans, and <em>Yersinia pestis</em> on which the dynamics depend. To squeeze this real-life scenario into a model with a small number of parameters requires a few assumptions.</p>
<p>%We begin by assuming, and Kermack and Mckendrick did, that mortality from bubonic plague, in Bombay, in 1905, was quite high, close to 90%. Next, we realize that the only data we have is deaths. Given, however, that the mortality is very high, we might approximate the number of infections by saying that Deaths = 0.9 <span class="math inline">\(\times\)</span> Infections.</p>
<p>A good starting place is a simple SIR model for a population of constant size <a href="disease.html#eq:SIRd">(10.1)</a> <span class="citation">(<a href="#ref-Ellner:2006qe" role="doc-biblioref">S. P. Ellner and Guckenheimer 2006</a>; <a href="#ref-Kermack:1927fk" role="doc-biblioref">Kermack and McCormick 1927</a>)</span>.</p>
<div id="optimization" class="section level3" number="10.3.1">
<h3><span class="header-section-number">10.3.1</span> Optimization</h3>
<p>We next want to let R find the most accurate estimates of our model parameters <span class="math inline">\(\beta,\,\gamma\)</span>. The best and most accessible reference for this is <span class="citation"><a href="#ref-Bolker:2008rr" role="doc-biblioref">Bolker</a> (<a href="#ref-Bolker:2008rr" role="doc-biblioref">2008</a>)</span>. Please read the Appendix (for the moment, available on request) for more explanation regarding optimization and objective functions.</p>
<p>Now we create the objective function. An objective function compares a model to data, and calculates a measure of fit (e.g., residual sum of squares or likelihood). Our objective function will calculate the likelihood<a href="#fn61" class="footnote-ref" id="fnref61"><sup>61</sup></a> of particular values for SIR model parameters. These parameters include <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(\beta\)</span> of the SIR model. We will also estimate <span class="math inline">\(I_0\)</span>, initial size of the infected population at our <span class="math inline">\(t=0\)</span>. A survey of easily accessed census data suggests the population at the time was in the neighborhood of <span class="math inline">\(\sim 9.5 \times 10^5\)</span> individuals. We also might assume that <span class="math inline">\(I_0\)</span> would be a very small number, perhaps <span class="math inline">\(\sim 1\)</span> in principle, so we will use that. We would really like to estimate <span class="math inline">\(N\)</span> and <span class="math inline">\(I_0\)</span>, but we’ll save that for another day.</p>
<p>Some details about our objective function:</p>
<ol style="list-style-type: decimal">
<li>Arguments are transformed parameters (this allows the optimizer to work on the logit<a href="#fn62" class="footnote-ref" id="fnref62"><sup>62</sup></a> and log scales).</li>
<li>Transformed parameters are backtransformed to the scale of the model.</li>
<li>Parameters are used to integrate the ODEs using <code>ode</code>, retaining only the resistant (i.e. dead) group (the fourth column of the output); this provides the <em>predicted values</em> given the parameters and the time from onset, and the standard deviation of the residuals around the predicted values.</li>
<li>It returns the negative log-likelihood of the data, given the parameter values.</li>
</ol>
<p>Here is our objective function. Note that its last value is the negative sum of the log-probabilities of the data (given a particular realization of the model).</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="disease.html#cb300-1" aria-hidden="true" tabindex="-1"></a>sirLL<span class="ot">=</span><span class="cf">function</span>(logit.B, logit.g, log.I0, log.N) {</span>
<span id="cb300-2"><a href="disease.html#cb300-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#parameters</span></span>
<span id="cb300-3"><a href="disease.html#cb300-3" aria-hidden="true" tabindex="-1"></a>  parms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">B=</span><span class="fu">plogis</span>(logit.B), <span class="at">g=</span><span class="fu">plogis</span>(logit.g));</span>
<span id="cb300-4"><a href="disease.html#cb300-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># starting point</span></span>
<span id="cb300-5"><a href="disease.html#cb300-5" aria-hidden="true" tabindex="-1"></a>  x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">S=</span><span class="fu">exp</span>(log.N), <span class="at">I=</span><span class="fu">exp</span>(log.I0), <span class="at">R=</span><span class="dv">0</span>)</span>
<span id="cb300-6"><a href="disease.html#cb300-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># solve</span></span>
<span id="cb300-7"><a href="disease.html#cb300-7" aria-hidden="true" tabindex="-1"></a>  Rs <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="at">y=</span>x0, ross<span class="sc">$</span>Week, SIRd, parms, <span class="at">hmax=</span>.<span class="dv">01</span>)[,<span class="dv">4</span>]</span>
<span id="cb300-8"><a href="disease.html#cb300-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate the root mean squared error of the fit</span></span>
<span id="cb300-9"><a href="disease.html#cb300-9" aria-hidden="true" tabindex="-1"></a>  SD <span class="ot">&lt;-</span> <span class="fu">sqrt</span>( <span class="fu">sum</span>( (ross<span class="sc">$</span>CumulativeDeaths <span class="sc">-</span> Rs)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">length</span>(ross<span class="sc">$</span>Week) )</span>
<span id="cb300-10"><a href="disease.html#cb300-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate the negative loglikelihood</span></span>
<span id="cb300-11"><a href="disease.html#cb300-11" aria-hidden="true" tabindex="-1"></a>   <span class="sc">-</span><span class="fu">sum</span>(<span class="fu">dnorm</span>(ross<span class="sc">$</span>CumulativeDeaths, <span class="at">mean=</span>Rs, <span class="at">sd=</span>SD, <span class="at">log=</span><span class="cn">TRUE</span>))</span>
<span id="cb300-12"><a href="disease.html#cb300-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We then use this function, <code>sirLL</code>, to find the likelihood of the best parameters. The <code>mle2</code> function in the <code>bbmle</code> library<a href="#fn63" class="footnote-ref" id="fnref63"><sup>63</sup></a> will minimize the negative log-likelihood generated by <code>sirLL</code>, and return values for the parameters of interest.</p>
<p>We will use a robust, but relatively slow method called Nelder-Mead (it is the default). We supply <code>mle2</code> with the objective function and a list of initial parameter values. This can take a few minutes, but that’s okay.</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="disease.html#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bbmle)</span>
<span id="cb301-2"><a href="disease.html#cb301-2" aria-hidden="true" tabindex="-1"></a><span class="co"># we used fixed to fix N and I0 to particular values and not estimate them.</span></span>
<span id="cb301-3"><a href="disease.html#cb301-3" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">mle2</span>(sirLL, <span class="at">start=</span><span class="fu">list</span>(<span class="at">logit.B=</span><span class="fu">qlogis</span>(<span class="fl">1e-5</span>), <span class="at">logit.g=</span><span class="fu">qlogis</span>(.<span class="dv">2</span>), </span>
<span id="cb301-4"><a href="disease.html#cb301-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">log.N=</span><span class="fu">log</span>(<span class="fl">9.5e5</span>), <span class="at">log.I0=</span><span class="dv">0</span>), </span>
<span id="cb301-5"><a href="disease.html#cb301-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">method=</span><span class="st">&quot;Nelder-Mead&quot;</span>) </span></code></pre></div>
<p>Let’s look at a summary of the fit, as far as it went. Here is what I get.</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="disease.html#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## Length  Class   Mode 
##      1   mle2     S4</code></pre>
<p>This gets us some parameter estimates, but they are probably not accurate because the computer couldn’t settle on what it thought was a stable solution (convergence failure. This occurs frequently when we ask the computer to estimate too many, often correlated, parameters for a given data set. Therefore, we have to make assumptions regarding selected parameters. Let us assume for the time being that the two variable estimates are correct, that the population size of the vulnerable population was approximately exp(<code>rround(coef(fit)[3],1)</code>) and the number of infections at the onset of the outbreak was <code>9.6</code>. We will hold these constant and ask R to refit the model, using the default method.</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="disease.html#cb304-1" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">mle2</span>(sirLL, <span class="at">start=</span><span class="fu">as.list</span>(<span class="fu">coef</span>(fit)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]),</span>
<span id="cb304-2"><a href="disease.html#cb304-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">fixed=</span><span class="fu">list</span>(<span class="at">log.N=</span><span class="fu">coef</span>(fit)[<span class="dv">4</span>], <span class="at">log.I0=</span><span class="fu">coef</span>(fit)[<span class="dv">3</span>]), <span class="at">method=</span><span class="st">&quot;BFGS&quot;</span>)</span>
<span id="cb304-3"><a href="disease.html#cb304-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span></code></pre></div>
<p>Next we want to find confidence intervals for <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\gamma\)</span>. This can take more than several minutes, but it results in a likelihood profile for these parameters, which show the confidence regions for these parameters (Fig. <a href="disease.html#fig:profile">10.4</a>).</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="disease.html#cb305-1" aria-hidden="true" tabindex="-1"></a>pr2 <span class="ot">&lt;-</span> <span class="fu">profile</span>(fit2)</span></code></pre></div>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="disease.html#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>))</span>
<span id="cb306-2"><a href="disease.html#cb306-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pr2)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:profile"></span>
<img src="figs/profile-1.png" alt="*The likelihood profile plots show us the confidence intervals on transformed SIR model parameters.*" width="90%" />
<p class="caption">
Figure 10.4: <em>The likelihood profile plots show us the confidence intervals on transformed SIR model parameters.</em>
</p>
</div>
<p>Last we get to plot our curve with the data. We first backtransform the coefficients of the objective function.</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="disease.html#cb307-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">plogis</span>(<span class="fu">coef</span>(fit)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]),</span>
<span id="cb307-2"><a href="disease.html#cb307-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">exp</span>(<span class="fu">coef</span>(fit)[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>])) ); p</span></code></pre></div>
<pre><code>## [1] 8.018462e-05 7.364288e-01 2.992425e+00 1.461884e+04</code></pre>
<p>We then get ready to integrate the disease dynamics over this time period.</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="disease.html#cb309-1" aria-hidden="true" tabindex="-1"></a>inits <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">S =</span> p[<span class="dv">4</span>], <span class="at">I=</span>p[<span class="dv">3</span>], <span class="at">R=</span><span class="dv">0</span>)</span>
<span id="cb309-2"><a href="disease.html#cb309-2" aria-hidden="true" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">B=</span>p[<span class="dv">1</span>], <span class="at">g=</span>p[<span class="dv">2</span>])</span>
<span id="cb309-3"><a href="disease.html#cb309-3" aria-hidden="true" tabindex="-1"></a>outdf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="fu">ode</span>(inits, ross<span class="sc">$</span>Week, SIRd, params) )</span></code></pre></div>
<p>Last, we plot the model and the data (Fig. ).</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="disease.html#cb310-1" aria-hidden="true" tabindex="-1"></a>sir.Bombay <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(<span class="at">data=</span>outdf, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">names_to=</span><span class="st">&quot;Populations&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;Density&quot;</span>)</span>
<span id="cb310-2"><a href="disease.html#cb310-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sir.Bombay, <span class="fu">aes</span>(time, Density, <span class="at">colour=</span>Populations)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb310-3"><a href="disease.html#cb310-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>ross, </span>
<span id="cb310-4"><a href="disease.html#cb310-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>Week, <span class="at">y=</span>CumulativeDeaths), </span>
<span id="cb310-5"><a href="disease.html#cb310-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">inherit.aes=</span><span class="cn">FALSE</span> )</span></code></pre></div>
<p><img src="figs/unnamed-chunk-138-1.png" width="90%" /></p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="disease.html#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inherit.aes=FALSE tells geom_point not color by &quot;Populations&quot; </span></span></code></pre></div>
<p>So, what does this mean (Fig. <a href="disease.html#fig:sir2">10.3</a>? We might check what these values mean, against what we know about the reality. Our model predicts that logit of <span class="math inline">\(\gamma\)</span> was a confidence interval,</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="disease.html#cb312-1" aria-hidden="true" tabindex="-1"></a>(CIs <span class="ot">&lt;-</span> <span class="fu">confint</span>(pr2))</span></code></pre></div>
<pre><code>##              2.5 %    97.5 %
## logit.B -9.4425402 -9.416570
## logit.g  0.9659977  1.114912</code></pre>
<p>This corresponds to a confidence interval for <span class="math inline">\(\gamma\)</span> of</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="disease.html#cb314-1" aria-hidden="true" tabindex="-1"></a>(gs <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">plogis</span>(CIs[<span class="dv">2</span>,]) ))</span></code></pre></div>
<pre><code>## [1] 0.7243210 0.7530437</code></pre>
<p>Recall that the duration of the disease in the host is <span class="math inline">\(1/\gamma\)</span>. Therefore, our model predicts a confidence interval for the duration (in days) of</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="disease.html#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span><span class="sc">*</span><span class="dv">1</span><span class="sc">/</span>gs</span></code></pre></div>
<pre><code>## [1] 9.664223 9.295610</code></pre>
<p>Thus, based on this analysis, the duration of the disease is about 9.5 days. This seems to agree with what we know about the biology of the Bubonic plague. Its duration, in a human host, is typically thought to last 4–10 days.</p>

</div>
</div>
</div>
<h3> References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Antonovics1992" class="csl-entry">
Antonovics, J., and H. M. Alexander. 1992. <span>“<span class="nocase">Epidemiology of Anther-Smut Infection of Silene alba (= S. latifolia) Caused by Ustilago violacea: Patterns of Spore Deposition in Experimental Populations</span>.”</span> <em>Proceedings of the Royal Society B: Biological Sciences</em> 250 (1328): 157–63.
</div>
<div id="ref-Bjornstad2018b" class="csl-entry">
Bjornstad, O. N. 2018. <em>Epidemics: Models and Data in r</em>. Edited by R. Gentleman, K. Hornik, and G. Parmigiani. Use r! Series. Springer.
</div>
<div id="ref-Bolker:2008rr" class="csl-entry">
Bolker, B M. 2008. <em><span class="nocase">Ecological Models and Data in R</span></em>. Princeton, NJ: Princeton University Press.
</div>
<div id="ref-Ellner:2006qe" class="csl-entry">
Ellner, S P, and J Guckenheimer. 2006. <em><span class="nocase">Dynamic Models in Biology</span></em>. Princeton University Press, Princeton, NJ.
</div>
<div id="ref-Kermack:1927fk" class="csl-entry">
Kermack, W O, and W G McCormick. 1927. <span>“<span class="nocase">A contribution to the mathematical theory of epidemics.</span>”</span> <em>Proceedings of the Royal Society, Series A</em> 115: 700–721.
</div>
<div id="ref-McCallum2001" class="csl-entry">
McCallum, Hamish, Nigel Barlow, and Jim Hone. 2001. <span>“<span class="nocase">How should pathogen transmission be modelled?</span>”</span> <em>Trends in Ecology and Evolution</em> 16 (6): 295–300.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="57">
<li id="fn57"><p>This is an interesting phenomenon of exponential processes—the mean time associated with the process is equal to the inverse of the rate. This is analogous to turnover time or residence time for a molecule of water in a well-mixed lake.<a href="disease.html#fnref57" class="footnote-back">↩︎</a></p></li>
<li id="fn58"><p><span class="math inline">\(S\)</span> is the absolute density, whereas <span class="math inline">\(S/N\)</span> is the relative density.<a href="disease.html#fnref58" class="footnote-back">↩︎</a></p></li>
<li id="fn59"><p>Bombay is the coastal city now known as Mumbai, and is the capital of Maharashtra; it is one of the largest cities in the world.<a href="disease.html#fnref59" class="footnote-back">↩︎</a></p></li>
<li id="fn60"><p>Data provided kindly by S.P. Ellner<a href="disease.html#fnref60" class="footnote-back">↩︎</a></p></li>
<li id="fn61"><p>Likelihood is proportional the probability of data, given a particular model and its parameters.<a href="disease.html#fnref61" class="footnote-back">↩︎</a></p></li>
<li id="fn62"><p>A logit is the transformation of a proportion which will linearize the logistic curve, logit (p) = <span class="math inline">\(\log ( p/(1-p) )\)</span>.<a href="disease.html#fnref62" class="footnote-back">↩︎</a></p></li>
<li id="fn63"><p>You will need to install the <code>bbmle</code> package, unless someone has already done this for the computer you are using.<a href="disease.html#fnref63" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="host-parasitoid-relations.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="consumer-resource-competition-and-mutualisms.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
