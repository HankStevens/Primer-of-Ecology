<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Density-independent Demography | Primer of Ecology with R</title>
  <meta name="description" content="4 Density-independent Demography | Primer of Ecology with R" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Density-independent Demography | Primer of Ecology with R" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="HankStevens/Primer-of-Ecology" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Density-independent Demography | Primer of Ecology with R" />
  
  
  

<meta name="author" content="Hank Stevens" />


<meta name="date" content="2020-08-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="expo.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="theory.html"><a href="theory.html"><i class="fa fa-check"></i><b>1</b> Theory in Ecology</a><ul>
<li class="chapter" data-level="1.1" data-path="theory.html"><a href="theory.html#examples-of-theories"><i class="fa fa-check"></i><b>1.1</b> Examples of theories</a><ul>
<li class="chapter" data-level="1.1.1" data-path="theory.html"><a href="theory.html#hierarchy-theory"><i class="fa fa-check"></i><b>1.1.1</b> Hierarchy theory</a></li>
<li class="chapter" data-level="1.1.2" data-path="theory.html"><a href="theory.html#a-general-theory-of-ecology"><i class="fa fa-check"></i><b>1.1.2</b> A general theory of ecology</a></li>
<li class="chapter" data-level="1.1.3" data-path="theory.html"><a href="theory.html#efficient-theory"><i class="fa fa-check"></i><b>1.1.3</b> Efficient theory</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="theory.html"><a href="theory.html#metabolic_scaling"><i class="fa fa-check"></i><b>1.2</b> An example: Metabolic Theory of Ecology</a><ul>
<li class="chapter" data-level="1.2.1" data-path="theory.html"><a href="theory.html#body-size-dependence"><i class="fa fa-check"></i><b>1.2.1</b> Body-size dependence</a></li>
<li class="chapter" data-level="1.2.2" data-path="theory.html"><a href="theory.html#temperature-dependence"><i class="fa fa-check"></i><b>1.2.2</b> Temperature dependence</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="theory.html"><a href="theory.html#power-law-scaling-implies-constant-relative-differences"><i class="fa fa-check"></i><b>1.3</b> Power law scaling implies constant relative differences</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="oft.html"><a href="oft.html"><i class="fa fa-check"></i><b>2</b> Optimal Foraging</a><ul>
<li class="chapter" data-level="2.1" data-path="oft.html"><a href="oft.html#a-prey-model"><i class="fa fa-check"></i><b>2.1</b> A prey model</a><ul>
<li class="chapter" data-level="2.1.1" data-path="oft.html"><a href="oft.html#our-intuition"><i class="fa fa-check"></i><b>2.1.1</b> Our intuition</a></li>
<li class="chapter" data-level="2.1.2" data-path="oft.html"><a href="oft.html#mathematical-support"><i class="fa fa-check"></i><b>2.1.2</b> Mathematical support</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="oft.html"><a href="oft.html#the-patch-model"><i class="fa fa-check"></i><b>2.2</b> The patch model</a></li>
<li class="chapter" data-level="2.3" data-path="oft.html"><a href="oft.html#a-simulation-of-a-prey-model"><i class="fa fa-check"></i><b>2.3</b> A simulation of a prey model</a><ul>
<li class="chapter" data-level="2.3.1" data-path="oft.html"><a href="oft.html#lab-exercise"><i class="fa fa-check"></i><b>2.3.1</b> Lab exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="expo.html"><a href="expo.html"><i class="fa fa-check"></i><b>3</b> Simple density-independent growth</a><ul>
<li class="chapter" data-level="3.1" data-path="expo.html"><a href="expo.html#discrete-growth-rates-of-fruit-flies-in-my-kitchen"><i class="fa fa-check"></i><b>3.1</b> Discrete growth rates of fruit flies in my kitchen</a></li>
<li class="chapter" data-level="3.2" data-path="expo.html"><a href="expo.html#fruit-flies-with-continuous-overlapping-generations"><i class="fa fa-check"></i><b>3.2</b> Fruit flies with continuous overlapping generations</a></li>
<li class="chapter" data-level="3.3" data-path="expo.html"><a href="expo.html#properties-of-geometric-and-exponential-growth"><i class="fa fa-check"></i><b>3.3</b> Properties of geometric and exponential growth</a><ul>
<li class="chapter" data-level="3.3.1" data-path="expo.html"><a href="expo.html#average-growth-rate"><i class="fa fa-check"></i><b>3.3.1</b> Average growth rate</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="expo.html"><a href="expo.html#modeling-with-data-simulated-dynamics"><i class="fa fa-check"></i><b>3.4</b> Modeling with Data: Simulated Dynamics</a><ul>
<li class="chapter" data-level="3.4.1" data-path="expo.html"><a href="expo.html#data-based-approaches"><i class="fa fa-check"></i><b>3.4.1</b> Data-based approaches</a></li>
<li class="chapter" data-level="3.4.2" data-path="expo.html"><a href="expo.html#creating-and-visualizing-the-data"><i class="fa fa-check"></i><b>3.4.2</b> Creating and visualizing the data</a></li>
<li class="chapter" data-level="3.4.3" data-path="expo.html"><a href="expo.html#one-simulation"><i class="fa fa-check"></i><b>3.4.3</b> One simulation</a></li>
<li class="chapter" data-level="3.4.4" data-path="expo.html"><a href="expo.html#multiple-simulations"><i class="fa fa-check"></i><b>3.4.4</b> Multiple simulations</a></li>
<li class="chapter" data-level="3.4.5" data-path="expo.html"><a href="expo.html#a-distribution-of-possible-futures"><i class="fa fa-check"></i><b>3.4.5</b> A distribution of possible futures</a></li>
<li class="chapter" data-level="3.4.6" data-path="expo.html"><a href="expo.html#analyzing-results"><i class="fa fa-check"></i><b>3.4.6</b> Analyzing results</a></li>
<li class="chapter" data-level="3.4.7" data-path="expo.html"><a href="expo.html#inferring-processes-underlying-growth-rate"><i class="fa fa-check"></i><b>3.4.7</b> Inferring processes underlying growth rate</a></li>
<li class="chapter" data-level="3.4.8" data-path="expo.html"><a href="expo.html#f-environmental-noise"><i class="fa fa-check"></i><b>3.4.8</b> 1/<span class="math inline">\(f\)</span> environmental noise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="DID.html"><a href="DID.html"><i class="fa fa-check"></i><b>4</b> Density-independent Demography</a><ul>
<li class="chapter" data-level="4.1" data-path="DID.html"><a href="DID.html#a-two-stage-matrix-model"><i class="fa fa-check"></i><b>4.1</b> A two stage matrix model</a></li>
<li class="chapter" data-level="4.2" data-path="DID.html"><a href="DID.html#a-brief-primer-on-matrices"><i class="fa fa-check"></i><b>4.2</b> A brief primer on matrices</a></li>
<li class="chapter" data-level="4.3" data-path="DID.html"><a href="DID.html#decomposing-a"><i class="fa fa-check"></i><b>4.3</b> Decomposing <strong>A</strong></a></li>
<li class="chapter" data-level="4.4" data-path="DID.html"><a href="DID.html#a-three-stage-model"><i class="fa fa-check"></i><b>4.4</b> A three stage model</a></li>
<li class="chapter" data-level="4.5" data-path="DID.html"><a href="DID.html#projection"><i class="fa fa-check"></i><b>4.5</b> Projection</a></li>
<li class="chapter" data-level="4.6" data-path="DID.html"><a href="DID.html#analyzing-the-transition-matrix"><i class="fa fa-check"></i><b>4.6</b> Analyzing the transition matrix</a><ul>
<li class="chapter" data-level="4.6.1" data-path="DID.html"><a href="DID.html#eigenanalysis"><i class="fa fa-check"></i><b>4.6.1</b> Eigenanalysis</a></li>
<li class="chapter" data-level="4.6.2" data-path="DID.html"><a href="DID.html#finite-rate-of-increase"><i class="fa fa-check"></i><b>4.6.2</b> Finite rate of increase</a></li>
<li class="chapter" data-level="4.6.3" data-path="DID.html"><a href="DID.html#stable-stage-distribution"><i class="fa fa-check"></i><b>4.6.3</b> Stable stage distribution</a></li>
<li class="chapter" data-level="4.6.4" data-path="DID.html"><a href="DID.html#calculating-the-stable-stage-distribution"><i class="fa fa-check"></i><b>4.6.4</b> Calculating the stable stage distribution</a></li>
<li class="chapter" data-level="4.6.5" data-path="DID.html"><a href="DID.html#reproductive-value"><i class="fa fa-check"></i><b>4.6.5</b> Reproductive value</a></li>
<li class="chapter" data-level="4.6.6" data-path="DID.html"><a href="DID.html#sensitivity-and-elasticity"><i class="fa fa-check"></i><b>4.6.6</b> Sensitivity and elasticity</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="DID.html"><a href="DID.html#r-packges-for-demography"><i class="fa fa-check"></i><b>4.7</b> R packges for demography</a></li>
<li class="chapter" data-level="4.8" data-path="DID.html"><a href="DID.html#exploring-a-real-population"><i class="fa fa-check"></i><b>4.8</b> Exploring a real population</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>5</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Primer of Ecology with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="DID" class="section level1">
<h1><span class="header-section-number">4</span> Density-independent Demography</h1>
<p>In the preceding chapter, we listed Hastings’ <span class="citation">(Hastings <a href="#ref-Hastings2011" role="doc-biblioref">2011</a>)</span> key principles and assumptions of single species population growth. One of the key assumptions is that “all individuals in a population are identical.” In this chapter, we elucidate an important violation of that assumption, population structure.</p>
<div class="figure"><span id="fig:human"></span>
<img src="figs/AgeDistM.png" alt="Demography of human populations of Mexico and Sweden. Based on 1990 data from US Census Bureau, Population Division, International Programs Center." width="30%" /><img src="figs/AgeDistS.png" alt="Demography of human populations of Mexico and Sweden. Based on 1990 data from US Census Bureau, Population Division, International Programs Center." width="30%" /><img src="figs/AgeSpecFert.png" alt="Demography of human populations of Mexico and Sweden. Based on 1990 data from US Census Bureau, Population Division, International Programs Center." width="30%" />
<p class="caption">
Figure 4.1: Demography of human populations of Mexico and Sweden. Based on 1990 data from US Census Bureau, Population Division, International Programs Center.
</p>
</div>
<p><em>Populations have structure.</em> Consider the human populations of Mexico and Sweden in 1990. Mexico had a much larger fraction of their population in child bearing age classes or younger (Fig. <a href="DID.html#fig:human">4.1</a>). In addition, the age-specific fertility rate was higher in Mexico, especially for younger women
(Fig. <a href="DID.html#fig:human">4.1</a>). How did this happen, and why did Mexico have so
many young people? What were the consequences of this for their
culture, their use of resources, their domestic and foreign policies,
and their future population growth? How about Sweden?</p>
<p>Demography is the study of populations with special attention to their structure <span class="citation">(Lincoln, Boxshall, and Clark <a href="#ref-Lincoln:1998ta" role="doc-biblioref">1998</a>)</span>. Originally, age-based human demography was the provenance of actuaries who helped governments keep track of the number citizens of different ages and thus, for instance, know how many would be available for conscription into the military.<a href="#fn22" class="footnote-ref" id="fnref22"><sup>22</sup></a></p>
<p><em>The reason we model the structure of populations</em> is because various demographic rates vary markedly with these stages. Juveniles produce no offspring. Very few seeds survive an entire year, whereas some large adults survive very well. We use structure when that structure is associated with important differences in demographic rates: <em>survival</em>, <em>fecundity</em>, and <em>growth</em>.</p>
<p>The <em>structure</em> to which we refer is simply the organization of populations by some character such as life history stage, age, or size. Sizes and ages are often reduced to categories such as we saw in human populations (e.g., 0–4.9,y, 5–9.9,y,…). Sizes may be based on any reliable and repeatable measure that relates to demographic rates and are similarly binned. Life history stages may include eggs, larvae, metamorphs, juveniles, and adults in amphibians, or seeds, rosettes, and reproductive stems in herbaceous plants. With a variable such as size, we don’t even need to use categories, but rather we can use size as a continuous variable; we address this briefly later in the chapter.</p>
<p>Structured population models allow us to intertwine species-specific natural history and quantitative methods. This makes the approach especially appealing for the conservation biology of threatened and endangered species. We use structured population models to improve our better understanding of a population or improve predictions of its future dynamics, or guide the management of the population. We might learn a lot about what controls the abundance
of a species if we can test ideas related to different stages, ages,
or sizes. What limits the population growth of the Western toad –
is it egg survival, or overwintering survival of juveniles? Where
should we invest our efforts to
control garlic mustard (<em>Alliaria petiolata</em>) – killing the
first year
rosettes, or the second year adults? Why are cacti generally endangered <span class="citation">(Goettsch et al. <a href="#ref-Goettsch2015" role="doc-biblioref">2015</a>)</span>—is the smallest size, or the largest size
that is most essential to insure long-term survival? We can use
structured population models to address such questions.</p>
<div id="a-two-stage-matrix-model" class="section level2">
<h2><span class="header-section-number">4.1</span> A two stage matrix model</h2>
<div class="figure"><span id="fig:toadlh"></span>
<img src="figs/VoneshF1.png" alt="Like all amphibians, the Western toad (Anaxyrus boreas) has a complex life cycle, with several life history stages. Adults breed in early spring, laying eggs in water. The larvae (tadpoles) hatch and develop over the spring and summer, and then metamorphose (become metamorphs), and then juveniles. Juveniles require more than a year to mature. Adults can live up to about a decade. American toads (A. americanus) do the same thing." width="65%" />
<p class="caption">
Figure 4.2: Like all amphibians, the Western toad (Anaxyrus boreas) has a complex life cycle, with several life history stages. Adults breed in early spring, laying eggs in water. The larvae (tadpoles) hatch and develop over the spring and summer, and then metamorphose (become metamorphs), and then juveniles. Juveniles require more than a year to mature. Adults can live up to about a decade. American toads (A. americanus) do the same thing.
</p>
</div>
<p>A matrix model of a structured population consists of <em>stages</em> and <em>transitions</em>. <span class="citation">Vonesh and Cruz (<a href="#ref-Vonesh:2002fr" role="doc-biblioref">2002</a>)</span> used matrix projection to assess the importance of egg mortality for declines in amphibian populations. Their model of the Western toad (<em>Anaxyrus boreas</em>, Fig. <a href="DID.html#fig:toadlh">4.2</a>) comprises two stages (juveniles and adults) and four transitions.</p>
<p>In all structured popuation models<a href="#fn23" class="footnote-ref" id="fnref23"><sup>23</sup></a>, a transition is the annual contribution of an individual in stage <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span> to stage <span class="math inline">\(j\)</span> at <span class="math inline">\(t+1\)</span>. In Fig. <a href="DID.html#fig:toadlh">4.2</a>, the transition from juvenile to adult is the probability that a juvenile survives an entire year and also matures, becoming sexually viable.<a href="#fn24" class="footnote-ref" id="fnref24"><sup>24</sup></a> The transition from juvenile to juvenile is the probability that a juvenile survives a year and does not mature. The transition from adult to adult is the probability that an adult survives the year. These three transitions are probabilities.</p>
<p>The transition from adult to juvenile (Fig. <a href="DID.html#fig:toadlh">4.2</a>) is typically referred to as <em>fecundity</em>, and it is the product of several events. Vonesh and De la Cruz assume that this transition depends on the population sex ratio, the average clutch size of a female, egg survival, larval survival and metamorphosis, and the overwintering survival of metamorphs. They even assume that larval survival depnds on denisty. Thus what we refer to as “fecundity”<a href="#fn25" class="footnote-ref" id="fnref25"><sup>25</sup></a> is far more than just average clutch size because it must include all the processes that occur over the year associated with producing a clutch and the survival of that clutch.</p>
<p>Structured population models allow us to take advantage of the natural history of our study species. For our study population, at a minimum, we need to (i) identify stages that differ in their demographic rates, and (ii) when individuals tend to breed.</p>
<p>Consider the example of the Western toad (<em>Anaxyrus boreas</em>). As with all amphibians, survival and fecundity rates depend heavily or entirely on life history stages of egg, larvae (tadpole), juvenile, and adult. We would know that breeding occurs in early spring, depending on latitude and elevation. If we wanted to model juveniles and adults, we would typically sample a population prior to breeding when juveniles and adults are just starting to become active.</p>
<p>The design of a structured population model depends on the sampling or census schedule. These models are typically assume an annual census that occurs just before, and just after seed set, egg laying, or births. We refer to these as <em>pre-breeding</em> or <em>post-breeding</em> census models. <span class="citation">Vonesh and Cruz (<a href="#ref-Vonesh:2002fr" role="doc-biblioref">2002</a>)</span> (Fig. <a href="DID.html#fig:toadlh">4.2</a>) use a pre-breeding census model. This is because only juveniles and adults are present in the population at the time of sampling. If the design assumed a post-breeding census (later in the year), it would probably include three stages, with larva (tadpoles) in addition to juveniles and adults.</p>
<p>The reasons for using a pre- <em>vs.</em> post-breeding census include our ability to actually identify and sample stages, and parameter estimation. For example, it may be easy to accurately estimate the abundance of juvenile and adult toads, but very difficult to estimate larval density and larval survival. In such a case, we could represent the adult to juvenile transition as a black box, estimated as the total number of new juveniles in year <span class="math inline">\(t+1\)</span> divided by the number of adults in year <span class="math inline">\(t\)</span>.</p>
<p>We can draw a two different types of life cycle graphs for this two-stage model in just such a population (Fig. <a href="DID.html#fig:vdlc1">4.3</a>). Some people find one more illuminating than the other. It is useful to be able to use both.</p>
<div class="figure"><span id="fig:vdlc1"></span>
<img src="figs/vdlc2.jpg" alt="Two types of life cycle graphs. These both represent an amphibian pre-breeding model." width="65%" /><img src="figs/vdlc1-2.png" alt="Two types of life cycle graphs. These both represent an amphibian pre-breeding model." width="65%" />
<p class="caption">
Figure 4.3: Two types of life cycle graphs. These both represent an amphibian pre-breeding model.
</p>
</div>
<p>All the stages must be present during the annual census, and each arrow or
transition must represent everything that happens over the
entire year. Notice the transition from adult toad to juvenile toad
(Fig. <a href="DID.html#fig:vdlc1">4.3</a>) includes egg production, egg survival, tadpole or
larva survival and growth, and metamorphosis out of the aquatic
stage. This are obviously important events. We make explicit only those stages that we count during our census; all other other events are iplicit within the transitions.</p>
<p>Once we have a life cycle diagram (Fig. <a href="DID.html#fig:vdlc1">4.3</a>), we create a <em>transition</em> or <em>projection</em> matrix that represents mathematically all of the stages and transitions between stages <a href="DID.html#eq:m1">(4.1)</a>. This matrix will have one row and one column for each stage, and the columns represent the stages in year <span class="math inline">\(t\)</span> and the rows represent the stages in year <span class="math inline">\(t+1\)</span>. We refer to a single column by <em>j</em> and a single row by <em>i</em>. Each column represents stage <em>j</em> in year <span class="math inline">\(t\)</span>, and each row represents stage <em>i</em> in year <span class="math inline">\(t+1\)</span>. For our amphibian example, the transition matrix will have two rows and two columns. It will be a “two by two”, or <span class="math inline">\(2 \times 2\)</span> matrix.
<span class="math display" id="eq:m1">\[
\begin{equation}
\tag{4.1}
 \mathbf{A} =
\left(
\begin{array}{cc}
 p_{11}&amp;F_{12} \\
p_{21}&amp;p_{22} 
\end{array}
\right)
\end{equation}
\]</span>
If <a href="DID.html#eq:m1">(4.1)</a> represents the Western toad (Fig. <a href="DID.html#fig:vdlc1">4.3</a>), then transition</p>
<ul>
<li><span class="math inline">\(p_{11}\)</span> is the probability that juveniles survive but fail to mature,</li>
<li><span class="math inline">\(p_{21}\)</span> is the probability that juveniles survive and also mature,</li>
<li><span class="math inline">\(p_{22}\)</span> is the probability that adults survive, and</li>
<li><span class="math inline">\(F_{12}\)</span> is contribution of the average adult to the juvenile stage.</li>
</ul>
<p>In addition to fecundity, survival, maturation or growth from one stage to the next, some organisms undergo <em>regression</em> (Fig. <a href="DID.html#fig:conceptualmatrix">4.4</a>). Regressing means to transition from a later stage to an earlier stage. For instance, and plant can shrink in size do to physical damage, disease or herbivory. A plant can also return temporarily to a non-reproductive stage after a large bout of reproduction. These are examples of regression (Fig. <a href="DID.html#fig:conceptualmatrix">4.4</a>).</p>
<p>One assumption we are making is that individuals set seed, or give birth, all at once. Therefore, we refer to our model as a <em>birth-pulse model</em>. On the other hand, if we assume that we have continuous reproduction throughout the year, we do things differently, and would refer to this as a <em>birth-flow model</em>. Whether a population is breeding continuously over a year, or whether reproduction is seasonal, will influence how we estimate fecundities. Even for synchronously breeding populations, many models pool years into a single age class or stage. The interested reader should consult an authoritative text such as <span class="citation">Caswell (<a href="#ref-Caswell:2001gu" role="doc-biblioref">2001</a>)</span>.</p>
<div class="figure"><span id="fig:conceptualmatrix"></span>
<img src="figs/conceptualmatrix-1.png" alt="A transition matrix, in which each element in the matrix describes the probability that an individual of a given size $j$ at time $t$ appears as size $i$ and time $t+1$. Reproduction typically results in the minimum size, stage, or age. This matrix may be composed of a small number of rows and columns (2-10), or, in the case of integral projection, an infinite number of rows and columns. The number of rows is equal to the number of columns." width="100%" />
<p class="caption">
Figure 4.4: A transition matrix, in which each element in the matrix describes the probability that an individual of a given size <span class="math inline">\(j\)</span> at time <span class="math inline">\(t\)</span> appears as size <span class="math inline">\(i\)</span> and time <span class="math inline">\(t+1\)</span>. Reproduction typically results in the minimum size, stage, or age. This matrix may be composed of a small number of rows and columns (2-10), or, in the case of integral projection, an infinite number of rows and columns. The number of rows is equal to the number of columns.
</p>
</div>
<p>A life cycle graph (Figs. <a href="DID.html#fig:toadlh">4.2</a>, <a href="DID.html#fig:vdlc1">4.3</a>) and the corresponding transition matrix <a href="DID.html#eq:m1">(4.1)</a> constitute our model. The matrix <strong>A</strong> for our structured population is directly analogous to <span class="math inline">\(\lambda\)</span> for our unstructured model of discrete population growth in the previous chapter.<a href="#fn26" class="footnote-ref" id="fnref26"><sup>26</sup></a></p>
<p>Later, we will project the population in an analogous way, using
<span class="math display">\[\mathbf{ N_{t+1} = A N_t}\]</span>
and to do that, we need a refresher on matrix multiplication.</p>
</div>
<div id="a-brief-primer-on-matrices" class="section level2">
<h2><span class="header-section-number">4.2</span> A brief primer on matrices</h2>
<p>We refer to matrices by their rows and columns. A matrix with three rows and one column is a <span class="math inline">\(3 \times 1\)</span> matrix (a ``three by one’’ matrix); we <em>always</em> state the number of rows first. Matrices comprise <em>elements</em>; an element of a matrix is signified by its row and column. The element in the second row and first column is <span class="math inline">\(a_{21}\)</span>. The <em>dimension</em> of a matrix is its number of rows and columns.</p>
<p>To add two matrices, they must have the same dimensions. Consider two matrices, <strong>A</strong> and <strong>B</strong> . To add these two matrices we simply add the elements in the same row and column of both matrices, as below.</p>
<p><span class="math display">\[\begin{align*}
\mathbf{A} &amp;=
\left(
\begin{array}{cc}
a &amp; b \\
c &amp; d
\end{array} \right); \;
\mathbf{B} =
\left(\begin{array}{cc}
m &amp; o\\
n &amp; p
\end{array}\right)\\
\mathbf{A+B} &amp;=
\left( \begin{array}{cc}
\left( a+m \right) &amp; \left(b+o \right)\\
\left(c+n \right) &amp; \left(d+p \right)
\end{array} \right) 
\end{align*}\]</span></p>
<p>Multiplying matrices is a little more complicated. To do so, we mutliply elements and then sum them:</p>
<ul>
<li>multiply each row element of the first matrix (<strong>A</strong>) times each column element of the second matrix (<strong>B</strong>),</li>
<li>sum the element-wise products, and</li>
<li>place this sum in the respective element of the final matrix.</li>
</ul>
<p>This process is what we refer to as a <em>dot product</em> or sometimes <em>inner product</em>. When we have two vectors of equal length <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> the dot product is
<span class="math display">\[x \cdot y = x_1y_1 + x_2y_2 + \ldots + x_n y_n\]</span>
A dot product begins with two equal length vectors and returns a single number (i.e. a scalar).</p>
<p>Consider the matrix multiplication in <a href="DID.html#eq:exM">(4.2)</a>. We first multiply each element of row 1 of <strong>A</strong> (<span class="math inline">\(a\; b\)</span>), times the corresponding elements of column 1 of <strong>B</strong> (<span class="math inline">\(m\; n\)</span>), sum these products, and place the sum in the first row, first column of the resulting matrix. We then repeat this for each row of <strong>A</strong> and each column of <strong>B</strong>.</p>
<p><span class="math display" id="eq:exM">\[\begin{align}
\tag{4.2}
\mathbf{AB} &amp;=
\left( \begin{array}{cc}
\left( am + bn \right) &amp; \left(ao+bp \right)\\
\left(cm + dn \right) &amp; \left(co + dp \right)
\end{array}\right) 
\end{align}\]</span></p>
<p>To do this, the number of columns in the first matrix must equal the number of rows in the second matrix. It also means that the resulting matrix will have the same number of rows as the first matrix, and the same number of columns as the second matrix. Multiplying a <span class="math inline">\(2 \times 2\)</span> matrix by a <span class="math inline">\(2 \times 1\)</span> results in a <span class="math inline">\(2 \times 1\)</span>. Multiplying a <span class="math inline">\(3 \times 3\)</span> matrix by a <span class="math inline">\(3 \times 1\)</span> results in a <span class="math inline">\(3 \times 1\)</span>. We cannot multiply a <span class="math inline">\(2 \times 1\)</span> matrix by a <span class="math inline">\(2 \times 2\)</span> because the number of columns in the first matrix (1) does not match the number of rows in the second matrix (2).</p>
<p>Let’s define two <span class="math inline">\(2 \times 2\)</span> matrices, <strong>M</strong> and <strong>N</strong>, filling in one by rows, and the other by columns.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="DID.html#cb82-1"></a>(M &lt;-<span class="st"> </span><span class="kw">matrix</span>( <span class="dv">1</span><span class="op">:</span><span class="dv">4</span> , <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    2
## [2,]    3    4</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="DID.html#cb84-1"></a>(N &lt;-<span class="st"> </span><span class="kw">matrix</span>( <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>), <span class="dt">nrow=</span><span class="dv">2</span>)) <span class="co"># byrow=FALSE is the default.</span></span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]   10   30
## [2,]   20   40</code></pre>
<p>Adding these matrices is simple. Here we do the first element by hand, and then sum the matrices all at once.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="DID.html#cb86-1"></a><span class="co"># 1 + 10</span></span>
<span id="cb86-2"><a href="DID.html#cb86-2"></a>M[<span class="dv">1</span>,<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>N[<span class="dv">1</span>,<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] 11</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="DID.html#cb88-1"></a>M <span class="op">+</span><span class="st"> </span>N</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]   11   32
## [2,]   23   44</code></pre>
<p>To mulitply <strong>M</strong> and <strong>N</strong>, we multiply and then sum the first row of <span class="math inline">\(M\)</span> by the first column of <span class="math inline">\(N\)</span>, and make this element <span class="math inline">\(a_{11}\)</span> of the resulting matrix product.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="DID.html#cb90-1"></a><span class="co"># 1*10 + 2*20</span></span>
<span id="cb90-2"><a href="DID.html#cb90-2"></a>M[<span class="dv">1</span>,<span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>N[<span class="dv">1</span>,<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>M[<span class="dv">1</span>,<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>N[<span class="dv">2</span>,<span class="dv">1</span>] </span></code></pre></div>
<pre><code>## [1] 50</code></pre>
<p>This is the dot product.</p>
<p>In R, we must use <code>%*%</code> to signify that we mean matrix multiplication.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="DID.html#cb92-1"></a>M <span class="op">%*%</span><span class="st"> </span>N</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]   50  110
## [2,]  110  250</code></pre>
<p>If we multiply <strong>M</strong> times a <span class="math inline">\(2 \times 1\)</span> matrix <strong>D</strong>, what should we get?</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="DID.html#cb94-1"></a>D &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">200</span>), <span class="dt">nrow=</span><span class="dv">2</span>)</span>
<span id="cb94-2"><a href="DID.html#cb94-2"></a>M <span class="op">%*%</span><span class="st"> </span>D</span></code></pre></div>
<pre><code>##      [,1]
## [1,]  500
## [2,] 1100</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="DID.html#cb96-1"></a><span class="co"># note that we cannot perform D %*% M</span></span></code></pre></div>
<p>Make sure you could write out the multiplication and summation for each element in the resulting matrix.</p>
<p>The transpose of <strong>M</strong> is <span class="math inline">\(\mathbf{M^T}\)</span></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="DID.html#cb97-1"></a>M; <span class="kw">t</span>(M)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    2
## [2,]    3    4</code></pre>
<pre><code>##      [,1] [,2]
## [1,]    1    3
## [2,]    2    4</code></pre>
<p>We use the transpose of <strong>A</strong> to calculate reproductive value, later in the chapter.</p>
</div>
<div id="decomposing-a" class="section level2">
<h2><span class="header-section-number">4.3</span> Decomposing <strong>A</strong></h2>
<p>A slightly different way to conceptualize our transition matrix is to consider it the three separate matrices, one each for survival, growth, and fecundity,
<span class="math display">\[\mathbf{ A = SG + F }\]</span>.</p>
<p>Survival, <strong>S</strong>, and growth, <strong>G</strong>, havethese elements:</p>
<ul>
<li>each stage <span class="math inline">\(j\)</span> has its own probability of survival <span class="math inline">\(s_j\)</span>, which describes survival of each stage from <span class="math inline">\(t\)</span> to <span class="math inline">\(t+1\)</span>.</li>
<li>each survivor in stage <span class="math inline">\(j\)</span> will grow or regress into a different stage, or remain in the same stage, with probability <span class="math inline">\(g_{ij}\)</span>.</li>
</ul>
<p>In a demographic context, fecundity, <strong>F</strong>, is the surviving number of offspring produced by the average individual in stage <span class="math inline">\(i\)</span>. Sometimes this is a complete black box, in which we can only count the adults in year <span class="math inline">\(t\)</span> and the offspring in year <span class="math inline">\(t+1\)</span>. Other times, we can use estimates of the probability that an individual in stage <span class="math inline">\(i\)</span> reproduces at all, the average number of offspring of an individual that does actually reproduce, and the survival and growth of the adults or the resulting offspring. It all depends on the detail we have of our study system. And, of course, it depends heavily on whether we census our population shortly before reproduction (pre-breeding census), or shortly after reproduction (post-breeding census).</p>
<p>For our Western Toad (Fig. <a href="DID.html#fig:toadlh">4.2</a>), this results in
<span class="math display" id="eq:SGF">\[\begin{equation*}
\tag{4.3}
 \mathbf{A = SG + F} = 
 \left(
 \begin{array}{c}
 \sigma_j\\
\sigma_a
 \end{array} \right)
\left(
\begin{array}{cc}
1-\mathrm{P} &amp; 0 \\
\mathrm{P} &amp; 1
\end{array} \right)
+
\left(
\begin{array}{cc}
0 &amp; \rho \phi \sigma_e \sigma_t \sigma_m \\
0 &amp; 0
\end{array} \right)
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(\sigma_j,\,\sigma_a\)</span> are survival of juveniles and adults, and P is the probability of juvenile growth, given survival. If an adult survives it always remains an adult (<span class="math inline">\(g_{22}=1\)</span>) and never regresses (<span class="math inline">\(g_{12}=0\)</span>). Fecundity occurs only in adults, and it is the product of the sex ratio (<span class="math inline">\(\rho\)</span>), average clutch size per female (<span class="math inline">\(\phi\)</span>), egg survival (<span class="math inline">\(\sigma_e\)</span>), survival of tadpoles (<span class="math inline">\(\sigma_t\)</span>), and the overwintering survival of the metamorphs (<span class="math inline">\(\sigma_m\)</span>).</p>
<p>Following the rules of matrix multiplication and addition, we now have</p>
<p>Vonesh and de la Cruz went further and added <em>density-dependence</em> using a term for the negative effects of high tadpole density on tadpole survival and growth. We do not show that here, but regardless how complex the natural history gets, we can build natural history into our models.</p>
<p><span class="math display" id="eq:SGA">\[\begin{equation*}
\tag{4.4}
 \mathbf{SG} = 
\left(
\begin{array}{cc}
\sigma_j (1-\mathrm{P}) &amp; 0 \\
\sigma_j \mathrm{P} &amp; \sigma_a
\end{array} \right) \; ; \;
\mathbf{A} = 
\left(
\begin{array}{cc}
\sigma_j (1-\mathrm{P}) &amp; \rho \phi \sigma_e \sigma_t \sigma_m \\
\sigma_j \mathrm{P} &amp; \sigma_a
\end{array} \right)
\end{equation*}\]</span></p>
</div>
<div id="a-three-stage-model" class="section level2">
<h2><span class="header-section-number">4.4</span> A three stage model</h2>
Now we describe a three-stage model of a plant population. Like our amphibian example, it is a <em>pre-breeding</em> model, relying on a pre-breeding census. Nonetheless, it includes a seed stage for the seed bank, where seeds may be more than one year old. Eleanor <span class="citation">Pardini et al. (<a href="#ref-Pardini:2009aa" role="doc-biblioref">n.d.</a>)</span> and colleagues modeled garlic mustard (<em>Alliaria petiolata</em>), a biennial plant species that is an exotic invasive species in the eastern deciduous forest of the U.S. The stages they choose to represent were those present in May: seeds in the soil seed bank, 1–2 month old immature rosettes, and adults (Fig. @fig:garlic1).
<div class="figure"><span id="fig:garlic1"></span>
<img src="figs/pardiniLC.pdf" alt="The life cycle of garlic mustard using a post-breeding census (Pardini et al. 2009). The census takes place in May of each year. Each arrow represents the transition from May to May. Seeds germinate in early spring and become rosettes (basal leaves near the soil surface). The rosettes experience mortality all summer, fall, and winter. Surviving rosettes become reproductive adults the following spring a summer. Adults flower and are pollinated in June, after which the fruits ripen and seeds mature. Seeds overwinter for at least six months before germinating in the spring. Not all seeds germinate, but they may remain viable in the seed bank for several years. Thus, the complete life cycle at least two years. Once the seeds germinate, the plant requires over a year to reach maturity, and produce flowers, fruits and seeds." width="90%" />
<p class="caption">
Figure 4.5: The life cycle of garlic mustard using a post-breeding census (Pardini et al. 2009). The census takes place in May of each year. Each arrow represents the transition from May to May. Seeds germinate in early spring and become rosettes (basal leaves near the soil surface). The rosettes experience mortality all summer, fall, and winter. Surviving rosettes become reproductive adults the following spring a summer. Adults flower and are pollinated in June, after which the fruits ripen and seeds mature. Seeds overwinter for at least six months before germinating in the spring. Not all seeds germinate, but they may remain viable in the seed bank for several years. Thus, the complete life cycle at least two years. Once the seeds germinate, the plant requires over a year to reach maturity, and produce flowers, fruits and seeds.
</p>
</div>
<p>Let’s work through these probability transitions.</p>
<ul>
<li><span class="math inline">\(s_1\)</span>, a germinated seed survives as a rosette.</li>
<li><span class="math inline">\(s_2\)</span>, surviving from May to August as a rosette.</li>
<li><span class="math inline">\(s_3\)</span>, surviving from August to early May and becoming a reproductive plant.</li>
<li><span class="math inline">\(v\)</span>, a seed is viable (survives and can germinate).</li>
<li><span class="math inline">\(g_1\)</span>, a viable seed germinates in the first season, or <span class="math inline">\(1-g_1\)</span> remains un germinated</li>
<li><span class="math inline">\(g_2\)</span>, a viable seed germinates in the second season or <span class="math inline">\(1-g_2\)</span> does not.</li>
</ul>
<p>Fecundity, <span class="math inline">\(f\)</span>, is the average number of seeds per reproductive plant.</p>
<p>The transition matrix <strong>A</strong> would thus be</p>
<p><span class="math display" id="eq:pardini">\[\begin{equation*}
\tag{4.5}
 \mathbf{A} = 
\left(
\begin{array}{ccc}
 1-g_2  &amp; 0       &amp; v(1-g_1)f \\
g_2 s_1 &amp; 0       &amp; v g_1 s_1 f \\
0       &amp; s_2 s_3 &amp; 0
\end{array} \right)
\end{equation*}\]</span></p>
<p>Put into your own words each of the transition elements.</p>
<p>What about the transition from adult to rosette? Did the plant shrink? While perennial plants can get smaller, or <em>regress</em>, that is not what happens here. In this transition, the adult in May gets pollinated, develops fruits, the seeds mature and are deposited on the soil late that summer or fall. Those seeds are survive overwinter, germinate in early spring, and grow into rosettes that summer, and survive until the next census in May. In that way, stage 3 (adult) contributes to stage 2 (rosette) through reproduction plus survival and growth. The transition from adult to seed, <span class="math inline">\(p_{13}\)</span>, occurs only when the seeds do not germinate after the first winter, but spend another year in the seed bank in the soil.</p>
<p>Once we have the transition matrix, we can use it to characterize many features of the population, including the finite rate of increase (<span class="math inline">\(\lambda\)</span>), the predicted relative abundances of the various stages, and the relative importance of each separate transition <span class="math inline">\(p_{ij}\)</span> for the long term population growth rate. We will do this in a later section, but first will explore projection. It is frequently useful to acutally project the population, one year at a time, into the future.</p>
</div>
<div id="projection" class="section level2">
<h2><span class="header-section-number">4.5</span> Projection</h2>
<p><em>Projection</em> is the modeling of a population through time, for prediction under one or another set of assumptions. In practice, we use <em>matrix multiplication</em> to project stage- or structured populations. Matrix multiplication does all these calculations for us. We let <strong>A</strong> be our square demographic transition matrix, with one row and one column for each stage. Let <span class="math inline">\(\mathbf{N}_t\)</span> be a one-column matrix of stage sizes, with one row for each stage. Matrix multiplication allows us to project the population,
<span class="math inline">\(\mathbf{A}\mathbf{N}_t = \mathbf{N}_{t+1}\)</span>.</p>
<p>To project a population for multiple years, we use a <em>for-loop</em>. We used this in the previous chapter for an unstructured population. Here we multiply our transition matrix by the current year’s abundances projecting next year’s abundances. All we need to specify are the transition matrix, starting stage abundances for <span class="math inline">\(t=0\)</span>, and the number of years through which we want to project. Here we define a transition matrix, <span class="math inline">\(\mathbf{N}_0\)</span>, and a numbers of time steps to project.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="DID.html#cb100-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>( <span class="kw">c</span>(.<span class="dv">1</span>, <span class="fl">2.0</span>, </span>
<span id="cb100-2"><a href="DID.html#cb100-2"></a>        <span class="fl">.3</span>,.<span class="dv">4</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">byrow=</span>T)</span>
<span id="cb100-3"><a href="DID.html#cb100-3"></a>N0 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">1</span>), <span class="dt">nrow=</span><span class="dv">1</span>) </span>
<span id="cb100-4"><a href="DID.html#cb100-4"></a>years &lt;-<span class="st"> </span><span class="dv">6</span></span></code></pre></div>
<p>To do the for-loop, we need an zeroes matrix to hold <span class="math inline">\(n\)</span> for each of the years of each of the stages, including for our first year. We start by filling our matrix with zeroes and “binding” the rows in <span class="math inline">\(\mathbf{N}_0\)</span> onto the top of our zeroes matrix as the first row.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="DID.html#cb101-1"></a>N.proj1 &lt;-<span class="st"> </span><span class="kw">matrix</span>( <span class="dv">0</span>, <span class="dt">nrow=</span>years, <span class="dt">ncol=</span><span class="kw">nrow</span>(A)) </span>
<span id="cb101-2"><a href="DID.html#cb101-2"></a><span class="kw">colnames</span>(N.proj1) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Juv&quot;</span>, <span class="st">&quot;Adult&quot;</span>)</span>
<span id="cb101-3"><a href="DID.html#cb101-3"></a>N.proj2 &lt;-<span class="st"> </span><span class="kw">rbind</span>(N0, N.proj1)</span></code></pre></div>
<p>Now we perform the iteration with the for-loop and plot the result. Note how we do the multiplication for the current year <span class="math inline">\(t\)</span> and put the result in the next year <span class="math inline">\(t+1\)</span>.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="DID.html#cb102-1"></a><span class="co"># Project, then...</span></span>
<span id="cb102-2"><a href="DID.html#cb102-2"></a><span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>years) {N.proj2[t<span class="op">+</span><span class="dv">1</span>,] &lt;-<span class="st"> </span>A<span class="op">%*%</span>N.proj2[t,]}</span>
<span id="cb102-3"><a href="DID.html#cb102-3"></a><span class="co"># ...rearrange and plot</span></span>
<span id="cb102-4"><a href="DID.html#cb102-4"></a>N.proj.data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Year=</span><span class="dv">0</span><span class="op">:</span>years, N.proj2)</span>
<span id="cb102-5"><a href="DID.html#cb102-5"></a>npd &lt;-<span class="st"> </span><span class="kw">gather</span>(N.proj.data, Stage, Abundance, <span class="op">-</span>Year)</span>
<span id="cb102-6"><a href="DID.html#cb102-6"></a><span class="kw">ggplot</span>(npd, <span class="kw">aes</span>(Year, Abundance, <span class="dt">linetype=</span>Stage)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>()</span></code></pre></div>
<div class="figure"><span id="fig:projmat"></span>
<img src="figs/projmat-1.png" alt="Projection of a population showing transient dynamics." width="90%" />
<p class="caption">
Figure 4.6: Projection of a population showing transient dynamics.
</p>
</div>
<p>In the first seven years, we see the abundances of the two stages bounce around. These are <em>transient</em> dynamics that, in our density-independent models, will fade away over time.</p>
</div>
<div id="analyzing-the-transition-matrix" class="section level2">
<h2><span class="header-section-number">4.6</span> Analyzing the transition matrix</h2>
<p>Projection is very important for many reasons, especially for stochastic models or for very complicated models. However, we also get some of our best insights through direct analysis the transition matrix using <em>eigenanalysis</em> <span class="citation">(Caswell <a href="#ref-Caswell:2001gu" role="doc-biblioref">2001</a>)</span>.</p>
<p>The features we learn about a structured population using eigenanalysis are best thought of as predictions, attractors, or long term averages, assuming that the transition elements don’t change. This is a big assumption, but understanding it helps us interpret the analysis appropriately.</p>
<p>Once you have obtained the transition matrix, <span class="math inline">\(\mathbf{A}\)</span>, you can analysis it using <em>eigenanalysis</em> to estimate</p>
<ul>
<li><span class="math inline">\(\lambda\)</span>, the finite rate of increase,</li>
<li>stable stage structure,</li>
<li>reproductive value, and</li>
<li>sensitivities and elasticities.</li>
</ul>
<p>Below, we explain each of these quantities.</p>
<div id="eigenanalysis" class="section level3">
<h3><span class="header-section-number">4.6.1</span> Eigenanalysis</h3>
<p>Eigenanalysis is a mathematical technique that summarizes multivariate data. Ecologists use eigenanalysis frequently, for (i) multivariate statistics such as ordination, (ii) local stability analyses with two or more species, and (iii) analyzing population transition matrices. Eigenanalysis is simply a method to transform a square matrix into independent, or orthogonal, pieces. These pieces are <em>eigenvectors</em> and their corresponding <em>eigenvalues.</em> There are the same number of eigenvalues (and eigenvectors) as there are columns in a matrix. In demography, the two most useful pieces are the <em>dominant right eigenvalue</em> and its <em>corresponding right eigenvector</em>.</p>
<p>Eigenanalysis is a technique that finds all the solutions for <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\mathbf{w}\)</span> of</p>
<p><span class="math display" id="eq:eigsol">\[\begin{equation}
\tag{4.6}
\mathbf{Aw}=\lambda \mathbf{w}
\end{equation}\]</span>
where <span class="math inline">\(\mathbf{w}\)</span> is a particular summary of our data. With analysis of a transition matrix, <span class="math inline">\(\mathbf{A}\)</span> is the projection matrix, <span class="math inline">\(\lambda\)</span> is an <em>eigenvalue</em> and <span class="math inline">\(\mathbf{w}\)</span> is an <em>eigenvector</em>. If we write out eq. <a href="DID.html#eq:eigsol">(4.6)</a> for a <span class="math inline">\(2 \times 2\)</span> matrix, we would have</p>
<p><span class="math display" id="eq:eigsollong">\[
 \tag{4.7}
 \left(
 \begin{array}{ccc}
  a_{11} &amp; a_{12} \\
  a_{21} &amp; a_{22}\\
 \end{array} 
 \right) 
 \left(
  \begin{array}[c]{c}
   w_{11}\\
   w_{21}
  \end{array}
  \right)
  =\lambda \left(
  \begin{array}[c]{c}
   w_{11}\\
   w_{21}
  \end{array}
  \right)
\]</span></p>
<p>For instance, we can preform eigenanalysis on this transition matrix.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="DID.html#cb103-1"></a>(A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.3</span>, <span class="dv">2</span>, <span class="fl">.7</span>), <span class="dt">nrow=</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]  0.0  2.0
## [2,]  0.3  0.7</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="DID.html#cb105-1"></a>(eA &lt;-<span class="st"> </span><span class="kw">eigen</span>(A))</span></code></pre></div>
<pre><code>## eigen() decomposition
## $values
## [1]  1.2 -0.5
## 
## $vectors
##            [,1]       [,2]
## [1,] -0.8574929 -0.9701425
## [2,] -0.5144958  0.2425356</code></pre>
<p>This gives us one eigenvalue per column of our transition matrix (<code>values</code>). Each eigenvalue has a <em>corresponding eigenvector</em> that is the corresponding column of the <code>vectors</code> matrix.</p>
<p>Let’s use R to prove to ourselves that eq. <a href="DID.html#eq:eigsol">(4.6)</a> is what we say it is. Here we see for ourselves whether <span class="math inline">\(\mathbf{A}\mathbf{w} = \lambda \mathbf{w}\)</span> for
<span class="math inline">\(i = 1\)</span>. Below, we use the results of the previous eigenanalysis.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="DID.html#cb107-1"></a>(lambda1 &lt;-<span class="st"> </span>eA<span class="op">$</span>values[<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 1.2</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="DID.html#cb109-1"></a>(w1 &lt;-<span class="st"> </span>eA<span class="op">$</span>vectors[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] -0.8574929 -0.5144958</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="DID.html#cb111-1"></a><span class="kw">cbind</span>(A <span class="op">%*%</span><span class="st"> </span>w1, lambda1 <span class="op">*</span><span class="st"> </span>w1)</span></code></pre></div>
<pre><code>##            [,1]       [,2]
## [1,] -1.0289915 -1.0289915
## [2,] -0.6173949 -0.6173949</code></pre>
<p>The first column is <span class="math inline">\(\mathbf{Aw}\)</span> and the second column is <span class="math inline">\(\lambda \mathbf{w}\)</span>. Sure enough, they look the same. Try doing the same exercise for the second eigenvalue and the second eigenvector, <span class="math inline">\(i=2\)</span>.</p>
<p>Typically, the first eigenvalue and its corresponding eigenvector capture the most important features of the transition matrix. We call these the dominant eigenvalue, <span class="math inline">\(\lambda_1\)</span>, and its corresponding eigenvector, <span class="math inline">\(w_1\)</span>. While first solution does not capture all of the information about our transition matrix, it is the most useful.</p>
<p>There are an infinite number of solutions to this equation because solutions can just be simple multiples of the set found with eigenanalysis. Eigenanalysis finds a set in which the solutions are all independent of each other, and which capture all of the information in <span class="math inline">\(\mathbf{A}\)</span> in a particularly useful way.</p>
<p>In this book, we will not delve into details of eigenanalysis beyond this. What is important for us is how we use the results. Below, we describe how we use eigenanalysis to find (i) the long term asymptotic finite rate of increase <span class="math inline">\(\lambda\)</span>, (ii) the <em>stable stage distribution</em>, and the the <em>reproductive values</em> of each stage.</p>
</div>
<div id="finite-rate-of-increase" class="section level3">
<h3><span class="header-section-number">4.6.2</span> Finite rate of increase</h3>
<p>
The asymptotic annual growth rate or finite rate of increase is the dominant eigenvalue of the transition matrix. Eigenvalues are always referred to with the Greek symbol <span class="math inline">\(\lambda\)</span>, and provide a solution to <a href="DID.html#eq:eigsol">(4.6)</a>. The dominant eigenvalue of any matrix, <span class="math inline">\(\lambda_{1}\)</span>, is the eigenvalue with the largest magnitude, and it is frequently a complex number. (When we perform eigenanalysis, it is common to get complex numbers, with real and imaginary parts. The magnitude is the sum of the squared parts.) With population transition matrices, <span class="math inline">\(\lambda_{1}\)</span> will always be positive and real. This will not be the case with other types of matrices we examine in later chapters.</p>
<p>The dominant eigenvalue is the biggest one. We can find which one it by asking R to tell us the index position <span class="math inline">\(i\)</span> of the largest absolute value (the modulus) of the eigenvalues. In most cases, it is the first eigenvalue, as it is here.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="DID.html#cb113-1"></a>( dom.pos &lt;-<span class="st"> </span><span class="kw">which.max</span>( <span class="kw">Mod</span>(eA[[<span class="st">&quot;values&quot;</span>]]) )  )</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>We use that index to extract the largest eigenvalue. We keep the real part, using <code>Re()</code>, dropping the imaginary part. (Note that although the dominant eigenvalue of a real transition matrix will always be real, R will include an imaginary part equal to zero (<span class="math inline">\(0i\)</span>) as a place holder if any of the eigenvalues has a non-zero imaginary part).</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="DID.html#cb115-1"></a><span class="co"># extract the dominant eigenvalue and retain only its Real part</span></span>
<span id="cb115-2"><a href="DID.html#cb115-2"></a>( L1 &lt;-<span class="st"> </span><span class="kw">Re</span>(eA[[<span class="st">&quot;values&quot;</span>]][dom.pos]) )</span></code></pre></div>
<pre><code>## [1] 1.2</code></pre>
<p><code>L1</code> is <span class="math inline">\(\lambda_1\)</span>, the aysmptotic finite rate of increase. This finite rate of increase has the same biological meaning as <span class="math inline">\(\lambda\)</span> in the previous chapter.</p>
</div>
<div id="stable-stage-distribution" class="section level3">
<h3><span class="header-section-number">4.6.3</span> Stable stage distribution</h3>
<p>The relative abundance of the different life history stages is called the <em>stage distribution</em>, that is, the distribution of individuals among the stages. A property of a stage structured population is that, if all the demographic rates (elements of the transition matrix) remain constant, its stage structure will approach a <em>stable</em> stage distribution, a stage distribution in which the <strong>relative</strong> number of individuals in each stage is constant. Note that a population can grow, so that the absolute number of individuals increases, but the relative abundances of the stages is constant; this is the stable stage distribution. If the population is not actually growing (i.e. <span class="math inline">\(\lambda=1\)</span>) and demographic parameters remain constant, then the population is <em>stationary</em> and will achieve a <em>stationary stage distribution</em>, where neither absolute nor relative abundances change.</p>
<p>How do we find the stable stage distribution? It also turns out that <span class="math inline">\(w_1\)</span> provides the necessary information. We scale the eigenvector <span class="math inline">\(w_1\)</span> by the sum of its elements because we are interested in the <em>distribution</em>, which is defined by all stages summing to one. Therefore the stable stage distribution is
<span class="math display" id="eq:ssd">\[\begin{equation}
 \tag{4.8}
 \frac{w_1}{\sum_{i=1}^s{w_1}}
\end{equation}\]</span>
where <span class="math inline">\(s\)</span> is the number of stages.</p>
<p>Once a population reaches its stable stage distribution each of the stages grow exponentially, because
<span class="math display">\[\mathbf{Aw}=\lambda \mathbf{w}\]</span></p>
</div>
<div id="calculating-the-stable-stage-distribution" class="section level3">
<h3><span class="header-section-number">4.6.4</span> Calculating the stable stage distribution</h3>
<p>The dominant eigenvector, <span class="math inline">\(w_1\)</span>, is in the same position as the dominant eigenvalue. We extract <span class="math inline">\(w_1\)</span>, keeping just the real part, and divide it by its sum to get the stable stage distribution.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="DID.html#cb117-1"></a><span class="co"># continuing from previous code...</span></span>
<span id="cb117-2"><a href="DID.html#cb117-2"></a>w1 &lt;-<span class="st"> </span><span class="kw">Re</span>(eA[[<span class="st">&quot;vectors&quot;</span>]][,dom.pos])</span>
<span id="cb117-3"><a href="DID.html#cb117-3"></a>ssd &lt;-<span class="st"> </span>w1<span class="op">/</span><span class="kw">sum</span>(w1)</span>
<span id="cb117-4"><a href="DID.html#cb117-4"></a><span class="kw">round</span>(ssd, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.625 0.375</code></pre>
<p>This shows us that if the transition matrix does not change over time, the population will eventually be composed of these relative abundances.</p>
<p>We have claimed, without evidence, that with a constant transition matrix, the projected population will eventually reach a stable stage distribution and grow exponentially with a finite rate of increase of <span class="math inline">\(\lambda_1\)</span>. Here we show an example.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="DID.html#cb119-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.3</span>, <span class="dv">2</span>, <span class="fl">.7</span>), <span class="dt">nrow=</span><span class="dv">2</span>) <span class="co"># our tran. matrix</span></span>
<span id="cb119-2"><a href="DID.html#cb119-2"></a>N0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">Juveniles=</span><span class="dv">1</span>,<span class="dt">Adults=</span><span class="dv">10</span>) <span class="co"># initial population</span></span>
<span id="cb119-3"><a href="DID.html#cb119-3"></a>steps &lt;-<span class="st"> </span><span class="dv">8</span> <span class="co"># number of time steps</span></span>
<span id="cb119-4"><a href="DID.html#cb119-4"></a><span class="co"># combine the stages of our initial population, and a zero matrix </span></span>
<span id="cb119-5"><a href="DID.html#cb119-5"></a><span class="co"># with a column for each stage and a row for each time step</span></span>
<span id="cb119-6"><a href="DID.html#cb119-6"></a>N &lt;-<span class="st"> </span><span class="kw">rbind</span>(N0, <span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">ncol=</span><span class="dv">2</span>, <span class="dt">nrow=</span>steps) )</span>
<span id="cb119-7"><a href="DID.html#cb119-7"></a><span class="co"># use a for-loop to project the population each year and store it.</span></span>
<span id="cb119-8"><a href="DID.html#cb119-8"></a><span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>steps) {N[t<span class="op">+</span><span class="dv">1</span>,] &lt;-<span class="st"> </span>A<span class="op">%*%</span>N[t,]}</span>
<span id="cb119-9"><a href="DID.html#cb119-9"></a><span class="co"># Sum the stages to get the total N</span></span>
<span id="cb119-10"><a href="DID.html#cb119-10"></a>N.total &lt;-<span class="st"> </span><span class="kw">rowSums</span>(N)</span>
<span id="cb119-11"><a href="DID.html#cb119-11"></a><span class="co"># For each year, divide each stage by the total to get </span></span>
<span id="cb119-12"><a href="DID.html#cb119-12"></a><span class="co"># relative abundances and thus the distribution.</span></span>
<span id="cb119-13"><a href="DID.html#cb119-13"></a>proportions &lt;-<span class="st"> </span>N<span class="op">/</span>N.total</span>
<span id="cb119-14"><a href="DID.html#cb119-14"></a>SD &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Year=</span><span class="dv">0</span><span class="op">:</span>steps, proportions)</span>
<span id="cb119-15"><a href="DID.html#cb119-15"></a>sdg &lt;-<span class="st"> </span><span class="kw">gather</span>(SD, Stage, Proportion, <span class="op">-</span>Year)</span>
<span id="cb119-16"><a href="DID.html#cb119-16"></a></span>
<span id="cb119-17"><a href="DID.html#cb119-17"></a><span class="co"># plot the distributions for succeeding years.</span></span>
<span id="cb119-18"><a href="DID.html#cb119-18"></a><span class="kw">ggplot</span>(sdg, <span class="kw">aes</span>(Stage, Proportion)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_col</span>()  <span class="op">+</span><span class="st"> </span></span>
<span id="cb119-19"><a href="DID.html#cb119-19"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Year, <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="figs/poweriter-1.png" width="90%" /></p>
<p>Using total population sizes, we can calculate an annual rate of increase <span class="math inline">\(N_{t+1}/N_t\)</span>.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="DID.html#cb120-1"></a><span class="co"># using &quot;-&quot; in an index removes that element</span></span>
<span id="cb120-2"><a href="DID.html#cb120-2"></a>lambda.t &lt;-<span class="st"> </span>N.total[<span class="op">-</span><span class="dv">1</span>]<span class="op">/</span>N.total[<span class="op">-</span>(steps<span class="op">+</span><span class="dv">1</span>)] </span>
<span id="cb120-3"><a href="DID.html#cb120-3"></a><span class="kw">qplot</span>(<span class="dt">x=</span><span class="dv">1</span><span class="op">:</span>steps, <span class="dt">y=</span>lambda.t, <span class="dt">geom=</span><span class="kw">c</span>(<span class="st">&quot;line&quot;</span>, <span class="st">&quot;point&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb120-4"><a href="DID.html#cb120-4"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;point&quot;</span>, <span class="dt">x =</span> steps  , <span class="dt">y=</span>L1, <span class="dt">pch=</span><span class="dv">1</span>, <span class="dt">size=</span><span class="dv">3</span>) </span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-36"></span>
<img src="figs/unnamed-chunk-36-1.png" alt="Calculating an annual finite rate of increase from a projected population shows that the population will approach asymptotically a constant geometric rate of increase. Solid points are annual growth rate; the circular point is lambda(1) from eigen analyysis." width="90%" />
<p class="caption">
Figure 4.7: Calculating an annual finite rate of increase from a projected population shows that the population will approach asymptotically a constant geometric rate of increase. Solid points are annual growth rate; the circular point is lambda(1) from eigen analyysis.
</p>
</div>
<p>Iterating the transition matrix to approximate <span class="math inline">\(\lambda_1\)</span> and <span class="math inline">\(w_1\)</span> is actually called the <em>power iteration method</em> for eigenanalysis.</p>
</div>
<div id="reproductive-value" class="section level3">
<h3><span class="header-section-number">4.6.5</span> Reproductive value</h3>
<p>
If the stage structure gives us one measure of the importance of a stage (its relative abundance), then the <em>reproductive value</em> gives us one measure of the importance of an <em>individual</em> in each stage. Reproductive value is the expected contribution of each individual to future reproduction. We characterize all individuals in a stage using the same expected reproductive value.</p>
<p>We find each stage’s reproductive value by solving for the dominant <em>left</em> eigenvector <span class="math inline">\(\mathbf{v}\)</span>, where
<span class="math display" id="eq:rv">\[\begin{equation}
 \tag{4.9}
 \mathbf{vA}=\lambda\mathbf{v}
\end{equation}\]</span>
Like the relation between the dominant right eigenvector and the stable stage distribution, this vector is actually <em>proportional</em> to the reproductive values. Unlike the stable stage distribution, we scale it so that all reproductive values are relative to that of the first stage (e.g. juveniles or seeds).
<span class="math display" id="eq:rv2">\[
 \tag{4.10}
  \frac{v}{v_{1}}
\]</span></p>
<p>We find the left eigenvalues and -vectors by performing eigenanalysis on the <em>transpose</em> of the transition matrix. Transposition flips rows and columns. We perform eigenanalysis, extracting just the dominant left eigenvector; we then scale it, so the stage 1 has a reproductive value of 1.0.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="DID.html#cb121-1"></a>etA &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">t</span>(A))</span>
<span id="cb121-2"><a href="DID.html#cb121-2"></a>dom.pos &lt;-<span class="st"> </span><span class="kw">which.max</span>(<span class="kw">Mod</span>(etA<span class="op">$</span>values))</span>
<span id="cb121-3"><a href="DID.html#cb121-3"></a>v1 &lt;-<span class="st"> </span><span class="kw">Re</span>(etA<span class="op">$</span>vectors[,dom.pos])</span>
<span id="cb121-4"><a href="DID.html#cb121-4"></a>( rv &lt;-<span class="st"> </span>v1<span class="op">/</span>v1[<span class="dv">1</span>] )</span></code></pre></div>
<pre><code>## [1] 1 4</code></pre>
<p>Here we see that reproductive value, <span class="math inline">\(rv\)</span>, increases with age or stage. This means that the expected reproductive value of an individual in the second stage is <code>4</code> times as great as that of an individual in the first stage. In general, reproductive value of individuals in a stage increases with increasing probability of reaching fecund stages.</p>
</div>
<div id="sensitivity-and-elasticity" class="section level3">
<h3><span class="header-section-number">4.6.6</span> Sensitivity and elasticity</h3>
<p>Sensitivity and elasticity tell us the relative importance of each transition (i.e. each arrow of the life cycle graph or element of the matrix) in determining <span class="math inline">\(\lambda\)</span>. They do so by combining information on the stable stage structure and reproductive values.</p>
<p>The stage structure and reproductive values each in their own way contribute to the importance of each stage in determining <span class="math inline">\(\lambda\)</span>. The stable stage distribution provides the relative abundance of individuals in each stage. Reproductive value provides the expected contribution to future population growth of individuals in each stage. Sensitivity and elasticity combine these to tell us the relative importance of each transition in determining <span class="math inline">\(\lambda_1\)</span>.</p>
<p>Almost always, sensitivities of a transition matrix are the sensistivities of <span class="math inline">\(\lambda_1\)</span> to the elements of the transition matrix. They are the direct contributions of each transition to determining <span class="math inline">\(\lambda_1\)</span>. The sensitivity for the element <span class="math inline">\(a_{ij}\)</span> of a transition matrix is the change in <span class="math inline">\(\lambda_1\)</span> that occurs when we change <span class="math inline">\(a_{ij}\)</span> a small amount, or <span class="math inline">\(\delta \lambda / \delta a_{ij}\)</span>. It isn’t surprising, then, these are derived from the stable stage distribution and the reproductive values. Specifically, the sensitivities are calculated as</p>
<p><span class="math display" id="eq:sens">\[
\frac{\delta \lambda}{\delta a_{ij}}=\frac{v_{i}w_{j}}{v\cdot w} 
\tag{4.11}
\]</span>
where <span class="math inline">\(v_{i}w_{j}\)</span> is the product of each pairwise combination of elements of the dominant left and right eigenvectors, <span class="math inline">\(v\)</span> and <span class="math inline">\(w\)</span>. Specifically, the numerator is generated by the reproductive value of the target stage and the stable stage distribution of the source stage,
<span class="math display">\[
\begin{pmatrix} v_1\\v_2 \end{pmatrix} \begin{pmatrix} w_1 &amp; w_2 \end{pmatrix}=
\begin{pmatrix} 
v_1 w_1 &amp; v_1 w_2 \\
v_2 w_1 &amp; v_2 w_2
\end{pmatrix}
\]</span></p>
<p>In the denominator, the <em>dot product</em>, <span class="math inline">\(\mathbf{v} \cdot \mathbf{w}\)</span>, is the sum of the pairwise products of each vector element. Dividing <span class="math inline">\(v_{i}w_{j}\)</span> by this sum causes the sensitivities to be relative to the magnitudes of <span class="math inline">\(v\)</span> and <span class="math inline">\(w\)</span>.</p>
<p>Let’s calculate sensitivities now. Because the stable stage distribution and the reproductive values are merely scaled versions of the dominant right and left eigenvectors, it doesn’t matter whether we use the unscaled eigenvectors, or the scaled stable stage distribution and reproductive values.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="DID.html#cb123-1"></a>vw &lt;-<span class="st"> </span><span class="kw">matrix</span>(rv, <span class="dt">nr=</span><span class="dv">2</span>, <span class="dt">nc=</span><span class="dv">1</span>) <span class="op">%*%</span><span class="st"> </span><span class="kw">matrix</span>(ssd, <span class="dt">nr=</span><span class="dv">1</span>, <span class="dt">nc=</span><span class="dv">2</span>) <span class="co"># or vw &lt;- v1 %*% t(w1); the numerator</span></span>
<span id="cb123-2"><a href="DID.html#cb123-2"></a>dot.prod &lt;-<span class="st"> </span><span class="kw">sum</span>(rv<span class="op">*</span>ssd) <span class="co"># or dot.prod &lt;- sum(v1 * w1) denominator</span></span>
<span id="cb123-3"><a href="DID.html#cb123-3"></a>(s &lt;-<span class="st"> </span>vw<span class="op">/</span>dot.prod)</span></code></pre></div>
<pre><code>##           [,1]      [,2]
## [1,] 0.2941176 0.1764706
## [2,] 1.1764706 0.7058824</code></pre>
<p>These are the sensitivities, <span class="math inline">\(\delta \lambda / \delta a_{ij}\)</span>, of each corresponding transition element. You will always get a sensitivity for every position in this matrix, even when the transition is zero, <span class="math inline">\(a_{ij}=0\)</span>. We just ignore those, but by convention, include them.</p>
<p>These sensitivities are the relative change in <span class="math inline">\(\lambda_1\)</span> for an absolute change in the element. For instance, it is the relative effect of increasing <span class="math inline">\(a_{21}\)</span> from 0.3 to 0.33, or <span class="math inline">\(a_{22}\)</span> from 0.7 to 0.73.</p>
<p>The largest of these sensitivities is that for is <span class="math inline">\(p_{21}\)</span>, surviving from the first stage to the second stage. This means that small changes to <span class="math inline">\(p_{21}\)</span> have large effects on <span class="math inline">\(\lambda_1\)</span> than do small changes to <span class="math inline">\(F_2\)</span> or <span class="math inline">\(p_{22}\)</span>.</p>
As <span class="math inline">\(\delta \lambda / \delta a_{ij}\)</span>, the sensitivities are the slope of the line relating the magnitude of <span class="math inline">\(\lambda_1\)</span> to the matrix element.
<div class="figure"><span id="fig:unnamed-chunk-39"></span>
<img src="figs/unnamed-chunk-39-1.png" alt="Sensitivities of lambda to transition elements are slopes. The dotted line is the calculated sensitivity of lambda to A[2,1], because it is the slope evaluated at A[2,1]." width="75%" />
<p class="caption">
Figure 4.8: Sensitivities of lambda to transition elements are slopes. The dotted line is the calculated sensitivity of lambda to A[2,1], because it is the slope evaluated at A[2,1].
</p>
</div>
<p><em>Elasticities</em> are sensitivities that have been weighted by the transition probabilities. We may, however, be interested in how a <em>proportional</em> change in a transition element influences <span class="math inline">\(\lambda_1\)</span>—how does a 10% increase in seed production, or a 10% decline in juvenile survival influence <span class="math inline">\(\lambda_1\)</span>? For these answers, we need to adjust sensitivities to account for the relative magnitudes of the transition elements, and this provides the elasticities, <span class="math inline">\(e_{ij}\)</span>. Elasticities are <em>relative sensitivities</em>, and are defined as</p>
<p><span class="math display">\[
e_{ij}=\frac{\delta \lambda/\lambda}{\delta a_{ij}/a_{ij}} = \frac{a_{ij}}{\lambda}\frac{\delta \lambda}{\delta a_{ij}}.
\]</span>
These are also equal to
<span class="math display">\[e_{ij}= \frac{\delta \log \lambda}{\delta \log a_{ij}}.\]</span>
Like sensitivities, we can think of elasticities as slopes.</p>
<p>Calculating these in R is easy.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="DID.html#cb125-1"></a>e &lt;-<span class="st"> </span>(A<span class="op">/</span>L1) <span class="op">*</span><span class="st"> </span>s</span>
<span id="cb125-2"><a href="DID.html#cb125-2"></a>(<span class="kw">round</span>(e, <span class="dv">3</span>))</span></code></pre></div>
<pre><code>##       [,1]  [,2]
## [1,] 0.000 0.294
## [2,] 0.294 0.412</code></pre>
<p>Now we see that survival by adults (<span class="math inline">\(p_{22}\)</span>) has the biggest effect on <span class="math inline">\(\lambda_1\)</span>. Why the difference between sensitivities and elasticities? Because the elasticities reflect the effect of a <em>proportional change</em> (e.g., 1%) of the elements, whereas sensitivities reflect the effect of a change by a constant amount (e.g., 0.01) of each element.</p>
<p>Note that elasticities are relative to each other, in that they sum to 1.0. This is an especially nice features of elasticities because it makes it easier to compare elasticities among differ matrices and even different organisms.</p>
<p>Once we have the sensitivities and elasticities, we can really begin to see what is controlling the growth rate of a stage (or age) structured population. Although these values do not tell us which stages and transitions will be influenced by natural phenomona or management practices, they provide us with the predicted effects on <span class="math inline">\(\lambda_1\)</span> of a proportional change in a demographic rate. This is particularly important in the management of invasive (or endangered) species where we seek to have the maximum impact for the minimum amount of effort and resources <span class="citation">(Caswell <a href="#ref-Caswell:2001gu" role="doc-biblioref">2001</a>; Ellner and Guckenheimer <a href="#ref-Ellner:2006qe" role="doc-biblioref">2006</a>)</span>.</p>
<p><em>All of these details can get very confusing</em>, and smart people don’t always get it right. Therefore, get expert advice <span class="citation">(Caswell <a href="#ref-Caswell:2001gu" role="doc-biblioref">2001</a>; Ellner and Guckenheimer <a href="#ref-Ellner:2006qe" role="doc-biblioref">2006</a>)</span>, and remember that the stages of life cycle graph and matrix are the stages that you collect at one point in time, and an arrow or transition element has to include everything that happens from one census period to the next.</p>
<hr />
<p>What do we do if our stages seem like arbitrary categories along a continuous scale? What if size is easy to measure accurately and is a really good predictor of demographic rates, and these rates vary continuously with size? How do we decide on size classes? How do we draw seemingly arbitrary divisions between different sizes?</p>
<p>With <em>integral projection</em>, as opposed to matrix projection, we no
longer have to worry about a particular number of stages or age
classes. We select an individual-level state variable, such as body mass, length, stem diameter, or even location, that is a useful predictor of
demographic rates. We use this continuously varying state variable in place of stages or age classes. We rely on statistical methods, such as linear regression, to describe the relations between the individual-level state variable and survival, growth, and fecundity. We then combine those relations to model how individuals in a population are likely to change from one generation to the next.</p>
<p>In many organisms, size is often a relatively good predictor of survival and fecundity. Within a poulation, size is often associated with age, learning, and resource acquisition. Size is also related to the onset of reproductive maturity and initiation of specific reproductive structures. Among reproductive individuals, size is often strongly correlated with per capita reproductive output. Integral projection can use size to model size-dependent demography.</p>
<p>Whereas matrix projection models use matrix algebra to project populations. Matrix algebra is mutliplication of discrete classes and summation of discrete products. Integral projection models (IPMs) use multiplication and the calculus of integration across continuous variables toward the same end.</p>
</div>
</div>
<div id="r-packges-for-demography" class="section level2">
<h2><span class="header-section-number">4.7</span> R packges for demography</h2>
<p><span class="citation">Caswell (<a href="#ref-Caswell:2001gu" role="doc-biblioref">2001</a>)</span> is a definitive reference text for matrix models. <span class="citation">Ellner and Guckenheimer (<a href="#ref-Ellner:2006qe" role="doc-biblioref">2006</a>)</span> provides an excellent introduction, and I am sure there are many other excellent texts as well.</p>
<p><span class="citation">Stubben and Milligan (<a href="#ref-Stubben:2007" role="doc-biblioref">2007</a>)</span> and <span class="citation">Stott, Hodgson, and Townley (<a href="#ref-Stott:2018" role="doc-biblioref">2018</a>)</span>, and <span class="citation">de la Cruz (<a href="#ref-delaCruz:2019" role="doc-biblioref">2019</a>)</span> provide R packages for stage-based matrix models with methods that go well beyond this text. In addition, there are several other packages for analyzing life tables and human demography.</p>
<p><span class="citation">Ellner, Childs, and Rees (<a href="#ref-Ellner:2016aa" role="doc-biblioref">2016</a>)</span> is probably the best source for understanding IPMs. The R package IPMpack <span class="citation">(Metcalf et al. <a href="#ref-Metcalf:2014ab" role="doc-biblioref">2014</a>)</span> is an excellent package to implement and analyze IPMs.</p>
</div>
<div id="exploring-a-real-population" class="section level2">
<h2><span class="header-section-number">4.8</span> Exploring a real population</h2>
<p><span class="citation">Crouse, Crowder, and Caswell (<a href="#ref-Crouse1987" role="doc-biblioref">1987</a>)</span> performed a demographic analysis of an endangered sea turtle species, the loggerhead (<em>Caretta caretta</em>). Management of loggerhead populations seemed essential for their long term survival, and a popular management strategy had been and still is to protect nesting females, eggs, and hatchlings. The ground breaking work by Crouse<a href="#fn27" class="footnote-ref" id="fnref27"><sup>27</sup></a> and her colleagues compiled data to create a stage-based projection matrix to analyze quantitatively which stages are most important and least important in influencing long-term growth rate. This work led to US Federal laws requiring that US shrimp fishermen use nets that include Turtle Excluder Devices (TEDs, <a href="https://www.fisheries.noaa.gov/southeast/bycatch/turtle-excluder-device-regulations" class="uri">https://www.fisheries.noaa.gov/southeast/bycatch/turtle-excluder-device-regulations</a> ). Crouse et al. determined a transition matrix, <strong>A</strong>, for their loggerhead population:</p>
<p><span class="math display">\[\begin{array}{c}
H\\J_s\\J_l \\sub \\ B_1 \\B_2 \\ M
\end{array}
 \left(
\begin{array}{cccccccc}
     0&amp;      0&amp;      0&amp;      0&amp;    127&amp;      4&amp; 80\\
0.6747&amp; 0.7370&amp;      0&amp;      0&amp;      0&amp;      0&amp; 0\\
     0&amp; 0.0486&amp; 0.6610&amp;      0&amp;      0&amp;      0&amp; 0\\
     0&amp;      0&amp; 0.0147&amp; 0.6907&amp;      0&amp;      0&amp; 0\\
     0&amp;      0&amp;      0&amp; 0.0518&amp;      0&amp;      0&amp; 0\\
      0&amp;      0&amp;      0&amp;      0&amp; 0.8091&amp;      0&amp; 0\\
      0&amp;      0&amp;      0&amp;      0&amp;      0&amp; 0.8091&amp; 0.8089
\end{array} 
\right)\]</span></p>
<ol style="list-style-type: decimal">
<li>Draw by hand two different types of life cycle graphs for this loggerhead population. Include the matrix elements associated with each transition.</li>
<li>Use eigenanalysis to determine <span class="math inline">\(\lambda_1\)</span>. Explain what this tells us about the population, including any assumptions regarding the stable stage distribution.</li>
<li>Use eigenanalysis to determine the stable stage distribution.</li>
<li>Use eigenanalysis to determine the elasticities. Which transition(s) are most influential in determining growth rate?</li>
<li>What is the predicted long-term relative abundance of all stages? What do we call this?</li>
<li>If your interest is to maximize long-term growth rate, in which stage(s) should you invest protection measures? Which stages are least likely to enhance long-term growth rate, regardless of protective measures?</li>
<li>Start with <span class="math inline">\(\mathbf{N} = \left(1000\,10\,10\,10\,10\,10\,10\right)\)</span> and graph dynamics for all stages for 20 years.</li>
</ol>

</div>
</div>
<h3> References</h3>
<div id="refs" class="references">
<div id="ref-Caswell:2001gu">
<p>Caswell, H. 2001. <em>Matrix Population Models: Construction, Analysis, and Interpretation</em>. 2nd ed. Sinauer Associates, Inc., Sunderland, MA, USA.</p>
</div>
<div id="ref-Crouse1987">
<p>Crouse, D T, L B Crowder, and H Caswell. 1987. “A stage-based population model for loggerhead sea turtles and implications for conservation.” <em>Ecology</em> 68: 1412–23.</p>
</div>
<div id="ref-delaCruz:2019">
<p>de la Cruz, Marcelino. 2019. <em>Rramas: Matrix Population Models</em>. <a href="https://CRAN.R-project.org/package=Rramas">https://CRAN.R-project.org/package=Rramas</a>.</p>
</div>
<div id="ref-Ellner:2006qe">
<p>Ellner, S P, and J Guckenheimer. 2006. <em>Dynamic Models in Biology</em>. Princeton University Press, Princeton, NJ.</p>
</div>
<div id="ref-Ellner:2016aa">
<p>Ellner, Stephen P., Dylan Z. Childs, and Mark Rees. 2016. <em>Data-Driven Modelling of Structured Populations: A Practical Guide to the Integral Projection Model</em>. Lecture Notes on Matehematical Modelling in the Life Sciences. Springer International Publishing.</p>
</div>
<div id="ref-Goettsch2015">
<p>Goettsch, Bárbara, Craig Hilton-Taylor, Gabriela Cruz-Piñón, James P. Duffy, Anne Frances, Héctor M. Hernández, Richard Inger, et al. 2015. “High proportion of cactus species threatened with extinction.” <em>Nature Plants</em> 1 (10): 15142.</p>
</div>
<div id="ref-Hastings2011">
<p>Hastings, A. 2011. “Single Species Population Dynamics and Its Theoretical Underpinnings.” In, edited by S. M. Scheiner and M. R. Willig. Chicago, IL, USA: University of Chicago Press.</p>
</div>
<div id="ref-Lincoln:1998ta">
<p>Lincoln, R, G Boxshall, and P Clark. 1998. <em>A Dictionary of Ecology, Evolution and Systematics</em>. 2nd ed. Cambridge University Press, Cambridge UK.</p>
</div>
<div id="ref-Metcalf:2014ab">
<p>Metcalf, C. J. E., S. M. McMahon, R. Salguero-Gomez, E. Jongejans, and C. Merow. 2014. <em>IPMpack: Builds and Analyses Integral Projection Models (Ipms).</em> <a href="https://CRAN.R-project.org/package=IPMpack">https://CRAN.R-project.org/package=IPMpack</a>.</p>
</div>
<div id="ref-Pardini:2009aa">
<p>Pardini, Eleanor A., John M. Drake, Jonathan M. Chase, and Tiffany M. Knight. n.d. “Complex population dynamics and control of the invasive biennial Alliaria petiolata (garlic mustard).” <em>ECOLOGICAL APPLICATIONS</em> 19 (2): 387–97. <a href="https://doi.org/%7B10.1890/08-0845.1%7D">https://doi.org/{10.1890/08-0845.1}</a>.</p>
</div>
<div id="ref-Stott:2018">
<p>Stott, Iain, Dave Hodgson, and Stuart Townley. 2018. <em>Popdemo: Demographic Modelling Using Projection Matrices</em>. <a href="https://CRAN.R-project.org/package=popdemo">https://CRAN.R-project.org/package=popdemo</a>.</p>
</div>
<div id="ref-Stubben:2007">
<p>Stubben, Chris J., and Brook G. Milligan. 2007. “Estimating and Analyzing Demographic Models Using the Popbio Package in R.” <em>Journal of Statistical Software</em> 22 (11).</p>
</div>
<div id="ref-Vonesh:2002fr">
<p>Vonesh, J R, and O de la Cruz. 2002. “Complex life cycles and density dependence: assessing the contribution of egg mortality to amphibian declines.” <em>Oecologia</em> 133 (3): 325–33.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="22">
<li id="fn22"><p>In his chapter entitled ``Interesting Ways to Think about Death’’ G.E. Hutchinson <span class="citation">Hutchinson (<a href="#ref-Hutchinson1978" role="doc-biblioref">1978</a>)</span> cites C.~F. Trenerry, E.~L. Gover and A.~S. Paul (<em>The Origins and Early History of Insurance</em>, London, P.~S. King &amp; Sons, Ltd.) for description of early Roman actuarial tables.<a href="DID.html#fnref22" class="footnote-back">↩︎</a></p></li>
<li id="fn23"><p>Models comprise stages and transitions.<a href="DID.html#fnref23" class="footnote-back">↩︎</a></p></li>
<li id="fn24"><p>Practice these pronunciations: <span class="math inline">\(\sigma\)</span> is sigma <span class="math inline">\(\phi\)</span> is phi or phee; <span class="math inline">\(\rho\)</span> is rho.<a href="DID.html#fnref24" class="footnote-back">↩︎</a></p></li>
<li id="fn25"><p>In structured population models, fecundity includes survival.<a href="DID.html#fnref25" class="footnote-back">↩︎</a></p></li>
<li id="fn26"><p>A is the analog of lambda.<a href="DID.html#fnref26" class="footnote-back">↩︎</a></p></li>
<li id="fn27"><p>Crouse was a graduate student at the time—graduate students are the life-blood of modern science, doing cutting edge work and pushing their fields forward.<a href="DID.html#fnref27" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="expo.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
