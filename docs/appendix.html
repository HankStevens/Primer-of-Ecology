<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>14 Appendix | Primer of Ecology using R</title>
<meta name="author" content="Hank Stevens">
<meta name="description" content="14.1 Very introductory materials About R: https://www.r-project.org/about.html Getting started on R, (R documentation): https://cran.r-project.org/doc/manuals/r-release/R-intro.html Getting...">
<meta name="generator" content="bookdown 0.23 with bs4_book()">
<meta property="og:title" content="14 Appendix | Primer of Ecology using R">
<meta property="og:type" content="book">
<meta property="og:description" content="14.1 Very introductory materials About R: https://www.r-project.org/about.html Getting started on R, (R documentation): https://cran.r-project.org/doc/manuals/r-release/R-intro.html Getting...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="14 Appendix | Primer of Ecology using R">
<meta name="twitter:description" content="14.1 Very introductory materials About R: https://www.r-project.org/about.html Getting started on R, (R documentation): https://cran.r-project.org/doc/manuals/r-release/R-intro.html Getting...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.10/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-VCV8MES4YY"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-VCV8MES4YY');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Primer of Ecology using R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="theory.html"><span class="header-section-number">1</span> Theory in Ecology</a></li>
<li><a class="" href="oft.html"><span class="header-section-number">2</span> Optimal Foraging</a></li>
<li><a class="" href="expo.html"><span class="header-section-number">3</span> Simple density-independent growth</a></li>
<li><a class="" href="DID.html"><span class="header-section-number">4</span> Density-independent Demography</a></li>
<li><a class="" href="DDgrowth.html"><span class="header-section-number">5</span> Density-dependent growth</a></li>
<li><a class="" href="meta.html"><span class="header-section-number">6</span> Populations in Space</a></li>
<li><a class="" href="direct-competition-and-mutualism.html"><span class="header-section-number">7</span> Direct competition and mutualism</a></li>
<li><a class="" href="cr.html"><span class="header-section-number">8</span> Consumer-resource Interactions</a></li>
<li><a class="" href="host-parasitoid-relations.html"><span class="header-section-number">9</span> Host-parasitoid relations</a></li>
<li><a class="" href="disease.html"><span class="header-section-number">10</span> Disease</a></li>
<li><a class="" href="consumer-resource-competition-and-mutualisms.html"><span class="header-section-number">11</span> Consumer-resource Competition and Mutualisms</a></li>
<li><a class="" href="food-webs-and-other-networks.html"><span class="header-section-number">12</span> Food webs and other networks</a></li>
<li><a class="" href="diversity.html"><span class="header-section-number">13</span> Diversity</a></li>
<li><a class="active" href="appendix.html"><span class="header-section-number">14</span> Appendix</a></li>
<li><a class="" href="references.html"><span class="header-section-number">15</span> References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="appendix" class="section level1" number="14">
<h1>
<span class="header-section-number">14</span> Appendix<a class="anchor" aria-label="anchor" href="#appendix"><i class="fas fa-link"></i></a>
</h1>
<div id="very-introductory-materials" class="section level2" number="14.1">
<h2>
<span class="header-section-number">14.1</span> Very introductory materials<a class="anchor" aria-label="anchor" href="#very-introductory-materials"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>About R: <a href="https://www.r-project.org/about.html" class="uri">https://www.r-project.org/about.html</a>
</li>
<li>Getting started on R, (R documentation): <a href="https://cran.r-project.org/doc/manuals/r-release/R-intro.html" class="uri">https://cran.r-project.org/doc/manuals/r-release/R-intro.html</a>
</li>
<li>Getting started on R interactively, using the RStudio interface: <a href="https://swirlstats.com/" class="uri">https://swirlstats.com/</a>
</li>
</ul>
<p>Here are two statistics texts, both of which have great introductory material on getting started with the R language.</p>
<ul>
<li>
<a href="http://users.miamioh.edu/fishert4/sta363/" class="uri">http://users.miamioh.edu/fishert4/sta363/</a> (a great statistics text)</li>
<li>
<a href="http://r-statistics.co/" class="uri">http://r-statistics.co/</a> (graphics and stats; has ads)</li>
</ul>
<p>Arranging and summarizing data with <code>dplyr</code>: <a href="https://cran.r-project.org/web/packages/dplyr/vignettes/dplyr.html" class="uri">https://cran.r-project.org/web/packages/dplyr/vignettes/dplyr.html</a></p>
<p><em>R is a language. Use it every day, and you will learn it quickly.</em></p>
</div>
<div id="writing-your-own-functions" class="section level2" number="14.2">
<h2>
<span class="header-section-number">14.2</span> Writing your own functions<a class="anchor" aria-label="anchor" href="#writing-your-own-functions"><i class="fas fa-link"></i></a>
</h2>
<p>One very cool thing in R is that you can write your own functions. Indeed it is the extensibility of R that makes it the home of cutting edge working, because edge cutters (i.e., leading scientists) can write code that we all can use. People actually write entire <em>packages</em>, which are integrated collections of functions, and R has been extended with hundreds of such packages available for download at all the R mirrors.</p>
<p>Let’s make our own function to calculate a mean. Let’s further pretend you work for an unethical boss who wants you to show that average sales are higher than they really are. Therefore your function should provide a mean plus 5%.</p>
<div class="sourceCode" id="cb574"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">MyBogusMean</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">cheat</span><span class="op">=</span><span class="fl">0.05</span><span class="op">)</span> <span class="op">{</span> <span class="va">SumOfX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
                             <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
                             <span class="va">trueMean</span> <span class="op">&lt;-</span> <span class="va">SumOfX</span><span class="op">/</span><span class="va">n</span> 
                           <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">cheat</span><span class="op">)</span> <span class="op">*</span> <span class="va">trueMean</span><span class="op">}</span>
<span class="va">RealSales</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">300</span><span class="op">)</span>
<span class="fu">MyBogusMean</span><span class="op">(</span><span class="va">RealSales</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 210</code></pre>
<p>Thus a function can take any input, do stuff, including produce graphics, or interact with the operating system, or manipulated numbers. You decide on the arguments of the function, in this case, <code>x</code> and <code>cheat</code>. Note that we supplied a number for <code>cheat</code>; this results in the <code>cheat</code> argument having a <em>default</em> value, and we do not have to supply it. If an argument does not have a default, we have to supply it. If there is a default value, we can change it. Now try these.</p>
<div class="sourceCode" id="cb576"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">MyBogusMean</span><span class="op">(</span><span class="va">RealSales</span>, cheat<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 220</code></pre>
<div class="sourceCode" id="cb578"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">MyBogusMean</span><span class="op">(</span><span class="va">RealSales</span>, cheat<span class="op">=</span><span class="fl">0</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 200</code></pre>
</div>
<div id="iterated-actions-the-apply-family-and-loops" class="section level2" number="14.3">
<h2>
<span class="header-section-number">14.3</span> Iterated Actions: the <code>apply</code> Family and Loops<a class="anchor" aria-label="anchor" href="#iterated-actions-the-apply-family-and-loops"><i class="fas fa-link"></i></a>
</h2>
<p>We often want to perform an action again and again and again…, perhaps thousands or millions of times. In some cases, each action is independent — we just want to do it a lot. In these cases, we have a choice of methods. Other times, each action depends on the previous action. In this case, I always use for-loops.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;There are other methods we could use. These are discussed by others, under various topics, including “flow control.” We use ODE solvers for continuous ordinary differential equations.&lt;/p&gt;"><sup>82</sup></a> Here I discuss first methods that work only for independent actions.</p>
<div id="iterations-of-independent-actions" class="section level3" number="14.3.1">
<h3>
<span class="header-section-number">14.3.1</span> Iterations of independent actions<a class="anchor" aria-label="anchor" href="#iterations-of-independent-actions"><i class="fas fa-link"></i></a>
</h3>
<p>Imagine that we have a matrix or data frame and we want to do the same thing to each column (or row). For this we use apply, to “apply” a function to each column (or row). We tell <code>apply</code> what data we want to use, we tell it the “margin” we want to focus on, and then we tell it the function. The <em>margin</em> is the <em>side</em> of the matrix. We describe matrices by their number of rows, then columns, as in “a 2 by 5 matrix,” so rows constitute the first margin, and columns constitute the second margin. Here we create a <span class="math inline">\(2 \times 5\)</span> matrix, and take the mean of rows, for the first margin. Then we sum the columns for the second margin.</p>
<div class="sourceCode" id="cb580"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="va">m</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    3    5    7    9
## [2,]    2    4    6    8   10</code></pre>
<div class="sourceCode" id="cb582"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">m</span>, MARGIN<span class="op">=</span><span class="fl">1</span>, <span class="va">mean</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 5 6</code></pre>
<div class="sourceCode" id="cb584"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">m</span>, MARGIN<span class="op">=</span><span class="fl">2</span>, <span class="va">sum</span><span class="op">)</span></code></pre></div>
<pre><code>## [1]  3  7 11 15 19</code></pre>
<p>See <code><a href="https://rdrr.io/r/base/colSums.html">?rowMeans</a></code> for simple, and even faster, operations.</p>
<p>Similarly, <code>lapply</code> will “apply” a function to each element of a list, or each column of a data frame, and always returns a list. The function <code>sapply</code> does something similar, but will simplify the result, to a less complex data structure if possible.</p>
<p>Here we do an independent operation 10 times using <code>sapply</code>, defining a function on-the-fly to calculate the mean of a random draw of five observations from the standard normal distribution.</p>
<div class="sourceCode" id="cb586"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span> <span class="op">)</span> <span class="op">)</span></code></pre></div>
<pre><code>##  [1] -0.08837270 -0.06003405 -0.39673085  0.48373156  0.55228638 -0.47503345
##  [7]  0.64569465  0.36796809  0.25172968  0.71059443</code></pre>
</div>
<div id="dependent-iterations" class="section level3" number="14.3.2">
<h3>
<span class="header-section-number">14.3.2</span> Dependent iterations<a class="anchor" aria-label="anchor" href="#dependent-iterations"><i class="fas fa-link"></i></a>
</h3>
<p>Often the repeated actions depend on previous outcomes, as with
population growth. Here we provide a couple of examples where we accomplish this with <em>for loops</em>.</p>
<p>One thing to keep in mind for <em>for loops</em> in R is that the computation of this is fastest if we first make a holder for the output. Here I simulate a random walk, where, for instance, we start with 25 individuals at time = 0, and increase or decrease by some amount that is drawn randomly from a normal distribution, with a mean of zero and a standard deviation 2. We will round the “amount” to the nearest integer (the zero-th decimal place). Your output will differ because it is a random process.</p>
<div class="sourceCode" id="cb588"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gens</span> <span class="op">&lt;-</span> <span class="fl">10</span>
<span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="va">gens</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">output</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">25</span>
<span class="kw">for</span><span class="op">(</span> <span class="va">t</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">gens</span> <span class="op">)</span> <span class="va">output</span><span class="op">[</span><span class="va">t</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">output</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">1</span>, mean<span class="op">=</span><span class="fl">0</span>, sd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span>
<span class="va">output</span></code></pre></div>
<pre><code>##  [1] 25 26 26 25 24 28 27 26 25 25 27</code></pre>
</div>
</div>
<div id="probability-distributions-and-randomization" class="section level2" number="14.4">
<h2>
<span class="header-section-number">14.4</span> Probability Distributions and Randomization<a class="anchor" aria-label="anchor" href="#probability-distributions-and-randomization"><i class="fas fa-link"></i></a>
</h2>
<p>R has a variety of probability distributions built-in. For the normal distribution, for instance, there are four functions.</p>
<ul>
<li>
<code>dnorm</code> The probability density function, that creates the widely observed bell-shaped curve.</li>
<li>
<code>pnorm</code> The cumulative probability function that we usually use to describe the probability that a test statistic is greater than or equal to a critical value.</li>
<li>
<code>qnorm</code> The quantile function that takes probabilities as input.</li>
<li>
<code>rnorm</code> A random number generator which draws values (quantiles) from a distribution with a specified mean and standard deviation.</li>
</ul>
<p>For each of these, default parameter values return the standard normal distribution (<span class="math inline">\(\mu=0\)</span>, <span class="math inline">\(Sigma=1\)</span>), but these parameters can be changed.</p>
<p>Here we have the 95% confidence intervals.</p>
<div class="sourceCode" id="cb590"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span>p<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>,<span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] -1.959964  1.959964</code></pre>
<p>Next we create a histogram using 20 random draws from a normal
distribution with a mean of 11 and a standard deviation of 6; we overlay this with the probability density function (Fig. <a href="appendix.html#fig:myhist">14.1</a>).</p>
<div class="sourceCode" id="cb592"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, m<span class="op">=</span><span class="fl">11</span>, sd<span class="op">=</span><span class="fl">6</span><span class="op">)</span>, probability<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="va">myplot</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">myplot</span><span class="op">$</span><span class="va">mids</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">myplot</span><span class="op">$</span><span class="va">mids</span>, m<span class="op">=</span><span class="fl">11</span>, sd<span class="op">=</span><span class="fl">6</span><span class="op">)</span> <span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:myhist"></span>
<img src="figs/myhist-1.png" alt="*Histogram of random numbers drawn from a normal distribution with $\mu=11$ and $\sigma=6$. The normal probability density function is drawn as well.*" width="90%"><p class="caption">
Figure 14.1: <em>Histogram of random numbers drawn from a normal distribution with <span class="math inline">\(\mu=11\)</span> and <span class="math inline">\(\sigma=6\)</span>. The normal probability density function is drawn as well.</em>
</p>
</div>
</div>
<div id="numerical-integration-of-ordinary-differential-equations" class="section level2" number="14.5">
<h2>
<span class="header-section-number">14.5</span> Numerical integration of ordinary differential equations<a class="anchor" aria-label="anchor" href="#numerical-integration-of-ordinary-differential-equations"><i class="fas fa-link"></i></a>
</h2>
<p>In order to study continuous population dynamics, we often would like to integrate complex nonlinear functions of population dynamics. To do this, we need to use numerical techniques that turn the infinitely small steps of calculus, <span class="math inline">\(\d x\)</span>, into very small, but finite steps, in order to approximate the change in <span class="math inline">\(y\)</span>, given the change in <span class="math inline">\(x\)</span>, or <span class="math inline">\(dy/dx\)</span>. Mathematicians and computer scientists have devised very clever ways of doing this very accurately and precisely. In R, the best package for this is <code>deSolve</code>, which contains several <em>solvers</em> for differential equations that perform numerical integration. We will access these solvers (i.e. numerical integraters) using the <code>ode</code> function in the <code>deSolve</code> package. This function, <code>ode</code>, is a “wrapper” for the underlying suite of functions that do the work. That is, it provides a simple way to use any one of the small suite of functions.</p>
<p>When we have an ordinary differential equation (ODE) such as logistic growth, <span class="math inline">\(dN/dt = rN(1-\alpha N)\)</span>, we say that we “solve” the equation for a particular time interval given a set of parameters and initial conditions or initial population size. For instance, we say that we solve the logistic growth model for time at <span class="math inline">\(t=0,\, 1 \ldots \, 20\)</span>, with parameters <span class="math inline">\(r=1\)</span>, <span class="math inline">\(\alpha=0.001\)</span>, and <span class="math inline">\(N_0=10\)</span>.</p>
<p>Let’s do an example with <code>ode</code>, using logistic growth. We first have to define a function in a particular way. The arguments for the function must be time, a vector of populations, and a vector or list of model parameters.</p>
<div class="sourceCode" id="cb593"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">logGrowth</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">y</span>, <span class="va">p</span><span class="op">)</span><span class="op">{</span>
  <span class="va">N</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
  <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>, <span class="op">{</span>
    <span class="va">dN.dt</span> <span class="op">&lt;-</span> <span class="va">r</span> <span class="op">*</span> <span class="va">N</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">a</span> <span class="op">*</span> <span class="va">N</span><span class="op">)</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> <span class="va">dN.dt</span> <span class="op">)</span> <span class="op">)</span>
  <span class="op">}</span> <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Note that I like to convert <span class="math inline">\(y\)</span> into a readable or transparent state variable (<span class="math inline">\(N\)</span> in this case). I also like to use <code>with</code> which allows me to use the names of my parameters <span class="citation">(<a href="references.html#ref-Petzoldt:2003dp" role="doc-biblioref">Petzoldt 2003</a>)</span>; this works only is <code>p</code> is a vector with named paramters (see below). Finally, we return the derivative as a list of one component.</p>
<p>The following is equivalent, but slightly less readable or transparent.</p>
<div class="sourceCode" id="cb594"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">logGrowth</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">y</span>, <span class="va">p</span><span class="op">)</span><span class="op">{</span>
    <span class="va">dN.dt</span> <span class="op">&lt;-</span> <span class="va">p</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> <span class="va">dN.dt</span> <span class="op">)</span> <span class="op">)</span>
  <span class="op">}</span></code></pre></div>
<p>This requires that the order of the parameters is expected, that <span class="math inline">\(r\)</span> is first and <span class="math inline">\(\alpha\)</span> is second.</p>
<p>To solve the ODE, we will need to specify parameters, and initial conditions. Because we are using a vector of named parameters, we need to make sure we name them! We also need to supply the time steps we want.</p>
<div class="sourceCode" id="cb595"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>r<span class="op">=</span><span class="fl">1</span>, a <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="va">y0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>N<span class="op">=</span><span class="fl">10</span><span class="op">)</span>
<span class="va">t</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span></code></pre></div>
<p>Now you put it all into <code>ode</code>, with the correct arguments. The output is a matrix, with the first column being the time steps, and the remaining being your state variables. First we load the <code>deSolve</code> package.</p>
<div class="sourceCode" id="cb596"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://desolve.r-forge.r-project.org/">deSolve</a></span><span class="op">)</span>
<span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/deSolve/man/ode.html">ode</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">y0</span>, times<span class="op">=</span><span class="va">t</span>, func<span class="op">=</span><span class="va">logGrowth</span>, parms<span class="op">=</span><span class="va">p</span><span class="op">)</span>
<span class="va">out</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span></code></pre></div>
<pre><code>##      time         N
## [1,]    1  10.00000
## [2,]    2  26.72369
## [3,]    3  69.45310
## [4,]    4 168.66426
## [5,]    5 355.46079</code></pre>
<div class="sourceCode" id="cb598"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="figs/unnamed-chunk-276-1.png" width="90%"></div>
<p>If you are going to model more than two species, y becomes a vector of length 2. Here we create a function for Lotka-Volterra competition, where
<span class="math display">\[\frac{d N_1}{d t} = r_1 N_1\left(1 - \alpha_{11} N_1 - \alpha_{12} N_2 \right)\]</span>
<span class="math display">\[\frac{d N_2}{d t} = r_2N_2\left(1 - \alpha_{22}N_2 - \alpha_{21}N_1 \right)\]</span></p>
<div class="sourceCode" id="cb599"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">LVComp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">y</span>, <span class="va">p</span><span class="op">)</span><span class="op">{</span>
  <span class="va">N</span> <span class="op">&lt;-</span> <span class="va">y</span>
  <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>, <span class="op">{</span>
    <span class="va">dN1.dt</span> <span class="op">&lt;-</span> <span class="va">r</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">N</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">a</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">N</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">a</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">N</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>
    <span class="va">dN2.dt</span> <span class="op">&lt;-</span> <span class="va">r</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">N</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">a</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">N</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">a</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">N</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">dN1.dt</span>, <span class="va">dN2.dt</span><span class="op">)</span> <span class="op">)</span> <span class="op">)</span>
  <span class="op">}</span> <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Note that <code>LVComp</code> assumes that <span class="math inline">\(N\)</span> and <span class="math inline">\(r\)</span> are vectors, and the competition coefficients are in a matrix. For instance, the function extracts the the first element of <code>r</code> for the first species (<code>r[1]</code>); for the intraspecific competition coefficient for species 1, it uses the element of <code>a</code> that is in the first column and first row (<code>a[1,1]</code>). The vector of population sizes, <span class="math inline">\(N\)</span>, contains one value for each population <em>at one time point</em>. Thus here, the vector contains only two elements (one for each of the two species); it holds only these values, but will do so repeatedly, at each time point. Only the output will contain all of the population sizxes through time.</p>
<p>To integrate these populations, we need to specify new initial conditions, and new parameters for the two-species model.</p>
<div class="sourceCode" id="cb600"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.02</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span>, <span class="fl">0.03</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">a</span><span class="op">)</span>
<span class="va">N0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span>
<span class="va">t2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">20</span><span class="op">)</span>
<span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/deSolve/man/ode.html">ode</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">N0</span>, times<span class="op">=</span><span class="va">t2</span>, func<span class="op">=</span><span class="va">LVComp</span>, parms<span class="op">=</span><span class="va">p2</span><span class="op">)</span>
<span class="va">out</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="op">]</span></code></pre></div>
<pre><code>##      time        1        2
## [1,]    1 10.00000 10.00000
## [2,]    5 35.53914 21.79929
## [3,]   10 39.61141 20.35672
## [4,]   20 39.99332 20.00667</code></pre>
<div class="sourceCode" id="cb602"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="figs/unnamed-chunk-278-1.png" width="90%"></div>
<p>The <code>ode</code> function is a wrapper for a variety of ODE solvers; the default <code>lsoda</code> is a well tested tool. In addition, it has several bells and whistles that we will not need to take advantage of here, although I will mention one,<code>hmax</code>. This tells <code>lsoda</code> the largest step it can take. Once in a great while, with a very <em>stiff</em> ODE (a very wiggly complex dynamic), ODE assumes it can take a bigger step than it should. Setting <code>hmax</code> to a smallish number will limit the size of the step to help ensure that the integration proceeds as it should.</p>
<p>One of the other solvers in the <code>deSolve</code>, <code>lsodar</code>, will also return roots (or equilibria), for a system of ODEs, if they exist. Here we find the roots (i.e. the solutions, or equilibria) for a two species enemy-victim model.</p>
<div class="sourceCode" id="cb603"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">EV</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">y</span>, <span class="va">p</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>, <span class="op">{</span>
    <span class="va">dv.dt</span> <span class="op">&lt;-</span> <span class="va">b</span> <span class="op">*</span> <span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fl">.005</span><span class="op">*</span><span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="va">a</span><span class="op">*</span><span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">y</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
    <span class="va">de.dt</span> <span class="op">&lt;-</span><span class="va">a</span><span class="op">*</span><span class="va">e</span><span class="op">*</span><span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">y</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">s</span><span class="op">*</span><span class="va">y</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">dv.dt</span>, <span class="va">de.dt</span><span class="op">)</span> <span class="op">)</span> <span class="op">)</span>
  <span class="op">}</span> <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>To use <code>lsodar</code> to find equilibria, we need to specify a root finding function whose inputs are are the sme of the ODE function, and which returns a scalar (a single number) that determines whether the rate of change (<span class="math inline">\(dy/dx\)</span>) is sufficiently close to zero that we can say that the system has stopped changed, that is, has reached a steady state or equilibrium. Here we sum the absolute rates of change of each species, and then subtract 10<span class="math inline">\(^{-10}\)</span>; if that difference is zero, we decide that, for all pratcial purposes, the system has stopped changing.</p>
<div class="sourceCode" id="cb604"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rootfun</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">t</span>,<span class="va">y</span>,<span class="va">p</span><span class="op">)</span> <span class="op">{</span> 
<span class="va">dstate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu">EV</span><span class="op">(</span><span class="va">t</span>,<span class="va">y</span>,<span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="co">#rate of change vector </span>
<span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">dstate</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fl">1e-10</span><span class="op">)</span> 
<span class="op">}</span> </code></pre></div>
<p>Note that <code>unlist</code> changes the <code>list</code> returned by <code>EV</code> into a simple vector, which can then be summed.</p>
<p>Next we specify parameters, and time. Here all we want is the root, so we specify that we want the value of <span class="math inline">\(y\)</span> after a really long time (<span class="math inline">\(t=10^{10}\)</span>). The <code>lsodar</code> function will stop sooner than that, and return the equilibrium it finds, and the time step at which it occurred.</p>
<div class="sourceCode" id="cb605"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>b <span class="op">=</span> <span class="fl">0.5</span>, a <span class="op">=</span> <span class="fl">0.02</span>, e<span class="op">=</span><span class="fl">0.1</span>, s<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span>
<span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1e10</span><span class="op">)</span></code></pre></div>
<p>Now we run the function.</p>
<div class="sourceCode" id="cb606"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/deSolve/man/ode.html">ode</a></span><span class="op">(</span>y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">45</span>,<span class="fl">200</span><span class="op">)</span>, <span class="va">t</span>, <span class="va">EV</span>, parms<span class="op">=</span><span class="va">p</span>, rootfun<span class="op">=</span><span class="va">rootfun</span>, method<span class="op">=</span><span class="st">"lsodar"</span><span class="op">)</span>
<span class="va">out</span><span class="op">[</span>,<span class="op">]</span></code></pre></div>
<pre><code>##          time   1     2
## [1,]   0.0000  45 200.0
## [2,] 500.8094 100  12.5</code></pre>
<p>Here we see that the steady state population sizes are <span class="math inline">\(V=100\)</span> and <span class="math inline">\(E=12.5\)</span>, and that given our starting point, this steady state was achieved at <span class="math inline">\(t=500.8\)</span>. Other information is available; see <code><a href="https://rdrr.io/pkg/deSolve/man/lsodar.html">?lsodar</a></code> after loading the <code>deSolve</code> package.</p>
<p>We can also find the equilibrium or steady state using the <code>rootSolve</code> package.</p>
<div class="sourceCode" id="cb608"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">rootSolve</span><span class="op">)</span>
<span class="va">equil</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rootSolve/man/runsteady.html">runsteady</a></span><span class="op">(</span>y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">45</span>,<span class="fl">200</span><span class="op">)</span>, times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1E5</span><span class="op">)</span>, func<span class="op">=</span><span class="va">EV</span>, parms<span class="op">=</span><span class="va">p</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">equil</span><span class="op">$</span><span class="va">y</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 100.0  12.5</code></pre>
</div>
<div id="eigenanalysis-1" class="section level2" number="14.6">
<h2>
<span class="header-section-number">14.6</span> Eigenanalysis<a class="anchor" aria-label="anchor" href="#eigenanalysis-1"><i class="fas fa-link"></i></a>
</h2>
<p>Performing eigenanalysis in R is easy. We use the  function which returns a list with two components. The first named component is a vector of eigenvalues and the second named component is a matrix of corresponding eigenvectors. These will be numeric if possible, or complex, if any of the elements are complex numbers.</p>
<p>Here we have a typical demographic stage matrix.</p>
<div class="sourceCode" id="cb610"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.1</span>, <span class="fl">10</span>, <span class="fl">.5</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="va">eig.A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">eig.A</span><span class="op">)</span></code></pre></div>
<pre><code>## List of 2
##  $ values : num [1:2] 1.281 -0.781
##  $ vectors: num [1:2, 1:2] -0.9919 -0.127 -0.997 0.0778
##  - attr(*, "class")= chr "eigen"</code></pre>
<p>Singular value decomposition (SVD) is a generalization of eigenanalysis and is used in R for some applications where eigenanalysis was used historically, but where SVD is more numerically accurate ( for principle components analysis).</p>
<div id="eigenanalysis-of-demographic-versus-jacobian-matrices" class="section level3" number="14.6.1">
<h3>
<span class="header-section-number">14.6.1</span> Eigenanalysis of demographic versus Jacobian matrices<a class="anchor" aria-label="anchor" href="#eigenanalysis-of-demographic-versus-jacobian-matrices"><i class="fas fa-link"></i></a>
</h3>
<p>Eigenanalyses of demographic and Jacobian matrices are worth comparing. In one sense, they have similar meanings — they both describe the asymptotic (long-term) properties of a system, either population size (demographic matrix) or a perturbation at an equilibrium. The quantitative interpretation of the eigenvalues will therefore differ.</p>
<p>In the case of the stage (or age) structured demographic model, the elements of the demographic matrix are discrete per capita increments of change over a specified time interval. This is directly analogous to the finite rate of increase, <span class="math inline">\(\lambda\)</span>, in discrete unstructured models. (Indeed, an unstructured discrete growth model is a stage-structured model with one stage). Therefore, the eigenvalues of a demographic matrix will have the same units — a per capita increment of change. That is why the dominant eigenvalue has to be greater than 1.0 for the population to increase, and less than 1 (not merely less than zero) for the population to decline.</p>
<p>In the case of the Jacobian matrix, comprised of continuous partial differential equations, the elements are per capita <em>instantaneous</em> rates of change. As differential equations, they describe the <em>instantanteous</em> rates of change, analogous to <span class="math inline">\(r\)</span>. Therefore, values greater than zero indicate increases, and values less than zero indicate decreases. Because these rates are evaluated at an equilibrium, the equilibrium acts like a new zero — positive values indicate growth away from the equilibrium, and negative values indicate shrinkage back toward the equilibrium. When we evaluate these elements at the equilibrium, the numbers we get are in the same units as <span class="math inline">\(r\)</span>, where values greater than zero indicate increase, and values less than zero indicate decrease. The change they describe is the instantaneous per capita rate of change of each population with respect to the others. The eigenvalues summarizing all of the elements Jacobian matrix thus must be less than zero for the disturbance to decline.</p>
<p>So, in summary, the elements of a demographic matrix are discrete increments over a real time interval. Therefore its eigenvalues represent relative per capita growth rates a discrete time interval, and we interpret the eigenvalues with respect to 1.0. On the other hand, the elements of the Jacobian matrix are instantaneous per captia rates of change evaluated at an equilibrium. Therefore its eigenvalues represent the per capita <em>instantaneous</em> rates of change of a tiny perturbation at the equilibrium. We interpret the eigenvalues with respect to 0 indicating whether the perturbation grows or shrinks.</p>
</div>
</div>
<div id="derivation-of-the-right-eigenvalues" class="section level2" number="14.7">
<h2>
<span class="header-section-number">14.7</span> Derivation of the right eigenvalues<a class="anchor" aria-label="anchor" href="#derivation-of-the-right-eigenvalues"><i class="fas fa-link"></i></a>
</h2>
<p><span class="math display">\[\begin{align*}
Aw &amp;=\lambda w\\
Aw-\lambda w &amp;=0\\
Aw - \lambda I w  &amp;=\mathbf{0} \\
\left(A - \lambda I\right)w  &amp;=0 
\end{align*}\]</span></p>
<p>By rules of determinants, it follows then that,
<span class="math display">\[\mathrm{det} \left| A - \lambda I \right| =0\]</span></p>
<p>And here is an empirical example.</p>
<div class="sourceCode" id="cb612"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">$</span><span class="va">values</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">$</span><span class="va">vectors</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>
<span class="va">I</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">*</span><span class="va">w</span> <span class="op">-</span> <span class="va">A</span><span class="op">%*%</span><span class="va">w</span>, <span class="fl">4</span><span class="op">)</span></code></pre></div>
<pre><code>##      [,1]
## [1,]    0
## [2,]    0</code></pre>
<div class="sourceCode" id="cb614"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">*</span><span class="va">I</span><span class="op">%*%</span><span class="va">w</span> <span class="op">-</span> <span class="va">A</span><span class="op">%*%</span><span class="va">w</span>, <span class="fl">4</span><span class="op">)</span></code></pre></div>
<pre><code>##      [,1]
## [1,]    0
## [2,]    0</code></pre>
<div class="sourceCode" id="cb616"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="va">lambda</span><span class="op">*</span><span class="va">I</span> <span class="op">-</span> <span class="va">A</span><span class="op">)</span><span class="op">%*%</span><span class="va">w</span>, <span class="fl">4</span><span class="op">)</span></code></pre></div>
<pre><code>##      [,1]
## [1,]    0
## [2,]    0</code></pre>
<div class="sourceCode" id="cb618"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/det.html">det</a></span><span class="op">(</span> <span class="va">lambda</span><span class="op">*</span><span class="va">I</span><span class="op">-</span><span class="va">A</span> <span class="op">)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>Once we know that the determinant is zero, we can use that to create a simple quadratic equation in terms of <span class="math inline">\(\lambda\)</span>, and then solve. First, let’s remember what the above difference is:
<span class="math display">\[\mathbf{A} - \lambda\mathbf{I} = \begin{pmatrix} 
a-\lambda &amp; b \\
c &amp; d - \lambda
\end{pmatrix}\]</span></p>
<p>Then we can use the determinant to solve for lambda.
<span class="math display">\[ \mathrm{det} \begin{pmatrix} 
a-\lambda &amp; b \\
c &amp; d - \lambda
\end{pmatrix} = (a-\lambda)(d-\lambda) - bc = 0\]</span>
<span class="math display">\[\lambda^2 - (a+d)\lambda + (ad-bc) = 0\]</span>
<span class="math display">\[\lambda = \frac{-(a+d) \pm \sqrt{(a+d)^2 - 4(ad-bc)}}{2}\]</span>
And that is one way to find the two eigenvalues of a <span class="math inline">\(2 \times 2\)</span> matrix, whether it is a demographic projection matrix, predator-prey interaction matrix, or something else.</p>
</div>
<div id="symbols-used-in-this-book" class="section level2" number="14.8">
<h2>
<span class="header-section-number">14.8</span> Symbols used in this book<a class="anchor" aria-label="anchor" href="#symbols-used-in-this-book"><i class="fas fa-link"></i></a>
</h2>
<p>I am convinced that one of the biggest hurdles to learning theoretical ecology — and the one that is easiest to overcome — is to be able to “read” and hear them in your head. This requires being able to pronounce Greek symbols. Few of us learned how to pronounce <span class="math inline">\(\alpha\)</span> in primary school. Therefore, I provide here an incomplete simplistic American English pronunciation guide for (some of) the rest of us, for symbols in this book. Only a few are tricky, and different people will pronounce them differently.</p>
<p>Symbols and their pronunciation; occasional usage applies to lowercase, unless otherwise specified. A few symbols have common variants. Any symbol might be part of any equation; ecologists frequently ascribe other meanings which have to be defined each time they are used.</p>
<div class="inline-table"><table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:greek">Table 14.1: </span>Symbols and their pronunciation; occasional usage applies to lowercase, unless otherwise specified. A few symbols have common variants. Any symbol might be part of any equation; ecologists frequently ascribe other meanings which have to be defined each time they are used.
</caption>
<thead><tr>
<th style="text-align:left;">
Greek Symbol
</th>
<th style="text-align:left;">
Spelling and pronunciation
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
A, <span class="math inline">\(\alpha\)</span>
</td>
<td style="text-align:left;">
alpha; al’-fa; point or local diversity (or a parameter in the logseries abundance distribution)
</td>
</tr>
<tr>
<td style="text-align:left;">
B, <span class="math inline">\(\beta\)</span>
</td>
<td style="text-align:left;">
beta; bay’-ta; turnover diversity
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\mathrm{\Gamma}\)</span>, <span class="math inline">\(\gamma\)</span>
</td>
<td style="text-align:left;">
gamma; gam’-ma; regional diversity
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\mathrm{\Delta}\)</span>, <span class="math inline">\(\delta\)</span>, <span class="math inline">\(\partial\)</span>
</td>
<td style="text-align:left;">
delta; del’-ta; change or difference
</td>
</tr>
<tr>
<td style="text-align:left;">
E, <span class="math inline">\(\epsilon\)</span>, <span class="math inline">\(\varepsilon\)</span>
</td>
<td style="text-align:left;">
epsilon; ep’-si-lon; error
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\mathrm{\Theta}\)</span>, <span class="math inline">\(\theta\)</span>
</td>
<td style="text-align:left;">
theta; thay’-ta (‘th’ as in ‘thanks’); in neutral theory, biodiversity
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\mathrm{\Lambda}\)</span>, <span class="math inline">\(\lambda\)</span>
</td>
<td style="text-align:left;">
lambda; lam’-da; eigenvalues, and finite rate of increase
</td>
</tr>
<tr>
<td style="text-align:left;">
M, <span class="math inline">\(\mu\)</span>
</td>
<td style="text-align:left;">
mu; meeoo, myou; mean
</td>
</tr>
<tr>
<td style="text-align:left;">
N, <span class="math inline">\(\nu\)</span>
</td>
<td style="text-align:left;">
nu; noo, nou
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\mathrm{\Pi}\)</span>, <span class="math inline">\(\pi\)</span>
</td>
<td style="text-align:left;">
pi; pie; uppercase for product (of the elements of a vector)
</td>
</tr>
<tr>
<td style="text-align:left;">
P, <span class="math inline">\(\rho\)</span>
</td>
<td style="text-align:left;">
rho; row (as in ‘a boat’); correlation
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\mathrm{\Sigma}\)</span>, <span class="math inline">\(\sigma\)</span>, <span class="math inline">\(\varsigma\)</span>
</td>
<td style="text-align:left;">
sigma; sig’-ma; standard deviation (uppercase is used for summation)
</td>
</tr>
<tr>
<td style="text-align:left;">
T, <span class="math inline">\(\tau\)</span>
</td>
<td style="text-align:left;">
tau; (sounds like what you say when you stub your toe - ‘Ow!’ but with a ‘t’).
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\Phi\)</span>, <span class="math inline">\(\phi\)</span>
</td>
<td style="text-align:left;">
phi; fie, figh
</td>
</tr>
<tr>
<td style="text-align:left;">
X, <span class="math inline">\(\chi\)</span>
</td>
<td style="text-align:left;">
chi; kie, kigh
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\mathrm{\Psi}\)</span>, <span class="math inline">\(\psi\)</span>
</td>
<td style="text-align:left;">
psi; sie, sigh
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\mathrm{\Omega}\)</span>, <span class="math inline">\(\omega\)</span>
</td>
<td style="text-align:left;">
omega; oh-may’-ga; degree of omnivory
</td>
</tr>
</tbody>
</table></div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="diversity.html"><span class="header-section-number">13</span> Diversity</a></div>
<div class="next"><a href="references.html"><span class="header-section-number">15</span> References</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#appendix"><span class="header-section-number">14</span> Appendix</a></li>
<li><a class="nav-link" href="#very-introductory-materials"><span class="header-section-number">14.1</span> Very introductory materials</a></li>
<li><a class="nav-link" href="#writing-your-own-functions"><span class="header-section-number">14.2</span> Writing your own functions</a></li>
<li>
<a class="nav-link" href="#iterated-actions-the-apply-family-and-loops"><span class="header-section-number">14.3</span> Iterated Actions: the apply Family and Loops</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#iterations-of-independent-actions"><span class="header-section-number">14.3.1</span> Iterations of independent actions</a></li>
<li><a class="nav-link" href="#dependent-iterations"><span class="header-section-number">14.3.2</span> Dependent iterations</a></li>
</ul>
</li>
<li><a class="nav-link" href="#probability-distributions-and-randomization"><span class="header-section-number">14.4</span> Probability Distributions and Randomization</a></li>
<li><a class="nav-link" href="#numerical-integration-of-ordinary-differential-equations"><span class="header-section-number">14.5</span> Numerical integration of ordinary differential equations</a></li>
<li>
<a class="nav-link" href="#eigenanalysis-1"><span class="header-section-number">14.6</span> Eigenanalysis</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#eigenanalysis-of-demographic-versus-jacobian-matrices"><span class="header-section-number">14.6.1</span> Eigenanalysis of demographic versus Jacobian matrices</a></li></ul>
</li>
<li><a class="nav-link" href="#derivation-of-the-right-eigenvalues"><span class="header-section-number">14.7</span> Derivation of the right eigenvalues</a></li>
<li><a class="nav-link" href="#symbols-used-in-this-book"><span class="header-section-number">14.8</span> Symbols used in this book</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Primer of Ecology using R</strong>" was written by Hank Stevens. It was last built on 2021-09-10.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
