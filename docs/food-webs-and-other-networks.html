<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>12 Food webs and other networks | Primer of Ecology using R</title>
<meta name="author" content="Hank Stevens">
<meta name="description" content="A food web is a real or a model of a set of feeding relations among species or functional groups. This chapter has two foci, (i) a very brief introduction to multi-species webs as networks, and...">
<meta name="generator" content="bookdown 0.23 with bs4_book()">
<meta property="og:title" content="12 Food webs and other networks | Primer of Ecology using R">
<meta property="og:type" content="book">
<meta property="og:description" content="A food web is a real or a model of a set of feeding relations among species or functional groups. This chapter has two foci, (i) a very brief introduction to multi-species webs as networks, and...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="12 Food webs and other networks | Primer of Ecology using R">
<meta name="twitter:description" content="A food web is a real or a model of a set of feeding relations among species or functional groups. This chapter has two foci, (i) a very brief introduction to multi-species webs as networks, and...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.10/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-VCV8MES4YY"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-VCV8MES4YY');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Primer of Ecology using R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="theory.html"><span class="header-section-number">1</span> Theory in Ecology</a></li>
<li><a class="" href="oft.html"><span class="header-section-number">2</span> Optimal Foraging</a></li>
<li><a class="" href="expo.html"><span class="header-section-number">3</span> Simple density-independent growth</a></li>
<li><a class="" href="DID.html"><span class="header-section-number">4</span> Density-independent Demography</a></li>
<li><a class="" href="DDgrowth.html"><span class="header-section-number">5</span> Density-dependent growth</a></li>
<li><a class="" href="meta.html"><span class="header-section-number">6</span> Populations in Space</a></li>
<li><a class="" href="direct-competition-and-mutualism.html"><span class="header-section-number">7</span> Direct competition and mutualism</a></li>
<li><a class="" href="cr.html"><span class="header-section-number">8</span> Consumer-resource Interactions</a></li>
<li><a class="" href="host-parasitoid-relations.html"><span class="header-section-number">9</span> Host-parasitoid relations</a></li>
<li><a class="" href="disease.html"><span class="header-section-number">10</span> Disease</a></li>
<li><a class="" href="consumer-resource-competition-and-mutualisms.html"><span class="header-section-number">11</span> Consumer-resource Competition and Mutualisms</a></li>
<li><a class="active" href="food-webs-and-other-networks.html"><span class="header-section-number">12</span> Food webs and other networks</a></li>
<li><a class="" href="diversity.html"><span class="header-section-number">13</span> Diversity</a></li>
<li><a class="" href="appendix.html"><span class="header-section-number">14</span> Appendix</a></li>
<li><a class="" href="references.html"><span class="header-section-number">15</span> References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="food-webs-and-other-networks" class="section level1" number="12">
<h1>
<span class="header-section-number">12</span> Food webs and other networks<a class="anchor" aria-label="anchor" href="#food-webs-and-other-networks"><i class="fas fa-link"></i></a>
</h1>
<p>A food web is a real or a model of a <em>set of feeding relations among species or functional groups</em>. This chapter has two foci, (i) a very brief introduction to multi-species webs as networks, and (ii) a re-examination of old lessons regarding the effect of food chain length on a web’s dynamical properties.</p>
<div class="figure">
<span style="display:block;" id="fig:web"></span>
<img src="figs/web-1.png" alt="A food web is a map of feeding relations. Here, snails (S) and invertebrates (I) feed on algae, and fish, F, feed on invertebrates and algae. We can represent this as a graph or a matrix." width="40%"><p class="caption">
Figure 12.1: A food web is a map of feeding relations. Here, snails (S) and invertebrates (I) feed on algae, and fish, F, feed on invertebrates and algae. We can represent this as a graph or a matrix.
</p>
</div>
<span class="math display">\[\begin{matrix}
&amp; ~A~ &amp; ~I~ &amp; ~S~ &amp; ~F~\\
\hline
A&amp;0&amp;-&amp;-&amp;-\\
I&amp;+&amp;0&amp;0&amp;-\\
S&amp;+&amp;0&amp;0&amp;0\\
F&amp;+&amp;+&amp;0&amp;0
\end{matrix}\]</span>
<div id="food-web-characteristics" class="section level2" number="12.1">
<h2>
<span class="header-section-number">12.1</span> Food Web Characteristics<a class="anchor" aria-label="anchor" href="#food-web-characteristics"><i class="fas fa-link"></i></a>
</h2>
<p>We need language to describe the components of a food web, such as <em>links</em> and <em>nodes</em>, and we also need language to describe the properties of a web as a whole. Generally speaking, networks such as food webs have <em>emergent properties</em> <span class="citation">(<a href="references.html#ref-May:2006lr" role="doc-biblioref">R. M. May 2006</a>)</span>, such as the number of nodes in the network. Emergent properties are typically considered to be nothing more than characteristics which do not exist at simpler levels of organization. For instance, one emergent property of a population is its density, because population density cannot be measured in an individual; that is why density is an emergent property.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;If we assume no supernatural or spectral interference, then we can also assume that density arises mechanistically from complicated interactions among individuals and their environments, rather than via magic. Other scientists will disagree and say that properties like density that are merely additive aggregates do not qualify for the lofty title of “emergent property.”&lt;/p&gt;"><sup>65</sup></a> While all food web models are based on simple pairwise interactions, the resulting emergent properties of multispecies webs quickly become complex due to indirect interactions and coupled oscillations <span class="citation">(<a href="references.html#ref-Berlow:2004yq" role="doc-biblioref">Berlow et al. 2004</a>; <a href="references.html#ref-Vandermeer:2006fj" role="doc-biblioref">Vandermeer 2006</a>)</span>. In addition, any extrinsic factor (e.g., seasonality) that might influence species interactions may also influence the emergent properties of food webs.</p>
<p>A few important network descriptors and emergent properties include,</p>
<ul>
<li>
<strong>Node</strong> A point of connection among links, a.k.a. trophospecies; each node in the web may be any set of organisms that share sufficiently similar feeding relations; in Fig. <a href="food-webs-and-other-networks.html#fig:web">12.1</a>, <span class="math inline">\(F\)</span> may be a single population of one species, or it may be a suite of species that all feed on both <span class="math inline">\(I\)</span> and <span class="math inline">\(A\)</span>.</li>
<li>
<strong>Link</strong> A feeding relation; a connection between nodes or trophospecies; may be directed (one way) or undirected. A directed link is indicated by an arrow, and is the effect (<span class="math inline">\(+,\,-\)</span>) of one species on another. An undirected link is indicated by a line (no arrow head), and is merely a connection, usually with positive and negative effects assumed, but not quantified.</li>
<li>
<strong>Connectance</strong> The proportion of possible links realized. Connectance may be based on either directed, <span class="math inline">\(C_{D}\)</span>, or undirected, <span class="math inline">\(C_{U}\)</span>, links. For Fig. <a href="food-webs-and-other-networks.html#fig:web">12.1</a> these would be
<span class="math display">\[\begin{gather*}
C_{D}=\frac{L}{S^{2}}=\frac{8}{16}=0.5 \\
C_{U}=\frac{L}{\left(S^2-S\right)/2}=\frac{4}{6}=0.67
\end{gather*}\]</span>
where <span class="math inline">\(S\)</span> is the number of species or nodes.</li>
<li>
<strong>Degree distribution</strong>, <span class="math inline">\(\mathrm{Pr}(i)\)</span> The probability that a randomly chosen node will have degree <span class="math inline">\(i\)</span>, that is, be connected to <span class="math inline">\(i\)</span> other nodes <span class="citation">(<a href="references.html#ref-May:2006lr" role="doc-biblioref">R. M. May 2006</a>)</span>. In Fig. <a href="food-webs-and-other-networks.html#fig:web">12.1</a>, <span class="math inline">\(S\)</span> is of degree 1 (i.e., is connected to one other species). <span class="math inline">\(F\)</span> and <span class="math inline">\(I\)</span> are of degree 2, and <span class="math inline">\(A\)</span> is of degree 3. If we divide through by the number of nodes (4, in Fig. <a href="food-webs-and-other-networks.html#fig:web">12.1</a>), then the degree distribution consists of the probabilities <span class="math inline">\(\mathrm{Pr}\left(i\right)=\{0.25,\,0.5,\,0.25\}\)</span>. As webs increase in size, we can describe this distribution as we would a statistical distribution. For instance, for a web with randomly placed connections, the degree distribution is the binomial distribution <span class="citation">(<a href="references.html#ref-Cohen1990d" role="doc-biblioref">J. E. Cohen, Briand, and Newman 1990</a>)</span>.</li>
<li>
<strong>Characteristic path length</strong> Sometimes defined as the average shortest path between any two nodes <span class="citation">(<a href="references.html#ref-Dunne2002aa" role="doc-biblioref">Dunne, Williams, and Martinez 2002</a>)</span>. For instance, for Fig. <a href="food-webs-and-other-networks.html#fig:web">12.1</a>, the shortest path between <span class="math inline">\(S\)</span> and <span class="math inline">\(A\)</span> is 1 link, and between <span class="math inline">\(A\)</span> and <span class="math inline">\(I\)</span> is 2 links. The average of all pairwise shortest paths is <span class="math inline">\((1+1+1+1+2+2)/6=1.\bar{3}\)</span>. It is also sometimes defined as the average of all paths between each pair of nodes.</li>
<li>
<strong>Modularity, Compartmentation</strong> The degree to which subsets of species are highly connected or independent of other species. This tends to arise in consumer-resource interactions <span class="citation">(<a href="references.html#ref-Thebault2010" role="doc-biblioref">Thebault and Fontaine 2010</a>)</span>.</li>
</ul>
<p>To calculate modularity in a food web, first assume each species interacts with itself. Next, calculate the proportion of shared interactions, <span class="math inline">\(p_{ij}\)</span> for each pair of species, by comparing the lists of species with which each species in a pair interacts. The numerator of <span class="math inline">\(p_{ij}\)</span> is the number of species with which both of the pair interact. The denominator is the total number of different species with which either species interacts. </p>
<p>As an example, let’s calculate this for the above food web (Fig. <a href="food-webs-and-other-networks.html#fig:web">12.1</a>). <span class="math inline">\(S\)</span> interacts with <span class="math inline">\(S\)</span> and <span class="math inline">\(A\)</span>, <span class="math inline">\(I\)</span> interacts with <span class="math inline">\(I\)</span>, <span class="math inline">\(A\)</span>, and <span class="math inline">\(F\)</span>. Therefore, <span class="math inline">\(S\)</span> and <span class="math inline">\(I\)</span> both interact with only <span class="math inline">\(A\)</span>, whereas, together, <span class="math inline">\(S\)</span> and <span class="math inline">\(I\)</span> interact with <span class="math inline">\(S\)</span>, <span class="math inline">\(I\)</span>, <span class="math inline">\(A\)</span>, and <span class="math inline">\(F\)</span>. The proportion, <span class="math inline">\(p_{ij}\)</span>, therefore is <span class="math inline">\(1/4 = 0.25\)</span>. We do this for each species pair. </p>
<p>Next we sum the proportions, and divide the sum by the maximum possible number of undirected links, <span class="math inline">\(C_U\)</span>.</p>
<span class="math display">\[\begin{matrix}
 &amp; S &amp; I &amp; F\\
\hline
A&amp;2/4&amp;3/4&amp;3/4\\
S&amp;  &amp;1/4&amp;1/4\\
I&amp;  &amp;  &amp;3/3
\end{matrix}\]</span>
<p><span class="math display">\[\begin{align*}
C_{I}&amp;=\frac{\sum_{i=1}^{S-1}\sum_{j=i+1}^{S}p_{ij}}{\left(S^2-S\right)/2}\\
    &amp;=3.5/6\\
    &amp;=0.58
\end{align*}\]</span></p>
<p>To reiterate: For any pair of species, <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> (<span class="math inline">\(i\neq j\)</span>), <span class="math inline">\(p_{ij}\)</span> is the proportion of shared interactions, calculated from the number of species that interact with both species <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>, divided by the number of species that interact with either species <span class="math inline">\(i\)</span> or species <span class="math inline">\(j\)</span>. As above, <span class="math inline">\(S\)</span> is the number of species or nodes in the web.</p>
<ul>
<li>
<strong>Nestedness</strong> the degree to which specialists make connections that generalists do too. A completely nested network is one in which we can rank species by the number of interactions, and find that species that interact with fewer other species are always interacting with species that generalists also interact with. This tends to arise in plant-pollinator networks <span class="citation">(<a href="references.html#ref-Thebault2010" role="doc-biblioref">Thebault and Fontaine 2010</a>)</span>.</li>
<li>
<strong>Motif</strong> A repeating pattern; most commonly, a unique set of unidirectional patterns of consumption (Fig. <a href="food-webs-and-other-networks.html#fig:motifs">12.2</a>). A motif <em>profile</em> of a species is the variety of motifs that that species is part of, and the relative frequency with which they play each role.</li>
<li>
<strong>Small world architecture</strong> The degree to which characteristic path length, <span class="math inline">\(L\)</span>, grows with the logarithm of the number of nodes in the web, <span class="math inline">\(N\)</span>,
<span class="math display">\[L \propto log(N)\]</span>
This occurs when nodes are connected via a small number of links through a node with a large number of connections. This occurs in social networks when individuals are connected via shared acquaintances.</li>
</ul>
<div class="figure">
<span style="display:block;" id="fig:motifs"></span>
<img src="figs/motifs.png" alt="There are 13 different possible motifs for three species. These links record only consumption. For instance, S1 is a simple linear food chain and S4 is a single species that is consumed by two other species. motifs D1-D8 all include mutual consumption. This is likely to occur between species in the same guild, and when adults of one feed on juveniles of another." width="90%"><p class="caption">
Figure 12.2: There are 13 different possible motifs for three species. These links record only consumption. For instance, S1 is a simple linear food chain and S4 is a single species that is consumed by two other species. motifs D1-D8 all include mutual consumption. This is likely to occur between species in the same guild, and when adults of one feed on juveniles of another.
</p>
</div>
<ul>
<li><p><strong>Trophic level, trophic position</strong> may simply be categorized as basal, intermediate or top trophic positions. Basal positions are those in which the trophospecies feed on no other species. The top positions are those in which the trophospecies are fed upon by nothing. One can also calculate a quantitative measure of trophic level. This is important in part because omnivory, something rampant in real food webs, complicates identification of a trophic level. We can calculate trophic level for the top predator, <span class="math inline">\(F\)</span> (Fig. <a href="food-webs-and-other-networks.html#fig:web">12.1</a>), and let us assume that <span class="math inline">\(F\)</span> gets two-thirds of what it needs from <span class="math inline">\(I\)</span>, and gets one-third from <span class="math inline">\(A\)</span>. <span class="math inline">\(I\)</span> itself is on the second trophic level, so given that, the trophic level of <span class="math inline">\(P\)</span> is calculated as
<span class="math display">\[\begin{equation*}
T_{i}=1+\sum_{j=1}^{S}T_{j}p_{ij}=1+\left(2\left(0.67\right)+1\left(0.33\right)\right)=2.67
\end{equation*}\]</span>
where <span class="math inline">\(T_{i}\)</span> is the trophic level of species <span class="math inline">\(i\)</span>,
<span class="math inline">\(T_{j}\)</span> is the trophic level of prey species <span class="math inline">\(j\)</span>,
and <span class="math inline">\(p_{ij}\)</span> is the proportion of the diet of predator
<span class="math inline">\(i\)</span> consisting of prey <span class="math inline">\(j\)</span>.</p></li>
<li><p><strong>Omnivory</strong> Feeding on more than one <em>trophic</em> level; it is <em>not</em> merely feeding on different species or resources.</p></li>
<li><p><strong>Intraguild predation</strong> A type of omnivory in which predation occurs between consumers that share a resource; in Fig. <a href="food-webs-and-other-networks.html#fig:web">12.1</a> <span class="math inline">\(F\)</span> and <span class="math inline">\(I\)</span> share prey <span class="math inline">\(A\)</span>. When <span class="math inline">\(F\)</span> gets most of its energy from <span class="math inline">\(I\)</span>, we typically refer to that as omnivory; when <span class="math inline">\(F\)</span> gets most of its energy from <span class="math inline">\(A\)</span>, we typically refer to that as intraguild predation because two species that share a resource occasionally eat each other.</p></li>
</ul>
<p>This list of food web descriptors is a fine start but is by no means exhaustive.</p>
</div>
<div id="does-omnivory-destablize-food-chains" class="section level2" number="12.2">
<h2>
<span class="header-section-number">12.2</span> Does omnivory destablize food chains?<a class="anchor" aria-label="anchor" href="#does-omnivory-destablize-food-chains"><i class="fas fa-link"></i></a>
</h2>
<p>There are many interesting questions about food webs that we could address; let us address one that has a long history, and as yet, no complete answer: What determines the length of a food chain? Some have argued that chance plays a large role <span class="citation">(<a href="references.html#ref-Cohen1990d" role="doc-biblioref">J. E. Cohen, Briand, and Newman 1990</a>; <a href="references.html#ref-Hubbell2001" role="doc-biblioref">Hubbell 2001</a>; <a href="references.html#ref-Williams2000a" role="doc-biblioref">Williams and Martinez 2000</a>)</span>, and others have shown that area <span class="citation">(<a href="references.html#ref-MacArthur1967" role="doc-biblioref">MacArthur and Wilson 1967</a>; <a href="references.html#ref-Rosenzweig1995" role="doc-biblioref">Rosenzweig 1995</a>)</span> or ecosystem size <span class="citation">(<a href="references.html#ref-Post:2002bs" role="doc-biblioref">Post 2002</a>)</span> may play roles. The explanation that we will focus on here is <em>dynamical stability</em>. Communities with more species had been hypothesized to be less stable, and therefore less likely to persist and be observed in nature. Stuart Pimm and John Lawton <span class="citation">(<a href="references.html#ref-Pimm1977" role="doc-biblioref">Pimm and Lawton 1977</a>)</span> extended this work by testing whether <em>food chain length</em> could be limited by the instability of long food chains.</p>
<div id="multi-species-lotkavolterra-notation" class="section level3" number="12.2.1">
<h3>
<span class="header-section-number">12.2.1</span> Multi-species Lotka–Volterra notation<a class="anchor" aria-label="anchor" href="#multi-species-lotkavolterra-notation"><i class="fas fa-link"></i></a>
</h3>
<p>A many-species Lotka–Volterra model can be represented in a very compact form,
<span class="math display" id="eq:compact">\[\begin{equation}
\tag{12.1}
\frac{d X_{i}}{d t}=X_{i}\left(b_{i}+\sum_{j=1}^{S}a_{ij}X_{j}\right)
\end{equation}\]</span>
where <span class="math inline">\(S\)</span> is the number of species in the web, <span class="math inline">\(b_i\)</span> is the intrinsic rate of increase of species <span class="math inline">\(i\)</span> (i.e., <span class="math inline">\(r_i\)</span>), and <span class="math inline">\(a_{ij}\)</span> is a per capita effect of species <span class="math inline">\(j\)</span> on species <span class="math inline">\(i\)</span>.</p>
<p>When <span class="math inline">\(i=j\)</span>, <span class="math inline">\(a_{ij}\)</span> refers to an <em>intra</em>specific effect, which is typically negative. Recall that in our earlier chapters on competition, we used <span class="math inline">\(\alpha_{ii}\)</span> to represent intraspecific per capita effects. Here for notational convenience, we leave <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> in the equation, realizing that <span class="math inline">\(i=j\)</span> for intraspecific interactions. Further, we let <span class="math inline">\(a_{ij}\)</span> be any sign, either positive or negative, and sum the effects. If we let <span class="math inline">\(X=N\)</span>, <span class="math inline">\(b=r\)</span>, and <span class="math inline">\(a=r \alpha\)</span>, then the following are equivalent:
<span class="math display">\[\begin{gather*}
  \dot{N_1} =r_1N_1\left(1-\alpha_{11}N_1 - \alpha_{12}N_2\right)\\
  \dot{X} =X_1\left(b_1+a_{11}X_1+a_{12}X_2 \right)
\end{gather*}\]</span>
The notation in <a href="food-webs-and-other-networks.html#eq:compact">(12.1)</a> is at once both simple and flexible. When <span class="math inline">\(a_{ij}\)</span> is negative, it may represent competition or the effect of a predator, <span class="math inline">\(j\)</span>, on its prey, <span class="math inline">\(i\)</span>. When <span class="math inline">\(a_{ij}\)</span> is positive, it may represent mutualism or the effect of prey~<span class="math inline">\(j\)</span> on a predator~<span class="math inline">\(i\)</span>.</p>
</div>
<div id="background" class="section level3" number="12.2.2">
<h3>
<span class="header-section-number">12.2.2</span> Background<a class="anchor" aria-label="anchor" href="#background"><i class="fas fa-link"></i></a>
</h3>
In the early and mid-1970’s, Robert May and others demonstrated that important predictions could be made with relatively simple Lotka–Volterra models <span class="citation">(<a href="references.html#ref-May1973ab" role="doc-biblioref">R. M. May 1973</a>)</span>, and this work still comprises an important compendium of lessons for ecologists today <span class="citation">(<a href="references.html#ref-May:2006lr" role="doc-biblioref">R. M. May 2006</a>)</span>. May used simple Lotka–Volterra models to show that increasing the number of species in a food web tended to make the food web less stable <span class="citation">(<a href="references.html#ref-May1973ab" role="doc-biblioref">R. M. May 1973</a>, <a href="references.html#ref-May1972" role="doc-biblioref">1972</a>)</span>. In species-rich webs, species were more likely to become extinct. Further, he showed that the more connections there were among species in the web (higher connectance), and the stronger those connections (higher interaction strength), the less stable the web. At the time, this ran counter to a prevailing sentiment that more diverse ecosystems were more stable, and led to heated discussion.
<div class="figure">
<span style="display:block;" id="fig:PLABE"></span>
<img src="figs/PLABE-1.png" alt="Three of the six webs investigated by Pimm and Lawton (1977). Left to right, these correspond to Pimm and Lawton (1977) Figs. 1A, E, and B. All basal species exhibit negative density dependence." width="50%"><img src="figs/PLABE-2.png" alt="Three of the six webs investigated by Pimm and Lawton (1977). Left to right, these correspond to Pimm and Lawton (1977) Figs. 1A, E, and B. All basal species exhibit negative density dependence." width="50%"><img src="figs/PLABE-3.png" alt="Three of the six webs investigated by Pimm and Lawton (1977). Left to right, these correspond to Pimm and Lawton (1977) Figs. 1A, E, and B. All basal species exhibit negative density dependence." width="50%"><p class="caption">
Figure 12.3: Three of the six webs investigated by Pimm and Lawton (1977). Left to right, these correspond to Pimm and Lawton (1977) Figs. 1A, E, and B. All basal species exhibit negative density dependence.
</p>
</div>
<p>May used specific quantitative definitions of all of his ideas. He defined connectance as the proportion of interactions in a web, given the total number of all possible directed interactions (i.e., directed connectance). Thus a linear food chain with four species (Fig. <a href="food-webs-and-other-networks.html#fig:PLABE">12.3</a>, web A), and intraspecific competition in the basal (bottom) species would have a connectance of <span class="math inline">\(4/16=0.25\)</span>. May’s definition of interaction strength was the square root of the average of all <span class="math inline">\(a_{ij}^2\)</span> (<span class="math inline">\(i \neq j\)</span>),
<span class="math display" id="eq:IS">\[\begin{equation}
  \tag{12.2}
  I =\sqrt{ \frac{\sum_{i=1}^S\sum_{j=1, i \neq j}^S a_{ij}}{S^2-S}}.
\end{equation}\]</span>
Squaring the <span class="math inline">\(a_{ij}\)</span> focuses on magnitudes, putting negative and positive values on equal footing.</p>
<p>An important component of May’s work explored the properties of <em>randomly</em> connected food webs. At first glance this might seem ludicrous, but upon consideration, we might wonder where else one could start. Often, simpler (in this case, random) might be better. The conclusions from the random connection models act as null hypotheses for how food webs might be structured; deviations from May’s conclusions might be explained by deviations from his assumptions. Since this work, many ecologists have studied the particular ways in which webs in nature appear non-random.</p>
One conclusion May derived was a threshold between stability and instability for random webs, defined by the relation
<span class="math display" id="eq:1">\[\begin{equation}
  \tag{12.3}
  I\left( S C_D \right)^{1/2} = 1
\end{equation}\]</span>
where <span class="math inline">\(I\)</span> is the average interaction strength, <span class="math inline">\(S\)</span> is the number of species, and <span class="math inline">\(C_D\)</span> is directed connectance. If <span class="math inline">\(I\left( S C \right)^{1/2} &gt; 1\)</span>, the system tended to be unstable (Fig. <a href="food-webs-and-other-networks.html#fig:may1">12.4</a>). Thus, if we
increase the number of species, we need to decrease the average interaction
strength if we want them to persist. The larger and more tightly connected (larger <span class="math inline">\(I\)</span>, <span class="math inline">\(S\)</span>, and <span class="math inline">\(C_D\)</span>) the
web, the more likely it was to come crashing down. Therefore, if longer food
chains were longer by virtue of having more species, they would be less stable
because of the extra species, if for no other reason.
<div class="figure">
<span style="display:block;" id="fig:may1"></span>
<img src="figs/may1-1.png" alt="Relation between the average interaction strength and the number of species able to coexist (here directed connectance is $C_D = 0.3$). The line represents the maximum number of species that are predicted to be able to coexist at equilibrium. Fewer species could coexist, but, on average, more species cannot coexist at equilibrium." width="60%"><p class="caption">
Figure 12.4: Relation between the average interaction strength and the number of species able to coexist (here directed connectance is <span class="math inline">\(C_D = 0.3\)</span>). The line represents the maximum number of species that are predicted to be able to coexist at equilibrium. Fewer species could coexist, but, on average, more species cannot coexist at equilibrium.
</p>
</div>
<p>Pimm and Lawton felt that it seemed reasonable that long chains might be less
stable also because predator-prey dynamics appear inherently unstable, and a
connected series of unstable relations seemed less likely to persist than
shorter chains. They tested whether food chain length
<em>per se</em>, and not the number of species, influenced the stability of food
chains. Another question they addressed concerned omnivory. At the time, surveys of naturally occurring
food webs had indicated that omnivory was rare <span class="citation">(<a href="references.html#ref-Pimm1978" role="doc-biblioref">Pimm and Lawton 1978</a>)</span>. Pimm and Lawton tested whether omnivory stabilized or destabilized food webs <span class="citation">(<a href="references.html#ref-Pimm1977" role="doc-biblioref">Pimm and Lawton 1977</a>, <a href="references.html#ref-Pimm1978" role="doc-biblioref">1978</a>)</span>.</p>
<p>Like May, Pimm and Lawton <span class="citation">(<a href="references.html#ref-Pimm1977" role="doc-biblioref">Pimm and Lawton 1977</a>)</span> used Lotka–Volterra models to
investigate their ideas. They designed six different food web configurations
that varied food chain length, but held the number of species constant (Fig.
<a href="food-webs-and-other-networks.html#fig:PLABE">12.3</a>). For each food web configuration, they varied randomly interaction strength and tested whether an
otherwise randomly structured food web was stable. Their food webs included
negative density dependence only in the basal species.</p>
<p>Pimm and Lawton concluded that (i) shorter chains were more stable than longer chains, and (ii) omnivory destabilized food webs. While these conclusions have stood the test of time, Pimm and Lawton failed to highlight another aspect of their data — that omnivory shortened return times for those webs that were qualitatively stable (Fig. <a href="food-webs-and-other-networks.html#fig:histsAB">12.10</a>). Thus, omnivory could make more stable those webs that it didn’t destroy. Subsequent work has elaborated on this, showing that weak omnivory is very likely to stabilize food webs <span class="citation">(<a href="references.html#ref-McCann1998a" role="doc-biblioref">McCann, Hastings, and Huxel 1998</a>)</span>.</p>
</div>
<div id="implementing-pimm-and-lawtons-methods" class="section level3" number="12.2.3">
<h3>
<span class="header-section-number">12.2.3</span> Implementing Pimm and Lawton’s Methods<a class="anchor" aria-label="anchor" href="#implementing-pimm-and-lawtons-methods"><i class="fas fa-link"></i></a>
</h3>
<p>Here we use R code to illustrate how one might replicate, and begin to extend, the work of Pimm and Lawton <span class="citation">(<a href="references.html#ref-Pimm1977" role="doc-biblioref">Pimm and Lawton 1977</a>)</span>.</p>
<p>In previous chapters, we began with explicit time derivatives, found partial derivatives and solved them at their equilibria. Rather than do all this, Pimm and Lawton bypassed these steps and went straight to the evaluated Jacobian matrix. They inserted random estimates for the elements of the Jacobian into each non-zero element in the food web matrix. These estimates were constrained within (presumably) reasonable limits, given large less abundant predators and small more abundant prey.</p>
<p>Their methods followed this approach.</p>
<ol style="list-style-type: decimal">
<li>Specify a food web interaction matrix.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;In the original publication, webs E and D seem to be represented incorrectly.&lt;/p&gt;"><sup>66</sup></a>
</li>
<li>Include negative density dependence for basal species only.</li>
<li>Set upper and lower bounds for the effects of predators on prey (<span class="math inline">\(0\)</span> to
<span class="math inline">\(-10\)</span>) and prey on predators(<span class="math inline">\(0\)</span> to <span class="math inline">\(+0.1\)</span>); these are the Jacobian elements.</li>
<li>Generate a large number of random Jacobian matrices and perform linear
stability analysis.</li>
<li>Determine qualitative stability (test <span class="math inline">\(\lambda_1&lt;0\)</span>), and return time for each random matrix. Use these to examine key features of the distributions of return times (e.g., average return time).</li>
<li>Compare the stability and return times among different food web configurations that varied systematically in food chain length and the presence
of omnivory, but hold the number of species constant.</li>
</ol>
<p>It is worth discussing briefly the Jacobian elements. <span class="citation"><a href="references.html#ref-May1973ab" role="doc-biblioref">R. M. May</a> (<a href="references.html#ref-May1973ab" role="doc-biblioref">1973</a>)</span> defined interaction strength as the Jacobian element of a matrix, which represents the <em>total effect of one individual on the population growth rate of another species</em>. Think about how you calculate the Jacobian — as the partial derivative of one species’ growth rate with respect to the size of the other population. It is the instantaneous change in the population growth rate per unit change in the population of another, at the equilibrium. The units chosen for the Jacobian elements thus mean that individual predators have relatively much larger effects on the population growth rates of prey than <em>vice versa</em>.</p>
<p>Let’s build a function that does what Pimm and Lawton did. There are an infinite number of ways to do this, but this will suffice. First, we’ll create a matrix that represents qualitatively the simplest longest food chain where each species feeds only on one other species and where no prey are fed upon by more than one consumer. Initially, we will use the values of greatest magnitude used by Pimm and Lawton.</p>
<div class="sourceCode" id="cb397"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Aq</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="op">-</span><span class="fl">1</span>,   <span class="op">-</span><span class="fl">10</span>,   <span class="fl">0</span>,     <span class="fl">0</span>,
  <span class="fl">0.1</span>, <span class="fl">0</span>,   <span class="op">-</span><span class="fl">10</span>,  <span class="fl">0</span>,
  <span class="fl">0</span>,    <span class="fl">0.1</span>,   <span class="fl">0</span>,    <span class="op">-</span><span class="fl">10</span>,
  <span class="fl">0</span>,      <span class="fl">0</span>,    <span class="fl">0.1</span>,   <span class="fl">0</span><span class="op">)</span>,
  nrow<span class="op">=</span><span class="fl">4</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>Note that this matrix indicates a negative effect of the basal species on itself, large negative effects (<span class="math inline">\(-10\)</span>) of each consumer on its prey, and small positive effects of each prey on its consumer.</p>
<p>We can do a quick check of this web using the <code>diagram</code> package.</p>
<div class="sourceCode" id="cb398"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">diagram</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/diagram/man/plotmat.html">plotmat</a></span><span class="op">(</span><span class="va">Aq</span>,relsize<span class="op">=</span><span class="fl">.8</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="figs/unnamed-chunk-178-1.png" width="90%"></div>
<p>Without any additional arguments, it shows us pretty much all we need to see.</p>
<p>For subsequent calculations, it is convenient to to find out from the matrix itself how big the matrix is, that is, how many species, <span class="math inline">\(S\)</span>, are in the web.</p>
<div class="sourceCode" id="cb399"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">Aq</span><span class="op">)</span></code></pre></div>
<p>Next, we create a random realization of this matrix by multiplying each element times a unique random number between zero and 1. For this matrix, that requires <span class="math inline">\(4^2\)</span> unique numbers.</p>
<div class="sourceCode" id="cb400"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">M</span> <span class="op">&lt;-</span> <span class="va">Aq</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">S</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p>Next we perform eigenanalysis on it, retaining the eigenvalues.</p>
<div class="sourceCode" id="cb401"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">eM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">[[</span><span class="st">"values"</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<p>Pimm and Lawton tested whether the dominant eigenvalue was greater than 0 (unstable) and if less than zero, they calculated return time. We will simply record the dominant eigenvalue (the maximum of the real parts of the eigenvalues).</p>
<div class="sourceCode" id="cb402"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">deM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/complex.html">Re</a></span><span class="op">(</span><span class="va">eM</span><span class="op">)</span> <span class="op">)</span></code></pre></div>
<p>Given the stabilizing effect of the intraspecific negative density dependence, we will hang on to that as well.</p>
<div class="sourceCode" id="cb403"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">intraNDD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="va">S</span><span class="op">)</span></code></pre></div>
<p>Given lessons from May’s work, we might also want to calculate the average interaction strength, not including the intraspecific interactions. Here we set the diagonal interactions equal to zero, square the remaining elements, find their average, and take the square root.</p>
<div class="sourceCode" id="cb404"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span>
<span class="va">IS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">M</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">S</span><span class="op">*</span><span class="op">(</span><span class="va">S</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></code></pre></div>
<p>Recall that weak omnivory is supposed to stabilize food webs <span class="citation">(<a href="references.html#ref-McCann1997" role="doc-biblioref">McCann and Hastings 1997</a>)</span>. For webs that include omnivory, we will calculate the interaction strength of omnivory in the same way we do for other interactions, as the square root of the average of the squared <span class="math inline">\(a_{ij}\)</span> <a href="food-webs-and-other-networks.html#eq:IS">(12.2)</a>.</p>
<p>We can wrap all this up in a function where we specify the <span class="math inline">\(i,\,j\)</span> of one of the directed omnivorous links. It does not matter which we specify, either the <span class="math inline">\(ij\)</span> or the <span class="math inline">\(ji\)</span>.</p>
<p>See the arguments in the function.</p>
<div class="sourceCode" id="cb405"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/args.html">args</a></span><span class="op">(</span><span class="va">pimmlawton</span><span class="op">)</span></code></pre></div>
<pre><code>## function (mat, N = 1, omni.i = NA, omni.j = NA, omega = NULL) 
## NULL</code></pre>
<p>Now we can check this function for a single simulation for our first web,</p>
<div class="sourceCode" id="cb407"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/primer/man/pimmlawton.html">pimmlawton</a></span><span class="op">(</span><span class="va">Aq</span><span class="op">)</span></code></pre></div>
<pre><code>##        DomEig        Im   IntraDD        I
## 1 -0.01593096 0.4626425 0.1327543 2.304443</code></pre>
<p>Now let’s do it 2000 times, as Pimm and Lawton did. Each row will be an independent randomization, and the columns will be the dominant eigenvalue, the intraspecific density dependence, and the average interaction strength.</p>
<div class="sourceCode" id="cb409"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out.A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/primer/man/pimmlawton.html">pimmlawton</a></span><span class="op">(</span><span class="va">Aq</span>, N<span class="op">=</span><span class="fl">2000</span><span class="op">)</span> </code></pre></div>
<p>We might like to look at basic summary statistics of the information we collected — what are their minima and maxima and mean?</p>
<div class="sourceCode" id="cb410"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">out.A</span><span class="op">)</span></code></pre></div>
<pre><code>##      DomEig                 Im            IntraDD                I         
##  Min.   :-2.281e-01   Min.   :0.0000   Min.   :0.0001776   Min.   :0.2652  
##  1st Qu.:-4.303e-02   1st Qu.:0.3009   1st Qu.:0.1178734   1st Qu.:2.2405  
##  Median :-1.498e-02   Median :0.6342   Median :0.2456105   Median :2.8509  
##  Mean   :-2.916e-02   Mean   :0.5916   Mean   :0.2464662   Mean   :2.7665  
##  3rd Qu.:-3.534e-03   3rd Qu.:0.8813   3rd Qu.:0.3761273   3rd Qu.:3.3695  
##  Max.   :-7.000e-08   Max.   :1.3732   Max.   :0.4997094   Max.   :4.7617</code></pre>
<p>We see that out of 2000 random food chains, the largest dominant eigenvalue is still less than zero (<span class="math inline">\(\lambda_1&lt;0\)</span>). What does that mean? It means that all of the chains are qualitatively stable, and that the return times are greater than zero (<span class="math inline">\(-1/\lambda_1&gt;0\)</span>).<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Recall that a negative return time indicates that any ``perturbation’’ at the equilibrium would have been closer to zero at some time in the past, i.e., that the perturbation is growing.&lt;/p&gt;"><sup>67</sup></a></p>
<p>May’s work showed that stability is related to interaction strength. Let’s examine how the dominant eigenvalue is related to interaction strength.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Recall that if we think of stability analysis as the analysis of a small perturbation at the equilibrium, then the dominant eigenvalue is the growth rate of that perturbation.&lt;/p&gt;"><sup>68</sup></a></p>
<p>May’s work showed that stability is related to interaction strength. Let’s examine how the dominant eigenvalue is related to interaction strength.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Recall that if we think of stability analysis as the analysis of a small perturbation at the equilibrium, then the dominant eigenvalue is the growth rate of that perturbation.&lt;/p&gt;"><sup>69</sup></a></p>
<div class="sourceCode" id="cb412"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out.A</span><span class="op">$</span><span class="va">I.rel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">out.A</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">I</span><span class="op">/</span><span class="va">IntraDD</span><span class="op">)</span> <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">out.A</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:pairsA"></span>
<img src="figs/pairsA-1.png" alt="Perturbations at the equilibrium tend to dissipate more rapidly (more negative dominant eigenvalues) with greater intraspecific negative density dependence (IntraDD) and greater interspecific interaction strength (I). This graph also demonstrates the independence of IntraDD and I in these simulations." width="90%"><p class="caption">
Figure 12.5: Perturbations at the equilibrium tend to dissipate more rapidly (more negative dominant eigenvalues) with greater intraspecific negative density dependence (IntraDD) and greater interspecific interaction strength (I). This graph also demonstrates the independence of IntraDD and I in these simulations.
</p>
</div>
<div class="sourceCode" id="cb413"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># out.A$Idd &lt;-  cut(out.A$IntraDD, </span>
<span class="co">#          quantile(out.A$IntraDD), include.lowest=TRUE )</span>
<span class="co"># ggplot(data=out.A, aes(I, DomEig)) + geom_point() +</span>
<span class="co">#   geom_smooth() + facet_wrap(~ Idd)</span></code></pre></div>
<p>The results of our simulation (Fig. <a href="food-webs-and-other-networks.html#fig:pairsA">12.5</a>) show that the dominant eigenvalue can become more negative with greater intraspecific negative density dependence (<code>IntraDD</code>) and greater intersepcifiic interaction strength (<code>I</code>). Recall what this means — the dominant eigenvalue is akin to a perturbation growth rate at the equilibrium and is the negative inverse of return time. Therefore, stability can increase and return time decrease with increasing interaction strengths.</p>
<p>Note also (Fig. <a href="food-webs-and-other-networks.html#fig:pairsA">12.5</a>) that many eigenvalues seem very close to zero — what does this mean for return times? The inverse of a very small number is a very big number, so it appears that many return times will be very, very large, and rendering the webs effectively unstable. Let’s calculate return times and examine a summary.</p>
<div class="sourceCode" id="cb414"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">RT.A</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span><span class="op">/</span><span class="va">out.A</span><span class="op">[[</span><span class="st">"DomEig"</span><span class="op">]</span><span class="op">]</span>
  <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">RT.A</span><span class="op">)</span></code></pre></div>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
##        4       23       67    11698      283 13909682</code></pre>
<p>We find that the maximum return time is a very large number, and even the median is fairly large (<code>67</code>). In an ever-changing world, is there any meaningful difference between a return time of 1000 generations <em>vs.</em> being unstable or neutrally stable?</p>
<p>Pimm and Lawton addressed this by picking an arbitrarily large number (150) and recording the percentage of return times greater than that. This percentage will tell us the percentage of webs that are not effectively stable.</p>
<div class="sourceCode" id="cb416"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span> <span class="va">RT.A</span> <span class="op">&gt;</span> <span class="fl">150</span> <span class="op">)</span> <span class="op">/</span> <span class="fl">2000</span></code></pre></div>
<pre><code>## [1] 0.348</code></pre>
<p>Now let’s extract the return times that are less than or equal to 150 and make a histogram with the right number of divisions or bins to allow it to look like the one in the original <span class="citation">(<a href="references.html#ref-Pimm1977" role="doc-biblioref">Pimm and Lawton 1977</a>)</span>.</p>
<div class="sourceCode" id="cb418"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">A.fast</span> <span class="op">&lt;-</span><span class="va">RT.A</span><span class="op">[</span><span class="va">RT.A</span> <span class="op">&lt;</span> <span class="fl">150</span><span class="op">]</span>
<span class="va">histA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">A.fast</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">150</span>, by<span class="op">=</span><span class="fl">5</span><span class="op">)</span>, main<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:histA"></span>
<img src="figs/histA-1.png" alt="*A linear four-species food chain has is only somewhat likely to have reasonble return times.*" width="90%"><p class="caption">
Figure 12.6: <em>A linear four-species food chain has is only somewhat likely to have reasonble return times.</em>
</p>
</div>
<p>This histogram (Fig. <a href="food-webs-and-other-networks.html#fig:histA">12.6</a>) provides us with a picture of the stability for a linear Lotka-Volterra food chain. Next, we will compare this to other webs.</p>
</div>
<div id="shortening-the-chain" class="section level3" number="12.2.4">
<h3>
<span class="header-section-number">12.2.4</span> Shortening the Chain<a class="anchor" aria-label="anchor" href="#shortening-the-chain"><i class="fas fa-link"></i></a>
</h3>
<p>Now let’s repeat all this (more quickly) for a shorter chain, but with the same number of species (Fig. <a href="food-webs-and-other-networks.html#fig:PLABE">12.3</a>, web E). So, we first make the web function. Next we run the 2000 simulations, and check a quick summary.</p>
<div class="sourceCode" id="cb419"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Eq</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="op">-</span><span class="fl">1</span>,   <span class="fl">0</span>,   <span class="fl">0</span>, <span class="op">-</span><span class="fl">10</span>,
  <span class="fl">0</span>,   <span class="op">-</span><span class="fl">1</span>,   <span class="fl">0</span>, <span class="op">-</span><span class="fl">10</span>,
  <span class="fl">0</span>,    <span class="fl">0</span>,   <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">10</span>,
  <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>,  <span class="fl">0</span><span class="op">)</span>,
  nrow<span class="op">=</span><span class="fl">4</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="co"># to confirm we got it right:</span>
<span class="co"># plotmat(Eq, relsize=.8)</span></code></pre></div>
<p>Now we can run the simulation.</p>
<div class="sourceCode" id="cb420"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out.E</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/primer/man/pimmlawton.html">pimmlawton</a></span><span class="op">(</span><span class="va">Eq</span>, N<span class="op">=</span><span class="fl">2000</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">out.E</span><span class="op">)</span></code></pre></div>
<pre><code>##      DomEig                Im            IntraDD              I        
##  Min.   :-0.486312   Min.   :0.0000   Min.   :0.04714   Min.   :0.206  
##  1st Qu.:-0.284289   1st Qu.:0.1425   1st Qu.:0.38941   1st Qu.:2.301  
##  Median :-0.201512   Median :0.6742   Median :0.49014   Median :2.861  
##  Mean   :-0.208653   Mean   :0.5832   Mean   :0.48049   Mean   :2.799  
##  3rd Qu.:-0.124729   3rd Qu.:0.8967   3rd Qu.:0.58144   3rd Qu.:3.372  
##  Max.   :-0.002686   Max.   :1.4232   Max.   :0.83458   Max.   :4.772</code></pre>
<p>The summary shows that, again, that all webs are stable (<span class="math inline">\(\lambda_1&lt;0\)</span>). A histogram of return times also shows very short return times (Fig. <a href="food-webs-and-other-networks.html#fig:histE">12.8</a>). Plots of <span class="math inline">\(\lambda_1\)</span> <em>vs.</em> interaction strengths show that with this short chain, and three basal species that the role of intraspecfic density dependence becomes even more important, and the predator-prey interactions less important in governing <span class="math inline">\(\lambda_1\)</span>.</p>
<div class="sourceCode" id="cb422"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,nr<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">DomEig</span> <span class="op">~</span> <span class="va">IntraDD</span>, data<span class="op">=</span><span class="va">out.E</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">DomEig</span> <span class="op">~</span> <span class="va">I</span>, data<span class="op">=</span><span class="va">out.E</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:E1"></span>
<img src="figs/E1-1.png" alt="For a food chain with two levels, and three basal species, perturbation growth rate (lambda_1) declines with increasing intraspecific negative density dependence (IntraDD) and is unrelated to predator-prey interaction strengths." width="9"><p class="caption">
Figure 12.7: For a food chain with two levels, and three basal species, perturbation growth rate (lambda_1) declines with increasing intraspecific negative density dependence (IntraDD) and is unrelated to predator-prey interaction strengths.
</p>
</div>
<p>Note that with the shorter food chain, a greater proportion of the <span class="math inline">\(\lambda_1\)</span> are more negative (farther away from zero) than in the four level food chain. Clearly then, shortening the web and increasing the amount of negative density dependence stabilizes it, in spite of still having the same number of species.</p>
<p>Let us again categorize these as having long and short return times, and graph the distribution of the short ones.</p>
<div class="sourceCode" id="cb423"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">RT.E</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span><span class="op">/</span><span class="va">out.E</span><span class="op">[[</span><span class="st">"DomEig"</span><span class="op">]</span><span class="op">]</span>
<span class="va">E.fast</span> <span class="op">&lt;-</span><span class="va">RT.E</span><span class="op">[</span><span class="va">RT.E</span> <span class="op">&lt;</span> <span class="fl">150</span><span class="op">]</span>
<span class="va">histE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">E.fast</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">150</span>, by<span class="op">=</span><span class="fl">5</span><span class="op">)</span>, main<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:histE"></span>
<img src="figs/histE-1.png" alt="*One predator and three prey, each with negative density dependence results in very stable webs.*" width="90%"><p class="caption">
Figure 12.8: <em>One predator and three prey, each with negative density dependence results in very stable webs.</em>
</p>
</div>
</div>
<div id="adding-omnivory" class="section level3" number="12.2.5">
<h3>
<span class="header-section-number">12.2.5</span> Adding Omnivory<a class="anchor" aria-label="anchor" href="#adding-omnivory"><i class="fas fa-link"></i></a>
</h3>
<p>Real webs also have omnivory — feeding on more than one trophic level. A nagging question, then and now, concerns the effect of omnivory on food web dynamics. Pimm and Lawton compared food web dynamics with and without omnivory. Let’s now create the omnivorous web they used to compare directly with their linear food chain (Fig. <a href="food-webs-and-other-networks.html#fig:PLABE">12.3</a>, B vs. A). Next we run the 2000 simulations, and check a quick summary.</p>
<div class="sourceCode" id="cb424"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Bq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">10</span>,   <span class="fl">0</span>,     <span class="fl">0</span>,
  <span class="fl">0.1</span>,  <span class="fl">0</span>,   <span class="op">-</span><span class="fl">10</span>,   <span class="op">-</span><span class="fl">2</span>,
  <span class="fl">0</span>,    <span class="fl">0.02</span>,   <span class="fl">0</span>,    <span class="op">-</span><span class="fl">10</span>,
  <span class="fl">0</span>,    <span class="fl">0.1</span>,    <span class="fl">0.1</span>,   <span class="fl">0</span><span class="op">)</span>,
  nrow<span class="op">=</span><span class="fl">4</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#plotmat(Bq, relsize=.8)</span>
<span class="co"># recall we have to tell the function which links are omnivorous</span>
<span class="va">out.B</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/pkg/primer/man/pimmlawton.html">pimmlawton</a></span><span class="op">(</span><span class="va">Bq</span>, N<span class="op">=</span><span class="fl">2000</span>, omni.i<span class="op">=</span><span class="fl">2</span>, omni.j<span class="op">=</span><span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">out.B</span><span class="op">)</span></code></pre></div>
<pre><code>##      DomEig              Im             IntraDD               I        
##  Min.   :-0.1879   Min.   :0.00000   Min.   :0.000291   Min.   :0.174  
##  1st Qu.: 0.3012   1st Qu.:0.00000   1st Qu.:0.125840   1st Qu.:2.266  
##  Median : 0.6625   Median :0.00000   Median :0.245659   Median :2.849  
##  Mean   : 0.6889   Mean   :0.03929   Mean   :0.248152   Mean   :2.781  
##  3rd Qu.: 1.0336   3rd Qu.:0.00000   3rd Qu.:0.371943   3rd Qu.:3.336  
##  Max.   : 1.9895   Max.   :0.99803   Max.   :0.499965   Max.   :4.887  
##      I.omni        
##  Min.   :0.001468  
##  1st Qu.:0.343668  
##  Median :0.691801  
##  Mean   :0.700981  
##  3rd Qu.:1.048982  
##  Max.   :1.412821</code></pre>
<p>With omnivory, we now see that most webs have <span class="math inline">\(\lambda_1&gt;0\)</span>, and thus are <em>unstable</em>. This was one of the main points made by Pimm and Lawton. Let’s look at the data for just the stable webs.</p>
<div class="sourceCode" id="cb426"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out.B.stable</span> <span class="op">&lt;-</span> <span class="va">out.B</span><span class="op">[</span><span class="va">out.B</span><span class="op">[</span>,<span class="st">"DomEig"</span><span class="op">]</span><span class="op">&lt;</span><span class="fl">0</span>,<span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">out.B.stable</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="figs/unnamed-chunk-194-1.png" width="90%"></div>
<p>It means that most of the randomly constructed webs were not stable point equilibria. To be complete, let’s graph what Pimm and Lawton did. They graphed the return times that were positive, and ignored those that were negative.</p>
<div class="sourceCode" id="cb427"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">RT.B</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span><span class="op">/</span><span class="va">out.B</span><span class="op">[[</span><span class="st">"DomEig"</span><span class="op">]</span><span class="op">]</span>
<span class="va">B.fast</span> <span class="op">&lt;-</span> <span class="va">RT.B</span><span class="op">[</span><span class="va">RT.B</span> <span class="op">&lt;</span> <span class="fl">150</span> <span class="op">&amp;</span> <span class="va">RT.B</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">]</span>
<span class="va">out.B.fast</span> <span class="op">&lt;-</span> <span class="va">out.B</span><span class="op">[</span><span class="va">RT.B</span> <span class="op">&lt;</span> <span class="fl">150</span> <span class="op">&amp;</span> <span class="va">RT.B</span> <span class="op">&gt;</span> <span class="fl">0</span>,<span class="op">]</span>
<span class="va">histB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">B.fast</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">150</span>, by<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,
              main<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:histB"></span>
<img src="figs/histB-1.png" alt="*Of the relatively few omnivorous webs that were qualitatively stable, a moderate fraction had low return times.*" width="90%"><p class="caption">
Figure 12.9: <em>Of the relatively few omnivorous webs that were qualitatively stable, a moderate fraction had low return times.</em>
</p>
</div>
</div>
<div id="comparing-chain-a-versus-b" class="section level3" number="12.2.6">
<h3>
<span class="header-section-number">12.2.6</span> Comparing Chain A versus B<a class="anchor" aria-label="anchor" href="#comparing-chain-a-versus-b"><i class="fas fa-link"></i></a>
</h3>
<p>Now let’s compare the properties of the two chains, without, and with, omnivory, chains <strong>A</strong> and <strong>B</strong> (Fig. <a href="food-webs-and-other-networks.html#fig:PLABE">12.3</a>, webs A and B). Because these are stochastic simulations, it means we have <em>distributions</em> of results. For instance, we have a distribution of return times for chain <strong>A</strong> and a distribution for return times for chain <strong>B</strong>. That is,
we can plot histograms for each of them. Pimm and Lawton compared their webs in common sense ways. They compared simple summaries, including</p>
<ul>
<li>the proportion of random webs that were qualitatively stable (positive return times),</li>
<li>the proportion of stable random webs with return times greater than 150.</li>
</ul>
<p>Now let’s try graphical displays. Rather than simply chopping off the long return times, we use base 10 logarithms of return times because the
distributions are so right-skewed. First, we make a data frame with a column for web ID (A or B) and a column for all the return times. We then filter for just positive return times</p>
<div class="sourceCode" id="cb428"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ret.time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>web<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, each<span class="op">=</span><span class="fl">2000</span><span class="op">)</span>,
                       return.time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">RT.A</span>, <span class="va">RT.B</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">return.time</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span></code></pre></div>
<p>Next we create a histogram of return times using probability density instead of counts.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Note that now we use probabilities for the &lt;span class="math inline"&gt;\(y\)&lt;/span&gt;-axis, rather than counts. The probability associated with any particular return time is the product of the height of the column and the width of the column (or bin).&lt;/p&gt;'><sup>70</sup></a> We also add a nonparametric density estimator.</p>
<div class="sourceCode" id="cb429"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">ret.time</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">return.time</span>, fill<span class="op">=</span><span class="va">web</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>,
                 alpha<span class="op">=</span><span class="fl">.5</span>, position<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_density</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill<span class="op">=</span><span class="cn">NULL</span>, colour<span class="op">=</span><span class="va">web</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_x_log10</span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:histsAB"></span>
<img src="figs/histsAB-1.png" alt="*Comparing the distributions of return times for chain **A** and **B**. 'Density' is probability density.*" width="90%"><p class="caption">
Figure 12.10: <em>Comparing the distributions of return times for chain <strong>A</strong> and <strong>B</strong>. ‘Density’ is probability density.</em>
</p>
</div>
<p>By overlaying these distributions, we make an interesting observation. The omnivorous webs with positive return times (those plotted) actually tended to have shorter return times than the linear chain. Pimm and Lawton noted this, but did not emphasize it. Rather, they sensibly focused on the more obvious result, that over 90% of the omnivorous webs had negative return times, indicating an absence of a stable point equilibrium.</p>
</div>
<div id="re-evaluating-take-home-messages" class="section level3" number="12.2.7">
<h3>
<span class="header-section-number">12.2.7</span> Re-evaluating Take-Home Messages<a class="anchor" aria-label="anchor" href="#re-evaluating-take-home-messages"><i class="fas fa-link"></i></a>
</h3>
<p>The primary messages made by <span class="citation"><a href="references.html#ref-Pimm1977" role="doc-biblioref">Pimm and Lawton</a> (<a href="references.html#ref-Pimm1977" role="doc-biblioref">1977</a>)</span> were that</p>
<ul>
<li>shorter webs are more stable than long chains,</li>
<li>omnivory destabilized webs.</li>
</ul>
<p>These conclusions were a major part of the lively debate surrounding these issues. It was consistent with the apparent observation of the time, that empirical food webs revealed little omnivory <span class="citation">(<a href="references.html#ref-Pimm1977" role="doc-biblioref">Pimm and Lawton 1977</a>, <a href="references.html#ref-Pimm1978" role="doc-biblioref">1978</a>)</span>, and that food chains in nature seemed to be much shorter than could occur, if primary productivity (green plants and algae) was channeled upwards into a linear chain.</p>
<p>Let’s consider their assumptions.</p>
<p>First, Pimm and Lawton made the argument, as many others have (including us), that systems with stable point equilibria (nodes or foci) are more likely to persist than systems with persistent oscillations, such as stable limit cycles. It is easy to show that a system can be pushed from a stable equilibrium into oscillations which eventually become so big as to drive an element of the system to extinction. This is a very reasonable assumption, but one which is not challenged enough. Other measures of system stability could be used, such as the minimum that occurs in a long series of fluctuations <span class="citation">(<a href="references.html#ref-Huxel1998" role="doc-biblioref">Huxel and McCann 1998</a>; <a href="references.html#ref-McCann1997" role="doc-biblioref">McCann and Hastings 1997</a>)</span>.</p>
<p>Second, Pimm and Lawton ignored the effects of self-regulated basal species. By exhibiting negative density dependence, the basal species stabilized the web. When Pimm and Lawton made a shorter web, they also added more self-regulated populations. Thus, they necessarily confounded chain length with the number of species with negative density dependence. Which change caused the observed differences among webs? We don’t know.</p>
<p>Third, they assumed that the effect of web topology (i.e., short <em>vs.</em> long chain) was best evaluated with the <em>average</em> properties of the topology, rather than the maximum properties of the topology. By these criteria, webs without omnivory were clearly better. On average, webs without omnivory were more often stable than chains with omnivory, even if some of their return times tended to be quite long. Therefore, one might argue that if a web assembles in nature, it is more likely to persist (i.e., be stable) if it lacks omnivory.</p>
<p>However, let us consider this preceding argument further. The world is a messy place, with constant insults and disturbances, and resources and environmental conditions fluctuating constantly. In addition, there is a constant rain of propagules dropping into communities, and species abundances are changing all the time. In a sense then, communities are being constantly perturbed. The only webs that can persist in the face of this onslaught are the <em>most</em> stable ones, that is the ones with the shortest return times. We just showed that Pimm and Lawton’s own analyses showed that <em>the most stable webs tended to be those with omnivory</em>. Subsequent work supports this claim that omnivory is rampant in nature <span class="citation">(<a href="references.html#ref-Polis1991" role="doc-biblioref">Polis 1991</a>)</span>, and this is supported by theory that shows weak interactions, including omnivory, stabilize food webs <span class="citation">(<a href="references.html#ref-McCann1998" role="doc-biblioref">McCann 1998</a>; <a href="references.html#ref-McCann1997" role="doc-biblioref">McCann and Hastings 1997</a>)</span>.</p>
<p>One feature of our simulations that we ignored were oscillations implied by the imaginary component of each eigenvalue. Recall that larger imaginary parts imply shorter cycles, while zero means no oscillation at all.</p>
<p>Pimm and Lawton made very important contributions to this lengthy debate, and we are finally figuring out how to interpret their results.</p>
</div>
</div>
<div id="perhaps-mutualism-stabilizes-bipartite-networks" class="section level2" number="12.3">
<h2>
<span class="header-section-number">12.3</span> Perhaps mutualism stabilizes bipartite networks<a class="anchor" aria-label="anchor" href="#perhaps-mutualism-stabilizes-bipartite-networks"><i class="fas fa-link"></i></a>
</h2>
<p>Understanding the effects of network architecture on network resilience is a core mission of community ecology. In this section, we compare how mutualist and antagonist interactions in bipartite networks affect network resilience <span class="citation">(<a href="references.html#ref-Thebault2010" role="doc-biblioref">Thebault and Fontaine 2010</a>)</span>. A bipartite network is one in which there are two separate groups of species, in which species interact between groups, but never within groups. Two such examples would be herbivores and plants, or pollinators and plants. <span class="citation"><a href="references.html#ref-Thebault2010" role="doc-biblioref">Thebault and Fontaine</a> (<a href="references.html#ref-Thebault2010" role="doc-biblioref">2010</a>)</span> compared both empirical and simulated plant-pollinator and plant-herbivore bipartite webs and found they differed in the network structure and the consequences for network stability.</p>
<p>To run the code in this section, you will need to install a few more packages. If you’ve already installed them, just load them.</p>
<div class="sourceCode" id="cb430"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pkgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bipartite"</span>, <span class="st">"igraph"</span>, <span class="st">"rARPACK"</span>, <span class="st">"lavaan"</span>, <span class="st">"semPlot"</span><span class="op">)</span>
<span class="co"># install.packages(pkgs)</span>
<span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span> <span class="co"># to hide messages</span>
  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">pkgs</span>, <span class="va">library</span>, character.only<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
In the following comparison between mutualist and antagonist bipartite networks, we control for network structure, and measure direct and indirect effects of diversity, connectance, nestedness, and modularity on resilience. We can then ask whether these effects differ between mutualist and antagonist networks (Fig. <a href="food-webs-and-other-networks.html#fig:TandF">12.11</a>). In brief, you will find that they do.<br><div class="figure">
<span style="display:block;" id="fig:TandF"></span>
<img src="TandF.png" alt="*Possible effects of species richness, connectance, modularity, and nestedness on network resilience.*" width="50%"><p class="caption">
Figure 12.11: <em>Possible effects of species richness, connectance, modularity, and nestedness on network resilience.</em>
</p>
</div>
<p>Our questions are derived from <span class="citation"><a href="references.html#ref-Thebault2010a" role="doc-biblioref">Thébault and Fontaine</a> (<a href="references.html#ref-Thebault2010a" role="doc-biblioref">2010</a>)</span>, but the approach we use is different. They simulated dynamic communities using systems of ODEs that are similar to those that we have seen in earlier chapters on mutualism and consumer-resource interactions. These ODEs included negative density dependence in plants and type II functional responses in mutualists and herbivores.</p>
<p>We will use the approach we used earlier, that of May (1973), <span class="citation"><a href="references.html#ref-Pimm1977" role="doc-biblioref">Pimm and Lawton</a> (<a href="references.html#ref-Pimm1977" role="doc-biblioref">1977</a>)</span> and <span class="citation"><a href="references.html#ref-Pimm1978" role="doc-biblioref">Pimm and Lawton</a> (<a href="references.html#ref-Pimm1978" role="doc-biblioref">1978</a>)</span>. In this approach, we do not simulate the dynamics. Instead, we assume that the species coexist, and we draw their interaction strengths at random from a specified distribution. This determines their instantaneous per capita effect on each other’s population growth rate, that is, the Jacobian matrix that describes their interactions.</p>
<p>In our approach, we will establish interactions at random, in which each pair of species (plant and animal) has the same probability of interacting. That probability is connectance (<span class="math inline">\(L/(PA)\)</span>), where <span class="math inline">\(P\)</span> and <span class="math inline">\(A\)</span> are the numbers of plants and animals in the network. Note that this measure of connectance differs from previous definitions, because we are ruling out all within-group interactions. This means that the structure (who is connected to whom) will be determined randomly rather than as a result of the dynamics of ODE models as in Thebault and Fontaine (2010). Further, the number of species and the connectance will both be draw at random, within specified ranges.</p>
<div id="creating-bipartite-webs" class="section level3" number="12.3.1">
<h3>
<span class="header-section-number">12.3.1</span> Creating bipartite webs<a class="anchor" aria-label="anchor" href="#creating-bipartite-webs"><i class="fas fa-link"></i></a>
</h3>
<p>We’ll start by demonstrating a toy example of a bipartite web of mutualists: plants and their pollinators. We select the numbers of species and the connectance.</p>
<div class="sourceCode" id="cb431"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The number of species of plants</span>
<span class="va">Sp</span> <span class="op">&lt;-</span> <span class="fl">5</span>
<span class="co"># The number of species of pollinators</span>
<span class="va">Sa</span> <span class="op">&lt;-</span> <span class="fl">12</span>
<span class="co"># the total number of species</span>
<span class="va">S</span> <span class="op">&lt;-</span> <span class="va">Sa</span><span class="op">+</span><span class="va">Sp</span>

<span class="co"># The connectance in this web. </span>
<span class="va">contc</span> <span class="op">&lt;-</span> <span class="fl">.4</span></code></pre></div>
<p>We then generate random interactions between species using the <em>binomial distribution</em>. This is the distribution of coin flips or rolling of die. If we want to flip a single fair coin ten times, we can use <code><a href="https://rdrr.io/r/stats/Binomial.html">rbinom()</a></code>.</p>
<div class="sourceCode" id="cb432"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># size is the number of coins to flip at once.</span>
<span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10</span>, size <span class="op">=</span> <span class="fl">1</span>, prob<span class="op">=</span><span class="fl">0.5</span> <span class="op">)</span></code></pre></div>
<pre><code>##  [1] 1 1 0 0 1 1 1 1 0 0</code></pre>
<p>We say this is “ten observations of 1 trial.”</p>
<p>If we want to flip 10 coins all at once and count the number of heads, we could do this:</p>
<div class="sourceCode" id="cb434"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># size is the number of coins to flip at once.</span>
<span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">1</span>, size <span class="op">=</span> <span class="fl">10</span>, prob<span class="op">=</span><span class="fl">0.5</span> <span class="op">)</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<p>We would say this is “one observation of ten trials.”</p>
<p>For our bipartite web, we will create <code>Sa * Sp</code> coin flips or observations of one trial, each with the probability of 0.4 of getting a link.</p>
<div class="sourceCode" id="cb436"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create interactions at random, drawing 0's and 1's with a probability of contc=0.5</span>
<span class="va">interactions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span> n <span class="op">=</span> <span class="va">Sa</span> <span class="op">*</span> <span class="va">Sp</span>, size<span class="op">=</span><span class="fl">1</span>, prob<span class="op">=</span><span class="va">contc</span><span class="op">)</span></code></pre></div>
<p>We create a matrix with these links (and no links). This will create our topology.</p>
<div class="sourceCode" id="cb437"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bip.network</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">interactions</span>, nrow<span class="op">=</span><span class="va">Sp</span>, ncol<span class="op">=</span><span class="va">Sa</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">bip.network</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"plant"</span>, <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">Sp</span><span class="op">]</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">bip.network</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"bug"</span>, <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">Sa</span><span class="op">]</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>
<span class="co">#...and look at it</span>
<span class="va">bip.network</span></code></pre></div>
<pre><code>##        bugA bugB bugC bugD bugE bugF bugG bugH bugI bugJ bugK bugL
## plantA    0    0    0    1    1    0    0    1    0    0    0    0
## plantB    0    0    0    1    0    1    0    0    0    0    1    0
## plantC    0    0    1    0    0    0    1    0    0    0    1    0
## plantD    0    1    0    0    0    1    0    0    0    1    0    0
## plantE    0    1    0    1    0    0    0    0    1    0    1    0</code></pre>
<p>Your web may have species that do not interact with any others; that’s okay for now. One day, you might have data like that.</p>
<p>Now let’s add interaction strength. We’ll rely on a semi-realistic assumption about <em>how much</em> each of the pollinators interact with those plant species. It is generally observed that most interactions are weak (e.g., infrequent visits) and a few are strong (e.g., frequent visits). That pattern can be approximated by an exponential distribution. We will create those interactions and then plot them.</p>
<div class="sourceCode" id="cb439"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Exponentially distributed of interaction strengths</span>
<span class="co"># Random numbers from and exponential distribution</span>
<span class="va">xp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">rexp</a></span><span class="op">(</span><span class="va">Sa</span><span class="op">*</span><span class="va">Sp</span><span class="op">)</span>

<span class="co"># express these as a probability distribution (divide by the sum)</span>
<span class="va">xp</span> <span class="op">&lt;-</span> <span class="va">xp</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">xp</span><span class="op">)</span>

<span class="co"># assign those exponential probabilities to our interactions,</span>
<span class="co"># creating the Quantitative network</span>
<span class="va">bip.networkQ</span> <span class="op">&lt;-</span> <span class="va">bip.network</span> <span class="op">*</span> <span class="va">xp</span></code></pre></div>
<p>Next we can make some pretty pictures of this web. To do this, you’ll need to load the <code>bipartite</code> package.</p>
<div class="sourceCode" id="cb440"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">{</span>
  <span class="co"># library(bipartite) if needed</span>
  <span class="co"># visweb and plotweb are in the bipartite package</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>, nc<span class="op">=</span><span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">bip.networkQ</span>, main<span class="op">=</span><span class="st">""</span>, xlab<span class="op">=</span><span class="st">"interaction strength"</span><span class="op">)</span>
  <span class="fu">bipartite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bipartite/man/plotweb.html">plotweb</a></span><span class="op">(</span><span class="va">bip.networkQ</span>, method<span class="op">=</span><span class="st">'normal'</span><span class="op">)</span> 
  <span class="fu">bipartite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bipartite/man/visweb.html">visweb</a></span><span class="op">(</span><span class="va">bip.networkQ</span>, type<span class="op">=</span><span class="st">'nested'</span><span class="op">)</span>
  <span class="fu">bipartite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bipartite/man/visweb.html">visweb</a></span><span class="op">(</span><span class="va">bip.networkQ</span>, type<span class="op">=</span><span class="st">'diagonal'</span><span class="op">)</span>
  <span class="op">}</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:toys"></span>
<img src="figs/toys-1.png" alt="*Illustrations of a hypothetical plant-pollinator network. The two matrices organize the species to highlight either nestedness (left) or modularity (right).*" width="90%"><p class="caption">
Figure 12.12: <em>Illustrations of a hypothetical plant-pollinator network. The two matrices organize the species to highlight either nestedness (left) or modularity (right).</em>
</p>
</div>
<p>There are several good network packages in R. We will use <code>bipartite</code> and <code>igraph</code>. Here we will measure the nestedness and the modularity using functions from package <code>bipartite</code>.</p>
<div class="sourceCode" id="cb441"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Nestedness:</span>
<span class="co"># quant. version of NODF  (Almeida-Neto et al. 2008, 2011)</span>
<span class="fu">networklevel</span><span class="op">(</span><span class="va">bip.networkQ</span>, index<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"weighted NODF"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## weighted NODF 
##      7.272727</code></pre>
<div class="sourceCode" id="cb443"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">metaComputeModules</span><span class="op">(</span><span class="va">bip.networkQ</span>, N<span class="op">=</span><span class="fl">5</span>, method<span class="op">=</span><span class="st">"Beckett"</span><span class="op">)</span> <span class="op">@</span> <span class="va">likelihood</span></code></pre></div>
<pre><code>## [1] 0.5686917</code></pre>
<p>This measure of nestedness (WNODF, <span class="citation"><a href="references.html#ref-AlmeidaNeto2011" role="doc-biblioref">Almeida-Neto and Ulrich</a> (<a href="references.html#ref-AlmeidaNeto2011" role="doc-biblioref">2011</a>)</span>) varies between 0 and 100 for completely nonnested and nested networks. This measure of modularity varies between 0 and 1 for completely non-modular and modular networks.</p>
<p>To measure stability of this plant by animal matrix, we first convert it to a square matrix, add a little negative denisty dependence, and then use eigenanalysis to find the dominant eigenvalue.</p>
<div class="sourceCode" id="cb445"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nr<span class="op">=</span><span class="va">S</span>, nc<span class="op">=</span><span class="va">S</span><span class="op">)</span> 
<span class="co"># upper triangular part</span>
<span class="va">n</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">Sp</span>, <span class="op">(</span><span class="va">Sp</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="va">S</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">bip.networkQ</span>
<span class="co"># lower triangular part</span>
<span class="va">n</span><span class="op">[</span><span class="op">(</span><span class="va">Sp</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="va">S</span>, <span class="fl">1</span><span class="op">:</span><span class="va">Sp</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">bip.networkQ</span><span class="op">)</span> 
<span class="co"># Add negative density dependence that is the </span>
<span class="co"># same magnitude as other species interactions</span>
<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>

<span class="co">#Calculate stability</span>
<span class="fu"><a href="https://rdrr.io/r/base/complex.html">Re</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">$</span><span class="va">values</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] -0.02598075</code></pre>
<p>That is just an example of the type of network we will create in our simulation—we create a bipartite web with a random number of species, and random connectance, each within specified bounds.</p>
</div>
<div id="testing-effects-of-nestedness-and-modularity-on-network-resilience." class="section level3" number="12.3.2">
<h3>
<span class="header-section-number">12.3.2</span> Testing effects of nestedness and modularity on network resilience.<a class="anchor" aria-label="anchor" href="#testing-effects-of-nestedness-and-modularity-on-network-resilience."><i class="fas fa-link"></i></a>
</h3>
<p>In our webs, we can compare the effects of negative vs. positive interactions directly, because we will create one network with interaction strengths, and then simply reverse the signs of the effects of the animals on the plants to get herbivory <em>vs.</em> mutualism.</p>
<p>We simulate 1000 random bipartite webs using a large number of different numbers of plant and animal species. We select a connectance by drawing randomly from a uniform distribution between the values in argument <code>C</code>.</p>
<p>When we generate a random network, we save one version that represents mutualists (+,+), and then we reverse the sign for the effect of the animal to represent herbivory (+,-).</p>
<p>The function <code><a href="https://rdrr.io/pkg/primer/man/bip_stability.html">bip_stability()</a></code> performs eigananalysis on the resulting Jacobian matrix to estimate <em>resilience</em>, which we define as the negative of the real part of the dominant eigenvalue. This way, greater resilience is a larger positive number. It calculates the resilience for both the mutualist and the herbivorous versions of each random network. It also calculates <em>nestedness</em> and <em>modularity</em> in ways similar to that in Thebault and Fontaine (2010). It can calculate modularity in two ways, using either the binary adjacency matrix (ones and zeroes) or a quantitative matrix; the latter takes much moore time to calculate, so it uses the binary matrix by default. It also tallies diversity as the total number of species and the connectance as the total number of links divided by the number of possible links.</p>
<p>This function has several arguments which you can see described in the help file. Among them are
* <code>Spp.a</code> and <code>Spp.p</code>: vectors from which the numbers of animal and plant species are drawn at random,
* <code>C</code>: a two-element vector provide the min and max of possible connectances drawn at random,
* <code>reps</code>: the number of random networks to create.</p>
<p>Here we use it to generate 1000 random webs. We will then use those to examine the relations between various emergent properties of the networks.</p>
<div class="sourceCode" id="cb447"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#library(primer)</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/primer/man/bip_stability.html">bip_stability</a></span><span class="op">(</span>Spp.a <span class="op">=</span> <span class="fl">16</span><span class="op">:</span><span class="fl">60</span>, Spp.p <span class="op">=</span> <span class="fl">8</span><span class="op">:</span><span class="fl">30</span>, C<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.05</span>, <span class="fl">0.5</span><span class="op">)</span>, reps<span class="op">=</span><span class="fl">5000</span>, quant<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>We can get a summary of the output of the 1000 simulated webs here.</p>
<div class="sourceCode" id="cb448"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span></code></pre></div>
<pre><code>##        S               C             modularity        nestedness    
##  Min.   :13.00   Min.   :0.06491   Min.   :0.00000   Min.   : 0.000  
##  1st Qu.:42.00   1st Qu.:0.17867   1st Qu.:0.00000   1st Qu.: 9.158  
##  Median :54.00   Median :0.27190   Median :0.09162   Median :14.362  
##  Mean   :54.56   Mean   :0.28361   Mean   :0.19515   Mean   :14.465  
##  3rd Qu.:67.00   3rd Qu.:0.38816   3rd Qu.:0.37102   3rd Qu.:19.855  
##  Max.   :90.00   Max.   :0.56818   Max.   :0.85802   Max.   :32.335  
##   resilience.m       resilience.h     
##  Min.   :0.003216   Min.   :0.001893  
##  1st Qu.:0.019222   1st Qu.:0.013289  
##  Median :0.026624   Median :0.019060  
##  Mean   :0.027845   Mean   :0.020408  
##  3rd Qu.:0.035156   3rd Qu.:0.026141  
##  Max.   :0.069583   Max.   :0.057484</code></pre>
<p>Are these webs stable? What are the means, medians and ranges of each of the web properties? What is the percent differences in the resiliences of the two interaction types?</p>
<p>We can also graph the pairwise relations.</p>
<div class="sourceCode" id="cb450"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="figs/unnamed-chunk-203-1.png" width="90%"></div>
<p>If you have a copy of Thebault and Fontaine (2010), you might check whether the above relations are similar to theirs.</p>
</div>
<div id="path-analysis" class="section level3" number="12.3.3">
<h3>
<span class="header-section-number">12.3.3</span> Path Analysis<a class="anchor" aria-label="anchor" href="#path-analysis"><i class="fas fa-link"></i></a>
</h3>
<p>Now we do the same sort of analysis that Thebault and Fontaine did to get their Fig. 2 C,D. Path analysis is a relatively simple way to model sets of correlations among dependent variables. To do this, we will use the <code>lavaan</code> package.</p>
<p>If we look above, we see curvature in some of the relations. In simple path analysis, as in Thebault and Fontaine, these relations are assumed to be linear. Here we transform these data a tad to help linearize these relations.</p>
<div class="sourceCode" id="cb451"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out.tr</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">b</span><span class="op">)</span><span class="op">^</span><span class="fl">.75</span></code></pre></div>
<p>We next scale our data so that all variables have a mean of zero and a standard deviation of 1. This will simplify the interpretation of the path analysis output: the regression coefficients partial correlation coefficients and will be effect sizes that are each comparable to the others.</p>
<div class="sourceCode" id="cb452"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">out.tr</span><span class="op">)</span> <span class="op">)</span> </code></pre></div>
<p>We specify each of the relationships, where <code>y ~ x</code> is “y as a function of x.” We then fit the model and get the path coefficients.</p>
<p>To mimic Thebault and Fontaine, we will include all and only the interactions in their figure 2. We start with the mutualism web. Start by loading the <code>lavaan</code> package if you haven’t previously.</p>
<div class="sourceCode" id="cb453"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># library(lavvan)</span>
<span class="co"># Step 1: Specify model</span>
<span class="va">model.m</span> <span class="op">&lt;-</span> <span class="st">'resilience.m ~ nestedness + modularity + S + C
          nestedness ~  S + C
          modularity ~ S + C '</span>

<span class="co"># Step 2: Estimate model of mutualism</span>
<span class="va">mod.m.fit</span> <span class="op">&lt;-</span> <span class="fu">sem</span><span class="op">(</span><span class="va">model.m</span>, data<span class="op">=</span><span class="va">dat</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod.m.fit</span><span class="op">)</span></code></pre></div>
<pre><code>##    resilience.m~nestedness    resilience.m~modularity 
##                      0.095                      0.129 
##             resilience.m~S             resilience.m~C 
##                      0.621                      0.684 
##               nestedness~S               nestedness~C 
##                      0.062                      0.959 
##               modularity~S               modularity~C 
##                     -0.324                     -0.828 
## resilience.m~~resilience.m     nestedness~~nestedness 
##                      0.125                      0.064 
##     modularity~~modularity 
##                      0.152</code></pre>
<p>These are the estimates of the pairwise regressions. Those are the path coefficients that tell us the strengths of the relations among the network properties. Below we make a path diagram using these.</p>
<p>Next, do the same thing for herbivory.</p>
<div class="sourceCode" id="cb455"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Step 1: Specify model</span>
<span class="va">model.h</span> <span class="op">&lt;-</span> <span class="st">'resilience.h ~ nestedness + modularity + S + C
          nestedness ~ S + C
          modularity ~ S + C'</span>

<span class="co"># Step 2: Estimate model of herbivory</span>
<span class="va">mod.h.fit</span> <span class="op">&lt;-</span> <span class="fu">sem</span><span class="op">(</span><span class="va">model.h</span>, data<span class="op">=</span><span class="va">dat</span><span class="op">)</span>
<span class="co">#coef(mod.h.fit)  </span></code></pre></div>
<p>To make the path diagrams, you’ll need the <code>semPlot</code> package.</p>
<div class="sourceCode" id="cb456"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># library(semPlot)</span>
<span class="fu">semPaths</span><span class="op">(</span><span class="va">mod.m.fit</span>, what<span class="op">=</span><span class="st">'path'</span>, whatLabels<span class="op">=</span><span class="st">"std"</span>, 
         curve<span class="op">=</span><span class="fl">1</span>, curvature<span class="op">=</span><span class="fl">1</span>, sizeMan<span class="op">=</span><span class="fl">10</span>,
         edge.label.cex <span class="op">=</span> <span class="fl">1.5</span>, nCharNodes<span class="op">=</span><span class="fl">4</span>,
         edge.label.position<span class="op">=</span><span class="fl">.7</span>, layout<span class="op">=</span><span class="st">'tree2'</span><span class="op">)</span>
<span class="fu">semPaths</span><span class="op">(</span><span class="va">mod.h.fit</span>, what<span class="op">=</span><span class="st">'path'</span>, whatLabels<span class="op">=</span><span class="st">"std"</span>, 
         curve<span class="op">=</span><span class="fl">1</span>, curvature<span class="op">=</span><span class="fl">1</span>, sizeMan<span class="op">=</span><span class="fl">10</span>,
         edge.label.cex <span class="op">=</span> <span class="fl">1.5</span>, nCharNodes<span class="op">=</span><span class="fl">4</span>,
         edge.label.position<span class="op">=</span><span class="fl">.7</span>, layout<span class="op">=</span><span class="st">'tree2'</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:paths"></span>
<img src="figs/paths-1.png" alt="*Given the same bipartite network structure and the identical interaction strengths, mutualistic (left) and antagonistic webs (right) show slightly different relations among emergent properties. Recall also that resilience is about *" width="50%"><img src="figs/paths-2.png" alt="*Given the same bipartite network structure and the identical interaction strengths, mutualistic (left) and antagonistic webs (right) show slightly different relations among emergent properties. Recall also that resilience is about *" width="50%"><p class="caption">
Figure 12.13: <em>Given the same bipartite network structure and the identical interaction strengths, mutualistic (left) and antagonistic webs (right) show slightly different relations among emergent properties. Recall also that resilience is about </em>
</p>
</div>
<p>Here we see that some of the relations among empergent properties differs in the two web types. It is reassuring that the relations between richness and connectance <em>vs.</em> nestedness and modularity are identical. This is because the topologies (connections) are identical, as the only difference is the sign of some of the interactions.</p>
<p>The differences lie in the slightly different effects on resilience. What are those differences, and are they consistent with Thebault and Fontaine (2010)? Are they consistent with what is generally presumed about the role of mutualisms and consumption in food webs?</p>
</div>
</div>
<div id="exploring-pandora-right-here-at-home" class="section level2" number="12.4">
<h2>
<span class="header-section-number">12.4</span> Exploring Pandora, right here at home<a class="anchor" aria-label="anchor" href="#exploring-pandora-right-here-at-home"><i class="fas fa-link"></i></a>
</h2>
<p>The Na’vi of Pandora know something of how their world works, and we are working hard to understand ours. Our world is a highly antagonistic world, driven by consumption - a tangled bank, nature, red in tooth and claw. However, all around us and hidden beneath our feet, many species cooperate to survive and thrive in this otherwise harsh world. This cooperation can happen among species and it can also happen among individuals within a species. Suzanne Simard and others have been investigating belowground networks of nutrient flux and information sharing among individuals and between species.</p>
<p>Most plant species develop mycorrhizae, fungi-root associations which are typically mutualistic interactions. These fungi can often connect individuals of the same species together, creating a network by which one plant can information, nutrients, and carbon with another plant via this fungal highway. However, how these connections are structured is still very poorly known. In an effort to shed some light on this, <span class="citation"><a href="references.html#ref-Beiler2015" role="doc-biblioref">Beiler, Simard, and Durall</a> (<a href="references.html#ref-Beiler2015" role="doc-biblioref">2015</a>)</span> described the topology of Douglas fir trees connected by two species of individual fungal genets, in contrasting environments (<a href="food-webs-and-other-networks.html#fig:plot1">12.14</a>).</p>
<div id="properties-assessed" class="section level3" number="12.4.1">
<h3>
<span class="header-section-number">12.4.1</span> Properties assessed<a class="anchor" aria-label="anchor" href="#properties-assessed"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Application of networks to mycorrhizae</li>
</ol>
<ul>
<li>node = tree</li>
<li>link = one or more fungal genets connecting two trees</li>
<li>triplet = three connected trees (open triplet is connected by two links, closed, by three)</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Network properties</li>
</ol>
<ul>
<li>link density (links/species)</li>
<li>degree distribution (statistical distribution of node degrees)</li>
<li>global or network clustering coefficient: fraction of triplets that are closed (no. of closed triplets) / (no. of open + no. closed triplets)</li>
<li>mean lcoal clustering coefficient among nodes in each network</li>
<li>Betweenness centrality: the number of times a node acts as a bridge along the shortest path between two other nodes. How important is this node in making connections for other nodes?</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Node properties</li>
</ol>
<ul>
<li>degree (# of links)</li>
<li>normalized degree: (fraction: d / all possible d)</li>
<li>node clustering coefficient (local transivity; extent to which its neighbors are are connected)</li>
</ul>
<p>All these were evaluated by whether the observed properties differed from properties that emerge from random networks with the same number of nodes and average node degree as the empirical mycorrhizal networks. We can generate such a graph using the <code>igraph</code> package.</p>
<p>Plot 1, from a xeric site, had 26 trees and 258 links. Therefore, the average node degree must be <span class="math inline">\(258/26\approx 9.9\)</span>. We can create a random graph by simply specify the number of vertices and the number of edges.</p>
<div class="sourceCode" id="cb457"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># node clustering coefficient: 0.84</span>
<span class="co"># for Plot 1</span>
<span class="va">V</span> <span class="op">&lt;-</span> <span class="fl">26</span>
<span class="va">E</span> <span class="op">&lt;-</span> <span class="fl">258</span>

<span class="va">gr</span> <span class="op">&lt;-</span> <span class="fu">erdos.renyi.game</span><span class="op">(</span><span class="va">V</span>, <span class="va">E</span>, type <span class="op">=</span> <span class="st">"gnm"</span><span class="op">)</span>
<span class="co"># graph "order" and "size"</span>
<span class="fu">gorder</span><span class="op">(</span><span class="va">gr</span><span class="op">)</span>; <span class="fu">gsize</span><span class="op">(</span><span class="va">gr</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 26</code></pre>
<pre><code>## [1] 258</code></pre>
<div class="sourceCode" id="cb460"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gr</span>, vertex.label<span class="op">=</span> <span class="cn">NA</span>, edge.arrow.size<span class="op">=</span><span class="fl">0.02</span>,vertex.size <span class="op">=</span> <span class="fl">0.5</span>, xlab <span class="op">=</span> <span class="st">"Random Network: G(V,E) model"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:plot1"></span>
<img src="figs/plot1-1.png" alt="*Example of a random graph using the same number of vertices and links as in plot 1 (Beiler et al. (2015)).*" width="70%"><p class="caption">
Figure 12.14: <em>Example of a random graph using the same number of vertices and links as in plot 1 (Beiler et al. (2015)).</em>
</p>
</div>
<p>We can compare the observed average node clustering coefficient (<span class="math inline">\(0.84 \pm 0.37\)</span>) to that of the random graph we created above. Note that transivity is node clustering.</p>
<div class="sourceCode" id="cb461"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu">transitivity</span><span class="op">(</span><span class="va">gr</span>, type <span class="op">=</span> <span class="st">"local"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.7959873</code></pre>
<p>We find that these differ. The observed can then be compared to 1000s of simulated random networks to see how unusual the observed value is. Here we use a toy example with 100 simulations to compare the node clustering coefficient observed in plot 1 to what we would expect in a random network.</p>
<div class="sourceCode" id="cb463"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ncc.sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="fl">100</span>, <span class="op">{</span> 
  <span class="va">gr</span> <span class="op">&lt;-</span> <span class="fu">erdos.renyi.game</span><span class="op">(</span><span class="va">V</span>, <span class="va">E</span>, type <span class="op">=</span> <span class="st">"gnm"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu">transitivity</span><span class="op">(</span><span class="va">gr</span>, type <span class="op">=</span> <span class="st">"local"</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span> <span class="op">)</span>
<span class="fu">qplot</span><span class="op">(</span>x<span class="op">=</span><span class="va">ncc.sims</span>, geom<span class="op">=</span><span class="st">"histogram"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0.84</span>, linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:nccHist"></span>
<img src="figs/nccHist-1.png" alt="*Observed node clustering appears unuusally high, relatively to that of random networks.*" width="90%"><p class="caption">
Figure 12.15: <em>Observed node clustering appears unuusally high, relatively to that of random networks.</em>
</p>
</div>
<p>We see that the local node clustering is higher in one real plot than we would expect by chance. Remember that this measures the extent to which a node’s neighbors are connected to each other.</p>
<p>Among their results, Beiler et al. found that node clustering coefficient and node degree increased with tree size. It is interesting that in spite of these both increasing with tree size, there is a negative relation between them node clustering coef and node degree (Fig. 2). Beiler et al. point out that this happens in ‘scale-free’ graphs.</p>
<p>A <em>scale-free</em> graph is one in which the probability of a node having L links follows a power law relation,
<span class="math display">\[Pr(L) \sim L^{-z}\]</span>
where, apparently, <span class="math inline">\(2&lt;z&lt;3\)</span>. Let’s demonstrate that for one plot.</p>
<div class="sourceCode" id="cb464"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># node clustering coefficients (per node)</span>
<span class="va">ncc</span> <span class="op">&lt;-</span> <span class="fu">transitivity</span><span class="op">(</span><span class="va">gr</span>, type <span class="op">=</span> <span class="st">"local"</span><span class="op">)</span>
<span class="co"># degrees of each node</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">degree</span><span class="op">(</span><span class="va">gr</span><span class="op">)</span>
<span class="fu">qplot</span><span class="op">(</span><span class="va">d</span>, <span class="va">ncc</span>, geom<span class="op">=</span><span class="st">"jitter"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:plot1sf"></span>
<img src="figs/plot1sf-1.png" alt="*Emergent relation between node clustering and node degree in a scale-free random network, based on the number of nodes and links in plot 1.*" width="90%"><p class="caption">
Figure 12.16: <em>Emergent relation between node clustering and node degree in a scale-free random network, based on the number of nodes and links in plot 1.</em>
</p>
</div>
<p>Now let’s combine all the plots into one graph. First I collect all the data from Beiler et al. (Table 1,2, Beiler et al. (2015)).</p>
<div class="sourceCode" id="cb465"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># vertices</span>
<span class="va">V</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">26</span>, <span class="fl">13</span>, <span class="fl">31</span>, <span class="fl">27</span>, <span class="fl">27</span>, <span class="fl">41</span><span class="op">)</span>
<span class="co"># egdes</span>
<span class="va">E</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">258</span>, <span class="fl">66</span>, <span class="fl">283</span>, <span class="fl">254</span>, <span class="fl">177</span>, <span class="fl">434</span><span class="op">)</span>
<span class="co"># proportion of trees colonized</span>
<span class="va">pV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.846</span>, <span class="fl">.5</span>, <span class="fl">.875</span>, <span class="fl">.846</span>, <span class="fl">.778</span>, <span class="fl">.889</span><span class="op">)</span>
<span class="co"># mean node degree</span>
<span class="va">mean.deg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">18</span>, <span class="fl">695</span>, <span class="fl">17.15</span>, <span class="fl">17.52</span>, <span class="fl">12.21</span>, <span class="fl">20.19</span><span class="op">)</span>
<span class="co"># mean node clustering coef.</span>
<span class="va">mean.ncc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.84</span>, <span class="fl">.63</span>, <span class="fl">.84</span>, <span class="fl">.85</span>, <span class="fl">.83</span>, <span class="fl">.8</span><span class="op">)</span>
<span class="va">plot</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>plot<span class="op">=</span><span class="va">plot</span>, V<span class="op">=</span><span class="va">V</span>, E<span class="op">=</span><span class="va">E</span>, pV<span class="op">=</span><span class="va">pV</span>, mean.deg<span class="op">=</span><span class="va">mean.deg</span>, mean.ncc<span class="op">=</span><span class="va">mean.ncc</span><span class="op">)</span>
<span class="va">df</span></code></pre></div>
<pre><code>##   plot  V   E    pV mean.deg mean.ncc
## 1    1 26 258 0.846    18.00     0.84
## 2    2 13  66 0.500   695.00     0.63
## 3    3 31 283 0.875    17.15     0.84
## 4    4 27 254 0.846    17.52     0.85
## 5    5 27 177 0.778    12.21     0.83
## 6    6 41 434 0.889    20.19     0.80</code></pre>
<p>Next I make a function that generates a random graph from the data in Beiler et al. and calculates the properties I need.</p>
<p>For scale free graphs, I will set the power exponent to something between 2 and 3.</p>
<div class="sourceCode" id="cb467"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exp.out</span> <span class="op">&lt;-</span> <span class="fl">2.5</span></code></pre></div>
<p>The following somewhat complicated looking code does the following for each plot in each site</p>
<ul>
<li>generates a scale-free random graph</li>
<li>calculates local node clustering coefficient (transivity) for each resulting “tree,”</li>
<li>calculates the degree for each “tree,”</li>
<li>records the site of the plot.</li>
</ul>
<p>It then binds together the data collected for each plot at each site.</p>
<div class="sourceCode" id="cb468"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">ve</span><span class="op">)</span><span class="op">{</span>
  <span class="co">#make a scale-free random graph, given V and E</span>
  <span class="va">gsf</span> <span class="op">&lt;-</span> <span class="fu">sample_fitness_pl</span><span class="op">(</span><span class="va">ve</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">ve</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, exponent.out<span class="op">=</span> <span class="va">exp.out</span>,
                           exponent.in <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, loops <span class="op">=</span> <span class="cn">FALSE</span>,
                           multiple <span class="op">=</span> <span class="cn">FALSE</span>, 
                           finite.size.correction <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="co"># calculate prpoerties</span>
  <span class="va">ncc</span> <span class="op">&lt;-</span> <span class="fu">transitivity</span><span class="op">(</span><span class="va">gsf</span>, type <span class="op">=</span> <span class="st">"local"</span><span class="op">)</span>
  <span class="va">deg</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/degree.html">degree</a></span><span class="op">(</span><span class="va">gsf</span><span class="op">)</span>
  
  <span class="co">#combine in a matrix</span>
  <span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>plot<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">ve</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">deg</span><span class="op">)</span><span class="op">)</span>, <span class="va">ncc</span>, <span class="va">deg</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
  <span class="va">m</span>
 <span class="op">}</span><span class="op">)</span>

<span class="co"># bind together both sites and label columns</span>
<span class="va">df.sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">df2</span><span class="op">)</span> <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df.sf</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"plot"</span>, <span class="st">"ncc"</span>, <span class="st">"deg"</span><span class="op">)</span>

<span class="co"># plot the relation between node clustering coefficient</span>
<span class="co"># and node degree</span>
<span class="fu">ggplot</span><span class="op">(</span><span class="va">df.sf</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">deg</span>, <span class="va">ncc</span>, colour<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span>  <span class="op">+</span> <span class="fu">geom_smooth</span><span class="op">(</span> method<span class="op">=</span><span class="st">"lm"</span>, se<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:allplotsf"></span>
<img src="figs/allplotsf-1.png" alt="*Emergent relations between node clustering and node degree in scale-free random networks, based on the number of nodes and links in each plot.*" width="90%"><p class="caption">
Figure 12.17: <em>Emergent relations between node clustering and node degree in scale-free random networks, based on the number of nodes and links in each plot.</em>
</p>
</div>
<p>The result is one example (or six examples) of what we would observe in a scale-free network. As one random draw, it may or may not be particularly representative the “typical” properties suggested in Beiler et al. (2015). Many observed networks appear to be scale-free, at least at first glance <span class="citation">(<a href="references.html#ref-Barabasi:2009aa" role="doc-biblioref">Barabasi 2009</a>)</span>. They may be a useful approximation of networks where node properties might be self-reinforcing, that is the better-connected nodes tend to become ever better connected.</p>
<p>Thus far in this book, we’ve barely scratched the surface of food webs and networks. I hope that at least you’ve gotten a sense of the flavor for their investigation.</p>

</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="consumer-resource-competition-and-mutualisms.html"><span class="header-section-number">11</span> Consumer-resource Competition and Mutualisms</a></div>
<div class="next"><a href="diversity.html"><span class="header-section-number">13</span> Diversity</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#food-webs-and-other-networks"><span class="header-section-number">12</span> Food webs and other networks</a></li>
<li><a class="nav-link" href="#food-web-characteristics"><span class="header-section-number">12.1</span> Food Web Characteristics</a></li>
<li>
<a class="nav-link" href="#does-omnivory-destablize-food-chains"><span class="header-section-number">12.2</span> Does omnivory destablize food chains?</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#multi-species-lotkavolterra-notation"><span class="header-section-number">12.2.1</span> Multi-species Lotka–Volterra notation</a></li>
<li><a class="nav-link" href="#background"><span class="header-section-number">12.2.2</span> Background</a></li>
<li><a class="nav-link" href="#implementing-pimm-and-lawtons-methods"><span class="header-section-number">12.2.3</span> Implementing Pimm and Lawton’s Methods</a></li>
<li><a class="nav-link" href="#shortening-the-chain"><span class="header-section-number">12.2.4</span> Shortening the Chain</a></li>
<li><a class="nav-link" href="#adding-omnivory"><span class="header-section-number">12.2.5</span> Adding Omnivory</a></li>
<li><a class="nav-link" href="#comparing-chain-a-versus-b"><span class="header-section-number">12.2.6</span> Comparing Chain A versus B</a></li>
<li><a class="nav-link" href="#re-evaluating-take-home-messages"><span class="header-section-number">12.2.7</span> Re-evaluating Take-Home Messages</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#perhaps-mutualism-stabilizes-bipartite-networks"><span class="header-section-number">12.3</span> Perhaps mutualism stabilizes bipartite networks</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#creating-bipartite-webs"><span class="header-section-number">12.3.1</span> Creating bipartite webs</a></li>
<li><a class="nav-link" href="#testing-effects-of-nestedness-and-modularity-on-network-resilience."><span class="header-section-number">12.3.2</span> Testing effects of nestedness and modularity on network resilience.</a></li>
<li><a class="nav-link" href="#path-analysis"><span class="header-section-number">12.3.3</span> Path Analysis</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#exploring-pandora-right-here-at-home"><span class="header-section-number">12.4</span> Exploring Pandora, right here at home</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#properties-assessed"><span class="header-section-number">12.4.1</span> Properties assessed</a></li></ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Primer of Ecology using R</strong>" was written by Hank Stevens. It was last built on 2021-09-02.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
