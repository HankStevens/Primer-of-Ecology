<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>9 Host-parasitoid relations | Primer of Ecology using R</title>
<meta name="author" content="Hank Stevens">
<meta name="description" content="A parasitoid is a ghastly thing. These animals, frequently small wasps, characteristically lay an egg on their hosts, often a caterpillar, the young hatch out, and then slowly consume the juicy...">
<meta name="generator" content="bookdown 0.23 with bs4_book()">
<meta property="og:title" content="9 Host-parasitoid relations | Primer of Ecology using R">
<meta property="og:type" content="book">
<meta property="og:description" content="A parasitoid is a ghastly thing. These animals, frequently small wasps, characteristically lay an egg on their hosts, often a caterpillar, the young hatch out, and then slowly consume the juicy...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="9 Host-parasitoid relations | Primer of Ecology using R">
<meta name="twitter:description" content="A parasitoid is a ghastly thing. These animals, frequently small wasps, characteristically lay an egg on their hosts, often a caterpillar, the young hatch out, and then slowly consume the juicy...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.10/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-VCV8MES4YY"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-VCV8MES4YY');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Primer of Ecology using R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="theory.html"><span class="header-section-number">1</span> Theory in Ecology</a></li>
<li><a class="" href="oft.html"><span class="header-section-number">2</span> Optimal Foraging</a></li>
<li><a class="" href="expo.html"><span class="header-section-number">3</span> Simple density-independent growth</a></li>
<li><a class="" href="DID.html"><span class="header-section-number">4</span> Density-independent Demography</a></li>
<li><a class="" href="DDgrowth.html"><span class="header-section-number">5</span> Density-dependent growth</a></li>
<li><a class="" href="meta.html"><span class="header-section-number">6</span> Populations in Space</a></li>
<li><a class="" href="direct-competition-and-mutualism.html"><span class="header-section-number">7</span> Direct competition and mutualism</a></li>
<li><a class="" href="cr.html"><span class="header-section-number">8</span> Consumer-resource Interactions</a></li>
<li><a class="active" href="host-parasitoid-relations.html"><span class="header-section-number">9</span> Host-parasitoid relations</a></li>
<li><a class="" href="disease.html"><span class="header-section-number">10</span> Disease</a></li>
<li><a class="" href="consumer-resource-competition-and-mutualisms.html"><span class="header-section-number">11</span> Consumer-resource Competition and Mutualisms</a></li>
<li><a class="" href="food-webs-and-other-networks.html"><span class="header-section-number">12</span> Food webs and other networks</a></li>
<li><a class="" href="diversity.html"><span class="header-section-number">13</span> Diversity</a></li>
<li><a class="" href="appendix.html"><span class="header-section-number">14</span> Appendix</a></li>
<li><a class="" href="references.html"><span class="header-section-number">15</span> References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="host-parasitoid-relations" class="section level1" number="9">
<h1>
<span class="header-section-number">9</span> Host-parasitoid relations<a class="anchor" aria-label="anchor" href="#host-parasitoid-relations"><i class="fas fa-link"></i></a>
</h1>
<p>A parasitoid is a ghastly thing. These animals, frequently small wasps, characteristically lay an egg on their hosts, often a caterpillar, the young hatch out, and then slowly consume the juicy bits of the host. Neither the adult wasp nor their larvae immediately kill their host. Many eggs can be laid on a host, and many larvae can live (at least briefly) in the host. Ultimately, however, the host is gradually consumed and one or a few larvae per host metamorphosizes into an adult. Thus parasitoid larvae always consume and kill their hapless host. In this sense, their natural history is intermediate between that of predator and parasite—they are parasite-like, or a parasitoid. Thank the gods for parasitoids, as they often help suppress other animals that we like even less, such as herbivores that eat our crops. There are even parasitoids of parasitoids, or hyperparasitoids. And they are among the most diverse taxonomic groups of all animals.</p>
<p>There are a variety of characteristics about host–parasitoid relations that might make them different from the kind of predator–prey relations that we have been thinking about up until now. In particular, the life cycles of host and prey are so intimately connected that there is a one-to-one correspondence between dead hosts and the number of parasitoids in the next generation. If we know how many hosts are killed, then we know approximately how many parasitoids are born.</p>
<div id="independent-and-random-attacks" class="section level2" number="9.1">
<h2>
<span class="header-section-number">9.1</span> Independent and random attacks<a class="anchor" aria-label="anchor" href="#independent-and-random-attacks"><i class="fas fa-link"></i></a>
</h2>
<p>In keeping with convention of parasitoid models, let us describe dynamics of hosts and their parasitoid enemies with a discrete time model <span class="citation">(<a href="references.html#ref-Nicholson:1935aa" role="doc-biblioref">Nicholson and Bailey 1935</a>; <a href="references.html#ref-May:1978fk" role="doc-biblioref">R. M. May 1978</a>)</span>. This makes sense, as these organisms, typically insects, frequently complete their life cycles together and within a year. Let us pretend that the hosts, <span class="math inline">\(H\)</span>, grow geometrically in the absence of parasitoids, such that <span class="math inline">\(H_{t+1} = RH_t\)</span>. If we assume that some individuals are attacked and killed by parasitoids, <span class="math inline">\(H_a\)</span>, then this rate becomes
<span class="math display" id="eq:12">\[\begin{equation}
 \tag{5.11}
  H_{t+1} = R\left( H_t - H_a \right)
\end{equation}\]</span>
Further, we assume a couple things about parasitoid natural history. First, we pretend the parasitoids <em>search randomly and independently</em> for prey, and are able to search area, <span class="math inline">\(a\)</span> (“area of discovery”), in their life time. The total number of <em>attack events</em> then is <span class="math inline">\(E_t=aH_tP_t\)</span>: adults may lay an egg on any host it encounters, but this event does not kill the host. Therefore, hosts can receive more than one egg, thereby making the number of attacked hosts lower than the number of attack events, <span class="math inline">\(E_t\)</span>. Each attack occurs as a random event, and for now we assume that each attack is independent of all others.</p>
<p>For many species of parasitoids, only one adult can emerge from a single host, regardless of how many eggs were laid on that host. Therefore, the number of emerging adult parasitoids, <span class="math inline">\(P_{t+1}\)</span>, is simply the number of hosts that were attacked at all, whether the host received one egg or many. Therefore, the number of parasitoids at time <span class="math inline">\(t+1\)</span> is merely the number of hosts that were attacked, and we can represent this as
<span class="math display" id="eq:13">\[\begin{equation}
  \tag{9.1}
  P_{t+1} = H_a.
\end{equation}\]</span>
The assumption of one dead host = one new parasitoid can be easily relaxed if we introduce a constant <span class="math inline">\(q\)</span>, such that <span class="math inline">\(P_{t+1} = qH_a\)</span>.</p>
<p><span class="citation"><a href="references.html#ref-Nicholson:1935aa" role="doc-biblioref">Nicholson and Bailey</a> (<a href="references.html#ref-Nicholson:1935aa" role="doc-biblioref">1935</a>)</span> took advantage of a well known discrete probability distribution, the <em>Poisson distribution</em><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;This distribution was discovered by a French mathematician (Sim'{e}on-Denis Poisson (1781–1840), so we pronounce the name “pwah-sohn,” like the “fois” of fois gras, and the “sohn” with a quiet “n,” like, well, like the French would say it.&lt;/p&gt;"><sup>54</sup></a> which describes the probability of observing a particular number of events in a specified time interval or area, when thos events occur randomly and independently. It is defined as
<span class="math display">\[P\left(x\right) = \frac{\mu^x e^{-\mu}}{x!} \]</span>
where the probability of observing <span class="math inline">\(x\)</span> events (in a given time interval) depends on the overall average rate <span class="math inline">\(\mu\)</span> and the number of observed events.
It generates the series
<span class="math display">\[\begin{equation*}
  \frac{1}{e^\mu},  \frac{\mu}{1!e^\mu}, \frac{\mu^2}{2!e^\mu}, \cdots \frac{\mu^r}{r!e^\mu}
\end{equation*}\]</span>
representing the probabilities of occurrence of 0, 1, 2, <span class="math inline">\(r\)</span>. The exclamation point indicates the factorial
<span class="math display">\[x! = x(x-1)(x-2)...(1)\]</span>
and where <span class="math inline">\(0!=1\)</span> by definition. This distribution allows us to predict the number of potential hosts that escape attack is <span class="math inline">\(e^{-\mu}\)</span> where <span class="math inline">\(\mu=aP\)</span>, the per parasitoid attack area, <span class="math inline">\(a\)</span>, times the number of parasitoids, <span class="math inline">\(P\)</span>. We can then use this to create a simple discrete analytical model of host–parasitoid dynamics.
<span class="math display" id="eq:para2">\[\begin{align}
  H_{t+1} &amp;= R H_te^{-aP_t}  \tag{9.2}\\
  P_{t+1} &amp;= H_t \left(1-e^{-aP_t}\right)\tag{9.3}
\end{align}\]</span>
Parameter <span class="math inline">\(a\)</span> is known as the “area of discovery,” the area searched during a parasitoid’s lifetime. The greater the area searched (i.e., larger <span class="math inline">\(a\)</span>) means more hosts killed, and fewer to survive and contribute to the next generation. The Poisson distribution tells us that if attacks are random and independent, then <span class="math inline">\(e^{-aP_t}\)</span> is the probability of a host not being attacked. Therefore, <span class="math inline">\(H_te^{-aP_t}\)</span> is the expected number of hosts which are not attacked and survive to reproduce.</p>
<p>We can find the equilibrium for this discrete model. Recall that, in models of continuous differential equations, this meant letting <span class="math inline">\(dN/dt = 0\)</span>. In the discrete case, it means letting <span class="math inline">\(N_{t+1}-N_t=0\)</span>. The equilibrium, <span class="math inline">\(N^*\)</span>, is the value of <span class="math inline">\(N\)</span> when this is true, so <span class="math inline">\(N^*=N_{t+1}=N_t\)</span>. We use this to find the equilibrium of the parasitoids, starting with <a href="host-parasitoid-relations.html#eq:para1">(9.2)</a>,
<span class="math display">\[\begin{align}
  H^*&amp;=RH^*e^{-aP_t}\notag\\
  1 &amp;=Re^{-aP_t} \notag\\
  P^*&amp;=P_t=\frac{\log R}{a}
\end{align}\]</span>
If we recognize that in <a href="host-parasitoid-relations.html#eq:para2">(9.3)</a>, <span class="math inline">\(P_{t+1}=H_t-H_{t+1}/R\)</span>, and that <span class="math inline">\(H^*=H_t=H_{t+1}\)</span>, then we find the host equilibrium
<span class="math display">\[\begin{align}
  H^*&amp;=P^*\frac{R}{R-1}.
\end{align}\]</span></p>
<div id="simulating-simple-host-parasitoid-dynamics" class="section level3" number="9.1.1">
<h3>
<span class="header-section-number">9.1.1</span> Simulating simple host-parasitoid dynamics<a class="anchor" aria-label="anchor" href="#simulating-simple-host-parasitoid-dynamics"><i class="fas fa-link"></i></a>
</h3>
<p>Here we motivate the Nicholson-Bailey model with a simulation of these dynamics. It may provide a more intuitive understanding than simply throwing a probability distribution at the problem. In the end, we wind up at the same place, and this should be reassuring.</p>
<p>The Nicholson-Bailey model assumes that parasitoids search a fixed area, and each attacks hosts randomly and independently. We set the duration of the time series, the model parameters, and create an empty data frame to hold the results.</p>
<div class="sourceCode" id="cb257"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">time</span> <span class="op">&lt;-</span> <span class="fl">20</span>; <span class="va">R</span> <span class="op">&lt;-</span> <span class="fl">3</span>; <span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">.005</span>
<span class="va">HPs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">Hs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>, <span class="va">Ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Next we calculate the equilibrium, and use a nearby point for the initial abundances.</p>
<div class="sourceCode" id="cb258"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Pst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span><span class="op">/</span><span class="va">a</span>; <span class="va">Hst</span> <span class="op">&lt;-</span> <span class="va">Pst</span><span class="op">*</span><span class="va">R</span><span class="op">/</span><span class="op">(</span><span class="va">R</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> 
<span class="va">HPs</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Hst</span><span class="op">+</span><span class="fl">1</span>, <span class="va">Pst</span><span class="op">)</span></code></pre></div>
<p>We then project the dynamics, one generation at a time, for each time step.</p>
<div class="sourceCode" id="cb259"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">for</span><span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">time</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>  <span class="va">HPs</span><span class="op">[</span><span class="va">t</span><span class="op">+</span><span class="fl">1</span>,<span class="op">]</span>  <span class="op">&lt;-</span> <span class="op">{</span><span class="va">H</span> <span class="op">&lt;-</span> <span class="va">R</span> <span class="op">*</span> <span class="va">HPs</span><span class="op">[</span><span class="va">t</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span> <span class="op">-</span><span class="va">a</span> <span class="op">*</span> <span class="va">HPs</span><span class="op">[</span><span class="va">t</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">)</span>
                                 <span class="va">P</span> <span class="op">&lt;-</span> <span class="va">HPs</span><span class="op">[</span><span class="va">t</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">a</span><span class="op">*</span><span class="va">HPs</span><span class="op">[</span><span class="va">t</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
                               <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">H</span>,<span class="va">P</span><span class="op">)</span> <span class="op">}</span></code></pre></div>
<p>Last we plot the trajectory, placing a point at the (unstable) equilibrium, and using arrows to highlight the direction and magnitude of the increment of change per time step.</p>
<div class="sourceCode" id="cb260"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">HPs</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">HPs</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, type<span class="op">=</span><span class="st">"n"</span>, xlab<span class="op">=</span><span class="st">"H"</span>, ylab<span class="op">=</span><span class="st">"P"</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">Hst</span>, <span class="va">Pst</span><span class="op">)</span>;
<span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html">arrows</a></span><span class="op">(</span><span class="va">HPs</span><span class="op">[</span><span class="op">-</span><span class="va">time</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">HPs</span><span class="op">[</span><span class="op">-</span><span class="va">time</span>,<span class="fl">2</span><span class="op">]</span>, <span class="va">HPs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">HPs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span>, length<span class="op">=</span><span class="fl">.05</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-104"></span>
<img src="figs/unnamed-chunk-104-1.png" alt="*Dynamics around the unstable equilibrium of the Nicholson-Bailey host--parasitoid model ($R=3$, $a=0.005$). Arrows indicate a single time step; the point is the equilibrium at the center.*" width="90%"><p class="caption">
Figure 9.1: <em>Dynamics around the unstable equilibrium of the Nicholson-Bailey host–parasitoid model (<span class="math inline">\(R=3\)</span>, <span class="math inline">\(a=0.005\)</span>). Arrows indicate a single time step; the point is the equilibrium at the center.</em>
</p>
</div>
<div id="simulating-random-attacks" class="section level4" number="9.1.1.1">
<h4>
<span class="header-section-number">9.1.1.1</span> Simulating Random Attacks<a class="anchor" aria-label="anchor" href="#simulating-random-attacks"><i class="fas fa-link"></i></a>
</h4>
<p>This model makes strong assumptions about the proportion of hosts that escape attacks, that depends on parasitoid attacks being random and independent. Therefore let us simulate parasitoid attacks that are random and independent and compare those data to field data. Let’s start with some field data collected by Mark Hassell <span class="citation">(<a href="references.html#ref-May:1978fk" role="doc-biblioref">R. M. May 1978</a>)</span>, which are the number of parasitoid larvae per host, either 0, 1, 2, 3, or 4 larvae.</p>
<div class="sourceCode" id="cb261"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">totals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1066</span>, <span class="fl">176</span>, <span class="fl">48</span>, <span class="fl">8</span>, <span class="fl">5</span><span class="op">)</span></code></pre></div>
<p>Here, 1066 hosts have no larvae. We can recreate the data set, where we have one observation per host: the number of larvae in that host.</p>
<div class="sourceCode" id="cb262"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">4</span>, <span class="va">totals</span><span class="op">)</span></code></pre></div>
<p>To simulate random attacks, let’s use the same number of hosts, and the same number of attacks, and let the computer attack hosts at random. We calculate the total number of hosts, <span class="math inline">\(H\)</span>, and the total and mean number of attacks experienced by hosts.</p>
<div class="sourceCode" id="cb263"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">H</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span> <span class="va">totals</span> <span class="op">)</span>
<span class="va">No.attacks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">obs</span><span class="op">)</span>
<span class="va">mean.attacks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">obs</span><span class="op">)</span></code></pre></div>
<p>Next, the predators attack (or ‘sample’) the hosts at random and with
equal probability. To code this, we identify the hosts by numbering
them 1–<span class="math inline">\(H\)</span>. We then attack these hosts independently, that is, we <code>replace</code> each attacked host back into the pool of possible prey.</p>
<div class="sourceCode" id="cb264"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">attack.events</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">H</span>, size<span class="op">=</span><span class="va">No.attacks</span>, replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>We then count the number times different hosts were attacked.</p>
<div class="sourceCode" id="cb265"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">N.attacks.per.host</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">attack.events</span><span class="op">)</span></code></pre></div>
<p>and then find count the number of hosts that were attacked once, twice, or more.</p>
<div class="sourceCode" id="cb266"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span> <span class="va">N.attacks.per.host</span> <span class="op">)</span> <span class="op">)</span></code></pre></div>
<pre><code>## N.attacks.per.host
##   1   2   3 
## 252  29   2</code></pre>
<p>We see, for instance, that  hosts were attacked twice. This also allows us to know how many hosts were  attacked,</p>
<div class="sourceCode" id="cb268"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">not.att</span> <span class="op">&lt;-</span> <span class="va">H</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span></code></pre></div>
<p>Let’s compare the observed data to the simulated data.</p>
<div class="sourceCode" id="cb269"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">obs.sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">N.attacks.per.host</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">not.att</span>, <span class="va">tmp</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">obs</span><span class="op">)</span></code></pre></div>
<pre><code>## obs
##    0    1    2    3    4 
## 1066  176   48    8    5</code></pre>
<div class="sourceCode" id="cb271"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">obs.sim</span><span class="op">)</span></code></pre></div>
<pre><code>## obs.sim
##    0    1    2    3 
## 1020  252   29    2</code></pre>
<p><em>There seem to be fewer unattacked hosts and more attacked hosts in the random-attack simulation than in the observed data</em>. Is this simply a consequence of the observed values being one of many random possibilities? Or is it a systematic difference? How do we check this?</p>
<p>One way to check whether the observed data differ from our model of random and independent attacks is to simulate many such observations, and compare the observed data (<code>rtotals[1]</code> unattacked hosts) to the distribution of the simulated results. Here we do this by performing <span class="math inline">\(n\)</span> simulations of the same steps we used above.</p>
<div class="sourceCode" id="cb273"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span>
<span class="va">unatt.sim</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="kw">function</span><span class="op">(</span><span class="va">j</span><span class="op">)</span> <span class="op">{</span> <span class="co">## Repeat n times...</span>
  <span class="co">## simulate the same number of attacks.</span>
  <span class="va">host.sim.att</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">H</span>, size<span class="op">=</span><span class="va">No.attacks</span>, replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
  <span class="co">## subtract the number of attacked hosts from the total in the host population</span>
  <span class="co">## The number of attacks on each attacked host</span>
  <span class="va">attacks.per</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">host.sim.att</span><span class="op">)</span>
  <span class="co">## the number of attacked hosts </span>
  <span class="va">n.attd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span> <span class="va">attacks.per</span><span class="op">)</span>
  <span class="co">## the number not attacked</span>
  <span class="va">H</span> <span class="op">-</span> <span class="va">n.attd</span>
                         <span class="op">}</span> <span class="op">)</span></code></pre></div>
<p>Next we just make a histogram (Fig. <a href="host-parasitoid-relations.html#fig:PoisSim">9.2</a>) of the number of unattacked hosts, adding a dotted line to show where the true data lie, and a dashed line for the prediction, under the assumption of random and independent attacks, based on the Poisson distribution.</p>
<div class="sourceCode" id="cb274"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">unatt.sim</span>, xlab<span class="op">=</span><span class="st">"Simulated # of Unattacked Hosts"</span>, 
     prob<span class="op">=</span><span class="cn">TRUE</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">1070</span><span class="op">)</span> <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fl">1066</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">mean.attacks</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:PoisSim"></span>
<img src="figs/PoisSim-1.png" alt="*Histogram of simulated host populations, attacked at a rate of ```r round(mean.attacks,2)``` mean attacks per host, assuming a attacks on hosts are random and independent of each other.*" width="90%"><p class="caption">
Figure 9.2: <em>Histogram of simulated host populations, attacked at a rate of <code>r round(mean.attacks,2)</code> mean attacks per host, assuming a attacks on hosts are random and independent of each other.</em>
</p>
</div>
<p>Our simulation results (Fig. <a href="host-parasitoid-relations.html#fig:PoisSim">9.2</a>) indicate that the observed data include far more unattacked hosts than expected by chance.</p>
<p>Another, quicker way to evaluate the assumption of independent and random attacks is to compare the ratio of the variance of the observed larvae per host to the mean. If the data follow a Poisson distribution, this ratio is expected to equal to one.</p>
<div class="sourceCode" id="cb275"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">I</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">obs</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">obs</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1.40413</code></pre>
<p>This ratio is greater than one, but we do not know if this could be due to chance. We can test it, because under the null hypothesis, we expect that the product of the ratio and the number of hosts, <span class="math inline">\(H\)</span>, follows a <span class="math inline">\(\chi^2\)</span> distribution, with <span class="math inline">\(H-1\)</span> degrees of freedom. We can ask how likely this ratio, or a more extreme ratio, is, if attacks are random and independent. We compare it to the cumulative probability density function for the <span class="math inline">\(\chi^2\)</span> distribution.</p>
<div class="sourceCode" id="cb277"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">pchisq</a></span><span class="op">(</span><span class="va">I</span><span class="op">*</span><span class="va">H</span>, df<span class="op">=</span><span class="va">H</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>We find that, given this large number of observations, it is exceedingly unlikely to observe a ratio this large or larger. It is nice that this agrees with our simulation! We feel more confident when a parametric test agrees with a simulation of our ideas; perhaps both are not necessary, but working through both helps us to understand what we are doing.</p>
</div>
</div>
</div>
<div id="aggregation-leads-to-coexistence" class="section level2" number="9.2">
<h2>
<span class="header-section-number">9.2</span> Aggregation leads to coexistence<a class="anchor" aria-label="anchor" href="#aggregation-leads-to-coexistence"><i class="fas fa-link"></i></a>
</h2>
<p>The Nicholson-Bailey model within independent and radnom attacks, <a href="host-parasitoid-relations.html#eq:para1">(9.2)</a>, <a href="host-parasitoid-relations.html#eq:para2">(9.3)</a>, predicts that the parasitoid and host become extinct. That is potentially useful - sometimes it is exactly what we observe in local subpopulations. It may also suggest that we are missing something because not all populations become extinct. This is a feature of models that we like: they allow us to rigorously evaluate our assumptions and falsify them. All scientific ideas ultimately have to be described in a manner that could allow us to, in principle, falsify them. If we have some confidence in the model above, this falsification might lead us to ask, “what is the model missing?”</p>
<p>Perhaps what we are missing is some important parasitoid natural history. Parasitoids tend to aggregate on particular hosts or on local populations of the hosts. Some hosts are more likely to get attacked than others, resulting in more unattacked hosts and more hosts receiving multiple attacks than predicted under random and independent attacks. This may be related to their searching behavior, or to spatial distributions of hosts in the landscape. When the parasitoids aggregate, they tend to leave the low density host populations unparasitized. As a result, these low density populations act as <em>refuges</em>.</p>
<p>Perhaps we can kill two birds with one stone, and fix both problems with one step. That is what <span class="citation"><a href="references.html#ref-May:1978fk" role="doc-biblioref">R. M. May</a> (<a href="references.html#ref-May:1978fk" role="doc-biblioref">1978</a>)</span> and others have done, by assuming that parasitoids <em>aggregate</em>.</p>
<p>May proposed the following logic for one reason we might observe more unattacked hosts than expected. Imagine that the distribution of parasitoids <em>among</em> patches in the landscape can be described with one probability distribution, with some particular mean and variance in the number of parasitoids per patch. Imagine next that their attacks on hosts <em>within</em> each patch are random and independent and thus described with the Poisson distribution. This will result in a compound distribution of attacks — a combination of the among-patch, and within-patch distributions.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;This distribution is actually a mixture of Poisson distributions. The Poisson distribution is determined entirely by its mean, &lt;span class="math inline"&gt;\(\mu\)&lt;/span&gt;. If we let &lt;span class="math inline"&gt;\(\mu\)&lt;/span&gt; itself be a random variable drawn from the Gamma distribution, then we arrive at the negative binomial distribution.&lt;/p&gt;'><sup>55</sup></a> If we examine the distribution of larvae per host, for all hosts in the landscape, we will find a higher proportion of unattacked hosts, and a higher proportion of hosts that are attacked many times.</p>
<p>The <em>negative binomial distribution</em> can describe aggregated data, such as the number of larvae per host. Such data are counts greater than or equal to zero, in which the variance is greater than the mean. Thus, the negative binomial distribution can describe greater aggregation than the Poisson distribution (where <span class="math inline">\(\mu=\sigma^2\)</span>), and thereby describe nature somewhat more accurately. May suggested that while the true distribution of larvae in hosts, in any particular case, was unlikely to truly be a negative binomial, it was nonetheless a useful approximation.</p>
<p>Ecologists frequently use the negative binomial distribution for count data where the variance is greater than the mean. There are different derivations of the distribution, and therefore different parameterizations <span class="citation">(<a href="references.html#ref-Bolker:2008rr" role="doc-biblioref">Bolker 2008</a>)</span>. In ecology, we typically use the mean, <span class="math inline">\(\mu\)</span>, and the <em>overdispersion parameter</em> <span class="math inline">\(k\)</span>. The variance, <span class="math inline">\(\sigma^2\)</span>, is a function of these, where <span class="math inline">\(\sigma^2 = \mu + \mu^2/k\)</span>; by overdispersion we mean that <span class="math inline">\(\sigma^2 &gt; \mu\)</span>. Large values of <span class="math inline">\(k\)</span> (<span class="math inline">\(k&gt;10\)</span>) indicate random and independent events rather than aggregation, and the distribution becomes indistinguishable from the Poisson. Small values (<span class="math inline">\(k&lt;2\)</span>) indicate aggregation.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Although &lt;span class="math inline"&gt;\(k\)&lt;/span&gt; is often referred to as a “clumping” or “aggregation” parameter, we might think of it as a “randomness” parameter, because larger values result in more random, Poisson-like distributions.&lt;/p&gt;'><sup>56</sup></a> Fig. <a href="host-parasitoid-relations.html#fig:negbin">9.3</a> shows examples. R has the negative binomial distribution built in (<code>nbinom</code>), but does not use <span class="math inline">\(k\)</span> as one of its arguments; rather, <code>size</code> <span class="math inline">\(=k\)</span>. Here we generate a graph showing the distribution with different values of <span class="math inline">\(k\)</span>.</p>
<div class="sourceCode" id="cb279"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nb.dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>
       Random <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html">dnbinom</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">5</span>, mu<span class="op">=</span><span class="fl">.5</span>, size<span class="op">=</span><span class="fl">10</span><span class="op">^</span><span class="fl">10</span><span class="op">)</span>,
      <span class="st">"k=10"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html">dnbinom</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">5</span>, mu<span class="op">=</span><span class="fl">.5</span>, size<span class="op">=</span><span class="fl">10</span><span class="op">)</span>,
      <span class="st">"k=1"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html">dnbinom</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">5</span>, mu<span class="op">=</span><span class="fl">.5</span>, size<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,
      <span class="st">"k=0.01"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html">dnbinom</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">5</span>, mu<span class="op">=</span><span class="fl">.5</span>, size<span class="op">=</span><span class="fl">.01</span><span class="op">)</span>
               <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html">matplot</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">5</span>, <span class="va">nb.dat</span> , type<span class="op">=</span><span class="st">"b"</span>, pch<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, col<span class="op">=</span><span class="fl">1</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,
        xlab<span class="op">=</span><span class="st">"Attacks per Hosts"</span>, ylab<span class="op">=</span><span class="st">"Probability"</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">nb.dat</span><span class="op">)</span><span class="op">)</span>, pch<span class="op">=</span><span class="fl">4</span><span class="op">:</span><span class="fl">1</span>, lty<span class="op">=</span><span class="fl">4</span><span class="op">:</span><span class="fl">1</span>, bty<span class="op">=</span><span class="st">'n'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span><span class="op">(</span><span class="va">mu</span><span class="op">==</span> <span class="fl">0.5</span><span class="op">)</span>, padj<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:negbin"></span>
<img src="figs/negbin-1.png" alt="*The negative binomial distribution, where the dispersion parameter $k$ controls variance or breadth the distribution. For a given mean, smaller $k$ causes a greater variance, and results in a higher proportion of zeroes. These $k$ are representative of values from @Pacala1990.*" width="90%"><p class="caption">
Figure 9.3: <em>The negative binomial distribution, where the dispersion parameter <span class="math inline">\(k\)</span> controls variance or breadth the distribution. For a given mean, smaller <span class="math inline">\(k\)</span> causes a greater variance, and results in a higher proportion of zeroes. These <span class="math inline">\(k\)</span> are representative of values from <span class="citation"><a href="references.html#ref-Pacala1990" role="doc-biblioref">Pacala, Hassell, and May</a> (<a href="references.html#ref-Pacala1990" role="doc-biblioref">1990</a>)</span>.</em>
</p>
</div>
<p>The proportion of unattacked hosts expected under the negative binomial is <span class="math inline">\((1 + aP_t/k)^{-k}\)</span>. Therefore, we can write the analytical expressions for the population dynamics that are very similar to those of the Nicholson-Bailey model, but using the negative binomial distribution.
<span class="math display" id="eq:may14b">\[\begin{align}
  H_{t+1} &amp;= RH_t\left(1+\frac{aP_t}{k} \right)^{-k}  \tag{9.4}\\
  P_{t+1} &amp;=  H_t - H_t\left(1+\frac{aP_t}{k} \right)^{-k}  \tag{9.5}
\end{align}\]</span>
<span class="citation"><a href="references.html#ref-May:1978fk" role="doc-biblioref">R. M. May</a> (<a href="references.html#ref-May:1978fk" role="doc-biblioref">1978</a>)</span> referred to this as a phenomenlogical model (as opposed to mechanistic) because the negative binomial merely approximates the true, perhaps compound, distribution.</p>
<div id="equilibria-for-a-discrete-time-model" class="section level3" number="9.2.1">
<h3>
<span class="header-section-number">9.2.1</span> Equilibria for a discrete-time model<a class="anchor" aria-label="anchor" href="#equilibria-for-a-discrete-time-model"><i class="fas fa-link"></i></a>
</h3>
<p>The equilibria of the host and parasitoid populations in May’s model <a href="host-parasitoid-relations.html#eq:may14a">(9.4)</a>, <a href="host-parasitoid-relations.html#eq:may14b">(9.5)</a>, are derived simply, once we decide upon how to describe the condition for an equilibrium (a.k.a. steady state). In models of differential equations, this meant letting <span class="math inline">\(d N/d t =0\)</span>. In the discrete case it means letting <span class="math inline">\(N_{t+1}-N_t=0\)</span>. The equilibrium is the value of <span class="math inline">\(N\)</span> when this is true, so <span class="math inline">\(N^*=N_{t+1}=N_t\)</span>. Following this train of thought, we have $H^*=H_{t+1} = H_t $ and <span class="math inline">\(P^*=P_{t+1} = P_t\)</span>.</p>
<p>To solve for equilbria, we begin with the expression for hosts <a href="host-parasitoid-relations.html#eq:may14a">(9.4)</a>, and solve for equilibrium parasitoid density. In this case, we can divide <a href="host-parasitoid-relations.html#eq:may14a">(9.4)</a> both sides by <span class="math inline">\(H^*\)</span>.
<span class="math display">\[\begin{align}
  1 &amp;= R\left(1+\frac{aP_t}{k}\right)^{-k}\notag\\
  R^{-1} &amp;=  \left(1+\frac{aP_t}{k}\right)^{-k}\notag\\
  R^{1/k} &amp;= 1 + \frac{aP_t}{k}\notag\\
  P^* &amp;= \frac{k}{a} \left(R^{1/k} - 1 \right)\label{eq:16}
\end{align}\]</span>
Given this, what causes increases in <span class="math inline">\(P^*\)</span>? Certainly decreasing <span class="math inline">\(a\)</span> leads to increases in <span class="math inline">\(P^*\)</span>. If a parasitoid population has a smaller <span class="math inline">\(a\)</span> (i.e. smaller area of discovery), this means that they require less space, and can thereby achieve higher density. Increasing <span class="math inline">\(k\)</span> means less aggregated attack events, which increases the probability that a parasitoid larvae is alone on a host, and this increases parasitoid density, but only up to a limit.</p>
<p>If we want <span class="math inline">\(H^*\)</span> as well, we can solve for that too. We see that <a href="host-parasitoid-relations.html#eq:may14b">(9.5)</a> can be rearranged to show
<span class="math display">\[\begin{align*}
  P_{t+1} &amp;= H_t - \frac{H_{t+1}}{R}
\end{align*}\]</span>
and given contant <span class="math inline">\(H\)</span> and <span class="math inline">\(P\)</span>,
<span class="math display" id="eq:18">\[\begin{align}
  \tag{9.6}
  H^* &amp;= P^* \left(\frac{R}{R-1} \right)
\end{align}\]</span>
where <span class="math inline">\(P^*\)</span> is <a href="host-parasitoid-relations.html#eq:may14a">(9.4)</a>.</p>
</div>
</div>
<div id="stability-of-hostparasitoid-dynamics" class="section level2" number="9.3">
<h2>
<span class="header-section-number">9.3</span> Stability of host–parasitoid dynamics<a class="anchor" aria-label="anchor" href="#stability-of-hostparasitoid-dynamics"><i class="fas fa-link"></i></a>
</h2>
<p>As with differential equation models, we can analyze the stability in the immediate vicinity of equilibria in discrete time models using eigenanalysis of the Jacobian matrix. Although analogous, there are some important differences between continuous and discrete models.</p>
<ul>
<li>The Jacobian matrix is comprised of partial derivatives of growth increments (e.g., <span class="math inline">\(\Delta N = N_{t+1}-N_t\)</span>), rather than of time derivatives (e.g., <span class="math inline">\(\dot{N}\)</span>).</li>
<li>Interpretation of eigenvalues of the Jacobian reflects the difference between finite rate of increase (<span class="math inline">\(\lambda\)</span>) and the intrinsic rate of increase (<span class="math inline">\(r\)</span>); e.g., for discrete models, <span class="math inline">\(\lambda = 1\)</span> indicates zero growth.</li>
<li>Populations with discrete generations can grow too quickly to be stable (e.g., chaos in discrete logistic growth).</li>
</ul>
<p>In the discrete time case, the Jacobian matrix is the set of partial derivatives of the discrete growth increment rather than of the time derivatives used for continuous growth<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Note &lt;span class="math inline"&gt;\(dN/dt\)&lt;/span&gt; is also an increment — it is the increment &lt;span class="math inline"&gt;\(\Delta N\)&lt;/span&gt; as &lt;span class="math inline"&gt;\(\Delta t \to 0\)&lt;/span&gt;, whereas in the discrete case, &lt;span class="math inline"&gt;\(\Delta t = 1\)&lt;/span&gt;.&lt;/p&gt;'><sup>57</sup></a>. The growth increments are the increments of change over an entire time step, or <span class="math inline">\(\Delta H=H_{t+1} - H_t\)</span> and <span class="math inline">\(\Delta P=P_{t+1} - P_t\)</span>. Taking those increments from <a href="host-parasitoid-relations.html#eq:may14a">(9.4)</a>, <a href="host-parasitoid-relations.html#eq:may14b">(9.5)</a>, the Jacobian matrix of partial differential equations is
<span class="math display" id="eq:jachp">\[\begin{align}
  \tag{9.7}
\left(
\begin {array}{cc}
\frac{\partial \Delta H}{\partial H}&amp;\frac{\partial \Delta H}{\partial P}\\
\frac{\partial \Delta P}{\partial H}&amp;\frac{\partial \Delta P}{\partial P}
\end {array}
\right) =
\left(
\begin {array}{cc}
R\left(1+aP\right)^{-k}-1\quad &amp;-akHR\left(1+aP\right)^{-\left(k+1\right)} \\
1-\left(1+aP\right)^{-k}&amp; akH\left(1+aP\right)^{-\left(k+1\right)}
\end {array}
\right) 
\end{align}\]</span>
@
To analyze this at the equilibrium, we substitute <span class="math inline">\(H^*,\,P^*\)</span> for <span class="math inline">\(H,\,P\)</span>, and perform eigenanalysis. The resulting eigenvalues, <span class="math inline">\(\lambda_1,\,\lambda_2\)</span>, then reflect <em>perturbation growth increments</em>, the discrete time analogy of the instantaneous perturbation growth rates of continuous models.</p>
<p>Recall that for continuous time, <span class="math inline">\(\lambda_1\)</span> is the instantaneous rate of change in a perturbation at equilibrium,
<span class="math display" id="eq:pert1">\[\begin{equation}
 \tag{9.8}
  \dot{x}= \lambda_1 x,\quad x_t = x_0e^{\lambda_1 t}
\end{equation}\]</span>
where <span class="math inline">\(x\)</span> is the perturbation at the equilibrium; if <span class="math inline">\(\lambda_1&lt;0\)</span>, the perturbation would decline. For discrete growth, we can think of <span class="math inline">\(\lambda_1\)</span> as the discrete growth factor of a perturbation at equilibrium,
<span class="math display" id="eq:pert2">\[\begin{equation}
  \tag{9.9}
  x_{t+1}=\lambda_1x_t
\end{equation}\]</span>
where <span class="math inline">\(x\)</span> is the perturbation. Here, we see that <span class="math inline">\(x\)</span> will decline as long as <span class="math inline">\(0 &lt;\lambda_1 &lt; 1\)</span>. Second, if <span class="math inline">\(\lambda_1 &lt; 0\)</span>, then <span class="math inline">\(x_{t+1}\)</span> changes sign with each time step, and the perturbation oscillates around 0. That is alright, as the magnitude also decreases with each time step, so the perturbation still declines toward zero. However, if <span class="math inline">\(\lambda &lt; -1\)</span>, those oscillations grow and the perturbation oscillates permanently. This is directly analogous to the oscillations, or stable limit cycles, we saw in the discrete logistic growth model. Thus, a criterion for stability in discrete growth models is that for all eigenvalues, <span class="math inline">\(-1 &lt; \lambda &lt; 1\)</span>.</p>
<p>For discrete models, we also need to be a little more concerned about the imaginary part of the eigenvalues, because they contribute to the magnitude of the oscillations and eigenvalues. We therefore add that the magnitude of <span class="math inline">\(\lambda = a + bi\)</span> is <span class="math inline">\(|\lambda|=\sqrt{a^2 +b^2}\)</span>. Thus, the system is stable when <span class="math inline">\(|\lambda|\leq 1\)</span>. The magnitude of a complex number is known as its <em>modulus</em>. The moduli (plural of modulus) of the host–parasite model therefore includes the complex plane, were the real part of each eigenvalue is on the <span class="math inline">\(x\)</span>-axis, and the imaginary part is on the <span class="math inline">\(y\)</span>-axis (Fig. <a href="#fig:mod"><strong>??</strong></a>). The magnitude or modulus of an eigenvalue is the length of the vector in this plane.</p>
<p>We can illustrate the stability criterion for discrete models in a few ways. The phase plane portrait or time series would illustrate the dynamics directly. However, it is also useful to show the relation between a measure of stability and parameters influencing stability. Since aggregation seems so important in the host–parasitoid model, we can show how stability (<span class="math inline">\(\lambda\)</span>) varies with <span class="math inline">\(k\)</span>. We can thus investigate <em>how much</em> aggregation is required for stability <span class="citation">(<a href="references.html#ref-Pacala1990" role="doc-biblioref">Pacala, Hassell, and May 1990</a>)</span>. We would anticipate that stability declines (<span class="math inline">\(|\lambda| \to 1\)</span>) as <span class="math inline">\(k\)</span> increases.</p>
<p>We proceed largely as we did for continuous models, first with expressions for, and partial derivatives of, the relevant functions — for discrete models we use <span class="math inline">\(F(N_t)\)</span>, where of <span class="math inline">\(N_{t+1}=F(N_t)\)</span>.</p>
<div class="sourceCode" id="cb280"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">F.H</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">R</span><span class="op">*</span><span class="va">H</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">a</span><span class="op">*</span><span class="va">P</span><span class="op">/</span><span class="va">k</span><span class="op">)</span><span class="op">^</span><span class="op">-</span><span class="va">k</span> <span class="op">-</span> <span class="va">H</span> <span class="op">)</span>
<span class="va">F.P</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">H</span> <span class="op">-</span> <span class="va">H</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">a</span><span class="op">*</span><span class="va">P</span><span class="op">/</span><span class="va">k</span><span class="op">)</span><span class="op">^</span><span class="op">-</span><span class="va">k</span> <span class="op">-</span> <span class="va">P</span><span class="op">)</span>
<span class="va">F.H.H</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/deriv.html">D</a></span><span class="op">(</span><span class="va">F.H</span>, <span class="st">"H"</span><span class="op">)</span>; <span class="va">F.H.P</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/deriv.html">D</a></span><span class="op">(</span><span class="va">F.H</span>, <span class="st">"P"</span><span class="op">)</span>
<span class="va">F.P.H</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/deriv.html">D</a></span><span class="op">(</span><span class="va">F.P</span>, <span class="st">"H"</span><span class="op">)</span>; <span class="va">F.P.P</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/deriv.html">D</a></span><span class="op">(</span><span class="va">F.P</span>, <span class="st">"P"</span><span class="op">)</span></code></pre></div>
<p>We next specify a sequence of <span class="math inline">\(k\)</span>’s, and for each <span class="math inline">\(k\)</span>, find the equilibria, evaluate the Jacobian, and return the eigenvalues of the Jacobian.</p>
<div class="sourceCode" id="cb281"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, by<span class="op">=</span><span class="fl">.01</span><span class="op">)</span>
<span class="va">R</span> <span class="op">&lt;-</span> <span class="fl">3</span>
<span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">.005</span>
<span class="va">HPeigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">k</span>, <span class="kw">function</span><span class="op">(</span><span class="va">ki</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">k</span> <span class="op">&lt;-</span> <span class="va">ki</span>
  <span class="va">P</span> <span class="op">&lt;-</span> <span class="va">k</span><span class="op">*</span><span class="op">(</span><span class="va">R</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">k</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="va">a</span>
  <span class="va">H</span> <span class="op">&lt;-</span> <span class="va">P</span> <span class="op">*</span> <span class="va">R</span><span class="op">/</span><span class="op">(</span><span class="va">R</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>
  <span class="va">jac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="va">F.H.H</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="va">F.H.P</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="va">F.P.H</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="va">F.P.P</span><span class="op">)</span><span class="op">)</span>, 
                nrow<span class="op">=</span><span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">TRUE</span> <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">jac</span><span class="op">)</span><span class="op">[[</span><span class="st">"values"</span><span class="op">]</span><span class="op">]</span> 
<span class="op">}</span> <span class="op">)</span></code></pre></div>
<p>Last, we plot the eigenvalue with the greatest absolute magnitude, and retain the sign of the real part, <span class="math inline">\(\lambda\)</span>  <span class="math inline">\(k\)</span>.</p>
<div class="sourceCode" id="cb282"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">modmaxs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span> <span class="va">HPeigs</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">lambdas</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/complex.html">Mod</a></span><span class="op">(</span><span class="va">lambdas</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/sign.html">sign</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/complex.html">Re</a></span><span class="op">(</span><span class="va">lambdas</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/complex.html">Mod</a></span><span class="op">(</span><span class="va">lambdas</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="op">}</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">k</span>, <span class="va">modmaxs</span>, type<span class="op">=</span><span class="st">'l'</span>, 
     ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span><span class="op">(</span><span class="st">"Stability "</span><span class="op">*</span><span class="op">(</span><span class="va">lambda</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="op">-</span><span class="fl">1</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:LK"></span>
<img src="figs/LK-1.png" alt="*Dynamical stability of a discrete host-parasitoid model with aggregation. Region of stability for the rate of change following a small perturbation away from equilibrium. The plus sign '+' is $(0,0)$ and the two small circles are the complex eigenvalues. The length of the vector is the modulus.*" width="90%"><p class="caption">
Figure 9.4: <em>Dynamical stability of a discrete host-parasitoid model with aggregation. Region of stability for the rate of change following a small perturbation away from equilibrium. The plus sign ‘+’ is <span class="math inline">\((0,0)\)</span> and the two small circles are the complex eigenvalues. The length of the vector is the modulus.</em>
</p>
</div>
<p>Most of our eigenvalues are complex numbers. It is typically important to evaluate the modulus, or magnitude, of the eigenvalues of a Jacobian matrix for a discrete model. Here we graph them in the complex number plane (Fig. <a href="#fig:mod"><strong>??</strong></a>).</p>
<p>First we set up the unit circle which will define the stability region in the complex number plane.</p>
<div class="sourceCode" id="cb283"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">th</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="va">pi</span>, <span class="va">pi</span>, len<span class="op">=</span><span class="fl">100</span><span class="op">)</span>
<span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fl">1i</span><span class="op">*</span><span class="va">th</span><span class="op">)</span></code></pre></div>
<p>We then plot the circle and add the eigenvalues for our smallest <span class="math inline">\(k\)</span>;</p>
<div class="sourceCode" id="cb284"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>pty<span class="op">=</span><span class="st">"s"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">z</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>, pch<span class="op">=</span><span class="fl">3</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">HPeigs</span><span class="op">[</span>,<span class="fl">100</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html">arrows</a></span><span class="op">(</span>x0<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, y0<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, x1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/complex.html">Re</a></span><span class="op">(</span><span class="va">HPeigs</span><span class="op">[</span>,<span class="fl">100</span><span class="op">]</span><span class="op">)</span>, y1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/complex.html">Im</a></span><span class="op">(</span><span class="va">HPeigs</span><span class="op">[</span>,<span class="fl">100</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:LK2"></span>
<img src="figs/LK2-1.png" alt="*The complex number plane; the length of the arrows are the moduli, lambda.*" width="90%"><p class="caption">
Figure 9.5: <em>The complex number plane; the length of the arrows are the moduli, lambda.</em>
</p>
</div>
<p>The length of the arrows are the moduli, <span class="math inline">\(|\lambda|\)</span>.</p>
<div id="dynamics-of-the-may-hostparasitoid-model" class="section level4" number="9.3.0.1">
<h4>
<span class="header-section-number">9.3.0.1</span> Dynamics of the May host–parasitoid model<a class="anchor" aria-label="anchor" href="#dynamics-of-the-may-hostparasitoid-model"><i class="fas fa-link"></i></a>
</h4>
<p>Here we simply play with May’s model. The following generates a phase plane diagram of the dynamics, although it is not shown. We set the duration of the time series, the model parameters, and create an empty data frame to hold the results.</p>
<div class="sourceCode" id="cb285"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">time</span> <span class="op">&lt;-</span> <span class="fl">20</span>; <span class="va">R</span> <span class="op">&lt;-</span> <span class="fl">3</span>; <span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">.005</span>; <span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">.6</span>
<span class="va">HP2s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Hs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>, Ps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Next we calculate the equilibrium, and use a nearby point for the initial abundances.</p>
<div class="sourceCode" id="cb286"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">P2st</span> <span class="op">&lt;-</span> <span class="va">k</span><span class="op">*</span><span class="op">(</span><span class="va">R</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">k</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="va">a</span>; <span class="va">H2st</span> <span class="op">&lt;-</span> <span class="va">P2st</span> <span class="op">*</span> <span class="va">R</span><span class="op">/</span><span class="op">(</span><span class="va">R</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>
<span class="va">P2st</span>;<span class="va">H2st</span></code></pre></div>
<pre><code>## [1] 628.8302</code></pre>
<pre><code>## [1] 943.2453</code></pre>
<div class="sourceCode" id="cb289"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">HP2s</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">500</span><span class="op">)</span></code></pre></div>
<p>We then project the dynamics, one generation at a time, for each time step.</p>
<div class="sourceCode" id="cb290"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">for</span><span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">time</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>  <span class="va">HP2s</span><span class="op">[</span><span class="va">t</span><span class="op">+</span><span class="fl">1</span>,<span class="op">]</span>  <span class="op">&lt;-</span> <span class="op">{</span>
  <span class="va">H</span> <span class="op">&lt;-</span> <span class="va">R</span> <span class="op">*</span> <span class="va">HP2s</span><span class="op">[</span><span class="va">t</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">a</span><span class="op">*</span><span class="va">HP2s</span><span class="op">[</span><span class="va">t</span>,<span class="fl">2</span><span class="op">]</span><span class="op">/</span><span class="va">k</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="va">k</span><span class="op">)</span>
  <span class="va">P</span> <span class="op">&lt;-</span> <span class="va">HP2s</span><span class="op">[</span><span class="va">t</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">HP2s</span><span class="op">[</span><span class="va">t</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">a</span><span class="op">*</span><span class="va">HP2s</span><span class="op">[</span><span class="va">t</span>,<span class="fl">2</span><span class="op">]</span><span class="op">/</span><span class="va">k</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="va">k</span><span class="op">)</span>
                               <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">H</span>,<span class="va">P</span><span class="op">)</span> <span class="op">}</span></code></pre></div>
<p>Last we plot the trajectory, placing a point at the equilibrium, and using arrows to highlight the direction and magnitude of the increment of change per time step.</p>
<div class="sourceCode" id="cb291"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">HP2s</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">HP2s</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, type<span class="op">=</span><span class="st">"l"</span>, xlab<span class="op">=</span><span class="st">"H"</span>, ylab<span class="op">=</span><span class="st">"P"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">H2st</span>, <span class="va">P2st</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html">arrows</a></span><span class="op">(</span><span class="va">HP2s</span><span class="op">[</span><span class="op">-</span><span class="va">time</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">HP2s</span><span class="op">[</span><span class="op">-</span><span class="va">time</span>,<span class="fl">2</span><span class="op">]</span>, <span class="va">HP2s</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">HP2s</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span>, length<span class="op">=</span><span class="fl">.05</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="inline-figure"><img src="figs/NBdynStable-1.png" width="90%"></div>
</div>
</div>
<div id="in-fine-3" class="section level2" number="9.4">
<h2>
<span class="header-section-number">9.4</span> <em>In Fine</em><a class="anchor" aria-label="anchor" href="#in-fine-3"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>Parasitoids are a wildly diverse set of taxa, but largely undescribed.</li>
<li>We commonly model host-parasitoid in discrete time.</li>
<li>Hosts grow geometrically, and die when attacked.</li>
<li>Parasitoids in the next generation are simply the number of attacked hosts.</li>
<li>Aggregation in attack behavior appears to allow stable coexistence.</li>
</ul>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="cr.html"><span class="header-section-number">8</span> Consumer-resource Interactions</a></div>
<div class="next"><a href="disease.html"><span class="header-section-number">10</span> Disease</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#host-parasitoid-relations"><span class="header-section-number">9</span> Host-parasitoid relations</a></li>
<li>
<a class="nav-link" href="#independent-and-random-attacks"><span class="header-section-number">9.1</span> Independent and random attacks</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#simulating-simple-host-parasitoid-dynamics"><span class="header-section-number">9.1.1</span> Simulating simple host-parasitoid dynamics</a></li></ul>
</li>
<li>
<a class="nav-link" href="#aggregation-leads-to-coexistence"><span class="header-section-number">9.2</span> Aggregation leads to coexistence</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#equilibria-for-a-discrete-time-model"><span class="header-section-number">9.2.1</span> Equilibria for a discrete-time model</a></li></ul>
</li>
<li><a class="nav-link" href="#stability-of-hostparasitoid-dynamics"><span class="header-section-number">9.3</span> Stability of host–parasitoid dynamics</a></li>
<li><a class="nav-link" href="#in-fine-3"><span class="header-section-number">9.4</span> In Fine</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Primer of Ecology using R</strong>" was written by Hank Stevens. It was last built on 2021-08-31.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
